[0m16:37:42.842876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1038fcb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d5d270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d5cb50>]}


============================== 16:37:42.845706 | 4f6690f6-4c90-4165-8fb2-67c521987a4b ==============================
[0m16:37:42.845706 [info ] [MainThread]: Running with dbt=1.10.4
[0m16:37:42.846173 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/michaelmalotte/code/personal/fao-elt-pipelines/dbt_project/logs', 'debug': 'False', 'profiles_dir': '/Users/michaelmalotte/code/personal/fao-elt-pipelines/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --target dev', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:37:42.850194 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'DB_PASSWORD'
[0m16:37:42.851711 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.061838042, "process_in_blocks": "0", "process_kernel_time": 0.097299, "process_mem_max_rss": "111214592", "process_out_blocks": "0", "process_user_time": 0.792491}
[0m16:37:42.852116 [debug] [MainThread]: Command `dbt run` failed at 16:37:42.852056 after 0.06 seconds
[0m16:37:42.852424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1038fcb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d5fdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d5ee00>]}
[0m16:37:42.852756 [debug] [MainThread]: Flushing usage events
[0m16:37:43.218298 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:38:31.897991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105868bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10725d2a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10725cb80>]}


============================== 16:38:31.900461 | e5ab9c03-8321-4c3d-a6b8-e58f10c47cb3 ==============================
[0m16:38:31.900461 [info ] [MainThread]: Running with dbt=1.10.4
[0m16:38:31.900921 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/michaelmalotte/code/personal/fao-elt-pipelines/dbt_project', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/michaelmalotte/code/personal/fao-elt-pipelines/dbt_project/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --target dev', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:38:32.018487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e5ab9c03-8321-4c3d-a6b8-e58f10c47cb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10284d420>]}
[0m16:38:32.059503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e5ab9c03-8321-4c3d-a6b8-e58f10c47cb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10724dc90>]}
[0m16:38:32.060327 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:38:32.278728 [debug] [MainThread]: checksum: 23bc95a42434187059b2384bcd89d8aac150f1bd09bd2e89bfeb67b518f50b75, vars: {}, profile: , target: dev, version: 1.10.4
[0m16:38:32.279362 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m16:38:32.279716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e5ab9c03-8321-4c3d-a6b8-e58f10c47cb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e15900>]}
[0m16:38:33.122978 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.fao_elt_pipeline.bronze
[0m16:38:33.128845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e5ab9c03-8321-4c3d-a6b8-e58f10c47cb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1028762f0>]}
[0m16:38:33.190362 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/michaelmalotte/code/personal/fao-elt-pipelines/dbt_project/target/manifest.json
[0m16:38:33.191637 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/michaelmalotte/code/personal/fao-elt-pipelines/dbt_project/target/semantic_manifest.json
[0m16:38:33.204561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e5ab9c03-8321-4c3d-a6b8-e58f10c47cb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10876a230>]}
[0m16:38:33.205003 [info ] [MainThread]: Found 6 models, 23 data tests, 2 sources, 435 macros
[0m16:38:33.205330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e5ab9c03-8321-4c3d-a6b8-e58f10c47cb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10876a8f0>]}
[0m16:38:33.206456 [info ] [MainThread]: 
[0m16:38:33.206774 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:38:33.207046 [info ] [MainThread]: 
[0m16:38:33.207416 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:38:33.209786 [debug] [ThreadPool]: Acquiring new postgres connection 'list_fao'
[0m16:38:33.215362 [debug] [ThreadPool]: Acquiring new postgres connection 'list_fao'
[0m16:38:33.239381 [debug] [ThreadPool]: Using postgres connection "list_fao"
[0m16:38:33.239763 [debug] [ThreadPool]: Using postgres connection "list_fao"
[0m16:38:33.240079 [debug] [ThreadPool]: On list_fao: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "connection_name": "list_fao"} */

    select distinct nspname from pg_namespace
  
[0m16:38:33.240402 [debug] [ThreadPool]: On list_fao: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "connection_name": "list_fao"} */

    select distinct nspname from pg_namespace
  
[0m16:38:33.240687 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:38:33.240976 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:38:33.271300 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.030 seconds
[0m16:38:33.271697 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.031 seconds
[0m16:38:33.272510 [debug] [ThreadPool]: On list_fao: Close
[0m16:38:33.273192 [debug] [ThreadPool]: On list_fao: Close
[0m16:38:33.273934 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_fao, now create_fao_public_gold)
[0m16:38:33.274306 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_fao, now create_fao_public_silver)
[0m16:38:33.274773 [debug] [ThreadPool]: Creating schema "database: "fao"
schema: "public_gold"
"
[0m16:38:33.275175 [debug] [ThreadPool]: Creating schema "database: "fao"
schema: "public_silver"
"
[0m16:38:33.278332 [debug] [ThreadPool]: Using postgres connection "create_fao_public_gold"
[0m16:38:33.279934 [debug] [ThreadPool]: Using postgres connection "create_fao_public_silver"
[0m16:38:33.280299 [debug] [ThreadPool]: On create_fao_public_gold: BEGIN
[0m16:38:33.280589 [debug] [ThreadPool]: On create_fao_public_silver: BEGIN
[0m16:38:33.280874 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:38:33.281138 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:38:33.292357 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m16:38:33.292764 [debug] [ThreadPool]: Using postgres connection "create_fao_public_silver"
[0m16:38:33.293133 [debug] [ThreadPool]: On create_fao_public_silver: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "connection_name": "create_fao_public_silver"} */
create schema if not exists "public_silver"
[0m16:38:33.293761 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m16:38:33.294079 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m16:38:33.294367 [debug] [ThreadPool]: Using postgres connection "create_fao_public_gold"
[0m16:38:33.294981 [debug] [ThreadPool]: On create_fao_public_silver: COMMIT
[0m16:38:33.295288 [debug] [ThreadPool]: On create_fao_public_gold: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "connection_name": "create_fao_public_gold"} */
create schema if not exists "public_gold"
[0m16:38:33.295581 [debug] [ThreadPool]: Using postgres connection "create_fao_public_silver"
[0m16:38:33.295895 [debug] [ThreadPool]: On create_fao_public_silver: COMMIT
[0m16:38:33.296351 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m16:38:33.296962 [debug] [ThreadPool]: On create_fao_public_gold: COMMIT
[0m16:38:33.297268 [debug] [ThreadPool]: Using postgres connection "create_fao_public_gold"
[0m16:38:33.297555 [debug] [ThreadPool]: On create_fao_public_gold: COMMIT
[0m16:38:33.297842 [debug] [ThreadPool]: SQL status: COMMIT in 0.002 seconds
[0m16:38:33.298151 [debug] [ThreadPool]: On create_fao_public_silver: Close
[0m16:38:33.298473 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m16:38:33.298989 [debug] [ThreadPool]: On create_fao_public_gold: Close
[0m16:38:33.299972 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_fao_public_silver, now list_fao_public_gold)
[0m16:38:33.300455 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_fao_public_gold, now list_fao_public_silver)
[0m16:38:33.303689 [debug] [ThreadPool]: Using postgres connection "list_fao_public_gold"
[0m16:38:33.304908 [debug] [ThreadPool]: Using postgres connection "list_fao_public_silver"
[0m16:38:33.305218 [debug] [ThreadPool]: On list_fao_public_gold: BEGIN
[0m16:38:33.305508 [debug] [ThreadPool]: On list_fao_public_silver: BEGIN
[0m16:38:33.305790 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:38:33.306057 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:38:33.323535 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m16:38:33.323946 [debug] [ThreadPool]: Using postgres connection "list_fao_public_silver"
[0m16:38:33.324261 [debug] [ThreadPool]: On list_fao_public_silver: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "connection_name": "list_fao_public_silver"} */
select
      'fao' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'fao' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'fao' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m16:38:33.324627 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m16:38:33.325071 [debug] [ThreadPool]: Using postgres connection "list_fao_public_gold"
[0m16:38:33.325406 [debug] [ThreadPool]: On list_fao_public_gold: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "connection_name": "list_fao_public_gold"} */
select
      'fao' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'fao' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'fao' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m16:38:33.329056 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m16:38:33.329399 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m16:38:33.330199 [debug] [ThreadPool]: On list_fao_public_silver: ROLLBACK
[0m16:38:33.330861 [debug] [ThreadPool]: On list_fao_public_gold: ROLLBACK
[0m16:38:33.331504 [debug] [ThreadPool]: On list_fao_public_silver: Close
[0m16:38:33.331822 [debug] [ThreadPool]: On list_fao_public_gold: Close
[0m16:38:33.334980 [debug] [MainThread]: Using postgres connection "master"
[0m16:38:33.335392 [debug] [MainThread]: On master: BEGIN
[0m16:38:33.335678 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:38:33.343370 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m16:38:33.343729 [debug] [MainThread]: Using postgres connection "master"
[0m16:38:33.344108 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:38:33.346639 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m16:38:33.347420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e5ab9c03-8321-4c3d-a6b8-e58f10c47cb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10839cfa0>]}
[0m16:38:33.347848 [debug] [MainThread]: On master: ROLLBACK
[0m16:38:33.348477 [debug] [MainThread]: Using postgres connection "master"
[0m16:38:33.348796 [debug] [MainThread]: On master: BEGIN
[0m16:38:33.350217 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:38:33.350538 [debug] [MainThread]: On master: COMMIT
[0m16:38:33.350825 [debug] [MainThread]: Using postgres connection "master"
[0m16:38:33.351111 [debug] [MainThread]: On master: COMMIT
[0m16:38:33.351933 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:38:33.352233 [debug] [MainThread]: On master: Close
[0m16:38:33.354084 [debug] [Thread-1 (]: Began running node model.fao_elt_pipeline.silver_prices_cleaned
[0m16:38:33.354466 [debug] [Thread-2 (]: Began running node model.fao_elt_pipeline.silver_production_cleaned
[0m16:38:33.354874 [info ] [Thread-1 (]: 1 of 6 START sql table model public_silver.silver_prices_cleaned ............... [RUN]
[0m16:38:33.355281 [info ] [Thread-2 (]: 2 of 6 START sql table model public_silver.silver_production_cleaned ........... [RUN]
[0m16:38:33.355671 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_fao_public_gold, now model.fao_elt_pipeline.silver_prices_cleaned)
[0m16:38:33.356037 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_fao_public_silver, now model.fao_elt_pipeline.silver_production_cleaned)
[0m16:38:33.356395 [debug] [Thread-1 (]: Began compiling node model.fao_elt_pipeline.silver_prices_cleaned
[0m16:38:33.356723 [debug] [Thread-2 (]: Began compiling node model.fao_elt_pipeline.silver_production_cleaned
[0m16:38:33.362120 [debug] [Thread-1 (]: Writing injected SQL for node "model.fao_elt_pipeline.silver_prices_cleaned"
[0m16:38:33.364429 [debug] [Thread-2 (]: Writing injected SQL for node "model.fao_elt_pipeline.silver_production_cleaned"
[0m16:38:33.365168 [debug] [Thread-1 (]: Began executing node model.fao_elt_pipeline.silver_prices_cleaned
[0m16:38:33.378103 [debug] [Thread-2 (]: Began executing node model.fao_elt_pipeline.silver_production_cleaned
[0m16:38:33.384897 [debug] [Thread-1 (]: Writing runtime sql for node "model.fao_elt_pipeline.silver_prices_cleaned"
[0m16:38:33.386759 [debug] [Thread-2 (]: Writing runtime sql for node "model.fao_elt_pipeline.silver_production_cleaned"
[0m16:38:33.387479 [debug] [Thread-2 (]: Using postgres connection "model.fao_elt_pipeline.silver_production_cleaned"
[0m16:38:33.387821 [debug] [Thread-2 (]: On model.fao_elt_pipeline.silver_production_cleaned: BEGIN
[0m16:38:33.388130 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:38:33.388541 [debug] [Thread-1 (]: Using postgres connection "model.fao_elt_pipeline.silver_prices_cleaned"
[0m16:38:33.388868 [debug] [Thread-1 (]: On model.fao_elt_pipeline.silver_prices_cleaned: BEGIN
[0m16:38:33.389172 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:38:33.400859 [debug] [Thread-2 (]: SQL status: BEGIN in 0.013 seconds
[0m16:38:33.401234 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m16:38:33.401603 [debug] [Thread-2 (]: Using postgres connection "model.fao_elt_pipeline.silver_production_cleaned"
[0m16:38:33.401956 [debug] [Thread-1 (]: Using postgres connection "model.fao_elt_pipeline.silver_prices_cleaned"
[0m16:38:33.402387 [debug] [Thread-2 (]: On model.fao_elt_pipeline.silver_production_cleaned: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.silver_production_cleaned"} */

  
    

  create  table "fao"."public_silver"."silver_production_cleaned__dbt_tmp"
  
  
    as
  
  (
    

WITH raw_production AS (
    SELECT
        data,
        loaded_at
    FROM "fao"."bronze"."raw_food_balance"
),

flattened_production AS (
    SELECT
        (data->>'area')::TEXT as country_name,
        (data->>'area_code')::TEXT as area_code,
        (data->>'area_code_m49')::TEXT as area_code_m49,
        (data->>'element')::TEXT as element_name,
        (data->>'element_code')::TEXT as element_code,
        (data->>'flag')::TEXT as flag,
        (data->>'item')::TEXT as item_name,
        (data->>'item_code')::TEXT as item_code,
        (data->>'item_code_fbs')::TEXT as item_code_fbs,
        (data->>'unit')::TEXT as unit,
        (data->>'value')::NUMERIC as production_value,
        (data->>'year')::INTEGER as year,
        loaded_at
    FROM raw_production
)

SELECT
    
    md5(
            coalesce(cast(area_code as varchar), '') || '-' || 
            coalesce(cast(item_code as varchar), '') || '-' || 
            coalesce(cast(year as varchar), '')
    )
 as production_id,
    country_name,
    area_code,
    area_code_m49,
    element_name,
    element_code,
    flag,
    item_name,
    item_code,
    item_code_fbs,
    unit,
    production_value,
    year,
    -- Convert to metric tons for consistency
    CASE
        WHEN unit = '1000 t' THEN production_value * 1000
        ELSE production_value
    END as production_metric_tons,
    -- Add data quality flags
    CASE
        WHEN production_value IS NULL OR production_value < 0 THEN FALSE
        ELSE TRUE
    END as is_valid_production,
    -- Add standardized country names
    CASE
        WHEN country_name LIKE '%Côte%' THEN 'Ivory Coast'
        WHEN country_name = 'China, mainland' THEN 'China'
        WHEN country_name = 'United States of America' THEN 'USA'
        WHEN country_name = 'United Kingdom of Great Britain and Northern Ireland' THEN 'UK'
        ELSE country_name
    END as country_name_standardized,
    loaded_at,
    CURRENT_TIMESTAMP as transformed_at
FROM flattened_production
WHERE element_name = 'Production'  -- Focus on production data only
  AND production_value >= 0
  AND year >= 1990
  );
  
[0m16:38:33.402892 [debug] [Thread-1 (]: On model.fao_elt_pipeline.silver_prices_cleaned: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.silver_prices_cleaned"} */

  
    

  create  table "fao"."public_silver"."silver_prices_cleaned__dbt_tmp"
  
  
    as
  
  (
    

WITH raw_prices AS (
    SELECT
        data,
        loaded_at
    FROM "fao"."bronze"."raw_prices"
),

flattened_prices AS (
    SELECT
        (data->>'area')::TEXT as country_name,
        (data->>'area_code')::TEXT as area_code,
        (data->>'area_code_m49')::TEXT as area_code_m49,
        (data->>'element')::TEXT as element_name,
        (data->>'element_code')::TEXT as element_code,
        (data->>'flag')::TEXT as flag,
        (data->>'item')::TEXT as item_name,
        (data->>'item_code')::TEXT as item_code,
        (data->>'item_code_cpc')::TEXT as item_code_cpc,
        (data->>'unit')::TEXT as unit,
        (data->>'value')::NUMERIC as price_value,
        (data->>'year')::INTEGER as year,
        loaded_at
    FROM raw_prices
)

SELECT
    
    md5(
            coalesce(cast(area_code as varchar), '') || '-' || 
            coalesce(cast(item_code as varchar), '') || '-' || 
            coalesce(cast(year as varchar), '')
    )
 as price_id,
    country_name,
    area_code,
    area_code_m49,
    element_name,
    element_code,
    flag,
    item_name,
    item_code,
    item_code_cpc,
    unit,
    price_value,
    year,
    -- Add data quality flags
    CASE
        WHEN price_value IS NULL OR price_value <= 0 THEN FALSE
        ELSE TRUE
    END as is_valid_price,
    -- Add standardized country names (handle special characters)
    CASE
        WHEN country_name LIKE '%Côte%' THEN 'Ivory Coast'
        WHEN country_name = 'China, mainland' THEN 'China'
        WHEN country_name = 'United States of America' THEN 'USA'
        WHEN country_name = 'United Kingdom of Great Britain and Northern Ireland' THEN 'UK'
        ELSE country_name
    END as country_name_standardized,
    loaded_at,
    CURRENT_TIMESTAMP as transformed_at
FROM flattened_prices
WHERE price_value IS NOT NULL
  AND price_value > 0
  AND year >= 1990  -- Focus on more recent data
  );
  
[0m16:38:33.406774 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.003 seconds
[0m16:38:33.407148 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.004 seconds
[0m16:38:33.415356 [debug] [Thread-2 (]: Using postgres connection "model.fao_elt_pipeline.silver_production_cleaned"
[0m16:38:33.416258 [debug] [Thread-1 (]: Using postgres connection "model.fao_elt_pipeline.silver_prices_cleaned"
[0m16:38:33.416617 [debug] [Thread-2 (]: On model.fao_elt_pipeline.silver_production_cleaned: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.silver_production_cleaned"} */

    create  index if not exists
  "53c76f45a064bf01b6d41f98401fad48"
  on "fao"."public_silver"."silver_production_cleaned__dbt_tmp" using btree
  (area_code, year)
  
[0m16:38:33.416952 [debug] [Thread-1 (]: On model.fao_elt_pipeline.silver_prices_cleaned: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.silver_prices_cleaned"} */

    create  index if not exists
  "ba05bb9c707cf7235bdc7501f8d37ca9"
  on "fao"."public_silver"."silver_prices_cleaned__dbt_tmp" using btree
  (area_code, year)
  
[0m16:38:33.422442 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.005 seconds
[0m16:38:33.422794 [debug] [Thread-2 (]: SQL status: CREATE INDEX in 0.006 seconds
[0m16:38:33.423709 [debug] [Thread-1 (]: Using postgres connection "model.fao_elt_pipeline.silver_prices_cleaned"
[0m16:38:33.424510 [debug] [Thread-2 (]: Using postgres connection "model.fao_elt_pipeline.silver_production_cleaned"
[0m16:38:33.424853 [debug] [Thread-1 (]: On model.fao_elt_pipeline.silver_prices_cleaned: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.silver_prices_cleaned"} */

    create  index if not exists
  "6bc0c957153f4c4be8373c6c57d24d9f"
  on "fao"."public_silver"."silver_prices_cleaned__dbt_tmp" using btree
  (item_code)
  
[0m16:38:33.425186 [debug] [Thread-2 (]: On model.fao_elt_pipeline.silver_production_cleaned: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.silver_production_cleaned"} */

    create  index if not exists
  "e4b973ec8e15ff289f7ce1b2613c6d5a"
  on "fao"."public_silver"."silver_production_cleaned__dbt_tmp" using btree
  (item_code)
  
[0m16:38:33.426789 [debug] [Thread-2 (]: SQL status: CREATE INDEX in 0.001 seconds
[0m16:38:33.427119 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.002 seconds
[0m16:38:33.430754 [debug] [Thread-2 (]: Using postgres connection "model.fao_elt_pipeline.silver_production_cleaned"
[0m16:38:33.432540 [debug] [Thread-1 (]: Using postgres connection "model.fao_elt_pipeline.silver_prices_cleaned"
[0m16:38:33.432890 [debug] [Thread-2 (]: On model.fao_elt_pipeline.silver_production_cleaned: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.silver_production_cleaned"} */
alter table "fao"."public_silver"."silver_production_cleaned__dbt_tmp" rename to "silver_production_cleaned"
[0m16:38:33.433225 [debug] [Thread-1 (]: On model.fao_elt_pipeline.silver_prices_cleaned: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.silver_prices_cleaned"} */
alter table "fao"."public_silver"."silver_prices_cleaned__dbt_tmp" rename to "silver_prices_cleaned"
[0m16:38:33.438618 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m16:38:33.445478 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.012 seconds
[0m16:38:33.448133 [debug] [Thread-1 (]: On model.fao_elt_pipeline.silver_prices_cleaned: COMMIT
[0m16:38:33.449099 [debug] [Thread-2 (]: On model.fao_elt_pipeline.silver_production_cleaned: COMMIT
[0m16:38:33.449505 [debug] [Thread-1 (]: Using postgres connection "model.fao_elt_pipeline.silver_prices_cleaned"
[0m16:38:33.449862 [debug] [Thread-2 (]: Using postgres connection "model.fao_elt_pipeline.silver_production_cleaned"
[0m16:38:33.450182 [debug] [Thread-1 (]: On model.fao_elt_pipeline.silver_prices_cleaned: COMMIT
[0m16:38:33.450487 [debug] [Thread-2 (]: On model.fao_elt_pipeline.silver_production_cleaned: COMMIT
[0m16:38:33.454011 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m16:38:33.458432 [debug] [Thread-1 (]: Applying DROP to: "fao"."public_silver"."silver_prices_cleaned__dbt_backup"
[0m16:38:33.458836 [debug] [Thread-2 (]: SQL status: COMMIT in 0.008 seconds
[0m16:38:33.461033 [debug] [Thread-1 (]: Using postgres connection "model.fao_elt_pipeline.silver_prices_cleaned"
[0m16:38:33.462610 [debug] [Thread-2 (]: Applying DROP to: "fao"."public_silver"."silver_production_cleaned__dbt_backup"
[0m16:38:33.463014 [debug] [Thread-1 (]: On model.fao_elt_pipeline.silver_prices_cleaned: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.silver_prices_cleaned"} */
drop table if exists "fao"."public_silver"."silver_prices_cleaned__dbt_backup" cascade
[0m16:38:33.463452 [debug] [Thread-2 (]: Using postgres connection "model.fao_elt_pipeline.silver_production_cleaned"
[0m16:38:33.463858 [debug] [Thread-2 (]: On model.fao_elt_pipeline.silver_production_cleaned: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.silver_production_cleaned"} */
drop table if exists "fao"."public_silver"."silver_production_cleaned__dbt_backup" cascade
[0m16:38:33.464919 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m16:38:33.466414 [debug] [Thread-1 (]: On model.fao_elt_pipeline.silver_prices_cleaned: Close
[0m16:38:33.466770 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.003 seconds
[0m16:38:33.467547 [debug] [Thread-2 (]: On model.fao_elt_pipeline.silver_production_cleaned: Close
[0m16:38:33.469062 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5ab9c03-8321-4c3d-a6b8-e58f10c47cb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e3dae0>]}
[0m16:38:33.469395 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5ab9c03-8321-4c3d-a6b8-e58f10c47cb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071d8b20>]}
[0m16:38:33.469961 [info ] [Thread-1 (]: 1 of 6 OK created sql table model public_silver.silver_prices_cleaned .......... [[32mSELECT 0[0m in 0.11s]
[0m16:38:33.470505 [info ] [Thread-2 (]: 2 of 6 OK created sql table model public_silver.silver_production_cleaned ...... [[32mSELECT 0[0m in 0.11s]
[0m16:38:33.470969 [debug] [Thread-1 (]: Finished running node model.fao_elt_pipeline.silver_prices_cleaned
[0m16:38:33.471396 [debug] [Thread-2 (]: Finished running node model.fao_elt_pipeline.silver_production_cleaned
[0m16:38:33.472080 [debug] [Thread-4 (]: Began running node model.fao_elt_pipeline.gold_country_metrics
[0m16:38:33.472414 [debug] [Thread-3 (]: Began running node model.fao_elt_pipeline.gold_price_production_analysis
[0m16:38:33.472772 [debug] [Thread-1 (]: Began running node model.fao_elt_pipeline.gold_regional_summary
[0m16:38:33.473178 [info ] [Thread-4 (]: 3 of 6 START sql table model public_gold.gold_country_metrics .................. [RUN]
[0m16:38:33.473584 [info ] [Thread-3 (]: 4 of 6 START sql table model public_gold.gold_price_production_analysis ........ [RUN]
[0m16:38:33.473976 [info ] [Thread-1 (]: 5 of 6 START sql table model public_gold.gold_regional_summary ................. [RUN]
[0m16:38:33.474399 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.fao_elt_pipeline.gold_country_metrics'
[0m16:38:33.474730 [debug] [Thread-2 (]: Began running node model.fao_elt_pipeline.silver_top_countries
[0m16:38:33.475134 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.fao_elt_pipeline.gold_price_production_analysis'
[0m16:38:33.475468 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fao_elt_pipeline.silver_prices_cleaned, now model.fao_elt_pipeline.gold_regional_summary)
[0m16:38:33.475834 [debug] [Thread-4 (]: Began compiling node model.fao_elt_pipeline.gold_country_metrics
[0m16:38:33.476223 [info ] [Thread-2 (]: 6 of 6 START sql table model public_silver.silver_top_countries ................ [RUN]
[0m16:38:33.476595 [debug] [Thread-3 (]: Began compiling node model.fao_elt_pipeline.gold_price_production_analysis
[0m16:38:33.476929 [debug] [Thread-1 (]: Began compiling node model.fao_elt_pipeline.gold_regional_summary
[0m16:38:33.479677 [debug] [Thread-4 (]: Writing injected SQL for node "model.fao_elt_pipeline.gold_country_metrics"
[0m16:38:33.480184 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.fao_elt_pipeline.silver_production_cleaned, now model.fao_elt_pipeline.silver_top_countries)
[0m16:38:33.482193 [debug] [Thread-3 (]: Writing injected SQL for node "model.fao_elt_pipeline.gold_price_production_analysis"
[0m16:38:33.484566 [debug] [Thread-1 (]: Writing injected SQL for node "model.fao_elt_pipeline.gold_regional_summary"
[0m16:38:33.484991 [debug] [Thread-2 (]: Began compiling node model.fao_elt_pipeline.silver_top_countries
[0m16:38:33.487496 [debug] [Thread-2 (]: Writing injected SQL for node "model.fao_elt_pipeline.silver_top_countries"
[0m16:38:33.487941 [debug] [Thread-3 (]: Began executing node model.fao_elt_pipeline.gold_price_production_analysis
[0m16:38:33.488412 [debug] [Thread-4 (]: Began executing node model.fao_elt_pipeline.gold_country_metrics
[0m16:38:33.488812 [debug] [Thread-1 (]: Began executing node model.fao_elt_pipeline.gold_regional_summary
[0m16:38:33.490853 [debug] [Thread-3 (]: Writing runtime sql for node "model.fao_elt_pipeline.gold_price_production_analysis"
[0m16:38:33.491282 [debug] [Thread-2 (]: Began executing node model.fao_elt_pipeline.silver_top_countries
[0m16:38:33.493774 [debug] [Thread-4 (]: Writing runtime sql for node "model.fao_elt_pipeline.gold_country_metrics"
[0m16:38:33.495774 [debug] [Thread-1 (]: Writing runtime sql for node "model.fao_elt_pipeline.gold_regional_summary"
[0m16:38:33.498094 [debug] [Thread-2 (]: Writing runtime sql for node "model.fao_elt_pipeline.silver_top_countries"
[0m16:38:33.498779 [debug] [Thread-3 (]: Using postgres connection "model.fao_elt_pipeline.gold_price_production_analysis"
[0m16:38:33.499194 [debug] [Thread-4 (]: Using postgres connection "model.fao_elt_pipeline.gold_country_metrics"
[0m16:38:33.499546 [debug] [Thread-3 (]: On model.fao_elt_pipeline.gold_price_production_analysis: BEGIN
[0m16:38:33.499901 [debug] [Thread-1 (]: Using postgres connection "model.fao_elt_pipeline.gold_regional_summary"
[0m16:38:33.500229 [debug] [Thread-4 (]: On model.fao_elt_pipeline.gold_country_metrics: BEGIN
[0m16:38:33.500577 [debug] [Thread-2 (]: Using postgres connection "model.fao_elt_pipeline.silver_top_countries"
[0m16:38:33.500891 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:38:33.501217 [debug] [Thread-1 (]: On model.fao_elt_pipeline.gold_regional_summary: BEGIN
[0m16:38:33.501536 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:38:33.501871 [debug] [Thread-2 (]: On model.fao_elt_pipeline.silver_top_countries: BEGIN
[0m16:38:33.502290 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:38:33.502692 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:38:33.523590 [debug] [Thread-3 (]: SQL status: BEGIN in 0.023 seconds
[0m16:38:33.524126 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m16:38:33.524591 [debug] [Thread-3 (]: Using postgres connection "model.fao_elt_pipeline.gold_price_production_analysis"
[0m16:38:33.525068 [debug] [Thread-4 (]: SQL status: BEGIN in 0.024 seconds
[0m16:38:33.525396 [debug] [Thread-1 (]: Using postgres connection "model.fao_elt_pipeline.gold_regional_summary"
[0m16:38:33.525698 [debug] [Thread-2 (]: SQL status: BEGIN in 0.023 seconds
[0m16:38:33.526163 [debug] [Thread-3 (]: On model.fao_elt_pipeline.gold_price_production_analysis: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.gold_price_production_analysis"} */

  
    

  create  table "fao"."public_gold"."gold_price_production_analysis__dbt_tmp"
  
  
    as
  
  (
    

WITH item_production AS (
    SELECT
        item_name,
        item_code,
        year,
        SUM(production_metric_tons) as global_production,
        COUNT(DISTINCT area_code) as producing_countries
    FROM "fao"."public_silver"."silver_production_cleaned"
    WHERE is_valid_production = TRUE
    GROUP BY item_name, item_code, year
),

item_prices AS (
    SELECT
        item_name,
        item_code,
        year,
        AVG(price_value) as avg_global_price,
        MAX(price_value) as max_price,
        MIN(price_value) as min_price,
        COUNT(DISTINCT area_code) as countries_with_prices
    FROM "fao"."public_silver"."silver_prices_cleaned"
    WHERE is_valid_price = TRUE
    GROUP BY item_name, item_code, year
),

price_production_combined AS (
    SELECT
        COALESCE(ip.item_name, ipr.item_name) as item_name,
        COALESCE(ip.item_code, ipr.item_code) as item_code,
        COALESCE(ip.year, ipr.year) as year,
        ip.global_production,
        ip.producing_countries,
        ipr.avg_global_price,
        ipr.max_price,
        ipr.min_price,
        ipr.countries_with_prices,
        -- Calculate price-production metrics
        CASE
            WHEN ip.global_production > 0 AND ipr.avg_global_price > 0
            THEN ipr.avg_global_price * ip.global_production
            ELSE NULL
        END as market_value
    FROM item_production ip
    FULL OUTER JOIN item_prices ipr
        ON ip.item_code = ipr.item_code
        AND ip.year = ipr.year
)

SELECT
    item_name,
    item_code,
    -- Aggregate metrics across all years
    ROUND(AVG(global_production), 0) as avg_annual_production,
    ROUND(SUM(global_production), 0) as total_production_all_years,
    ROUND(AVG(avg_global_price), 2) as avg_price_all_years,
    ROUND(AVG(market_value), 0) as avg_annual_market_value,
    ROUND(SUM(market_value), 0) as total_market_value,
    -- Price volatility
    ROUND(AVG(max_price - min_price), 2) as avg_price_spread,
    ROUND(MAX(max_price), 2) as highest_price_recorded,
    -- Market concentration
    ROUND(AVG(producing_countries), 1) as avg_producing_countries,
    ROUND(AVG(countries_with_prices), 1) as avg_countries_with_prices,
    -- Categorization
    CASE
        WHEN AVG(global_production) > 10000000 THEN 'Major Commodity'
        WHEN AVG(global_production) > 1000000 THEN 'Medium Commodity'
        ELSE 'Minor Commodity'
    END as commodity_scale,
    CASE
        WHEN AVG(avg_global_price) > 2000 THEN 'Premium Product'
        WHEN AVG(avg_global_price) > 500 THEN 'Standard Product'
        ELSE 'Basic Product'
    END as price_tier,
    -- Data quality
    COUNT(DISTINCT year) as years_with_data,
    MIN(year) as first_year,
    MAX(year) as last_year,
    CURRENT_TIMESTAMP as calculated_at
FROM price_production_combined
WHERE item_name IS NOT NULL
GROUP BY item_name, item_code
HAVING COUNT(DISTINCT year) >= 5  -- Only include items with sufficient data
ORDER BY total_market_value DESC NULLS LAST
  );
  
[0m16:38:33.526643 [debug] [Thread-4 (]: Using postgres connection "model.fao_elt_pipeline.gold_country_metrics"
[0m16:38:33.527193 [debug] [Thread-1 (]: On model.fao_elt_pipeline.gold_regional_summary: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.gold_regional_summary"} */

  
    

  create  table "fao"."public_gold"."gold_regional_summary__dbt_tmp"
  
  
    as
  
  (
    

WITH country_regions AS (
    -- Simple regional classification based on country names
    -- In production, you'd use a proper country-region mapping table
    SELECT
        country_name_standardized,
        area_code,
        CASE
            WHEN country_name_standardized IN ('China', 'India', 'Japan', 'Republic of Korea',
                                               'Thailand', 'Pakistan', 'Bangladesh', 'Myanmar') THEN 'Asia'
            WHEN country_name_standardized IN ('USA', 'Canada', 'Mexico') THEN 'North America'
            WHEN country_name_standardized IN ('Brazil', 'Argentina', 'Chile', 'Colombia',
                                               'Peru', 'Ecuador', 'Venezuela (Bolivarian Republic of)',
                                               'Paraguay', 'Uruguay', 'Bolivia (Plurinational State of)') THEN 'South America'
            WHEN country_name_standardized IN ('Germany', 'France', 'UK', 'Italy', 'Spain',
                                               'Poland', 'Netherlands (Kingdom of the)', 'Belgium',
                                               'Greece', 'Portugal', 'Sweden', 'Austria',
                                               'Denmark', 'Finland', 'Norway', 'Switzerland') THEN 'Europe'
            WHEN country_name_standardized IN ('Nigeria', 'Egypt', 'South Africa', 'Kenya',
                                               'Ethiopia', 'Morocco', 'Tunisia', 'Algeria',
                                               'Ghana', 'Ivory Coast', 'Senegal') THEN 'Africa'
            WHEN country_name_standardized IN ('Australia', 'New Zealand', 'Fiji') THEN 'Oceania'
            WHEN country_name_standardized IN ('Saudi Arabia', 'Iran (Islamic Republic of)',
                                               'Iraq', 'Syrian Arab Republic', 'Yemen',
                                               'United Arab Emirates', 'Oman') THEN 'Middle East'
            ELSE 'Other'
        END as region
    FROM (
        SELECT DISTINCT country_name_standardized, area_code
        FROM "fao"."public_silver"."silver_production_cleaned"
        UNION
        SELECT DISTINCT country_name_standardized, area_code
        FROM "fao"."public_silver"."silver_prices_cleaned"
    ) countries
),

regional_production AS (
    SELECT
        cr.region,
        p.year,
        p.item_name,
        SUM(p.production_metric_tons) as regional_production,
        COUNT(DISTINCT p.area_code) as countries_producing,
        AVG(p.production_metric_tons) as avg_country_production
    FROM "fao"."public_silver"."silver_production_cleaned" p
    JOIN country_regions cr
        ON p.country_name_standardized = cr.country_name_standardized
    WHERE p.is_valid_production = TRUE
    GROUP BY cr.region, p.year, p.item_name
),

regional_prices AS (
    SELECT
        cr.region,
        pr.year,
        pr.item_name,
        AVG(pr.price_value) as avg_regional_price,
        MAX(pr.price_value) as max_regional_price,
        MIN(pr.price_value) as min_regional_price,
        COUNT(DISTINCT pr.area_code) as countries_with_prices
    FROM "fao"."public_silver"."silver_prices_cleaned" pr
    JOIN country_regions cr
        ON pr.country_name_standardized = cr.country_name_standardized
    WHERE pr.is_valid_price = TRUE
    GROUP BY cr.region, pr.year, pr.item_name
)

SELECT
    COALESCE(rp.region, rpr.region) as region,
    -- Production metrics
    ROUND(SUM(rp.regional_production), 0) as total_production_metric_tons,
    ROUND(AVG(rp.regional_production), 0) as avg_annual_production,
    COUNT(DISTINCT rp.countries_producing) as total_producing_countries,
    COUNT(DISTINCT rp.item_name) as products_produced,
    -- Price metrics
    ROUND(AVG(rpr.avg_regional_price), 2) as avg_price_usd_per_tonne,
    ROUND(MAX(rpr.max_regional_price), 2) as highest_price_recorded,
    ROUND(AVG(rpr.max_regional_price - rpr.min_regional_price), 2) as avg_price_volatility,
    -- Market value
    ROUND(SUM(
        CASE
            WHEN rp.regional_production > 0 AND rpr.avg_regional_price > 0
            THEN rp.regional_production * rpr.avg_regional_price
            ELSE 0
        END
    ), 0) as total_market_value,
    -- Growth metrics (comparing recent vs early years)
    ROUND(
        AVG(CASE WHEN rp.year >= 2018 THEN rp.regional_production END) -
        AVG(CASE WHEN rp.year <= 1995 THEN rp.regional_production END),
        0
    ) as production_growth,
    -- Regional characteristics
    CASE
        WHEN SUM(rp.regional_production) > 100000000 THEN 'Major Agricultural Region'
        WHEN SUM(rp.regional_production) > 10000000 THEN 'Medium Agricultural Region'
        ELSE 'Minor Agricultural Region'
    END as regional_scale,
    -- Data coverage
    COUNT(DISTINCT COALESCE(rp.year, rpr.year)) as years_with_data,
    MIN(COALESCE(rp.year, rpr.year)) as first_year,
    MAX(COALESCE(rp.year, rpr.year)) as last_year,
    CURRENT_TIMESTAMP as calculated_at
FROM regional_production rp
FULL OUTER JOIN regional_prices rpr
    ON rp.region = rpr.region
    AND rp.year = rpr.year
    AND rp.item_name = rpr.item_name
WHERE COALESCE(rp.region, rpr.region) != 'Other'
GROUP BY COALESCE(rp.region, rpr.region)
ORDER BY total_production_metric_tons DESC
  );
  
[0m16:38:33.527742 [debug] [Thread-2 (]: Using postgres connection "model.fao_elt_pipeline.silver_top_countries"
[0m16:38:33.528305 [debug] [Thread-4 (]: On model.fao_elt_pipeline.gold_country_metrics: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.gold_country_metrics"} */

  
    

  create  table "fao"."public_gold"."gold_country_metrics__dbt_tmp"
  
  
    as
  
  (
    

WITH country_production AS (
    SELECT
        country_name_standardized as country_name,
        area_code,
        year,
        SUM(production_metric_tons) as annual_production,
        COUNT(DISTINCT item_code) as products_produced
    FROM "fao"."public_silver"."silver_production_cleaned"
    WHERE is_valid_production = TRUE
    GROUP BY country_name_standardized, area_code, year
),

country_prices AS (
    SELECT
        country_name_standardized as country_name,
        area_code,
        year,
        AVG(price_value) as avg_annual_price,
        COUNT(DISTINCT item_code) as products_priced
    FROM "fao"."public_silver"."silver_prices_cleaned"
    WHERE is_valid_price = TRUE
    GROUP BY country_name_standardized, area_code, year
),

country_trends AS (
    SELECT
        cp.country_name,
        cp.area_code,
        -- Production metrics
        SUM(cp.annual_production) as total_production_all_years,
        AVG(cp.annual_production) as avg_annual_production,
        MAX(cp.annual_production) as peak_annual_production,
        MIN(cp.annual_production) as min_annual_production,
        -- Calculate production growth rate (comparing first and last 3 years)
        AVG(CASE WHEN cp.year >= 2018 THEN cp.annual_production END) -
        AVG(CASE WHEN cp.year <= 1993 THEN cp.annual_production END) as production_change,
        -- Price metrics
        AVG(pc.avg_annual_price) as avg_price_all_years,
        MAX(pc.avg_annual_price) as max_price,
        MIN(pc.avg_annual_price) as min_price,
        -- Product diversity
        MAX(cp.products_produced) as max_products_produced,
        AVG(cp.products_produced) as avg_products_produced,
        -- Data availability
        COUNT(DISTINCT cp.year) as years_with_data,
        MIN(cp.year) as first_year,
        MAX(cp.year) as last_year
    FROM country_production cp
    LEFT JOIN country_prices pc
        ON cp.country_name = pc.country_name
        AND cp.area_code = pc.area_code
        AND cp.year = pc.year
    GROUP BY cp.country_name, cp.area_code
)





SELECT
    country_name,
    area_code,
    -- Production metrics
    ROUND(total_production_all_years, 0) as total_production_metric_tons,
    ROUND(avg_annual_production, 0) as avg_annual_production_metric_tons,
    ROUND(peak_annual_production, 0) as peak_production_metric_tons,
    ROUND(production_change, 0) as production_growth_metric_tons,
    CASE
        WHEN production_change > 0 THEN 'Growing'
        WHEN production_change < 0 THEN 'Declining'
        ELSE 'Stable'
    END as production_trend,
    -- Price metrics
    ROUND(avg_price_all_years, 2) as avg_price_usd_per_tonne,
    ROUND(max_price, 2) as max_price_usd_per_tonne,
    ROUND(min_price, 2) as min_price_usd_per_tonne,
    ROUND(max_price - min_price, 2) as price_volatility,
    -- Product diversity
    max_products_produced,
    ROUND(avg_products_produced, 1) as avg_products_produced,
    -- Classifications
    CASE
        WHEN total_production_all_years > 1000000 THEN 'Major Producer'
        WHEN total_production_all_years > 100000 THEN 'Medium Producer'
        ELSE 'Small Producer'
    END as producer_category,
    CASE
        WHEN avg_price_all_years > 1000 THEN 'High Value'
        WHEN avg_price_all_years > 500 THEN 'Medium Value'
        ELSE 'Low Value'
    END as price_category,
    -- Metadata
    years_with_data,
    first_year,
    last_year,
    CURRENT_TIMESTAMP as calculated_at
FROM country_trends
WHERE total_production_all_years > 0
ORDER BY total_production_all_years DESC
  );
  
[0m16:38:33.528988 [debug] [Thread-2 (]: On model.fao_elt_pipeline.silver_top_countries: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.silver_top_countries"} */

  
    

  create  table "fao"."public_silver"."silver_top_countries__dbt_tmp"
  
  
    as
  
  (
    

WITH production_rankings AS (
    SELECT
        country_name_standardized,
        area_code,
        SUM(production_metric_tons) as total_production,
        COUNT(DISTINCT item_code) as product_diversity,
        COUNT(DISTINCT year) as years_of_data,
        AVG(production_metric_tons) as avg_annual_production,
        MAX(year) as latest_year
    FROM "fao"."public_silver"."silver_production_cleaned"
    WHERE is_valid_production = TRUE
    GROUP BY country_name_standardized, area_code
),

price_rankings AS (
    SELECT
        country_name_standardized,
        area_code,
        AVG(price_value) as avg_price,
        COUNT(DISTINCT item_code) as items_with_prices,
        MAX(price_value) as max_price,
        MIN(price_value) as min_price
    FROM "fao"."public_silver"."silver_prices_cleaned"
    WHERE is_valid_price = TRUE
    GROUP BY country_name_standardized, area_code
),

combined_rankings AS (
    SELECT
        COALESCE(pr.country_name_standardized, pc.country_name_standardized) as country_name,
        COALESCE(pr.area_code, pc.area_code) as area_code,
        pr.total_production,
        pr.product_diversity,
        pr.avg_annual_production,
        pc.avg_price,
        pc.items_with_prices,
        pc.max_price,
        -- Calculate rankings
        RANK() OVER (ORDER BY pr.total_production DESC NULLS LAST) as production_rank,
        RANK() OVER (ORDER BY pc.avg_price DESC NULLS LAST) as price_rank,
        RANK() OVER (ORDER BY pr.product_diversity DESC NULLS LAST) as diversity_rank
    FROM production_rankings pr
    FULL OUTER JOIN price_rankings pc
        ON pr.country_name_standardized = pc.country_name_standardized
        AND pr.area_code = pc.area_code
)

SELECT
    country_name,
    area_code,
    total_production,
    product_diversity,
    ROUND(avg_annual_production, 2) as avg_annual_production,
    ROUND(avg_price, 2) as avg_price_usd_per_tonne,
    items_with_prices,
    ROUND(max_price, 2) as max_price_usd_per_tonne,
    production_rank,
    price_rank,
    diversity_rank,
    -- Identify top performers
    CASE
        WHEN production_rank <= 10 THEN TRUE
        ELSE FALSE
    END as is_top_producer,
    CASE
        WHEN price_rank <= 10 THEN TRUE
        ELSE FALSE
    END as is_high_price_country,
    CASE
        WHEN diversity_rank <= 10 THEN TRUE
        ELSE FALSE
    END as is_diverse_producer,
    CURRENT_TIMESTAMP as calculated_at
FROM combined_rankings
WHERE country_name IS NOT NULL
  );
  
[0m16:38:33.532380 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.004 seconds
[0m16:38:33.532850 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.004 seconds
[0m16:38:33.535113 [debug] [Thread-3 (]: Using postgres connection "model.fao_elt_pipeline.gold_price_production_analysis"
[0m16:38:33.535479 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.006 seconds
[0m16:38:33.535827 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.006 seconds
[0m16:38:33.537522 [debug] [Thread-1 (]: Using postgres connection "model.fao_elt_pipeline.gold_regional_summary"
[0m16:38:33.537870 [debug] [Thread-3 (]: On model.fao_elt_pipeline.gold_price_production_analysis: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.gold_price_production_analysis"} */
alter table "fao"."public_gold"."gold_price_production_analysis__dbt_tmp" rename to "gold_price_production_analysis"
[0m16:38:33.539667 [debug] [Thread-2 (]: Using postgres connection "model.fao_elt_pipeline.silver_top_countries"
[0m16:38:33.540553 [debug] [Thread-4 (]: Using postgres connection "model.fao_elt_pipeline.gold_country_metrics"
[0m16:38:33.540892 [debug] [Thread-1 (]: On model.fao_elt_pipeline.gold_regional_summary: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.gold_regional_summary"} */
alter table "fao"."public_gold"."gold_regional_summary__dbt_tmp" rename to "gold_regional_summary"
[0m16:38:33.541257 [debug] [Thread-2 (]: On model.fao_elt_pipeline.silver_top_countries: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.silver_top_countries"} */
alter table "fao"."public_silver"."silver_top_countries__dbt_tmp" rename to "silver_top_countries"
[0m16:38:33.541604 [debug] [Thread-4 (]: On model.fao_elt_pipeline.gold_country_metrics: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.gold_country_metrics"} */

    create  index if not exists
  "ae5a13575fdc6b0b504f22e9bb8862b0"
  on "fao"."public_gold"."gold_country_metrics__dbt_tmp" using btree
  (country_name)
  
[0m16:38:33.542001 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:38:33.542865 [debug] [Thread-3 (]: On model.fao_elt_pipeline.gold_price_production_analysis: COMMIT
[0m16:38:33.543242 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:38:33.543571 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:38:33.543889 [debug] [Thread-3 (]: Using postgres connection "model.fao_elt_pipeline.gold_price_production_analysis"
[0m16:38:33.544193 [debug] [Thread-4 (]: SQL status: CREATE INDEX in 0.002 seconds
[0m16:38:33.544902 [debug] [Thread-1 (]: On model.fao_elt_pipeline.gold_regional_summary: COMMIT
[0m16:38:33.545643 [debug] [Thread-2 (]: On model.fao_elt_pipeline.silver_top_countries: COMMIT
[0m16:38:33.545966 [debug] [Thread-3 (]: On model.fao_elt_pipeline.gold_price_production_analysis: COMMIT
[0m16:38:33.548328 [debug] [Thread-4 (]: Using postgres connection "model.fao_elt_pipeline.gold_country_metrics"
[0m16:38:33.548691 [debug] [Thread-1 (]: Using postgres connection "model.fao_elt_pipeline.gold_regional_summary"
[0m16:38:33.549020 [debug] [Thread-2 (]: Using postgres connection "model.fao_elt_pipeline.silver_top_countries"
[0m16:38:33.549369 [debug] [Thread-4 (]: On model.fao_elt_pipeline.gold_country_metrics: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.gold_country_metrics"} */
alter table "fao"."public_gold"."gold_country_metrics__dbt_tmp" rename to "gold_country_metrics"
[0m16:38:33.549686 [debug] [Thread-1 (]: On model.fao_elt_pipeline.gold_regional_summary: COMMIT
[0m16:38:33.549985 [debug] [Thread-2 (]: On model.fao_elt_pipeline.silver_top_countries: COMMIT
[0m16:38:33.551432 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m16:38:33.552746 [debug] [Thread-3 (]: Applying DROP to: "fao"."public_gold"."gold_price_production_analysis__dbt_backup"
[0m16:38:33.553155 [debug] [Thread-3 (]: Using postgres connection "model.fao_elt_pipeline.gold_price_production_analysis"
[0m16:38:33.553481 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m16:38:33.553764 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m16:38:33.554064 [debug] [Thread-3 (]: On model.fao_elt_pipeline.gold_price_production_analysis: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.gold_price_production_analysis"} */
drop table if exists "fao"."public_gold"."gold_price_production_analysis__dbt_backup" cascade
[0m16:38:33.554351 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m16:38:33.555682 [debug] [Thread-2 (]: Applying DROP to: "fao"."public_silver"."silver_top_countries__dbt_backup"
[0m16:38:33.556409 [debug] [Thread-4 (]: On model.fao_elt_pipeline.gold_country_metrics: COMMIT
[0m16:38:33.557816 [debug] [Thread-1 (]: Applying DROP to: "fao"."public_gold"."gold_regional_summary__dbt_backup"
[0m16:38:33.558169 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.001 seconds
[0m16:38:33.558572 [debug] [Thread-2 (]: Using postgres connection "model.fao_elt_pipeline.silver_top_countries"
[0m16:38:33.558885 [debug] [Thread-4 (]: Using postgres connection "model.fao_elt_pipeline.gold_country_metrics"
[0m16:38:33.559273 [debug] [Thread-1 (]: Using postgres connection "model.fao_elt_pipeline.gold_regional_summary"
[0m16:38:33.560023 [debug] [Thread-3 (]: On model.fao_elt_pipeline.gold_price_production_analysis: Close
[0m16:38:33.560354 [debug] [Thread-2 (]: On model.fao_elt_pipeline.silver_top_countries: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.silver_top_countries"} */
drop table if exists "fao"."public_silver"."silver_top_countries__dbt_backup" cascade
[0m16:38:33.560667 [debug] [Thread-4 (]: On model.fao_elt_pipeline.gold_country_metrics: COMMIT
[0m16:38:33.560975 [debug] [Thread-1 (]: On model.fao_elt_pipeline.gold_regional_summary: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.gold_regional_summary"} */
drop table if exists "fao"."public_gold"."gold_regional_summary__dbt_backup" cascade
[0m16:38:33.561453 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5ab9c03-8321-4c3d-a6b8-e58f10c47cb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108314fa0>]}
[0m16:38:33.561985 [info ] [Thread-3 (]: 4 of 6 OK created sql table model public_gold.gold_price_production_analysis ... [[32mSELECT 0[0m in 0.09s]
[0m16:38:33.562393 [debug] [Thread-3 (]: Finished running node model.fao_elt_pipeline.gold_price_production_analysis
[0m16:38:33.564984 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m16:38:33.565316 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.004 seconds
[0m16:38:33.565705 [debug] [Thread-4 (]: SQL status: COMMIT in 0.004 seconds
[0m16:38:33.566649 [debug] [Thread-1 (]: On model.fao_elt_pipeline.gold_regional_summary: Close
[0m16:38:33.567438 [debug] [Thread-2 (]: On model.fao_elt_pipeline.silver_top_countries: Close
[0m16:38:33.568898 [debug] [Thread-4 (]: Applying DROP to: "fao"."public_gold"."gold_country_metrics__dbt_backup"
[0m16:38:33.569406 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5ab9c03-8321-4c3d-a6b8-e58f10c47cb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e14eb0>]}
[0m16:38:33.569918 [debug] [Thread-4 (]: Using postgres connection "model.fao_elt_pipeline.gold_country_metrics"
[0m16:38:33.570284 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5ab9c03-8321-4c3d-a6b8-e58f10c47cb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071d8220>]}
[0m16:38:33.570764 [info ] [Thread-1 (]: 5 of 6 OK created sql table model public_gold.gold_regional_summary ............ [[32mSELECT 0[0m in 0.09s]
[0m16:38:33.571129 [debug] [Thread-4 (]: On model.fao_elt_pipeline.gold_country_metrics: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.gold_country_metrics"} */
drop table if exists "fao"."public_gold"."gold_country_metrics__dbt_backup" cascade
[0m16:38:33.571594 [info ] [Thread-2 (]: 6 of 6 OK created sql table model public_silver.silver_top_countries ........... [[32mSELECT 0[0m in 0.09s]
[0m16:38:33.572023 [debug] [Thread-1 (]: Finished running node model.fao_elt_pipeline.gold_regional_summary
[0m16:38:33.572448 [debug] [Thread-2 (]: Finished running node model.fao_elt_pipeline.silver_top_countries
[0m16:38:33.573576 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.001 seconds
[0m16:38:33.574480 [debug] [Thread-4 (]: On model.fao_elt_pipeline.gold_country_metrics: Close
[0m16:38:33.574938 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5ab9c03-8321-4c3d-a6b8-e58f10c47cb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e35f60>]}
[0m16:38:33.575413 [info ] [Thread-4 (]: 3 of 6 OK created sql table model public_gold.gold_country_metrics ............. [[32mSELECT 0[0m in 0.10s]
[0m16:38:33.575820 [debug] [Thread-4 (]: Finished running node model.fao_elt_pipeline.gold_country_metrics
[0m16:38:33.576842 [debug] [MainThread]: Using postgres connection "master"
[0m16:38:33.577242 [debug] [MainThread]: On master: BEGIN
[0m16:38:33.577518 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:38:33.585576 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m16:38:33.585928 [debug] [MainThread]: On master: COMMIT
[0m16:38:33.586214 [debug] [MainThread]: Using postgres connection "master"
[0m16:38:33.586488 [debug] [MainThread]: On master: COMMIT
[0m16:38:33.587061 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:38:33.587444 [debug] [MainThread]: On master: Close
[0m16:38:33.587809 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:38:33.588083 [debug] [MainThread]: Connection 'model.fao_elt_pipeline.gold_regional_summary' was properly closed.
[0m16:38:33.588344 [debug] [MainThread]: Connection 'model.fao_elt_pipeline.silver_top_countries' was properly closed.
[0m16:38:33.588598 [debug] [MainThread]: Connection 'model.fao_elt_pipeline.gold_country_metrics' was properly closed.
[0m16:38:33.588861 [debug] [MainThread]: Connection 'model.fao_elt_pipeline.gold_price_production_analysis' was properly closed.
[0m16:38:33.589185 [info ] [MainThread]: 
[0m16:38:33.589477 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m16:38:33.590258 [debug] [MainThread]: Command end result
[0m16:38:33.606243 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/michaelmalotte/code/personal/fao-elt-pipelines/dbt_project/target/manifest.json
[0m16:38:33.607335 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/michaelmalotte/code/personal/fao-elt-pipelines/dbt_project/target/semantic_manifest.json
[0m16:38:33.611795 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/michaelmalotte/code/personal/fao-elt-pipelines/dbt_project/target/run_results.json
[0m16:38:33.612115 [info ] [MainThread]: 
[0m16:38:33.612448 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:38:33.612740 [info ] [MainThread]: 
[0m16:38:33.613046 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m16:38:33.614877 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.7645882, "process_in_blocks": "0", "process_kernel_time": 0.169793, "process_mem_max_rss": "150126592", "process_out_blocks": "0", "process_user_time": 2.136299}
[0m16:38:33.620316 [debug] [MainThread]: Command `dbt run` succeeded at 16:38:33.620226 after 1.77 seconds
[0m16:38:33.620747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105868bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058fbfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e964a0>]}
[0m16:38:33.621109 [debug] [MainThread]: Flushing usage events
[0m16:38:34.029082 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:38:35.021919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106628bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f5d420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f5cd00>]}


============================== 16:38:35.024386 | d343e4a6-1ce4-4421-9b40-7f89862e87f0 ==============================
[0m16:38:35.024386 [info ] [MainThread]: Running with dbt=1.10.4
[0m16:38:35.024820 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/michaelmalotte/code/personal/fao-elt-pipelines/dbt_project/logs', 'version_check': 'True', 'profiles_dir': '/Users/michaelmalotte/code/personal/fao-elt-pipelines/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test --target dev', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:38:35.131302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd343e4a6-1ce4-4421-9b40-7f89862e87f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f85420>]}
[0m16:38:35.172219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd343e4a6-1ce4-4421-9b40-7f89862e87f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106785db0>]}
[0m16:38:35.172876 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:38:35.237295 [debug] [MainThread]: checksum: 23bc95a42434187059b2384bcd89d8aac150f1bd09bd2e89bfeb67b518f50b75, vars: {}, profile: , target: dev, version: 1.10.4
[0m16:38:35.319550 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:38:35.319956 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:38:35.323879 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.fao_elt_pipeline.bronze
[0m16:38:35.354720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd343e4a6-1ce4-4421-9b40-7f89862e87f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10910cd00>]}
[0m16:38:35.447916 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/michaelmalotte/code/personal/fao-elt-pipelines/dbt_project/target/manifest.json
[0m16:38:35.449302 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/michaelmalotte/code/personal/fao-elt-pipelines/dbt_project/target/semantic_manifest.json
[0m16:38:35.462609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd343e4a6-1ce4-4421-9b40-7f89862e87f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109116f20>]}
[0m16:38:35.463164 [info ] [MainThread]: Found 6 models, 23 data tests, 2 sources, 435 macros
[0m16:38:35.463555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd343e4a6-1ce4-4421-9b40-7f89862e87f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109116d10>]}
[0m16:38:35.465115 [info ] [MainThread]: 
[0m16:38:35.465487 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:38:35.465802 [info ] [MainThread]: 
[0m16:38:35.466214 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:38:35.468804 [debug] [ThreadPool]: Acquiring new postgres connection 'list_fao_public_gold'
[0m16:38:35.476178 [debug] [ThreadPool]: Acquiring new postgres connection 'list_fao_public_silver'
[0m16:38:35.494224 [debug] [ThreadPool]: Using postgres connection "list_fao_public_gold"
[0m16:38:35.494697 [debug] [ThreadPool]: Using postgres connection "list_fao_public_silver"
[0m16:38:35.495075 [debug] [ThreadPool]: On list_fao_public_gold: BEGIN
[0m16:38:35.495406 [debug] [ThreadPool]: On list_fao_public_silver: BEGIN
[0m16:38:35.495729 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:38:35.496028 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:38:35.565324 [debug] [ThreadPool]: SQL status: BEGIN in 0.070 seconds
[0m16:38:35.565768 [debug] [ThreadPool]: SQL status: BEGIN in 0.070 seconds
[0m16:38:35.566212 [debug] [ThreadPool]: Using postgres connection "list_fao_public_gold"
[0m16:38:35.566505 [debug] [ThreadPool]: Using postgres connection "list_fao_public_silver"
[0m16:38:35.566884 [debug] [ThreadPool]: On list_fao_public_gold: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "connection_name": "list_fao_public_gold"} */
select
      'fao' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'fao' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'fao' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m16:38:35.567324 [debug] [ThreadPool]: On list_fao_public_silver: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "connection_name": "list_fao_public_silver"} */
select
      'fao' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'fao' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'fao' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m16:38:35.569621 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m16:38:35.569980 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m16:38:35.570870 [debug] [ThreadPool]: On list_fao_public_silver: ROLLBACK
[0m16:38:35.571669 [debug] [ThreadPool]: On list_fao_public_gold: ROLLBACK
[0m16:38:35.572473 [debug] [ThreadPool]: On list_fao_public_silver: Close
[0m16:38:35.572871 [debug] [ThreadPool]: On list_fao_public_gold: Close
[0m16:38:35.577356 [debug] [MainThread]: Using postgres connection "master"
[0m16:38:35.577789 [debug] [MainThread]: On master: BEGIN
[0m16:38:35.578111 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:38:35.588403 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m16:38:35.588812 [debug] [MainThread]: Using postgres connection "master"
[0m16:38:35.589196 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:38:35.592093 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m16:38:35.593021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd343e4a6-1ce4-4421-9b40-7f89862e87f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109115090>]}
[0m16:38:35.593459 [debug] [MainThread]: On master: ROLLBACK
[0m16:38:35.594196 [debug] [MainThread]: Using postgres connection "master"
[0m16:38:35.594533 [debug] [MainThread]: On master: BEGIN
[0m16:38:35.595340 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:38:35.595640 [debug] [MainThread]: On master: COMMIT
[0m16:38:35.595925 [debug] [MainThread]: Using postgres connection "master"
[0m16:38:35.596201 [debug] [MainThread]: On master: COMMIT
[0m16:38:35.596792 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:38:35.597135 [debug] [MainThread]: On master: Close
[0m16:38:35.598754 [debug] [Thread-1 (]: Began running node test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee
[0m16:38:35.599138 [info ] [Thread-1 (]: 1 of 23 START test accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer  [RUN]
[0m16:38:35.599499 [debug] [Thread-2 (]: Began running node test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd
[0m16:38:35.599838 [debug] [Thread-3 (]: Began running node test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53
[0m16:38:35.600178 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_fao_public_gold, now test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee)
[0m16:38:35.600502 [debug] [Thread-4 (]: Began running node test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69
[0m16:38:35.600834 [info ] [Thread-2 (]: 2 of 23 START test accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable  [RUN]
[0m16:38:35.601173 [info ] [Thread-3 (]: 3 of 23 START test accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity  [RUN]
[0m16:38:35.601502 [debug] [Thread-1 (]: Began compiling node test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee
[0m16:38:35.601826 [info ] [Thread-4 (]: 4 of 23 START test accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product  [RUN]
[0m16:38:35.602160 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_fao_public_silver, now test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd)
[0m16:38:35.602567 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53'
[0m16:38:35.612880 [debug] [Thread-1 (]: Writing injected SQL for node "test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee"
[0m16:38:35.613403 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69'
[0m16:38:35.613757 [debug] [Thread-2 (]: Began compiling node test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd
[0m16:38:35.614078 [debug] [Thread-3 (]: Began compiling node test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53
[0m16:38:35.614631 [debug] [Thread-4 (]: Began compiling node test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69
[0m16:38:35.618288 [debug] [Thread-2 (]: Writing injected SQL for node "test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd"
[0m16:38:35.621523 [debug] [Thread-3 (]: Writing injected SQL for node "test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53"
[0m16:38:35.625042 [debug] [Thread-4 (]: Writing injected SQL for node "test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69"
[0m16:38:35.625503 [debug] [Thread-1 (]: Began executing node test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee
[0m16:38:35.636227 [debug] [Thread-1 (]: Writing runtime sql for node "test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee"
[0m16:38:35.636660 [debug] [Thread-2 (]: Began executing node test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd
[0m16:38:35.637072 [debug] [Thread-4 (]: Began executing node test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69
[0m16:38:35.637448 [debug] [Thread-3 (]: Began executing node test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53
[0m16:38:35.639087 [debug] [Thread-2 (]: Writing runtime sql for node "test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd"
[0m16:38:35.641118 [debug] [Thread-4 (]: Writing runtime sql for node "test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69"
[0m16:38:35.642453 [debug] [Thread-3 (]: Writing runtime sql for node "test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53"
[0m16:38:35.642966 [debug] [Thread-1 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee"
[0m16:38:35.643447 [debug] [Thread-1 (]: On test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee: BEGIN
[0m16:38:35.643788 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:38:35.644144 [debug] [Thread-2 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd"
[0m16:38:35.644545 [debug] [Thread-4 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69"
[0m16:38:35.644959 [debug] [Thread-3 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53"
[0m16:38:35.645311 [debug] [Thread-2 (]: On test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd: BEGIN
[0m16:38:35.645647 [debug] [Thread-4 (]: On test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69: BEGIN
[0m16:38:35.645977 [debug] [Thread-3 (]: On test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53: BEGIN
[0m16:38:35.646309 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:38:35.646634 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:38:35.646963 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:38:35.667038 [debug] [Thread-1 (]: SQL status: BEGIN in 0.023 seconds
[0m16:38:35.667498 [debug] [Thread-2 (]: SQL status: BEGIN in 0.021 seconds
[0m16:38:35.667911 [debug] [Thread-3 (]: SQL status: BEGIN in 0.021 seconds
[0m16:38:35.668220 [debug] [Thread-4 (]: SQL status: BEGIN in 0.022 seconds
[0m16:38:35.668608 [debug] [Thread-1 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee"
[0m16:38:35.668955 [debug] [Thread-2 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd"
[0m16:38:35.669350 [debug] [Thread-3 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53"
[0m16:38:35.669767 [debug] [Thread-4 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69"
[0m16:38:35.670164 [debug] [Thread-1 (]: On test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        producer_category as value_field,
        count(*) as n_records

    from "fao"."public_gold"."gold_country_metrics"
    group by producer_category

)

select *
from all_values
where value_field not in (
    'Major Producer','Medium Producer','Small Producer'
)



  
  
      
    ) dbt_internal_test
[0m16:38:35.670549 [debug] [Thread-2 (]: On test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        production_trend as value_field,
        count(*) as n_records

    from "fao"."public_gold"."gold_country_metrics"
    group by production_trend

)

select *
from all_values
where value_field not in (
    'Growing','Declining','Stable'
)



  
  
      
    ) dbt_internal_test
[0m16:38:35.670945 [debug] [Thread-3 (]: On test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        commodity_scale as value_field,
        count(*) as n_records

    from "fao"."public_gold"."gold_price_production_analysis"
    group by commodity_scale

)

select *
from all_values
where value_field not in (
    'Major Commodity','Medium Commodity','Minor Commodity'
)



  
  
      
    ) dbt_internal_test
[0m16:38:35.671332 [debug] [Thread-4 (]: On test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        price_tier as value_field,
        count(*) as n_records

    from "fao"."public_gold"."gold_price_production_analysis"
    group by price_tier

)

select *
from all_values
where value_field not in (
    'Premium Product','Standard Product','Basic Product'
)



  
  
      
    ) dbt_internal_test
[0m16:38:35.672765 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:38:35.673176 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:38:35.673536 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m16:38:35.673830 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m16:38:35.676568 [debug] [Thread-1 (]: On test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee: ROLLBACK
[0m16:38:35.677611 [debug] [Thread-4 (]: On test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69: ROLLBACK
[0m16:38:35.678445 [debug] [Thread-3 (]: On test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53: ROLLBACK
[0m16:38:35.679202 [debug] [Thread-2 (]: On test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd: ROLLBACK
[0m16:38:35.681398 [debug] [Thread-1 (]: On test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee: Close
[0m16:38:35.681812 [debug] [Thread-4 (]: On test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69: Close
[0m16:38:35.682193 [debug] [Thread-2 (]: On test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd: Close
[0m16:38:35.682696 [info ] [Thread-4 (]: 4 of 23 PASS accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product  [[32mPASS[0m in 0.07s]
[0m16:38:35.683099 [debug] [Thread-3 (]: On test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53: Close
[0m16:38:35.683552 [info ] [Thread-1 (]: 1 of 23 PASS accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer  [[32mPASS[0m in 0.08s]
[0m16:38:35.684046 [info ] [Thread-2 (]: 2 of 23 PASS accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable  [[32mPASS[0m in 0.08s]
[0m16:38:35.684509 [debug] [Thread-4 (]: Finished running node test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69
[0m16:38:35.685131 [debug] [Thread-1 (]: Finished running node test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee
[0m16:38:35.685612 [info ] [Thread-3 (]: 3 of 23 PASS accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity  [[32mPASS[0m in 0.08s]
[0m16:38:35.686041 [debug] [Thread-2 (]: Finished running node test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd
[0m16:38:35.686417 [debug] [Thread-4 (]: Began running node test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6
[0m16:38:35.686760 [debug] [Thread-1 (]: Began running node test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff
[0m16:38:35.687195 [debug] [Thread-3 (]: Finished running node test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53
[0m16:38:35.687529 [debug] [Thread-2 (]: Began running node test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f
[0m16:38:35.687870 [info ] [Thread-4 (]: 5 of 23 START test accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region  [RUN]
[0m16:38:35.688212 [info ] [Thread-1 (]: 6 of 23 START test accepted_values_silver_prices_cleaned_is_valid_price__True__False  [RUN]
[0m16:38:35.688550 [debug] [Thread-3 (]: Began running node test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c
[0m16:38:35.688890 [info ] [Thread-2 (]: 7 of 23 START test accepted_values_silver_production_cleaned_is_valid_production__True__False  [RUN]
[0m16:38:35.689247 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69, now test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6)
[0m16:38:35.689587 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee, now test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff)
[0m16:38:35.689912 [info ] [Thread-3 (]: 8 of 23 START test not_null_gold_country_metrics_country_name .................. [RUN]
[0m16:38:35.690251 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd, now test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f)
[0m16:38:35.690575 [debug] [Thread-4 (]: Began compiling node test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6
[0m16:38:35.690886 [debug] [Thread-1 (]: Began compiling node test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff
[0m16:38:35.691200 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53, now test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c)
[0m16:38:35.691514 [debug] [Thread-2 (]: Began compiling node test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f
[0m16:38:35.694763 [debug] [Thread-4 (]: Writing injected SQL for node "test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6"
[0m16:38:35.696951 [debug] [Thread-1 (]: Writing injected SQL for node "test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff"
[0m16:38:35.697303 [debug] [Thread-3 (]: Began compiling node test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c
[0m16:38:35.699437 [debug] [Thread-2 (]: Writing injected SQL for node "test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f"
[0m16:38:35.703803 [debug] [Thread-3 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c"
[0m16:38:35.704232 [debug] [Thread-4 (]: Began executing node test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6
[0m16:38:35.705925 [debug] [Thread-4 (]: Writing runtime sql for node "test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6"
[0m16:38:35.706311 [debug] [Thread-1 (]: Began executing node test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff
[0m16:38:35.706702 [debug] [Thread-2 (]: Began executing node test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f
[0m16:38:35.708960 [debug] [Thread-1 (]: Writing runtime sql for node "test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff"
[0m16:38:35.709365 [debug] [Thread-3 (]: Began executing node test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c
[0m16:38:35.709792 [debug] [Thread-4 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6"
[0m16:38:35.711357 [debug] [Thread-2 (]: Writing runtime sql for node "test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f"
[0m16:38:35.712945 [debug] [Thread-3 (]: Writing runtime sql for node "test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c"
[0m16:38:35.713379 [debug] [Thread-4 (]: On test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6: BEGIN
[0m16:38:35.713949 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:38:35.714397 [debug] [Thread-2 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f"
[0m16:38:35.714864 [debug] [Thread-1 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff"
[0m16:38:35.715276 [debug] [Thread-3 (]: Using postgres connection "test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c"
[0m16:38:35.715647 [debug] [Thread-2 (]: On test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f: BEGIN
[0m16:38:35.716004 [debug] [Thread-1 (]: On test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff: BEGIN
[0m16:38:35.716354 [debug] [Thread-3 (]: On test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c: BEGIN
[0m16:38:35.716713 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:38:35.717074 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:38:35.717407 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:38:35.733528 [debug] [Thread-4 (]: SQL status: BEGIN in 0.020 seconds
[0m16:38:35.734094 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m16:38:35.734456 [debug] [Thread-3 (]: SQL status: BEGIN in 0.017 seconds
[0m16:38:35.734769 [debug] [Thread-2 (]: SQL status: BEGIN in 0.018 seconds
[0m16:38:35.735152 [debug] [Thread-4 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6"
[0m16:38:35.735486 [debug] [Thread-1 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff"
[0m16:38:35.735799 [debug] [Thread-3 (]: Using postgres connection "test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c"
[0m16:38:35.736128 [debug] [Thread-2 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f"
[0m16:38:35.736507 [debug] [Thread-4 (]: On test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        regional_scale as value_field,
        count(*) as n_records

    from "fao"."public_gold"."gold_regional_summary"
    group by regional_scale

)

select *
from all_values
where value_field not in (
    'Major Agricultural Region','Medium Agricultural Region','Minor Agricultural Region'
)



  
  
      
    ) dbt_internal_test
[0m16:38:35.736901 [debug] [Thread-1 (]: On test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        is_valid_price as value_field,
        count(*) as n_records

    from "fao"."public_silver"."silver_prices_cleaned"
    group by is_valid_price

)

select *
from all_values
where value_field not in (
    'True','False'
)



  
  
      
    ) dbt_internal_test
[0m16:38:35.737360 [debug] [Thread-3 (]: On test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select country_name
from "fao"."public_gold"."gold_country_metrics"
where country_name is null



  
  
      
    ) dbt_internal_test
[0m16:38:35.737766 [debug] [Thread-2 (]: On test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        is_valid_production as value_field,
        count(*) as n_records

    from "fao"."public_silver"."silver_production_cleaned"
    group by is_valid_production

)

select *
from all_values
where value_field not in (
    'True','False'
)



  
  
      
    ) dbt_internal_test
[0m16:38:35.752683 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.014 seconds
[0m16:38:35.753096 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.015 seconds
[0m16:38:35.753475 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.015 seconds
[0m16:38:35.753819 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.016 seconds
[0m16:38:35.754961 [debug] [Thread-3 (]: On test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c: ROLLBACK
[0m16:38:35.755800 [debug] [Thread-4 (]: On test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6: ROLLBACK
[0m16:38:35.756585 [debug] [Thread-1 (]: On test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff: ROLLBACK
[0m16:38:35.757358 [debug] [Thread-2 (]: On test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f: ROLLBACK
[0m16:38:35.758095 [debug] [Thread-3 (]: On test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c: Close
[0m16:38:35.758524 [debug] [Thread-1 (]: On test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff: Close
[0m16:38:35.758878 [debug] [Thread-2 (]: On test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f: Close
[0m16:38:35.759206 [debug] [Thread-4 (]: On test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6: Close
[0m16:38:35.759758 [info ] [Thread-3 (]: 8 of 23 PASS not_null_gold_country_metrics_country_name ........................ [[32mPASS[0m in 0.07s]
[0m16:38:35.760224 [info ] [Thread-1 (]: 6 of 23 PASS accepted_values_silver_prices_cleaned_is_valid_price__True__False . [[32mPASS[0m in 0.07s]
[0m16:38:35.760833 [info ] [Thread-2 (]: 7 of 23 PASS accepted_values_silver_production_cleaned_is_valid_production__True__False  [[32mPASS[0m in 0.07s]
[0m16:38:35.761436 [info ] [Thread-4 (]: 5 of 23 PASS accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region  [[32mPASS[0m in 0.07s]
[0m16:38:35.761916 [debug] [Thread-3 (]: Finished running node test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c
[0m16:38:35.762340 [debug] [Thread-1 (]: Finished running node test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff
[0m16:38:35.762755 [debug] [Thread-2 (]: Finished running node test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f
[0m16:38:35.763160 [debug] [Thread-4 (]: Finished running node test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6
[0m16:38:35.763509 [debug] [Thread-3 (]: Began running node test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b
[0m16:38:35.763885 [debug] [Thread-1 (]: Began running node test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7
[0m16:38:35.764291 [debug] [Thread-2 (]: Began running node test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5
[0m16:38:35.764631 [debug] [Thread-4 (]: Began running node test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df
[0m16:38:35.764980 [info ] [Thread-3 (]: 9 of 23 START test not_null_gold_price_production_analysis_item_name ........... [RUN]
[0m16:38:35.765325 [info ] [Thread-1 (]: 10 of 23 START test not_null_gold_regional_summary_region ...................... [RUN]
[0m16:38:35.765653 [info ] [Thread-2 (]: 11 of 23 START test not_null_silver_prices_cleaned_price_id .................... [RUN]
[0m16:38:35.765989 [info ] [Thread-4 (]: 12 of 23 START test not_null_silver_prices_cleaned_price_value ................. [RUN]
[0m16:38:35.766363 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c, now test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b)
[0m16:38:35.766693 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff, now test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7)
[0m16:38:35.767014 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f, now test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5)
[0m16:38:35.767333 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6, now test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df)
[0m16:38:35.767671 [debug] [Thread-3 (]: Began compiling node test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b
[0m16:38:35.767981 [debug] [Thread-1 (]: Began compiling node test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7
[0m16:38:35.768284 [debug] [Thread-2 (]: Began compiling node test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5
[0m16:38:35.768743 [debug] [Thread-4 (]: Began compiling node test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df
[0m16:38:35.771489 [debug] [Thread-3 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b"
[0m16:38:35.773732 [debug] [Thread-1 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7"
[0m16:38:35.775948 [debug] [Thread-2 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5"
[0m16:38:35.778344 [debug] [Thread-4 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df"
[0m16:38:35.779111 [debug] [Thread-4 (]: Began executing node test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df
[0m16:38:35.781488 [debug] [Thread-4 (]: Writing runtime sql for node "test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df"
[0m16:38:35.781859 [debug] [Thread-3 (]: Began executing node test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b
[0m16:38:35.782170 [debug] [Thread-1 (]: Began executing node test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7
[0m16:38:35.782460 [debug] [Thread-2 (]: Began executing node test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5
[0m16:38:35.783987 [debug] [Thread-3 (]: Writing runtime sql for node "test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b"
[0m16:38:35.785327 [debug] [Thread-1 (]: Writing runtime sql for node "test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7"
[0m16:38:35.786943 [debug] [Thread-2 (]: Writing runtime sql for node "test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5"
[0m16:38:35.787397 [debug] [Thread-4 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df"
[0m16:38:35.788068 [debug] [Thread-4 (]: On test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df: BEGIN
[0m16:38:35.788519 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:38:35.788989 [debug] [Thread-3 (]: Using postgres connection "test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b"
[0m16:38:35.789330 [debug] [Thread-3 (]: On test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b: BEGIN
[0m16:38:35.789633 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:38:35.790082 [debug] [Thread-1 (]: Using postgres connection "test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7"
[0m16:38:35.790457 [debug] [Thread-2 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5"
[0m16:38:35.790768 [debug] [Thread-1 (]: On test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7: BEGIN
[0m16:38:35.791101 [debug] [Thread-2 (]: On test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5: BEGIN
[0m16:38:35.791429 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:38:35.791768 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:38:35.813900 [debug] [Thread-2 (]: SQL status: BEGIN in 0.022 seconds
[0m16:38:35.814407 [debug] [Thread-1 (]: SQL status: BEGIN in 0.023 seconds
[0m16:38:35.814740 [debug] [Thread-2 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5"
[0m16:38:35.815041 [debug] [Thread-4 (]: SQL status: BEGIN in 0.027 seconds
[0m16:38:35.815361 [debug] [Thread-1 (]: Using postgres connection "test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7"
[0m16:38:35.815755 [debug] [Thread-3 (]: SQL status: BEGIN in 0.026 seconds
[0m16:38:35.816267 [debug] [Thread-2 (]: On test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select price_id
from "fao"."public_silver"."silver_prices_cleaned"
where price_id is null



  
  
      
    ) dbt_internal_test
[0m16:38:35.816709 [debug] [Thread-4 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df"
[0m16:38:35.817126 [debug] [Thread-1 (]: On test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region
from "fao"."public_gold"."gold_regional_summary"
where region is null



  
  
      
    ) dbt_internal_test
[0m16:38:35.817497 [debug] [Thread-3 (]: Using postgres connection "test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b"
[0m16:38:35.817964 [debug] [Thread-4 (]: On test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select price_value
from "fao"."public_silver"."silver_prices_cleaned"
where price_value is null



  
  
      
    ) dbt_internal_test
[0m16:38:35.818444 [debug] [Thread-3 (]: On test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select item_name
from "fao"."public_gold"."gold_price_production_analysis"
where item_name is null



  
  
      
    ) dbt_internal_test
[0m16:38:35.818871 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:38:35.819303 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:38:35.820534 [debug] [Thread-2 (]: On test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5: ROLLBACK
[0m16:38:35.820992 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:38:35.821969 [debug] [Thread-1 (]: On test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7: ROLLBACK
[0m16:38:35.822304 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m16:38:35.823276 [debug] [Thread-3 (]: On test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b: ROLLBACK
[0m16:38:35.823645 [debug] [Thread-2 (]: On test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5: Close
[0m16:38:35.824473 [debug] [Thread-4 (]: On test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df: ROLLBACK
[0m16:38:35.825015 [info ] [Thread-2 (]: 11 of 23 PASS not_null_silver_prices_cleaned_price_id .......................... [[32mPASS[0m in 0.06s]
[0m16:38:35.825478 [debug] [Thread-2 (]: Finished running node test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5
[0m16:38:35.825826 [debug] [Thread-2 (]: Began running node test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b
[0m16:38:35.826212 [info ] [Thread-2 (]: 13 of 23 START test not_null_silver_prices_cleaned_year ........................ [RUN]
[0m16:38:35.826639 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5, now test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b)
[0m16:38:35.826993 [debug] [Thread-2 (]: Began compiling node test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b
[0m16:38:35.829898 [debug] [Thread-2 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b"
[0m16:38:35.830328 [debug] [Thread-4 (]: On test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df: Close
[0m16:38:35.830725 [debug] [Thread-1 (]: On test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7: Close
[0m16:38:35.831191 [debug] [Thread-3 (]: On test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b: Close
[0m16:38:35.831797 [info ] [Thread-1 (]: 10 of 23 PASS not_null_gold_regional_summary_region ............................ [[32mPASS[0m in 0.07s]
[0m16:38:35.832347 [info ] [Thread-4 (]: 12 of 23 PASS not_null_silver_prices_cleaned_price_value ....................... [[32mPASS[0m in 0.06s]
[0m16:38:35.832820 [debug] [Thread-2 (]: Began executing node test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b
[0m16:38:35.833329 [info ] [Thread-3 (]: 9 of 23 PASS not_null_gold_price_production_analysis_item_name ................. [[32mPASS[0m in 0.07s]
[0m16:38:35.833854 [debug] [Thread-1 (]: Finished running node test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7
[0m16:38:35.834346 [debug] [Thread-4 (]: Finished running node test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df
[0m16:38:35.835936 [debug] [Thread-2 (]: Writing runtime sql for node "test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b"
[0m16:38:35.836408 [debug] [Thread-3 (]: Finished running node test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b
[0m16:38:35.836939 [debug] [Thread-1 (]: Began running node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74
[0m16:38:35.837433 [debug] [Thread-4 (]: Began running node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d
[0m16:38:35.837927 [debug] [Thread-3 (]: Began running node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df
[0m16:38:35.838350 [info ] [Thread-1 (]: 14 of 23 START test not_null_silver_production_cleaned_production_id ........... [RUN]
[0m16:38:35.838792 [debug] [Thread-2 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b"
[0m16:38:35.839160 [info ] [Thread-4 (]: 15 of 23 START test not_null_silver_production_cleaned_production_metric_tons .. [RUN]
[0m16:38:35.839546 [info ] [Thread-3 (]: 16 of 23 START test not_null_silver_production_cleaned_production_value ........ [RUN]
[0m16:38:35.839952 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7, now test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74)
[0m16:38:35.840309 [debug] [Thread-2 (]: On test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b: BEGIN
[0m16:38:35.840647 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df, now test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d)
[0m16:38:35.840992 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b, now test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df)
[0m16:38:35.841387 [debug] [Thread-1 (]: Began compiling node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74
[0m16:38:35.841776 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:38:35.842147 [debug] [Thread-4 (]: Began compiling node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d
[0m16:38:35.842500 [debug] [Thread-3 (]: Began compiling node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df
[0m16:38:35.845107 [debug] [Thread-1 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74"
[0m16:38:35.848716 [debug] [Thread-4 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d"
[0m16:38:35.851224 [debug] [Thread-3 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df"
[0m16:38:35.851958 [debug] [Thread-3 (]: Began executing node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df
[0m16:38:35.853567 [debug] [Thread-3 (]: Writing runtime sql for node "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df"
[0m16:38:35.853995 [debug] [Thread-4 (]: Began executing node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d
[0m16:38:35.854475 [debug] [Thread-1 (]: Began executing node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74
[0m16:38:35.855989 [debug] [Thread-4 (]: Writing runtime sql for node "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d"
[0m16:38:35.857757 [debug] [Thread-1 (]: Writing runtime sql for node "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74"
[0m16:38:35.858244 [debug] [Thread-3 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df"
[0m16:38:35.858889 [debug] [Thread-3 (]: On test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df: BEGIN
[0m16:38:35.859342 [debug] [Thread-2 (]: SQL status: BEGIN in 0.018 seconds
[0m16:38:35.859839 [debug] [Thread-4 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d"
[0m16:38:35.860217 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:38:35.860562 [debug] [Thread-1 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74"
[0m16:38:35.860936 [debug] [Thread-2 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b"
[0m16:38:35.861322 [debug] [Thread-4 (]: On test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d: BEGIN
[0m16:38:35.861831 [debug] [Thread-1 (]: On test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74: BEGIN
[0m16:38:35.862249 [debug] [Thread-2 (]: On test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select year
from "fao"."public_silver"."silver_prices_cleaned"
where year is null



  
  
      
    ) dbt_internal_test
[0m16:38:35.862699 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:38:35.863072 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:38:35.864495 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:38:35.865583 [debug] [Thread-2 (]: On test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b: ROLLBACK
[0m16:38:35.866357 [debug] [Thread-2 (]: On test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b: Close
[0m16:38:35.866988 [info ] [Thread-2 (]: 13 of 23 PASS not_null_silver_prices_cleaned_year .............................. [[32mPASS[0m in 0.04s]
[0m16:38:35.867449 [debug] [Thread-2 (]: Finished running node test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b
[0m16:38:35.867809 [debug] [Thread-2 (]: Began running node test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd
[0m16:38:35.868293 [info ] [Thread-2 (]: 17 of 23 START test not_null_silver_top_countries_area_code .................... [RUN]
[0m16:38:35.868756 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b, now test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd)
[0m16:38:35.869174 [debug] [Thread-2 (]: Began compiling node test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd
[0m16:38:35.869521 [debug] [Thread-3 (]: SQL status: BEGIN in 0.009 seconds
[0m16:38:35.872177 [debug] [Thread-2 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd"
[0m16:38:35.872709 [debug] [Thread-3 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df"
[0m16:38:35.873299 [debug] [Thread-3 (]: On test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select production_value
from "fao"."public_silver"."silver_production_cleaned"
where production_value is null



  
  
      
    ) dbt_internal_test
[0m16:38:35.873745 [debug] [Thread-4 (]: SQL status: BEGIN in 0.011 seconds
[0m16:38:35.874240 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m16:38:35.874640 [debug] [Thread-2 (]: Began executing node test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd
[0m16:38:35.874999 [debug] [Thread-4 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d"
[0m16:38:35.875371 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:38:35.875692 [debug] [Thread-1 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74"
[0m16:38:35.877390 [debug] [Thread-2 (]: Writing runtime sql for node "test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd"
[0m16:38:35.877815 [debug] [Thread-4 (]: On test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select production_metric_tons
from "fao"."public_silver"."silver_production_cleaned"
where production_metric_tons is null



  
  
      
    ) dbt_internal_test
[0m16:38:35.878812 [debug] [Thread-3 (]: On test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df: ROLLBACK
[0m16:38:35.879234 [debug] [Thread-1 (]: On test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select production_id
from "fao"."public_silver"."silver_production_cleaned"
where production_id is null



  
  
      
    ) dbt_internal_test
[0m16:38:35.879852 [debug] [Thread-2 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd"
[0m16:38:35.880176 [debug] [Thread-2 (]: On test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd: BEGIN
[0m16:38:35.880484 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:38:35.883201 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m16:38:35.883555 [debug] [Thread-3 (]: On test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df: Close
[0m16:38:35.883914 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.004 seconds
[0m16:38:35.885004 [debug] [Thread-1 (]: On test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74: ROLLBACK
[0m16:38:35.885976 [debug] [Thread-4 (]: On test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d: ROLLBACK
[0m16:38:35.886460 [info ] [Thread-3 (]: 16 of 23 PASS not_null_silver_production_cleaned_production_value .............. [[32mPASS[0m in 0.05s]
[0m16:38:35.887067 [debug] [Thread-3 (]: Finished running node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df
[0m16:38:35.887421 [debug] [Thread-1 (]: On test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74: Close
[0m16:38:35.887768 [debug] [Thread-4 (]: On test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d: Close
[0m16:38:35.888168 [debug] [Thread-3 (]: Began running node test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a
[0m16:38:35.888593 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m16:38:35.889069 [info ] [Thread-1 (]: 14 of 23 PASS not_null_silver_production_cleaned_production_id ................. [[32mPASS[0m in 0.05s]
[0m16:38:35.889584 [info ] [Thread-4 (]: 15 of 23 PASS not_null_silver_production_cleaned_production_metric_tons ........ [[32mPASS[0m in 0.05s]
[0m16:38:35.889847 [info ] [Thread-3 (]: 18 of 23 START test not_null_silver_top_countries_country_name ................. [RUN]
[0m16:38:35.890455 [debug] [Thread-2 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd"
[0m16:38:35.890905 [debug] [Thread-1 (]: Finished running node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74
[0m16:38:35.891333 [debug] [Thread-4 (]: Finished running node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d
[0m16:38:35.891717 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df, now test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a)
[0m16:38:35.892086 [debug] [Thread-2 (]: On test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select area_code
from "fao"."public_silver"."silver_top_countries"
where area_code is null



  
  
      
    ) dbt_internal_test
[0m16:38:35.892451 [debug] [Thread-1 (]: Began running node test.fao_elt_pipeline.test_data_quality
[0m16:38:35.892777 [debug] [Thread-4 (]: Began running node test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4
[0m16:38:35.893122 [debug] [Thread-3 (]: Began compiling node test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a
[0m16:38:35.893507 [info ] [Thread-1 (]: 19 of 23 START test test_data_quality .......................................... [RUN]
[0m16:38:35.893867 [info ] [Thread-4 (]: 20 of 23 START test unique_gold_country_metrics_country_name ................... [RUN]
[0m16:38:35.894273 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:38:35.897623 [debug] [Thread-3 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a"
[0m16:38:35.898040 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74, now test.fao_elt_pipeline.test_data_quality)
[0m16:38:35.898379 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d, now test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4)
[0m16:38:35.899275 [debug] [Thread-2 (]: On test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd: ROLLBACK
[0m16:38:35.899699 [debug] [Thread-1 (]: Began compiling node test.fao_elt_pipeline.test_data_quality
[0m16:38:35.900027 [debug] [Thread-4 (]: Began compiling node test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4
[0m16:38:35.900424 [debug] [Thread-3 (]: Began executing node test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a
[0m16:38:35.902222 [debug] [Thread-1 (]: Writing injected SQL for node "test.fao_elt_pipeline.test_data_quality"
[0m16:38:35.905583 [debug] [Thread-4 (]: Writing injected SQL for node "test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4"
[0m16:38:35.905914 [debug] [Thread-2 (]: On test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd: Close
[0m16:38:35.907326 [debug] [Thread-3 (]: Writing runtime sql for node "test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a"
[0m16:38:35.907943 [info ] [Thread-2 (]: 17 of 23 PASS not_null_silver_top_countries_area_code .......................... [[32mPASS[0m in 0.04s]
[0m16:38:35.908476 [debug] [Thread-2 (]: Finished running node test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd
[0m16:38:35.908824 [debug] [Thread-4 (]: Began executing node test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4
[0m16:38:35.909197 [debug] [Thread-3 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a"
[0m16:38:35.909511 [debug] [Thread-1 (]: Began executing node test.fao_elt_pipeline.test_data_quality
[0m16:38:35.909838 [debug] [Thread-2 (]: Began running node test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1
[0m16:38:35.911389 [debug] [Thread-4 (]: Writing runtime sql for node "test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4"
[0m16:38:35.911773 [debug] [Thread-3 (]: On test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a: BEGIN
[0m16:38:35.913189 [debug] [Thread-1 (]: Writing runtime sql for node "test.fao_elt_pipeline.test_data_quality"
[0m16:38:35.913537 [info ] [Thread-2 (]: 21 of 23 START test unique_gold_regional_summary_region ........................ [RUN]
[0m16:38:35.913928 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:38:35.914355 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd, now test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1)
[0m16:38:35.914709 [debug] [Thread-4 (]: Using postgres connection "test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4"
[0m16:38:35.915132 [debug] [Thread-2 (]: Began compiling node test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1
[0m16:38:35.915496 [debug] [Thread-1 (]: Using postgres connection "test.fao_elt_pipeline.test_data_quality"
[0m16:38:35.915824 [debug] [Thread-4 (]: On test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4: BEGIN
[0m16:38:35.918014 [debug] [Thread-2 (]: Writing injected SQL for node "test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1"
[0m16:38:35.918421 [debug] [Thread-1 (]: On test.fao_elt_pipeline.test_data_quality: BEGIN
[0m16:38:35.918782 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:38:35.919174 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:38:35.919657 [debug] [Thread-2 (]: Began executing node test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1
[0m16:38:35.921943 [debug] [Thread-2 (]: Writing runtime sql for node "test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1"
[0m16:38:35.922705 [debug] [Thread-2 (]: Using postgres connection "test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1"
[0m16:38:35.923059 [debug] [Thread-3 (]: SQL status: BEGIN in 0.009 seconds
[0m16:38:35.923395 [debug] [Thread-2 (]: On test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1: BEGIN
[0m16:38:35.923715 [debug] [Thread-3 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a"
[0m16:38:35.924025 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:38:35.924353 [debug] [Thread-3 (]: On test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select country_name
from "fao"."public_silver"."silver_top_countries"
where country_name is null



  
  
      
    ) dbt_internal_test
[0m16:38:35.927902 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m16:38:35.929040 [debug] [Thread-3 (]: On test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a: ROLLBACK
[0m16:38:35.929408 [debug] [Thread-4 (]: SQL status: BEGIN in 0.011 seconds
[0m16:38:35.929737 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m16:38:35.930106 [debug] [Thread-4 (]: Using postgres connection "test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4"
[0m16:38:35.930415 [debug] [Thread-3 (]: On test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a: Close
[0m16:38:35.930735 [debug] [Thread-1 (]: Using postgres connection "test.fao_elt_pipeline.test_data_quality"
[0m16:38:35.931090 [debug] [Thread-4 (]: On test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    country_name as unique_field,
    count(*) as n_records

from "fao"."public_gold"."gold_country_metrics"
where country_name is not null
group by country_name
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:38:35.931613 [info ] [Thread-3 (]: 18 of 23 PASS not_null_silver_top_countries_country_name ....................... [[32mPASS[0m in 0.04s]
[0m16:38:35.932060 [debug] [Thread-1 (]: On test.fao_elt_pipeline.test_data_quality: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.test_data_quality"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Test to ensure we have data for major countries
-- This test will fail if we don't have data for these important agricultural producers

SELECT country_name
FROM (
    VALUES
        ('China'),
        ('India'),
        ('USA'),
        ('Brazil'),
        ('Germany')
) AS required_countries(country_name)
WHERE country_name NOT IN (
    SELECT DISTINCT country_name_standardized
    FROM "fao"."public_silver"."silver_production_cleaned"
)
  
  
      
    ) dbt_internal_test
[0m16:38:35.932592 [debug] [Thread-3 (]: Finished running node test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a
[0m16:38:35.933039 [debug] [Thread-2 (]: SQL status: BEGIN in 0.009 seconds
[0m16:38:35.933412 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:38:35.933848 [debug] [Thread-3 (]: Began running node test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31
[0m16:38:35.934228 [debug] [Thread-2 (]: Using postgres connection "test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1"
[0m16:38:35.934610 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:38:35.935515 [debug] [Thread-4 (]: On test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4: ROLLBACK
[0m16:38:35.935890 [info ] [Thread-3 (]: 22 of 23 START test unique_silver_prices_cleaned_price_id ...................... [RUN]
[0m16:38:35.936268 [debug] [Thread-2 (]: On test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    region as unique_field,
    count(*) as n_records

from "fao"."public_gold"."gold_regional_summary"
where region is not null
group by region
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:38:35.937094 [debug] [Thread-1 (]: On test.fao_elt_pipeline.test_data_quality: ROLLBACK
[0m16:38:35.937498 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a, now test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31)
[0m16:38:35.937885 [debug] [Thread-3 (]: Began compiling node test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31
[0m16:38:35.940377 [debug] [Thread-3 (]: Writing injected SQL for node "test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31"
[0m16:38:35.940748 [debug] [Thread-4 (]: On test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4: Close
[0m16:38:35.941067 [debug] [Thread-1 (]: On test.fao_elt_pipeline.test_data_quality: Close
[0m16:38:35.941427 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.004 seconds
[0m16:38:35.941889 [info ] [Thread-4 (]: 20 of 23 PASS unique_gold_country_metrics_country_name ......................... [[32mPASS[0m in 0.04s]
[0m16:38:35.942297 [debug] [Thread-3 (]: Began executing node test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31
[0m16:38:35.942744 [warn ] [Thread-1 (]: 19 of 23 WARN 5 test_data_quality .............................................. [[33mWARN 5[0m in 0.04s]
[0m16:38:35.943654 [debug] [Thread-2 (]: On test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1: ROLLBACK
[0m16:38:35.944116 [debug] [Thread-4 (]: Finished running node test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4
[0m16:38:35.945564 [debug] [Thread-3 (]: Writing runtime sql for node "test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31"
[0m16:38:35.945994 [debug] [Thread-1 (]: Finished running node test.fao_elt_pipeline.test_data_quality
[0m16:38:35.946373 [debug] [Thread-4 (]: Began running node test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048
[0m16:38:35.946739 [debug] [Thread-2 (]: On test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1: Close
[0m16:38:35.947180 [info ] [Thread-4 (]: 23 of 23 START test unique_silver_production_cleaned_production_id ............. [RUN]
[0m16:38:35.947668 [info ] [Thread-2 (]: 21 of 23 PASS unique_gold_regional_summary_region .............................. [[32mPASS[0m in 0.03s]
[0m16:38:35.948050 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4, now test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048)
[0m16:38:35.948466 [debug] [Thread-2 (]: Finished running node test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1
[0m16:38:35.948811 [debug] [Thread-3 (]: Using postgres connection "test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31"
[0m16:38:35.949134 [debug] [Thread-4 (]: Began compiling node test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048
[0m16:38:35.949529 [debug] [Thread-3 (]: On test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31: BEGIN
[0m16:38:35.951763 [debug] [Thread-4 (]: Writing injected SQL for node "test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048"
[0m16:38:35.952149 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:38:35.952665 [debug] [Thread-4 (]: Began executing node test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048
[0m16:38:35.954200 [debug] [Thread-4 (]: Writing runtime sql for node "test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048"
[0m16:38:35.954789 [debug] [Thread-4 (]: Using postgres connection "test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048"
[0m16:38:35.955126 [debug] [Thread-4 (]: On test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048: BEGIN
[0m16:38:35.955434 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:38:35.958960 [debug] [Thread-3 (]: SQL status: BEGIN in 0.007 seconds
[0m16:38:35.959362 [debug] [Thread-3 (]: Using postgres connection "test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31"
[0m16:38:35.959713 [debug] [Thread-3 (]: On test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    price_id as unique_field,
    count(*) as n_records

from "fao"."public_silver"."silver_prices_cleaned"
where price_id is not null
group by price_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:38:35.960930 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:38:35.961931 [debug] [Thread-3 (]: On test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31: ROLLBACK
[0m16:38:35.962559 [debug] [Thread-3 (]: On test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31: Close
[0m16:38:35.962920 [debug] [Thread-4 (]: SQL status: BEGIN in 0.007 seconds
[0m16:38:35.963679 [debug] [Thread-4 (]: Using postgres connection "test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048"
[0m16:38:35.963423 [info ] [Thread-3 (]: 22 of 23 PASS unique_silver_prices_cleaned_price_id ............................ [[32mPASS[0m in 0.03s]
[0m16:38:35.964179 [debug] [Thread-4 (]: On test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    production_id as unique_field,
    count(*) as n_records

from "fao"."public_silver"."silver_production_cleaned"
where production_id is not null
group by production_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:38:35.964634 [debug] [Thread-3 (]: Finished running node test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31
[0m16:38:35.965809 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:38:35.966688 [debug] [Thread-4 (]: On test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048: ROLLBACK
[0m16:38:35.967341 [debug] [Thread-4 (]: On test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048: Close
[0m16:38:35.967832 [info ] [Thread-4 (]: 23 of 23 PASS unique_silver_production_cleaned_production_id ................... [[32mPASS[0m in 0.02s]
[0m16:38:35.968291 [debug] [Thread-4 (]: Finished running node test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048
[0m16:38:35.969282 [debug] [MainThread]: Using postgres connection "master"
[0m16:38:35.969586 [debug] [MainThread]: On master: BEGIN
[0m16:38:35.969853 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:38:35.979429 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m16:38:35.979833 [debug] [MainThread]: On master: COMMIT
[0m16:38:35.980127 [debug] [MainThread]: Using postgres connection "master"
[0m16:38:35.980401 [debug] [MainThread]: On master: COMMIT
[0m16:38:35.981034 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:38:35.981436 [debug] [MainThread]: On master: Close
[0m16:38:35.981802 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:38:35.982108 [debug] [MainThread]: Connection 'test.fao_elt_pipeline.test_data_quality' was properly closed.
[0m16:38:35.982393 [debug] [MainThread]: Connection 'test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1' was properly closed.
[0m16:38:35.982669 [debug] [MainThread]: Connection 'test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31' was properly closed.
[0m16:38:35.982934 [debug] [MainThread]: Connection 'test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048' was properly closed.
[0m16:38:35.983250 [info ] [MainThread]: 
[0m16:38:35.983563 [info ] [MainThread]: Finished running 23 data tests in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m16:38:35.985442 [debug] [MainThread]: Command end result
[0m16:38:36.001965 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/michaelmalotte/code/personal/fao-elt-pipelines/dbt_project/target/manifest.json
[0m16:38:36.003170 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/michaelmalotte/code/personal/fao-elt-pipelines/dbt_project/target/semantic_manifest.json
[0m16:38:36.007910 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/michaelmalotte/code/personal/fao-elt-pipelines/dbt_project/target/run_results.json
[0m16:38:36.008252 [info ] [MainThread]: 
[0m16:38:36.008591 [info ] [MainThread]: [33mCompleted with 1 warning:[0m
[0m16:38:36.008892 [info ] [MainThread]: 
[0m16:38:36.009238 [warn ] [MainThread]: [33mWarning in test test_data_quality (tests/test_data_quality.sql)[0m
[0m16:38:36.009558 [warn ] [MainThread]: Got 5 results, configured to warn if != 0
[0m16:38:36.009825 [info ] [MainThread]: 
[0m16:38:36.010133 [info ] [MainThread]:   compiled code at target/compiled/fao_elt_pipeline/tests/test_data_quality.sql
[0m16:38:36.010440 [info ] [MainThread]: 
[0m16:38:36.010747 [info ] [MainThread]: Done. PASS=22 WARN=1 ERROR=0 SKIP=0 NO-OP=0 TOTAL=23
[0m16:38:36.012599 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.0373694, "process_in_blocks": "0", "process_kernel_time": 0.168178, "process_mem_max_rss": "141459456", "process_out_blocks": "0", "process_user_time": 1.597684}
[0m16:38:36.012963 [debug] [MainThread]: Command `dbt test` succeeded at 16:38:36.012917 after 1.04 seconds
[0m16:38:36.013295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106628bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fcbc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109116350>]}
[0m16:38:36.013622 [debug] [MainThread]: Flushing usage events
[0m16:38:36.336780 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:38:37.357300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106868c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c55480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c54d60>]}


============================== 16:38:37.359846 | 7e30e60a-df75-48f3-ae1d-fcb3115c4e84 ==============================
[0m16:38:37.359846 [info ] [MainThread]: Running with dbt=1.10.4
[0m16:38:37.360297 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/michaelmalotte/code/personal/fao-elt-pipelines/dbt_project/logs', 'profiles_dir': '/Users/michaelmalotte/code/personal/fao-elt-pipelines/dbt_project', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt docs generate --target dev', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:38:37.468809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7e30e60a-df75-48f3-ae1d-fcb3115c4e84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100f69b0>]}
[0m16:38:37.512739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7e30e60a-df75-48f3-ae1d-fcb3115c4e84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101fbf10>]}
[0m16:38:37.513469 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:38:37.577406 [debug] [MainThread]: checksum: 23bc95a42434187059b2384bcd89d8aac150f1bd09bd2e89bfeb67b518f50b75, vars: {}, profile: , target: dev, version: 1.10.4
[0m16:38:37.664574 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:38:37.665021 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:38:37.668736 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.fao_elt_pipeline.bronze
[0m16:38:37.699208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7e30e60a-df75-48f3-ae1d-fcb3115c4e84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f0cd60>]}
[0m16:38:37.709266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7e30e60a-df75-48f3-ae1d-fcb3115c4e84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110bca1a0>]}
[0m16:38:37.709725 [info ] [MainThread]: Found 6 models, 23 data tests, 2 sources, 435 macros
[0m16:38:37.710056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e30e60a-df75-48f3-ae1d-fcb3115c4e84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102a73a0>]}
[0m16:38:37.711397 [info ] [MainThread]: 
[0m16:38:37.711718 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:38:37.712000 [info ] [MainThread]: 
[0m16:38:37.712394 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:38:37.715431 [debug] [ThreadPool]: Acquiring new postgres connection 'list_fao_public_silver'
[0m16:38:37.746493 [debug] [ThreadPool]: Acquiring new postgres connection 'list_fao_public_gold'
[0m16:38:37.773778 [debug] [ThreadPool]: Using postgres connection "list_fao_public_silver"
[0m16:38:37.774322 [debug] [ThreadPool]: Using postgres connection "list_fao_public_gold"
[0m16:38:37.774721 [debug] [ThreadPool]: On list_fao_public_silver: BEGIN
[0m16:38:37.775029 [debug] [ThreadPool]: On list_fao_public_gold: BEGIN
[0m16:38:37.775320 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:38:37.775597 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:38:37.805220 [debug] [ThreadPool]: SQL status: BEGIN in 0.030 seconds
[0m16:38:37.805698 [debug] [ThreadPool]: SQL status: BEGIN in 0.030 seconds
[0m16:38:37.806174 [debug] [ThreadPool]: Using postgres connection "list_fao_public_gold"
[0m16:38:37.806535 [debug] [ThreadPool]: Using postgres connection "list_fao_public_silver"
[0m16:38:37.806855 [debug] [ThreadPool]: On list_fao_public_gold: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "connection_name": "list_fao_public_gold"} */
select
      'fao' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'fao' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'fao' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m16:38:37.807209 [debug] [ThreadPool]: On list_fao_public_silver: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "connection_name": "list_fao_public_silver"} */
select
      'fao' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'fao' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'fao' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m16:38:37.809418 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m16:38:37.809799 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m16:38:37.810694 [debug] [ThreadPool]: On list_fao_public_silver: ROLLBACK
[0m16:38:37.811423 [debug] [ThreadPool]: On list_fao_public_gold: ROLLBACK
[0m16:38:37.812064 [debug] [ThreadPool]: On list_fao_public_gold: Close
[0m16:38:37.812416 [debug] [ThreadPool]: On list_fao_public_silver: Close
[0m16:38:37.816030 [debug] [MainThread]: Using postgres connection "master"
[0m16:38:37.816444 [debug] [MainThread]: On master: BEGIN
[0m16:38:37.816739 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:38:37.824086 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m16:38:37.824478 [debug] [MainThread]: Using postgres connection "master"
[0m16:38:37.824849 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:38:37.828185 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m16:38:37.829174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e30e60a-df75-48f3-ae1d-fcb3115c4e84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ef6530>]}
[0m16:38:37.829624 [debug] [MainThread]: On master: ROLLBACK
[0m16:38:37.830480 [debug] [MainThread]: On master: Close
[0m16:38:37.831964 [debug] [Thread-1 (]: Began running node model.fao_elt_pipeline.silver_prices_cleaned
[0m16:38:37.832333 [debug] [Thread-2 (]: Began running node model.fao_elt_pipeline.silver_production_cleaned
[0m16:38:37.832701 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_fao_public_silver, now model.fao_elt_pipeline.silver_prices_cleaned)
[0m16:38:37.833062 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_fao_public_gold, now model.fao_elt_pipeline.silver_production_cleaned)
[0m16:38:37.833400 [debug] [Thread-1 (]: Began compiling node model.fao_elt_pipeline.silver_prices_cleaned
[0m16:38:37.833758 [debug] [Thread-2 (]: Began compiling node model.fao_elt_pipeline.silver_production_cleaned
[0m16:38:37.840852 [debug] [Thread-1 (]: Writing injected SQL for node "model.fao_elt_pipeline.silver_prices_cleaned"
[0m16:38:37.843533 [debug] [Thread-2 (]: Writing injected SQL for node "model.fao_elt_pipeline.silver_production_cleaned"
[0m16:38:37.844209 [debug] [Thread-1 (]: Began executing node model.fao_elt_pipeline.silver_prices_cleaned
[0m16:38:37.844724 [debug] [Thread-1 (]: Finished running node model.fao_elt_pipeline.silver_prices_cleaned
[0m16:38:37.845118 [debug] [Thread-2 (]: Began executing node model.fao_elt_pipeline.silver_production_cleaned
[0m16:38:37.845561 [debug] [Thread-2 (]: Finished running node model.fao_elt_pipeline.silver_production_cleaned
[0m16:38:37.846180 [debug] [Thread-4 (]: Began running node model.fao_elt_pipeline.gold_country_metrics
[0m16:38:37.846577 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.fao_elt_pipeline.gold_country_metrics'
[0m16:38:37.846970 [debug] [Thread-4 (]: Began compiling node model.fao_elt_pipeline.gold_country_metrics
[0m16:38:37.849183 [debug] [Thread-4 (]: Writing injected SQL for node "model.fao_elt_pipeline.gold_country_metrics"
[0m16:38:37.849595 [debug] [Thread-3 (]: Began running node model.fao_elt_pipeline.gold_price_production_analysis
[0m16:38:37.849964 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.fao_elt_pipeline.gold_price_production_analysis'
[0m16:38:37.850273 [debug] [Thread-3 (]: Began compiling node model.fao_elt_pipeline.gold_price_production_analysis
[0m16:38:37.852236 [debug] [Thread-3 (]: Writing injected SQL for node "model.fao_elt_pipeline.gold_price_production_analysis"
[0m16:38:37.852613 [debug] [Thread-1 (]: Began running node model.fao_elt_pipeline.gold_regional_summary
[0m16:38:37.853045 [debug] [Thread-2 (]: Began running node model.fao_elt_pipeline.silver_top_countries
[0m16:38:37.853472 [debug] [Thread-4 (]: Began executing node model.fao_elt_pipeline.gold_country_metrics
[0m16:38:37.853867 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fao_elt_pipeline.silver_prices_cleaned, now model.fao_elt_pipeline.gold_regional_summary)
[0m16:38:37.854260 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.fao_elt_pipeline.silver_production_cleaned, now model.fao_elt_pipeline.silver_top_countries)
[0m16:38:37.854739 [debug] [Thread-4 (]: Finished running node model.fao_elt_pipeline.gold_country_metrics
[0m16:38:37.855136 [debug] [Thread-3 (]: Began executing node model.fao_elt_pipeline.gold_price_production_analysis
[0m16:38:37.855531 [debug] [Thread-1 (]: Began compiling node model.fao_elt_pipeline.gold_regional_summary
[0m16:38:37.855856 [debug] [Thread-2 (]: Began compiling node model.fao_elt_pipeline.silver_top_countries
[0m16:38:37.856201 [debug] [Thread-4 (]: Began running node test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff
[0m16:38:37.856871 [debug] [Thread-3 (]: Finished running node model.fao_elt_pipeline.gold_price_production_analysis
[0m16:38:37.859448 [debug] [Thread-1 (]: Writing injected SQL for node "model.fao_elt_pipeline.gold_regional_summary"
[0m16:38:37.861330 [debug] [Thread-2 (]: Writing injected SQL for node "model.fao_elt_pipeline.silver_top_countries"
[0m16:38:37.861707 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.fao_elt_pipeline.gold_country_metrics, now test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff)
[0m16:38:37.862068 [debug] [Thread-3 (]: Began running node test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f
[0m16:38:37.862641 [debug] [Thread-4 (]: Began compiling node test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff
[0m16:38:37.863041 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.fao_elt_pipeline.gold_price_production_analysis, now test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f)
[0m16:38:37.863427 [debug] [Thread-1 (]: Began executing node model.fao_elt_pipeline.gold_regional_summary
[0m16:38:37.863797 [debug] [Thread-2 (]: Began executing node model.fao_elt_pipeline.silver_top_countries
[0m16:38:37.869577 [debug] [Thread-4 (]: Writing injected SQL for node "test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff"
[0m16:38:37.870036 [debug] [Thread-3 (]: Began compiling node test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f
[0m16:38:37.870658 [debug] [Thread-1 (]: Finished running node model.fao_elt_pipeline.gold_regional_summary
[0m16:38:37.871196 [debug] [Thread-2 (]: Finished running node model.fao_elt_pipeline.silver_top_countries
[0m16:38:37.874394 [debug] [Thread-3 (]: Writing injected SQL for node "test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f"
[0m16:38:37.874912 [debug] [Thread-1 (]: Began running node test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5
[0m16:38:37.875350 [debug] [Thread-4 (]: Began executing node test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff
[0m16:38:37.875775 [debug] [Thread-2 (]: Began running node test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df
[0m16:38:37.876295 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fao_elt_pipeline.gold_regional_summary, now test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5)
[0m16:38:37.876839 [debug] [Thread-4 (]: Finished running node test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff
[0m16:38:37.877209 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.fao_elt_pipeline.silver_top_countries, now test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df)
[0m16:38:37.877552 [debug] [Thread-1 (]: Began compiling node test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5
[0m16:38:37.877872 [debug] [Thread-3 (]: Began executing node test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f
[0m16:38:37.878227 [debug] [Thread-4 (]: Began running node test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b
[0m16:38:37.878579 [debug] [Thread-2 (]: Began compiling node test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df
[0m16:38:37.883201 [debug] [Thread-1 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5"
[0m16:38:37.883745 [debug] [Thread-3 (]: Finished running node test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f
[0m16:38:37.884090 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff, now test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b)
[0m16:38:37.886445 [debug] [Thread-2 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df"
[0m16:38:37.887144 [debug] [Thread-3 (]: Began running node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74
[0m16:38:37.887677 [debug] [Thread-1 (]: Began executing node test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5
[0m16:38:37.888075 [debug] [Thread-4 (]: Began compiling node test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b
[0m16:38:37.888546 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f, now test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74)
[0m16:38:37.889049 [debug] [Thread-1 (]: Finished running node test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5
[0m16:38:37.891514 [debug] [Thread-4 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b"
[0m16:38:37.891882 [debug] [Thread-2 (]: Began executing node test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df
[0m16:38:37.892216 [debug] [Thread-3 (]: Began compiling node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74
[0m16:38:37.892589 [debug] [Thread-1 (]: Began running node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d
[0m16:38:37.893140 [debug] [Thread-2 (]: Finished running node test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df
[0m16:38:37.895377 [debug] [Thread-3 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74"
[0m16:38:37.895858 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5, now test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d)
[0m16:38:37.896260 [debug] [Thread-2 (]: Began running node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df
[0m16:38:37.896648 [debug] [Thread-4 (]: Began executing node test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b
[0m16:38:37.897026 [debug] [Thread-1 (]: Began compiling node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d
[0m16:38:37.897398 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df, now test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df)
[0m16:38:37.897991 [debug] [Thread-4 (]: Finished running node test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b
[0m16:38:37.900152 [debug] [Thread-1 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d"
[0m16:38:37.900495 [debug] [Thread-3 (]: Began executing node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74
[0m16:38:37.900842 [debug] [Thread-2 (]: Began compiling node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df
[0m16:38:37.901190 [debug] [Thread-4 (]: Began running node test.fao_elt_pipeline.test_data_quality
[0m16:38:37.901750 [debug] [Thread-3 (]: Finished running node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74
[0m16:38:37.904019 [debug] [Thread-2 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df"
[0m16:38:37.904420 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b, now test.fao_elt_pipeline.test_data_quality)
[0m16:38:37.904762 [debug] [Thread-1 (]: Began executing node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d
[0m16:38:37.905208 [debug] [Thread-3 (]: Began running node test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31
[0m16:38:37.905706 [debug] [Thread-4 (]: Began compiling node test.fao_elt_pipeline.test_data_quality
[0m16:38:37.906266 [debug] [Thread-1 (]: Finished running node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d
[0m16:38:37.906639 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74, now test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31)
[0m16:38:37.909339 [debug] [Thread-4 (]: Writing injected SQL for node "test.fao_elt_pipeline.test_data_quality"
[0m16:38:37.909686 [debug] [Thread-2 (]: Began executing node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df
[0m16:38:37.910038 [debug] [Thread-1 (]: Began running node test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048
[0m16:38:37.910363 [debug] [Thread-3 (]: Began compiling node test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31
[0m16:38:37.910944 [debug] [Thread-2 (]: Finished running node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df
[0m16:38:37.911312 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d, now test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048)
[0m16:38:37.914621 [debug] [Thread-3 (]: Writing injected SQL for node "test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31"
[0m16:38:37.914984 [debug] [Thread-4 (]: Began executing node test.fao_elt_pipeline.test_data_quality
[0m16:38:37.915324 [debug] [Thread-2 (]: Began running node test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee
[0m16:38:37.915657 [debug] [Thread-1 (]: Began compiling node test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048
[0m16:38:37.916207 [debug] [Thread-4 (]: Finished running node test.fao_elt_pipeline.test_data_quality
[0m16:38:37.916549 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df, now test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee)
[0m16:38:37.916930 [debug] [Thread-3 (]: Began executing node test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31
[0m16:38:37.919028 [debug] [Thread-1 (]: Writing injected SQL for node "test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048"
[0m16:38:37.919434 [debug] [Thread-4 (]: Began running node test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd
[0m16:38:37.919822 [debug] [Thread-2 (]: Began compiling node test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee
[0m16:38:37.920351 [debug] [Thread-3 (]: Finished running node test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31
[0m16:38:37.920797 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.test_data_quality, now test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd)
[0m16:38:37.924047 [debug] [Thread-2 (]: Writing injected SQL for node "test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee"
[0m16:38:37.924471 [debug] [Thread-3 (]: Began running node test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c
[0m16:38:37.924832 [debug] [Thread-1 (]: Began executing node test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048
[0m16:38:37.925191 [debug] [Thread-4 (]: Began compiling node test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd
[0m16:38:37.925591 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31, now test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c)
[0m16:38:37.926081 [debug] [Thread-1 (]: Finished running node test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048
[0m16:38:37.929147 [debug] [Thread-4 (]: Writing injected SQL for node "test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd"
[0m16:38:37.929515 [debug] [Thread-2 (]: Began executing node test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee
[0m16:38:37.929847 [debug] [Thread-3 (]: Began compiling node test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c
[0m16:38:37.930195 [debug] [Thread-1 (]: Began running node test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4
[0m16:38:37.930741 [debug] [Thread-2 (]: Finished running node test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee
[0m16:38:37.932795 [debug] [Thread-3 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c"
[0m16:38:37.933189 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048, now test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4)
[0m16:38:37.933563 [debug] [Thread-2 (]: Began running node test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53
[0m16:38:37.933894 [debug] [Thread-4 (]: Began executing node test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd
[0m16:38:37.934274 [debug] [Thread-1 (]: Began compiling node test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4
[0m16:38:37.934637 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee, now test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53)
[0m16:38:37.934957 [debug] [Thread-3 (]: Began executing node test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c
[0m16:38:37.935422 [debug] [Thread-4 (]: Finished running node test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd
[0m16:38:37.937778 [debug] [Thread-1 (]: Writing injected SQL for node "test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4"
[0m16:38:37.938211 [debug] [Thread-2 (]: Began compiling node test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53
[0m16:38:37.938904 [debug] [Thread-3 (]: Finished running node test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c
[0m16:38:37.939380 [debug] [Thread-4 (]: Began running node test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69
[0m16:38:37.943938 [debug] [Thread-2 (]: Writing injected SQL for node "test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53"
[0m16:38:37.944444 [debug] [Thread-3 (]: Began running node test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b
[0m16:38:37.944895 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd, now test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69)
[0m16:38:37.945232 [debug] [Thread-1 (]: Began executing node test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4
[0m16:38:37.945617 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c, now test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b)
[0m16:38:37.945981 [debug] [Thread-4 (]: Began compiling node test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69
[0m16:38:37.946326 [debug] [Thread-2 (]: Began executing node test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53
[0m16:38:37.946848 [debug] [Thread-1 (]: Finished running node test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4
[0m16:38:37.947170 [debug] [Thread-3 (]: Began compiling node test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b
[0m16:38:37.950318 [debug] [Thread-4 (]: Writing injected SQL for node "test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69"
[0m16:38:37.950861 [debug] [Thread-2 (]: Finished running node test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53
[0m16:38:37.951233 [debug] [Thread-1 (]: Began running node test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6
[0m16:38:37.953442 [debug] [Thread-3 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b"
[0m16:38:37.953984 [debug] [Thread-2 (]: Began running node test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7
[0m16:38:37.954475 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4, now test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6)
[0m16:38:37.954901 [debug] [Thread-4 (]: Began executing node test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69
[0m16:38:37.955253 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53, now test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7)
[0m16:38:37.955645 [debug] [Thread-1 (]: Began compiling node test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6
[0m16:38:37.955969 [debug] [Thread-3 (]: Began executing node test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b
[0m16:38:37.956472 [debug] [Thread-4 (]: Finished running node test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69
[0m16:38:37.956797 [debug] [Thread-2 (]: Began compiling node test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7
[0m16:38:37.959903 [debug] [Thread-1 (]: Writing injected SQL for node "test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6"
[0m16:38:37.960417 [debug] [Thread-3 (]: Finished running node test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b
[0m16:38:37.960769 [debug] [Thread-4 (]: Began running node test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1
[0m16:38:37.962849 [debug] [Thread-2 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7"
[0m16:38:37.963269 [debug] [Thread-3 (]: Began running node test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd
[0m16:38:37.963653 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69, now test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1)
[0m16:38:37.964053 [debug] [Thread-1 (]: Began executing node test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6
[0m16:38:37.964418 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b, now test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd)
[0m16:38:37.964812 [debug] [Thread-4 (]: Began compiling node test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1
[0m16:38:37.965289 [debug] [Thread-1 (]: Finished running node test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6
[0m16:38:37.965613 [debug] [Thread-2 (]: Began executing node test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7
[0m16:38:37.965933 [debug] [Thread-3 (]: Began compiling node test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd
[0m16:38:37.968098 [debug] [Thread-4 (]: Writing injected SQL for node "test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1"
[0m16:38:37.968478 [debug] [Thread-1 (]: Began running node test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a
[0m16:38:37.968961 [debug] [Thread-2 (]: Finished running node test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7
[0m16:38:37.971374 [debug] [Thread-3 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd"
[0m16:38:37.971990 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6, now test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a)
[0m16:38:37.972546 [debug] [Thread-4 (]: Began executing node test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1
[0m16:38:37.972922 [debug] [Thread-1 (]: Began compiling node test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a
[0m16:38:37.973450 [debug] [Thread-4 (]: Finished running node test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1
[0m16:38:37.973794 [debug] [Thread-3 (]: Began executing node test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd
[0m16:38:37.976873 [debug] [Thread-1 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a"
[0m16:38:37.977463 [debug] [Thread-3 (]: Finished running node test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd
[0m16:38:37.977931 [debug] [Thread-1 (]: Began executing node test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a
[0m16:38:37.978383 [debug] [Thread-1 (]: Finished running node test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a
[0m16:38:37.978990 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:38:37.979279 [debug] [MainThread]: Connection 'test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a' was properly closed.
[0m16:38:37.979534 [debug] [MainThread]: Connection 'test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7' was properly closed.
[0m16:38:37.979788 [debug] [MainThread]: Connection 'test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1' was properly closed.
[0m16:38:37.980045 [debug] [MainThread]: Connection 'test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd' was properly closed.
[0m16:38:37.981956 [debug] [MainThread]: Command end result
[0m16:38:38.047842 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/michaelmalotte/code/personal/fao-elt-pipelines/dbt_project/target/manifest.json
[0m16:38:38.049155 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/michaelmalotte/code/personal/fao-elt-pipelines/dbt_project/target/semantic_manifest.json
[0m16:38:38.053969 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/michaelmalotte/code/personal/fao-elt-pipelines/dbt_project/target/run_results.json
[0m16:38:38.055903 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m16:38:38.056259 [info ] [MainThread]: Building catalog
[0m16:38:38.061954 [debug] [ThreadPool]: Acquiring new postgres connection 'fao.information_schema'
[0m16:38:38.066000 [debug] [ThreadPool]: Using postgres connection "fao.information_schema"
[0m16:38:38.066320 [debug] [ThreadPool]: On fao.information_schema: BEGIN
[0m16:38:38.066594 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:38:38.080107 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m16:38:38.080514 [debug] [ThreadPool]: Using postgres connection "fao.information_schema"
[0m16:38:38.080939 [debug] [ThreadPool]: On fao.information_schema: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "connection_name": "fao.information_schema"} */

    
    

    select
        'fao' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public_gold') and
           upper(tbl.relname) = upper('gold_regional_summary')) or (upper(sch.nspname) = upper('bronze') and
           upper(tbl.relname) = upper('raw_prices')) or (upper(sch.nspname) = upper('public_silver') and
           upper(tbl.relname) = upper('silver_top_countries')) or (upper(sch.nspname) = upper('public_silver') and
           upper(tbl.relname) = upper('silver_production_cleaned')) or (upper(sch.nspname) = upper('public_gold') and
           upper(tbl.relname) = upper('gold_price_production_analysis')) or (upper(sch.nspname) = upper('bronze') and
           upper(tbl.relname) = upper('raw_food_balance')) or (upper(sch.nspname) = upper('public_gold') and
           upper(tbl.relname) = upper('gold_country_metrics')) or (upper(sch.nspname) = upper('public_silver') and
           upper(tbl.relname) = upper('silver_prices_cleaned')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m16:38:38.084037 [debug] [ThreadPool]: SQL status: SELECT 111 in 0.003 seconds
[0m16:38:38.087474 [debug] [ThreadPool]: On fao.information_schema: ROLLBACK
[0m16:38:38.089632 [debug] [ThreadPool]: On fao.information_schema: Close
[0m16:38:38.098975 [debug] [MainThread]: Wrote artifact CatalogArtifact to /Users/michaelmalotte/code/personal/fao-elt-pipelines/dbt_project/target/catalog.json
[0m16:38:38.114707 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/michaelmalotte/code/personal/fao-elt-pipelines/dbt_project/target/manifest.json
[0m16:38:38.115768 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/michaelmalotte/code/personal/fao-elt-pipelines/dbt_project/target/semantic_manifest.json
[0m16:38:38.116083 [info ] [MainThread]: Catalog written to /Users/michaelmalotte/code/personal/fao-elt-pipelines/dbt_project/target/catalog.json
[0m16:38:38.117957 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 0.8094405, "process_in_blocks": "0", "process_kernel_time": 0.149705, "process_mem_max_rss": "140066816", "process_out_blocks": "0", "process_user_time": 1.395687}
[0m16:38:38.118341 [debug] [MainThread]: Command `dbt docs generate` succeeded at 16:38:38.118295 after 0.81 seconds
[0m16:38:38.118649 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m16:38:38.118919 [debug] [MainThread]: Connection 'fao.information_schema' was properly closed.
[0m16:38:38.119285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106868c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bac880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e86530>]}
[0m16:38:38.119669 [debug] [MainThread]: Flushing usage events
[0m16:38:38.446572 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:40:53.687839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cd8bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e5e6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e5dfc0>]}


============================== 16:40:53.690278 | c81016ac-ea22-4b94-9572-61b597b568ab ==============================
[0m16:40:53.690278 [info ] [MainThread]: Running with dbt=1.10.4
[0m16:40:53.690749 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/michaelmalotte/code/personal/fao-elt-pipelines/dbt_project', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/michaelmalotte/code/personal/fao-elt-pipelines/dbt_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt test --target dev', 'send_anonymous_usage_stats': 'True'}
[0m16:40:53.799707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c81016ac-ea22-4b94-9572-61b597b568ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102dd9420>]}
[0m16:40:53.840517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c81016ac-ea22-4b94-9572-61b597b568ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e35db0>]}
[0m16:40:53.841270 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:40:53.905190 [debug] [MainThread]: checksum: 23bc95a42434187059b2384bcd89d8aac150f1bd09bd2e89bfeb67b518f50b75, vars: {}, profile: , target: dev, version: 1.10.4
[0m16:40:53.985539 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:40:53.985924 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:40:53.989295 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.fao_elt_pipeline.bronze
[0m16:40:54.018935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c81016ac-ea22-4b94-9572-61b597b568ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10700cd00>]}
[0m16:40:54.107716 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/michaelmalotte/code/personal/fao-elt-pipelines/dbt_project/target/manifest.json
[0m16:40:54.108927 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/michaelmalotte/code/personal/fao-elt-pipelines/dbt_project/target/semantic_manifest.json
[0m16:40:54.120769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c81016ac-ea22-4b94-9572-61b597b568ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107016f20>]}
[0m16:40:54.121199 [info ] [MainThread]: Found 6 models, 23 data tests, 2 sources, 435 macros
[0m16:40:54.121529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c81016ac-ea22-4b94-9572-61b597b568ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107016d10>]}
[0m16:40:54.122979 [info ] [MainThread]: 
[0m16:40:54.123314 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:40:54.123604 [info ] [MainThread]: 
[0m16:40:54.124002 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:40:54.126428 [debug] [ThreadPool]: Acquiring new postgres connection 'list_fao_public_silver'
[0m16:40:54.133677 [debug] [ThreadPool]: Acquiring new postgres connection 'list_fao_public_gold'
[0m16:40:54.154496 [debug] [ThreadPool]: Using postgres connection "list_fao_public_silver"
[0m16:40:54.154900 [debug] [ThreadPool]: Using postgres connection "list_fao_public_gold"
[0m16:40:54.155208 [debug] [ThreadPool]: On list_fao_public_silver: BEGIN
[0m16:40:54.155503 [debug] [ThreadPool]: On list_fao_public_gold: BEGIN
[0m16:40:54.155780 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:40:54.156051 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:40:54.181617 [debug] [ThreadPool]: SQL status: BEGIN in 0.026 seconds
[0m16:40:54.181995 [debug] [ThreadPool]: SQL status: BEGIN in 0.026 seconds
[0m16:40:54.182302 [debug] [ThreadPool]: Using postgres connection "list_fao_public_silver"
[0m16:40:54.182620 [debug] [ThreadPool]: Using postgres connection "list_fao_public_gold"
[0m16:40:54.182942 [debug] [ThreadPool]: On list_fao_public_silver: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "connection_name": "list_fao_public_silver"} */
select
      'fao' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'fao' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'fao' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m16:40:54.183282 [debug] [ThreadPool]: On list_fao_public_gold: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "connection_name": "list_fao_public_gold"} */
select
      'fao' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'fao' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'fao' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m16:40:54.186220 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.003 seconds
[0m16:40:54.186557 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.003 seconds
[0m16:40:54.187457 [debug] [ThreadPool]: On list_fao_public_silver: ROLLBACK
[0m16:40:54.188149 [debug] [ThreadPool]: On list_fao_public_gold: ROLLBACK
[0m16:40:54.188857 [debug] [ThreadPool]: On list_fao_public_gold: Close
[0m16:40:54.189148 [debug] [ThreadPool]: On list_fao_public_silver: Close
[0m16:40:54.192723 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:54.193096 [debug] [MainThread]: On master: BEGIN
[0m16:40:54.193382 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:40:54.202584 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m16:40:54.202967 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:54.203349 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:40:54.206384 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m16:40:54.207232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c81016ac-ea22-4b94-9572-61b597b568ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107015090>]}
[0m16:40:54.207648 [debug] [MainThread]: On master: ROLLBACK
[0m16:40:54.208224 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:54.208526 [debug] [MainThread]: On master: BEGIN
[0m16:40:54.209283 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:40:54.209591 [debug] [MainThread]: On master: COMMIT
[0m16:40:54.209877 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:54.210167 [debug] [MainThread]: On master: COMMIT
[0m16:40:54.210707 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:40:54.211001 [debug] [MainThread]: On master: Close
[0m16:40:54.212653 [debug] [Thread-1 (]: Began running node test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee
[0m16:40:54.213039 [debug] [Thread-2 (]: Began running node test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd
[0m16:40:54.213406 [debug] [Thread-3 (]: Began running node test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53
[0m16:40:54.213733 [debug] [Thread-4 (]: Began running node test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69
[0m16:40:54.214075 [info ] [Thread-1 (]: 1 of 23 START test accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer  [RUN]
[0m16:40:54.214495 [info ] [Thread-2 (]: 2 of 23 START test accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable  [RUN]
[0m16:40:54.214888 [info ] [Thread-3 (]: 3 of 23 START test accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity  [RUN]
[0m16:40:54.215246 [info ] [Thread-4 (]: 4 of 23 START test accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product  [RUN]
[0m16:40:54.215635 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_fao_public_silver, now test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee)
[0m16:40:54.215983 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_fao_public_gold, now test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd)
[0m16:40:54.216376 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53'
[0m16:40:54.216759 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69'
[0m16:40:54.217096 [debug] [Thread-1 (]: Began compiling node test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee
[0m16:40:54.217425 [debug] [Thread-2 (]: Began compiling node test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd
[0m16:40:54.217750 [debug] [Thread-3 (]: Began compiling node test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53
[0m16:40:54.218067 [debug] [Thread-4 (]: Began compiling node test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69
[0m16:40:54.228483 [debug] [Thread-1 (]: Writing injected SQL for node "test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee"
[0m16:40:54.231745 [debug] [Thread-2 (]: Writing injected SQL for node "test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd"
[0m16:40:54.234544 [debug] [Thread-3 (]: Writing injected SQL for node "test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53"
[0m16:40:54.237804 [debug] [Thread-4 (]: Writing injected SQL for node "test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69"
[0m16:40:54.238572 [debug] [Thread-2 (]: Began executing node test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd
[0m16:40:54.248337 [debug] [Thread-2 (]: Writing runtime sql for node "test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd"
[0m16:40:54.248771 [debug] [Thread-1 (]: Began executing node test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee
[0m16:40:54.250205 [debug] [Thread-1 (]: Writing runtime sql for node "test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee"
[0m16:40:54.250612 [debug] [Thread-4 (]: Began executing node test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69
[0m16:40:54.251023 [debug] [Thread-3 (]: Began executing node test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53
[0m16:40:54.253017 [debug] [Thread-4 (]: Writing runtime sql for node "test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69"
[0m16:40:54.253444 [debug] [Thread-2 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd"
[0m16:40:54.254750 [debug] [Thread-3 (]: Writing runtime sql for node "test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53"
[0m16:40:54.255097 [debug] [Thread-1 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee"
[0m16:40:54.255500 [debug] [Thread-2 (]: On test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd: BEGIN
[0m16:40:54.255937 [debug] [Thread-4 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69"
[0m16:40:54.256305 [debug] [Thread-1 (]: On test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee: BEGIN
[0m16:40:54.256700 [debug] [Thread-3 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53"
[0m16:40:54.257018 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:40:54.257361 [debug] [Thread-4 (]: On test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69: BEGIN
[0m16:40:54.257683 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:40:54.258003 [debug] [Thread-3 (]: On test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53: BEGIN
[0m16:40:54.258405 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:40:54.258796 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:40:54.278258 [debug] [Thread-3 (]: SQL status: BEGIN in 0.019 seconds
[0m16:40:54.278806 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m16:40:54.279250 [debug] [Thread-2 (]: SQL status: BEGIN in 0.022 seconds
[0m16:40:54.279578 [debug] [Thread-4 (]: SQL status: BEGIN in 0.021 seconds
[0m16:40:54.279976 [debug] [Thread-3 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53"
[0m16:40:54.280330 [debug] [Thread-1 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee"
[0m16:40:54.280663 [debug] [Thread-2 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd"
[0m16:40:54.280996 [debug] [Thread-4 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69"
[0m16:40:54.281352 [debug] [Thread-3 (]: On test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        commodity_scale as value_field,
        count(*) as n_records

    from "fao"."public_gold"."gold_price_production_analysis"
    group by commodity_scale

)

select *
from all_values
where value_field not in (
    'Major Commodity','Medium Commodity','Minor Commodity'
)



  
  
      
    ) dbt_internal_test
[0m16:40:54.281745 [debug] [Thread-1 (]: On test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        producer_category as value_field,
        count(*) as n_records

    from "fao"."public_gold"."gold_country_metrics"
    group by producer_category

)

select *
from all_values
where value_field not in (
    'Major Producer','Medium Producer','Small Producer'
)



  
  
      
    ) dbt_internal_test
[0m16:40:54.282117 [debug] [Thread-2 (]: On test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        production_trend as value_field,
        count(*) as n_records

    from "fao"."public_gold"."gold_country_metrics"
    group by production_trend

)

select *
from all_values
where value_field not in (
    'Growing','Declining','Stable'
)



  
  
      
    ) dbt_internal_test
[0m16:40:54.282491 [debug] [Thread-4 (]: On test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        price_tier as value_field,
        count(*) as n_records

    from "fao"."public_gold"."gold_price_production_analysis"
    group by price_tier

)

select *
from all_values
where value_field not in (
    'Premium Product','Standard Product','Basic Product'
)



  
  
      
    ) dbt_internal_test
[0m16:40:54.283778 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:40:54.284219 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:40:54.284650 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m16:40:54.285024 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m16:40:54.287549 [debug] [Thread-3 (]: On test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53: ROLLBACK
[0m16:40:54.288430 [debug] [Thread-2 (]: On test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd: ROLLBACK
[0m16:40:54.289219 [debug] [Thread-4 (]: On test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69: ROLLBACK
[0m16:40:54.289969 [debug] [Thread-1 (]: On test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee: ROLLBACK
[0m16:40:54.291499 [debug] [Thread-4 (]: On test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69: Close
[0m16:40:54.291911 [debug] [Thread-2 (]: On test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd: Close
[0m16:40:54.292414 [info ] [Thread-4 (]: 4 of 23 PASS accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product  [[32mPASS[0m in 0.08s]
[0m16:40:54.292791 [debug] [Thread-3 (]: On test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53: Close
[0m16:40:54.293208 [info ] [Thread-2 (]: 2 of 23 PASS accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable  [[32mPASS[0m in 0.08s]
[0m16:40:54.293544 [debug] [Thread-1 (]: On test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee: Close
[0m16:40:54.293966 [debug] [Thread-4 (]: Finished running node test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69
[0m16:40:54.294421 [info ] [Thread-3 (]: 3 of 23 PASS accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity  [[32mPASS[0m in 0.08s]
[0m16:40:54.294990 [debug] [Thread-2 (]: Finished running node test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd
[0m16:40:54.295538 [info ] [Thread-1 (]: 1 of 23 PASS accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer  [[32mPASS[0m in 0.08s]
[0m16:40:54.295978 [debug] [Thread-4 (]: Began running node test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6
[0m16:40:54.296521 [debug] [Thread-3 (]: Finished running node test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53
[0m16:40:54.296883 [debug] [Thread-2 (]: Began running node test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff
[0m16:40:54.297278 [debug] [Thread-1 (]: Finished running node test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee
[0m16:40:54.297731 [info ] [Thread-4 (]: 5 of 23 START test accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region  [RUN]
[0m16:40:54.298198 [debug] [Thread-3 (]: Began running node test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f
[0m16:40:54.298548 [info ] [Thread-2 (]: 6 of 23 START test accepted_values_silver_prices_cleaned_is_valid_price__True__False  [RUN]
[0m16:40:54.298918 [debug] [Thread-1 (]: Began running node test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c
[0m16:40:54.299314 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69, now test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6)
[0m16:40:54.299661 [info ] [Thread-3 (]: 7 of 23 START test accepted_values_silver_production_cleaned_is_valid_production__True__False  [RUN]
[0m16:40:54.300006 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd, now test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff)
[0m16:40:54.300329 [info ] [Thread-1 (]: 8 of 23 START test not_null_gold_country_metrics_country_name .................. [RUN]
[0m16:40:54.300664 [debug] [Thread-4 (]: Began compiling node test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6
[0m16:40:54.301022 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53, now test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f)
[0m16:40:54.301337 [debug] [Thread-2 (]: Began compiling node test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff
[0m16:40:54.301647 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee, now test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c)
[0m16:40:54.304836 [debug] [Thread-4 (]: Writing injected SQL for node "test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6"
[0m16:40:54.305213 [debug] [Thread-3 (]: Began compiling node test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f
[0m16:40:54.307363 [debug] [Thread-2 (]: Writing injected SQL for node "test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff"
[0m16:40:54.307713 [debug] [Thread-1 (]: Began compiling node test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c
[0m16:40:54.310545 [debug] [Thread-3 (]: Writing injected SQL for node "test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f"
[0m16:40:54.311098 [debug] [Thread-4 (]: Began executing node test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6
[0m16:40:54.314507 [debug] [Thread-1 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c"
[0m16:40:54.314963 [debug] [Thread-2 (]: Began executing node test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff
[0m16:40:54.316363 [debug] [Thread-4 (]: Writing runtime sql for node "test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6"
[0m16:40:54.316745 [debug] [Thread-3 (]: Began executing node test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f
[0m16:40:54.319003 [debug] [Thread-2 (]: Writing runtime sql for node "test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff"
[0m16:40:54.320667 [debug] [Thread-3 (]: Writing runtime sql for node "test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f"
[0m16:40:54.321051 [debug] [Thread-1 (]: Began executing node test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c
[0m16:40:54.321687 [debug] [Thread-4 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6"
[0m16:40:54.323297 [debug] [Thread-1 (]: Writing runtime sql for node "test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c"
[0m16:40:54.323759 [debug] [Thread-2 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff"
[0m16:40:54.324098 [debug] [Thread-3 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f"
[0m16:40:54.324423 [debug] [Thread-4 (]: On test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6: BEGIN
[0m16:40:54.324813 [debug] [Thread-2 (]: On test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff: BEGIN
[0m16:40:54.325138 [debug] [Thread-3 (]: On test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f: BEGIN
[0m16:40:54.325508 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:40:54.325888 [debug] [Thread-1 (]: Using postgres connection "test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c"
[0m16:40:54.326292 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:40:54.326639 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:40:54.327066 [debug] [Thread-1 (]: On test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c: BEGIN
[0m16:40:54.327561 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:40:54.337532 [debug] [Thread-4 (]: SQL status: BEGIN in 0.012 seconds
[0m16:40:54.338054 [debug] [Thread-4 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6"
[0m16:40:54.338570 [debug] [Thread-4 (]: On test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        regional_scale as value_field,
        count(*) as n_records

    from "fao"."public_gold"."gold_regional_summary"
    group by regional_scale

)

select *
from all_values
where value_field not in (
    'Major Agricultural Region','Medium Agricultural Region','Minor Agricultural Region'
)



  
  
      
    ) dbt_internal_test
[0m16:40:54.339073 [debug] [Thread-2 (]: SQL status: BEGIN in 0.013 seconds
[0m16:40:54.339509 [debug] [Thread-3 (]: SQL status: BEGIN in 0.013 seconds
[0m16:40:54.339895 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m16:40:54.340457 [debug] [Thread-2 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff"
[0m16:40:54.340854 [debug] [Thread-3 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f"
[0m16:40:54.341193 [debug] [Thread-1 (]: Using postgres connection "test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c"
[0m16:40:54.341583 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:40:54.341973 [debug] [Thread-2 (]: On test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        is_valid_price as value_field,
        count(*) as n_records

    from "fao"."public_silver"."silver_prices_cleaned"
    group by is_valid_price

)

select *
from all_values
where value_field not in (
    'True','False'
)



  
  
      
    ) dbt_internal_test
[0m16:40:54.342374 [debug] [Thread-3 (]: On test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        is_valid_production as value_field,
        count(*) as n_records

    from "fao"."public_silver"."silver_production_cleaned"
    group by is_valid_production

)

select *
from all_values
where value_field not in (
    'True','False'
)



  
  
      
    ) dbt_internal_test
[0m16:40:54.342754 [debug] [Thread-1 (]: On test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select country_name
from "fao"."public_gold"."gold_country_metrics"
where country_name is null



  
  
      
    ) dbt_internal_test
[0m16:40:54.343769 [debug] [Thread-4 (]: On test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6: ROLLBACK
[0m16:40:54.344554 [debug] [Thread-4 (]: On test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6: Close
[0m16:40:54.344930 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:40:54.345265 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:40:54.345620 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:40:54.346522 [debug] [Thread-3 (]: On test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f: ROLLBACK
[0m16:40:54.347042 [info ] [Thread-4 (]: 5 of 23 PASS accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region  [[32mPASS[0m in 0.05s]
[0m16:40:54.347917 [debug] [Thread-1 (]: On test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c: ROLLBACK
[0m16:40:54.348680 [debug] [Thread-2 (]: On test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff: ROLLBACK
[0m16:40:54.349151 [debug] [Thread-4 (]: Finished running node test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6
[0m16:40:54.349577 [debug] [Thread-3 (]: On test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f: Close
[0m16:40:54.349981 [debug] [Thread-2 (]: On test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff: Close
[0m16:40:54.350322 [debug] [Thread-1 (]: On test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c: Close
[0m16:40:54.350684 [debug] [Thread-4 (]: Began running node test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b
[0m16:40:54.351242 [info ] [Thread-3 (]: 7 of 23 PASS accepted_values_silver_production_cleaned_is_valid_production__True__False  [[32mPASS[0m in 0.05s]
[0m16:40:54.351726 [info ] [Thread-2 (]: 6 of 23 PASS accepted_values_silver_prices_cleaned_is_valid_price__True__False . [[32mPASS[0m in 0.05s]
[0m16:40:54.352190 [info ] [Thread-1 (]: 8 of 23 PASS not_null_gold_country_metrics_country_name ........................ [[32mPASS[0m in 0.05s]
[0m16:40:54.352683 [info ] [Thread-4 (]: 9 of 23 START test not_null_gold_price_production_analysis_item_name ........... [RUN]
[0m16:40:54.353347 [debug] [Thread-3 (]: Finished running node test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f
[0m16:40:54.353839 [debug] [Thread-2 (]: Finished running node test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff
[0m16:40:54.354230 [debug] [Thread-1 (]: Finished running node test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c
[0m16:40:54.354599 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6, now test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b)
[0m16:40:54.354947 [debug] [Thread-3 (]: Began running node test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7
[0m16:40:54.355324 [debug] [Thread-2 (]: Began running node test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5
[0m16:40:54.355772 [debug] [Thread-1 (]: Began running node test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df
[0m16:40:54.356219 [debug] [Thread-4 (]: Began compiling node test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b
[0m16:40:54.356694 [info ] [Thread-3 (]: 10 of 23 START test not_null_gold_regional_summary_region ...................... [RUN]
[0m16:40:54.357119 [info ] [Thread-2 (]: 11 of 23 START test not_null_silver_prices_cleaned_price_id .................... [RUN]
[0m16:40:54.357515 [info ] [Thread-1 (]: 12 of 23 START test not_null_silver_prices_cleaned_price_value ................. [RUN]
[0m16:40:54.360105 [debug] [Thread-4 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b"
[0m16:40:54.360598 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f, now test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7)
[0m16:40:54.361100 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff, now test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5)
[0m16:40:54.361533 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c, now test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df)
[0m16:40:54.361999 [debug] [Thread-3 (]: Began compiling node test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7
[0m16:40:54.362380 [debug] [Thread-2 (]: Began compiling node test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5
[0m16:40:54.362760 [debug] [Thread-1 (]: Began compiling node test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df
[0m16:40:54.365269 [debug] [Thread-3 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7"
[0m16:40:54.365652 [debug] [Thread-4 (]: Began executing node test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b
[0m16:40:54.368242 [debug] [Thread-2 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5"
[0m16:40:54.370982 [debug] [Thread-1 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df"
[0m16:40:54.373947 [debug] [Thread-4 (]: Writing runtime sql for node "test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b"
[0m16:40:54.374641 [debug] [Thread-3 (]: Began executing node test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7
[0m16:40:54.375164 [debug] [Thread-2 (]: Began executing node test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5
[0m16:40:54.375561 [debug] [Thread-1 (]: Began executing node test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df
[0m16:40:54.377160 [debug] [Thread-3 (]: Writing runtime sql for node "test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7"
[0m16:40:54.378632 [debug] [Thread-2 (]: Writing runtime sql for node "test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5"
[0m16:40:54.379049 [debug] [Thread-4 (]: Using postgres connection "test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b"
[0m16:40:54.380561 [debug] [Thread-1 (]: Writing runtime sql for node "test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df"
[0m16:40:54.381090 [debug] [Thread-4 (]: On test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b: BEGIN
[0m16:40:54.381559 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:40:54.382016 [debug] [Thread-3 (]: Using postgres connection "test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7"
[0m16:40:54.382373 [debug] [Thread-3 (]: On test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7: BEGIN
[0m16:40:54.382723 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:40:54.383135 [debug] [Thread-2 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5"
[0m16:40:54.383621 [debug] [Thread-1 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df"
[0m16:40:54.383994 [debug] [Thread-2 (]: On test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5: BEGIN
[0m16:40:54.384359 [debug] [Thread-1 (]: On test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df: BEGIN
[0m16:40:54.384885 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:40:54.385332 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:40:54.389500 [debug] [Thread-4 (]: SQL status: BEGIN in 0.008 seconds
[0m16:40:54.389907 [debug] [Thread-4 (]: Using postgres connection "test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b"
[0m16:40:54.390261 [debug] [Thread-4 (]: On test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select item_name
from "fao"."public_gold"."gold_price_production_analysis"
where item_name is null



  
  
      
    ) dbt_internal_test
[0m16:40:54.391259 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:40:54.392359 [debug] [Thread-4 (]: On test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b: ROLLBACK
[0m16:40:54.393062 [debug] [Thread-4 (]: On test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b: Close
[0m16:40:54.393483 [debug] [Thread-3 (]: SQL status: BEGIN in 0.011 seconds
[0m16:40:54.394498 [debug] [Thread-3 (]: Using postgres connection "test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7"
[0m16:40:54.394884 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m16:40:54.394133 [info ] [Thread-4 (]: 9 of 23 PASS not_null_gold_price_production_analysis_item_name ................. [[32mPASS[0m in 0.04s]
[0m16:40:54.395366 [debug] [Thread-2 (]: SQL status: BEGIN in 0.010 seconds
[0m16:40:54.395743 [debug] [Thread-3 (]: On test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region
from "fao"."public_gold"."gold_regional_summary"
where region is null



  
  
      
    ) dbt_internal_test
[0m16:40:54.396110 [debug] [Thread-1 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df"
[0m16:40:54.396534 [debug] [Thread-4 (]: Finished running node test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b
[0m16:40:54.396887 [debug] [Thread-2 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5"
[0m16:40:54.397276 [debug] [Thread-1 (]: On test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select price_value
from "fao"."public_silver"."silver_prices_cleaned"
where price_value is null



  
  
      
    ) dbt_internal_test
[0m16:40:54.397690 [debug] [Thread-4 (]: Began running node test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b
[0m16:40:54.398108 [debug] [Thread-2 (]: On test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select price_id
from "fao"."public_silver"."silver_prices_cleaned"
where price_id is null



  
  
      
    ) dbt_internal_test
[0m16:40:54.398539 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:40:54.398921 [info ] [Thread-4 (]: 13 of 23 START test not_null_silver_prices_cleaned_year ........................ [RUN]
[0m16:40:54.400002 [debug] [Thread-3 (]: On test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7: ROLLBACK
[0m16:40:54.400375 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m16:40:54.400727 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:40:54.401088 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b, now test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b)
[0m16:40:54.402122 [debug] [Thread-1 (]: On test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df: ROLLBACK
[0m16:40:54.402514 [debug] [Thread-3 (]: On test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7: Close
[0m16:40:54.403591 [debug] [Thread-2 (]: On test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5: ROLLBACK
[0m16:40:54.403995 [debug] [Thread-4 (]: Began compiling node test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b
[0m16:40:54.404558 [info ] [Thread-3 (]: 10 of 23 PASS not_null_gold_regional_summary_region ............................ [[32mPASS[0m in 0.04s]
[0m16:40:54.404953 [debug] [Thread-1 (]: On test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df: Close
[0m16:40:54.407863 [debug] [Thread-4 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b"
[0m16:40:54.408313 [debug] [Thread-2 (]: On test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5: Close
[0m16:40:54.408725 [debug] [Thread-3 (]: Finished running node test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7
[0m16:40:54.409204 [info ] [Thread-1 (]: 12 of 23 PASS not_null_silver_prices_cleaned_price_value ....................... [[32mPASS[0m in 0.05s]
[0m16:40:54.409780 [debug] [Thread-3 (]: Began running node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74
[0m16:40:54.410262 [info ] [Thread-2 (]: 11 of 23 PASS not_null_silver_prices_cleaned_price_id .......................... [[32mPASS[0m in 0.05s]
[0m16:40:54.410841 [debug] [Thread-1 (]: Finished running node test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df
[0m16:40:54.411205 [info ] [Thread-3 (]: 14 of 23 START test not_null_silver_production_cleaned_production_id ........... [RUN]
[0m16:40:54.411669 [debug] [Thread-2 (]: Finished running node test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5
[0m16:40:54.411982 [debug] [Thread-4 (]: Began executing node test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b
[0m16:40:54.412331 [debug] [Thread-1 (]: Began running node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d
[0m16:40:54.412690 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7, now test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74)
[0m16:40:54.413054 [debug] [Thread-2 (]: Began running node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df
[0m16:40:54.414549 [debug] [Thread-4 (]: Writing runtime sql for node "test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b"
[0m16:40:54.414916 [info ] [Thread-1 (]: 15 of 23 START test not_null_silver_production_cleaned_production_metric_tons .. [RUN]
[0m16:40:54.415278 [debug] [Thread-3 (]: Began compiling node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74
[0m16:40:54.415673 [info ] [Thread-2 (]: 16 of 23 START test not_null_silver_production_cleaned_production_value ........ [RUN]
[0m16:40:54.416153 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df, now test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d)
[0m16:40:54.418582 [debug] [Thread-3 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74"
[0m16:40:54.419017 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5, now test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df)
[0m16:40:54.419412 [debug] [Thread-4 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b"
[0m16:40:54.419771 [debug] [Thread-1 (]: Began compiling node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d
[0m16:40:54.420170 [debug] [Thread-2 (]: Began compiling node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df
[0m16:40:54.420584 [debug] [Thread-4 (]: On test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b: BEGIN
[0m16:40:54.424029 [debug] [Thread-1 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d"
[0m16:40:54.424488 [debug] [Thread-3 (]: Began executing node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74
[0m16:40:54.427164 [debug] [Thread-2 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df"
[0m16:40:54.427596 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:40:54.429143 [debug] [Thread-3 (]: Writing runtime sql for node "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74"
[0m16:40:54.429697 [debug] [Thread-1 (]: Began executing node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d
[0m16:40:54.430116 [debug] [Thread-2 (]: Began executing node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df
[0m16:40:54.431654 [debug] [Thread-1 (]: Writing runtime sql for node "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d"
[0m16:40:54.433080 [debug] [Thread-2 (]: Writing runtime sql for node "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df"
[0m16:40:54.433637 [debug] [Thread-3 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74"
[0m16:40:54.434415 [debug] [Thread-1 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d"
[0m16:40:54.434825 [debug] [Thread-2 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df"
[0m16:40:54.435251 [debug] [Thread-3 (]: On test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74: BEGIN
[0m16:40:54.435682 [debug] [Thread-1 (]: On test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d: BEGIN
[0m16:40:54.436076 [debug] [Thread-2 (]: On test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df: BEGIN
[0m16:40:54.436530 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:40:54.436977 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:40:54.437424 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:40:54.441835 [debug] [Thread-4 (]: SQL status: BEGIN in 0.014 seconds
[0m16:40:54.442281 [debug] [Thread-4 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b"
[0m16:40:54.442640 [debug] [Thread-4 (]: On test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select year
from "fao"."public_silver"."silver_prices_cleaned"
where year is null



  
  
      
    ) dbt_internal_test
[0m16:40:54.443792 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:40:54.444826 [debug] [Thread-4 (]: On test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b: ROLLBACK
[0m16:40:54.445607 [debug] [Thread-4 (]: On test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b: Close
[0m16:40:54.446269 [info ] [Thread-4 (]: 13 of 23 PASS not_null_silver_prices_cleaned_year .............................. [[32mPASS[0m in 0.05s]
[0m16:40:54.446777 [debug] [Thread-4 (]: Finished running node test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b
[0m16:40:54.447294 [debug] [Thread-4 (]: Began running node test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd
[0m16:40:54.447794 [debug] [Thread-2 (]: SQL status: BEGIN in 0.010 seconds
[0m16:40:54.448223 [debug] [Thread-3 (]: SQL status: BEGIN in 0.012 seconds
[0m16:40:54.448608 [info ] [Thread-4 (]: 17 of 23 START test not_null_silver_top_countries_area_code .................... [RUN]
[0m16:40:54.448997 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m16:40:54.449348 [debug] [Thread-2 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df"
[0m16:40:54.449694 [debug] [Thread-3 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74"
[0m16:40:54.450086 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b, now test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd)
[0m16:40:54.450445 [debug] [Thread-1 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d"
[0m16:40:54.450790 [debug] [Thread-2 (]: On test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select production_value
from "fao"."public_silver"."silver_production_cleaned"
where production_value is null



  
  
      
    ) dbt_internal_test
[0m16:40:54.451159 [debug] [Thread-3 (]: On test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select production_id
from "fao"."public_silver"."silver_production_cleaned"
where production_id is null



  
  
      
    ) dbt_internal_test
[0m16:40:54.451497 [debug] [Thread-4 (]: Began compiling node test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd
[0m16:40:54.451903 [debug] [Thread-1 (]: On test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select production_metric_tons
from "fao"."public_silver"."silver_production_cleaned"
where production_metric_tons is null



  
  
      
    ) dbt_internal_test
[0m16:40:54.454666 [debug] [Thread-4 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd"
[0m16:40:54.455120 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m16:40:54.455625 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m16:40:54.457035 [debug] [Thread-3 (]: On test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74: ROLLBACK
[0m16:40:54.457503 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m16:40:54.458332 [debug] [Thread-2 (]: On test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df: ROLLBACK
[0m16:40:54.459380 [debug] [Thread-1 (]: On test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d: ROLLBACK
[0m16:40:54.459747 [debug] [Thread-4 (]: Began executing node test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd
[0m16:40:54.460093 [debug] [Thread-3 (]: On test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74: Close
[0m16:40:54.461865 [debug] [Thread-4 (]: Writing runtime sql for node "test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd"
[0m16:40:54.462298 [debug] [Thread-2 (]: On test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df: Close
[0m16:40:54.462653 [debug] [Thread-1 (]: On test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d: Close
[0m16:40:54.463159 [info ] [Thread-3 (]: 14 of 23 PASS not_null_silver_production_cleaned_production_id ................. [[32mPASS[0m in 0.05s]
[0m16:40:54.463747 [info ] [Thread-2 (]: 16 of 23 PASS not_null_silver_production_cleaned_production_value .............. [[32mPASS[0m in 0.04s]
[0m16:40:54.464714 [debug] [Thread-3 (]: Finished running node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74
[0m16:40:54.465081 [debug] [Thread-4 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd"
[0m16:40:54.464351 [info ] [Thread-1 (]: 15 of 23 PASS not_null_silver_production_cleaned_production_metric_tons ........ [[32mPASS[0m in 0.05s]
[0m16:40:54.465624 [debug] [Thread-2 (]: Finished running node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df
[0m16:40:54.465987 [debug] [Thread-3 (]: Began running node test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a
[0m16:40:54.466328 [debug] [Thread-4 (]: On test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd: BEGIN
[0m16:40:54.466754 [debug] [Thread-1 (]: Finished running node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d
[0m16:40:54.467091 [debug] [Thread-2 (]: Began running node test.fao_elt_pipeline.test_data_quality
[0m16:40:54.467435 [info ] [Thread-3 (]: 18 of 23 START test not_null_silver_top_countries_country_name ................. [RUN]
[0m16:40:54.467839 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:40:54.468234 [debug] [Thread-1 (]: Began running node test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4
[0m16:40:54.468606 [info ] [Thread-2 (]: 19 of 23 START test test_data_quality .......................................... [RUN]
[0m16:40:54.469083 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74, now test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a)
[0m16:40:54.469631 [info ] [Thread-1 (]: 20 of 23 START test unique_gold_country_metrics_country_name ................... [RUN]
[0m16:40:54.470308 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df, now test.fao_elt_pipeline.test_data_quality)
[0m16:40:54.470740 [debug] [Thread-3 (]: Began compiling node test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a
[0m16:40:54.471234 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d, now test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4)
[0m16:40:54.471704 [debug] [Thread-2 (]: Began compiling node test.fao_elt_pipeline.test_data_quality
[0m16:40:54.475383 [debug] [Thread-3 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a"
[0m16:40:54.475827 [debug] [Thread-1 (]: Began compiling node test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4
[0m16:40:54.477759 [debug] [Thread-2 (]: Writing injected SQL for node "test.fao_elt_pipeline.test_data_quality"
[0m16:40:54.478167 [debug] [Thread-4 (]: SQL status: BEGIN in 0.010 seconds
[0m16:40:54.481807 [debug] [Thread-1 (]: Writing injected SQL for node "test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4"
[0m16:40:54.482279 [debug] [Thread-4 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd"
[0m16:40:54.482775 [debug] [Thread-2 (]: Began executing node test.fao_elt_pipeline.test_data_quality
[0m16:40:54.483091 [debug] [Thread-3 (]: Began executing node test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a
[0m16:40:54.483433 [debug] [Thread-4 (]: On test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select area_code
from "fao"."public_silver"."silver_top_countries"
where area_code is null



  
  
      
    ) dbt_internal_test
[0m16:40:54.483791 [debug] [Thread-1 (]: Began executing node test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4
[0m16:40:54.485300 [debug] [Thread-2 (]: Writing runtime sql for node "test.fao_elt_pipeline.test_data_quality"
[0m16:40:54.486945 [debug] [Thread-3 (]: Writing runtime sql for node "test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a"
[0m16:40:54.488664 [debug] [Thread-1 (]: Writing runtime sql for node "test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4"
[0m16:40:54.489068 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m16:40:54.490357 [debug] [Thread-4 (]: On test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd: ROLLBACK
[0m16:40:54.490844 [debug] [Thread-2 (]: Using postgres connection "test.fao_elt_pipeline.test_data_quality"
[0m16:40:54.491221 [debug] [Thread-1 (]: Using postgres connection "test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4"
[0m16:40:54.491563 [debug] [Thread-3 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a"
[0m16:40:54.491895 [debug] [Thread-2 (]: On test.fao_elt_pipeline.test_data_quality: BEGIN
[0m16:40:54.492201 [debug] [Thread-4 (]: On test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd: Close
[0m16:40:54.492534 [debug] [Thread-1 (]: On test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4: BEGIN
[0m16:40:54.492869 [debug] [Thread-3 (]: On test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a: BEGIN
[0m16:40:54.493200 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:40:54.493557 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:40:54.494018 [info ] [Thread-4 (]: 17 of 23 PASS not_null_silver_top_countries_area_code .......................... [[32mPASS[0m in 0.04s]
[0m16:40:54.494417 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:40:54.495093 [debug] [Thread-4 (]: Finished running node test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd
[0m16:40:54.495587 [debug] [Thread-4 (]: Began running node test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1
[0m16:40:54.495962 [info ] [Thread-4 (]: 21 of 23 START test unique_gold_regional_summary_region ........................ [RUN]
[0m16:40:54.496408 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd, now test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1)
[0m16:40:54.496776 [debug] [Thread-4 (]: Began compiling node test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1
[0m16:40:54.499242 [debug] [Thread-4 (]: Writing injected SQL for node "test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1"
[0m16:40:54.499837 [debug] [Thread-4 (]: Began executing node test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1
[0m16:40:54.502741 [debug] [Thread-4 (]: Writing runtime sql for node "test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1"
[0m16:40:54.503413 [debug] [Thread-4 (]: Using postgres connection "test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1"
[0m16:40:54.503769 [debug] [Thread-4 (]: On test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1: BEGIN
[0m16:40:54.504083 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:40:54.508661 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m16:40:54.509089 [debug] [Thread-3 (]: SQL status: BEGIN in 0.015 seconds
[0m16:40:54.509494 [debug] [Thread-2 (]: SQL status: BEGIN in 0.016 seconds
[0m16:40:54.509880 [debug] [Thread-1 (]: Using postgres connection "test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4"
[0m16:40:54.510245 [debug] [Thread-3 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a"
[0m16:40:54.510582 [debug] [Thread-2 (]: Using postgres connection "test.fao_elt_pipeline.test_data_quality"
[0m16:40:54.510961 [debug] [Thread-1 (]: On test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    country_name as unique_field,
    count(*) as n_records

from "fao"."public_gold"."gold_country_metrics"
where country_name is not null
group by country_name
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:40:54.511340 [debug] [Thread-3 (]: On test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select country_name
from "fao"."public_silver"."silver_top_countries"
where country_name is null



  
  
      
    ) dbt_internal_test
[0m16:40:54.511716 [debug] [Thread-2 (]: On test.fao_elt_pipeline.test_data_quality: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.test_data_quality"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Test to ensure we have data for major countries
-- This test will fail if we don't have data for these important agricultural producers

SELECT country_name
FROM (
    VALUES
        ('China'),
        ('India'),
        ('USA'),
        ('Brazil'),
        ('Germany')
) AS required_countries(country_name)
WHERE country_name NOT IN (
    SELECT DISTINCT country_name_standardized
    FROM "fao"."public_silver"."silver_production_cleaned"
)
  
  
      
    ) dbt_internal_test
[0m16:40:54.512783 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:40:54.513190 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:40:54.513549 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:40:54.513911 [debug] [Thread-4 (]: SQL status: BEGIN in 0.010 seconds
[0m16:40:54.514945 [debug] [Thread-3 (]: On test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a: ROLLBACK
[0m16:40:54.515758 [debug] [Thread-2 (]: On test.fao_elt_pipeline.test_data_quality: ROLLBACK
[0m16:40:54.516605 [debug] [Thread-1 (]: On test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4: ROLLBACK
[0m16:40:54.516962 [debug] [Thread-4 (]: Using postgres connection "test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1"
[0m16:40:54.517541 [debug] [Thread-4 (]: On test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    region as unique_field,
    count(*) as n_records

from "fao"."public_gold"."gold_regional_summary"
where region is not null
group by region
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:40:54.518033 [debug] [Thread-2 (]: On test.fao_elt_pipeline.test_data_quality: Close
[0m16:40:54.518356 [debug] [Thread-3 (]: On test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a: Close
[0m16:40:54.518767 [debug] [Thread-1 (]: On test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4: Close
[0m16:40:54.519491 [warn ] [Thread-2 (]: 19 of 23 WARN 5 test_data_quality .............................................. [[33mWARN 5[0m in 0.05s]
[0m16:40:54.520445 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:40:54.519982 [info ] [Thread-3 (]: 18 of 23 PASS not_null_silver_top_countries_country_name ....................... [[32mPASS[0m in 0.05s]
[0m16:40:54.521479 [debug] [Thread-2 (]: Finished running node test.fao_elt_pipeline.test_data_quality
[0m16:40:54.520975 [info ] [Thread-1 (]: 20 of 23 PASS unique_gold_country_metrics_country_name ......................... [[32mPASS[0m in 0.05s]
[0m16:40:54.522494 [debug] [Thread-4 (]: On test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1: ROLLBACK
[0m16:40:54.522917 [debug] [Thread-3 (]: Finished running node test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a
[0m16:40:54.523272 [debug] [Thread-2 (]: Began running node test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31
[0m16:40:54.523720 [debug] [Thread-1 (]: Finished running node test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4
[0m16:40:54.524128 [debug] [Thread-3 (]: Began running node test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048
[0m16:40:54.524501 [info ] [Thread-2 (]: 22 of 23 START test unique_silver_prices_cleaned_price_id ...................... [RUN]
[0m16:40:54.524830 [debug] [Thread-4 (]: On test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1: Close
[0m16:40:54.525349 [info ] [Thread-3 (]: 23 of 23 START test unique_silver_production_cleaned_production_id ............. [RUN]
[0m16:40:54.525782 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.test_data_quality, now test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31)
[0m16:40:54.526167 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a, now test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048)
[0m16:40:54.526616 [info ] [Thread-4 (]: 21 of 23 PASS unique_gold_regional_summary_region .............................. [[32mPASS[0m in 0.03s]
[0m16:40:54.526998 [debug] [Thread-2 (]: Began compiling node test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31
[0m16:40:54.527337 [debug] [Thread-3 (]: Began compiling node test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048
[0m16:40:54.527748 [debug] [Thread-4 (]: Finished running node test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1
[0m16:40:54.530287 [debug] [Thread-2 (]: Writing injected SQL for node "test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31"
[0m16:40:54.532767 [debug] [Thread-3 (]: Writing injected SQL for node "test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048"
[0m16:40:54.533463 [debug] [Thread-3 (]: Began executing node test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048
[0m16:40:54.535059 [debug] [Thread-3 (]: Writing runtime sql for node "test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048"
[0m16:40:54.535457 [debug] [Thread-2 (]: Began executing node test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31
[0m16:40:54.537159 [debug] [Thread-2 (]: Writing runtime sql for node "test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31"
[0m16:40:54.537868 [debug] [Thread-2 (]: Using postgres connection "test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31"
[0m16:40:54.538288 [debug] [Thread-3 (]: Using postgres connection "test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048"
[0m16:40:54.538732 [debug] [Thread-2 (]: On test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31: BEGIN
[0m16:40:54.539138 [debug] [Thread-3 (]: On test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048: BEGIN
[0m16:40:54.539527 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:40:54.539875 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:40:54.555317 [debug] [Thread-3 (]: SQL status: BEGIN in 0.015 seconds
[0m16:40:54.555783 [debug] [Thread-2 (]: SQL status: BEGIN in 0.016 seconds
[0m16:40:54.556244 [debug] [Thread-3 (]: Using postgres connection "test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048"
[0m16:40:54.556572 [debug] [Thread-2 (]: Using postgres connection "test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31"
[0m16:40:54.556907 [debug] [Thread-3 (]: On test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    production_id as unique_field,
    count(*) as n_records

from "fao"."public_silver"."silver_production_cleaned"
where production_id is not null
group by production_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:40:54.557263 [debug] [Thread-2 (]: On test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    price_id as unique_field,
    count(*) as n_records

from "fao"."public_silver"."silver_prices_cleaned"
where price_id is not null
group by price_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:40:54.558484 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:40:54.558844 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:40:54.559822 [debug] [Thread-3 (]: On test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048: ROLLBACK
[0m16:40:54.560620 [debug] [Thread-2 (]: On test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31: ROLLBACK
[0m16:40:54.561347 [debug] [Thread-3 (]: On test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048: Close
[0m16:40:54.561737 [debug] [Thread-2 (]: On test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31: Close
[0m16:40:54.562310 [info ] [Thread-3 (]: 23 of 23 PASS unique_silver_production_cleaned_production_id ................... [[32mPASS[0m in 0.04s]
[0m16:40:54.562866 [info ] [Thread-2 (]: 22 of 23 PASS unique_silver_prices_cleaned_price_id ............................ [[32mPASS[0m in 0.04s]
[0m16:40:54.563333 [debug] [Thread-3 (]: Finished running node test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048
[0m16:40:54.563859 [debug] [Thread-2 (]: Finished running node test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31
[0m16:40:54.564827 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:54.565238 [debug] [MainThread]: On master: BEGIN
[0m16:40:54.565541 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:40:54.584761 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m16:40:54.585202 [debug] [MainThread]: On master: COMMIT
[0m16:40:54.585592 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:54.586049 [debug] [MainThread]: On master: COMMIT
[0m16:40:54.586889 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:40:54.587322 [debug] [MainThread]: On master: Close
[0m16:40:54.587734 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:40:54.588039 [debug] [MainThread]: Connection 'test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4' was properly closed.
[0m16:40:54.588343 [debug] [MainThread]: Connection 'test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31' was properly closed.
[0m16:40:54.588624 [debug] [MainThread]: Connection 'test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048' was properly closed.
[0m16:40:54.588906 [debug] [MainThread]: Connection 'test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1' was properly closed.
[0m16:40:54.589314 [info ] [MainThread]: 
[0m16:40:54.589668 [info ] [MainThread]: Finished running 23 data tests in 0 hours 0 minutes and 0.47 seconds (0.47s).
[0m16:40:54.591546 [debug] [MainThread]: Command end result
[0m16:40:54.608008 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/michaelmalotte/code/personal/fao-elt-pipelines/dbt_project/target/manifest.json
[0m16:40:54.609194 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/michaelmalotte/code/personal/fao-elt-pipelines/dbt_project/target/semantic_manifest.json
[0m16:40:54.614142 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/michaelmalotte/code/personal/fao-elt-pipelines/dbt_project/target/run_results.json
[0m16:40:54.614548 [info ] [MainThread]: 
[0m16:40:54.614903 [info ] [MainThread]: [33mCompleted with 1 warning:[0m
[0m16:40:54.615233 [info ] [MainThread]: 
[0m16:40:54.615581 [warn ] [MainThread]: [33mWarning in test test_data_quality (tests/test_data_quality.sql)[0m
[0m16:40:54.615917 [warn ] [MainThread]: Got 5 results, configured to warn if != 0
[0m16:40:54.616215 [info ] [MainThread]: 
[0m16:40:54.616536 [info ] [MainThread]:   compiled code at target/compiled/fao_elt_pipeline/tests/test_data_quality.sql
[0m16:40:54.616853 [info ] [MainThread]: 
[0m16:40:54.617177 [info ] [MainThread]: Done. PASS=22 WARN=1 ERROR=0 SKIP=0 NO-OP=0 TOTAL=23
[0m16:40:54.619083 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.9768156, "process_in_blocks": "0", "process_kernel_time": 0.181685, "process_mem_max_rss": "142295040", "process_out_blocks": "0", "process_user_time": 1.59151}
[0m16:40:54.619524 [debug] [MainThread]: Command `dbt test` succeeded at 16:40:54.619468 after 0.98 seconds
[0m16:40:54.619886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cd8bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e1fc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107016350>]}
[0m16:40:54.620366 [debug] [MainThread]: Flushing usage events
[0m16:40:55.030740 [debug] [MainThread]: An error was encountered while trying to flush usage events
