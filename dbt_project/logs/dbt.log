[0m16:37:42.842876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1038fcb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d5d270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d5cb50>]}


============================== 16:37:42.845706 | 4f6690f6-4c90-4165-8fb2-67c521987a4b ==============================
[0m16:37:42.845706 [info ] [MainThread]: Running with dbt=1.10.4
[0m16:37:42.846173 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/michaelmalotte/code/personal/fao-elt-pipelines/dbt_project/logs', 'debug': 'False', 'profiles_dir': '/Users/michaelmalotte/code/personal/fao-elt-pipelines/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --target dev', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:37:42.850194 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'DB_PASSWORD'
[0m16:37:42.851711 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.061838042, "process_in_blocks": "0", "process_kernel_time": 0.097299, "process_mem_max_rss": "111214592", "process_out_blocks": "0", "process_user_time": 0.792491}
[0m16:37:42.852116 [debug] [MainThread]: Command `dbt run` failed at 16:37:42.852056 after 0.06 seconds
[0m16:37:42.852424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1038fcb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d5fdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d5ee00>]}
[0m16:37:42.852756 [debug] [MainThread]: Flushing usage events
[0m16:37:43.218298 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:38:31.897991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105868bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10725d2a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10725cb80>]}


============================== 16:38:31.900461 | e5ab9c03-8321-4c3d-a6b8-e58f10c47cb3 ==============================
[0m16:38:31.900461 [info ] [MainThread]: Running with dbt=1.10.4
[0m16:38:31.900921 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/michaelmalotte/code/personal/fao-elt-pipelines/dbt_project', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/michaelmalotte/code/personal/fao-elt-pipelines/dbt_project/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --target dev', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:38:32.018487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e5ab9c03-8321-4c3d-a6b8-e58f10c47cb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10284d420>]}
[0m16:38:32.059503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e5ab9c03-8321-4c3d-a6b8-e58f10c47cb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10724dc90>]}
[0m16:38:32.060327 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:38:32.278728 [debug] [MainThread]: checksum: 23bc95a42434187059b2384bcd89d8aac150f1bd09bd2e89bfeb67b518f50b75, vars: {}, profile: , target: dev, version: 1.10.4
[0m16:38:32.279362 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m16:38:32.279716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e5ab9c03-8321-4c3d-a6b8-e58f10c47cb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e15900>]}
[0m16:38:33.122978 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.fao_elt_pipeline.bronze
[0m16:38:33.128845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e5ab9c03-8321-4c3d-a6b8-e58f10c47cb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1028762f0>]}
[0m16:38:33.190362 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/michaelmalotte/code/personal/fao-elt-pipelines/dbt_project/target/manifest.json
[0m16:38:33.191637 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/michaelmalotte/code/personal/fao-elt-pipelines/dbt_project/target/semantic_manifest.json
[0m16:38:33.204561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e5ab9c03-8321-4c3d-a6b8-e58f10c47cb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10876a230>]}
[0m16:38:33.205003 [info ] [MainThread]: Found 6 models, 23 data tests, 2 sources, 435 macros
[0m16:38:33.205330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e5ab9c03-8321-4c3d-a6b8-e58f10c47cb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10876a8f0>]}
[0m16:38:33.206456 [info ] [MainThread]: 
[0m16:38:33.206774 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:38:33.207046 [info ] [MainThread]: 
[0m16:38:33.207416 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:38:33.209786 [debug] [ThreadPool]: Acquiring new postgres connection 'list_fao'
[0m16:38:33.215362 [debug] [ThreadPool]: Acquiring new postgres connection 'list_fao'
[0m16:38:33.239381 [debug] [ThreadPool]: Using postgres connection "list_fao"
[0m16:38:33.239763 [debug] [ThreadPool]: Using postgres connection "list_fao"
[0m16:38:33.240079 [debug] [ThreadPool]: On list_fao: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "connection_name": "list_fao"} */

    select distinct nspname from pg_namespace
  
[0m16:38:33.240402 [debug] [ThreadPool]: On list_fao: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "connection_name": "list_fao"} */

    select distinct nspname from pg_namespace
  
[0m16:38:33.240687 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:38:33.240976 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:38:33.271300 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.030 seconds
[0m16:38:33.271697 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.031 seconds
[0m16:38:33.272510 [debug] [ThreadPool]: On list_fao: Close
[0m16:38:33.273192 [debug] [ThreadPool]: On list_fao: Close
[0m16:38:33.273934 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_fao, now create_fao_public_gold)
[0m16:38:33.274306 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_fao, now create_fao_public_silver)
[0m16:38:33.274773 [debug] [ThreadPool]: Creating schema "database: "fao"
schema: "public_gold"
"
[0m16:38:33.275175 [debug] [ThreadPool]: Creating schema "database: "fao"
schema: "public_silver"
"
[0m16:38:33.278332 [debug] [ThreadPool]: Using postgres connection "create_fao_public_gold"
[0m16:38:33.279934 [debug] [ThreadPool]: Using postgres connection "create_fao_public_silver"
[0m16:38:33.280299 [debug] [ThreadPool]: On create_fao_public_gold: BEGIN
[0m16:38:33.280589 [debug] [ThreadPool]: On create_fao_public_silver: BEGIN
[0m16:38:33.280874 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:38:33.281138 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:38:33.292357 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m16:38:33.292764 [debug] [ThreadPool]: Using postgres connection "create_fao_public_silver"
[0m16:38:33.293133 [debug] [ThreadPool]: On create_fao_public_silver: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "connection_name": "create_fao_public_silver"} */
create schema if not exists "public_silver"
[0m16:38:33.293761 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m16:38:33.294079 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m16:38:33.294367 [debug] [ThreadPool]: Using postgres connection "create_fao_public_gold"
[0m16:38:33.294981 [debug] [ThreadPool]: On create_fao_public_silver: COMMIT
[0m16:38:33.295288 [debug] [ThreadPool]: On create_fao_public_gold: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "connection_name": "create_fao_public_gold"} */
create schema if not exists "public_gold"
[0m16:38:33.295581 [debug] [ThreadPool]: Using postgres connection "create_fao_public_silver"
[0m16:38:33.295895 [debug] [ThreadPool]: On create_fao_public_silver: COMMIT
[0m16:38:33.296351 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m16:38:33.296962 [debug] [ThreadPool]: On create_fao_public_gold: COMMIT
[0m16:38:33.297268 [debug] [ThreadPool]: Using postgres connection "create_fao_public_gold"
[0m16:38:33.297555 [debug] [ThreadPool]: On create_fao_public_gold: COMMIT
[0m16:38:33.297842 [debug] [ThreadPool]: SQL status: COMMIT in 0.002 seconds
[0m16:38:33.298151 [debug] [ThreadPool]: On create_fao_public_silver: Close
[0m16:38:33.298473 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m16:38:33.298989 [debug] [ThreadPool]: On create_fao_public_gold: Close
[0m16:38:33.299972 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_fao_public_silver, now list_fao_public_gold)
[0m16:38:33.300455 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_fao_public_gold, now list_fao_public_silver)
[0m16:38:33.303689 [debug] [ThreadPool]: Using postgres connection "list_fao_public_gold"
[0m16:38:33.304908 [debug] [ThreadPool]: Using postgres connection "list_fao_public_silver"
[0m16:38:33.305218 [debug] [ThreadPool]: On list_fao_public_gold: BEGIN
[0m16:38:33.305508 [debug] [ThreadPool]: On list_fao_public_silver: BEGIN
[0m16:38:33.305790 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:38:33.306057 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:38:33.323535 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m16:38:33.323946 [debug] [ThreadPool]: Using postgres connection "list_fao_public_silver"
[0m16:38:33.324261 [debug] [ThreadPool]: On list_fao_public_silver: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "connection_name": "list_fao_public_silver"} */
select
      'fao' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'fao' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'fao' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m16:38:33.324627 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m16:38:33.325071 [debug] [ThreadPool]: Using postgres connection "list_fao_public_gold"
[0m16:38:33.325406 [debug] [ThreadPool]: On list_fao_public_gold: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "connection_name": "list_fao_public_gold"} */
select
      'fao' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'fao' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'fao' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m16:38:33.329056 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m16:38:33.329399 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m16:38:33.330199 [debug] [ThreadPool]: On list_fao_public_silver: ROLLBACK
[0m16:38:33.330861 [debug] [ThreadPool]: On list_fao_public_gold: ROLLBACK
[0m16:38:33.331504 [debug] [ThreadPool]: On list_fao_public_silver: Close
[0m16:38:33.331822 [debug] [ThreadPool]: On list_fao_public_gold: Close
[0m16:38:33.334980 [debug] [MainThread]: Using postgres connection "master"
[0m16:38:33.335392 [debug] [MainThread]: On master: BEGIN
[0m16:38:33.335678 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:38:33.343370 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m16:38:33.343729 [debug] [MainThread]: Using postgres connection "master"
[0m16:38:33.344108 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:38:33.346639 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m16:38:33.347420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e5ab9c03-8321-4c3d-a6b8-e58f10c47cb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10839cfa0>]}
[0m16:38:33.347848 [debug] [MainThread]: On master: ROLLBACK
[0m16:38:33.348477 [debug] [MainThread]: Using postgres connection "master"
[0m16:38:33.348796 [debug] [MainThread]: On master: BEGIN
[0m16:38:33.350217 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:38:33.350538 [debug] [MainThread]: On master: COMMIT
[0m16:38:33.350825 [debug] [MainThread]: Using postgres connection "master"
[0m16:38:33.351111 [debug] [MainThread]: On master: COMMIT
[0m16:38:33.351933 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:38:33.352233 [debug] [MainThread]: On master: Close
[0m16:38:33.354084 [debug] [Thread-1 (]: Began running node model.fao_elt_pipeline.silver_prices_cleaned
[0m16:38:33.354466 [debug] [Thread-2 (]: Began running node model.fao_elt_pipeline.silver_production_cleaned
[0m16:38:33.354874 [info ] [Thread-1 (]: 1 of 6 START sql table model public_silver.silver_prices_cleaned ............... [RUN]
[0m16:38:33.355281 [info ] [Thread-2 (]: 2 of 6 START sql table model public_silver.silver_production_cleaned ........... [RUN]
[0m16:38:33.355671 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_fao_public_gold, now model.fao_elt_pipeline.silver_prices_cleaned)
[0m16:38:33.356037 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_fao_public_silver, now model.fao_elt_pipeline.silver_production_cleaned)
[0m16:38:33.356395 [debug] [Thread-1 (]: Began compiling node model.fao_elt_pipeline.silver_prices_cleaned
[0m16:38:33.356723 [debug] [Thread-2 (]: Began compiling node model.fao_elt_pipeline.silver_production_cleaned
[0m16:38:33.362120 [debug] [Thread-1 (]: Writing injected SQL for node "model.fao_elt_pipeline.silver_prices_cleaned"
[0m16:38:33.364429 [debug] [Thread-2 (]: Writing injected SQL for node "model.fao_elt_pipeline.silver_production_cleaned"
[0m16:38:33.365168 [debug] [Thread-1 (]: Began executing node model.fao_elt_pipeline.silver_prices_cleaned
[0m16:38:33.378103 [debug] [Thread-2 (]: Began executing node model.fao_elt_pipeline.silver_production_cleaned
[0m16:38:33.384897 [debug] [Thread-1 (]: Writing runtime sql for node "model.fao_elt_pipeline.silver_prices_cleaned"
[0m16:38:33.386759 [debug] [Thread-2 (]: Writing runtime sql for node "model.fao_elt_pipeline.silver_production_cleaned"
[0m16:38:33.387479 [debug] [Thread-2 (]: Using postgres connection "model.fao_elt_pipeline.silver_production_cleaned"
[0m16:38:33.387821 [debug] [Thread-2 (]: On model.fao_elt_pipeline.silver_production_cleaned: BEGIN
[0m16:38:33.388130 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:38:33.388541 [debug] [Thread-1 (]: Using postgres connection "model.fao_elt_pipeline.silver_prices_cleaned"
[0m16:38:33.388868 [debug] [Thread-1 (]: On model.fao_elt_pipeline.silver_prices_cleaned: BEGIN
[0m16:38:33.389172 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:38:33.400859 [debug] [Thread-2 (]: SQL status: BEGIN in 0.013 seconds
[0m16:38:33.401234 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m16:38:33.401603 [debug] [Thread-2 (]: Using postgres connection "model.fao_elt_pipeline.silver_production_cleaned"
[0m16:38:33.401956 [debug] [Thread-1 (]: Using postgres connection "model.fao_elt_pipeline.silver_prices_cleaned"
[0m16:38:33.402387 [debug] [Thread-2 (]: On model.fao_elt_pipeline.silver_production_cleaned: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.silver_production_cleaned"} */

  
    

  create  table "fao"."public_silver"."silver_production_cleaned__dbt_tmp"
  
  
    as
  
  (
    

WITH raw_production AS (
    SELECT
        data,
        loaded_at
    FROM "fao"."bronze"."raw_food_balance"
),

flattened_production AS (
    SELECT
        (data->>'area')::TEXT as country_name,
        (data->>'area_code')::TEXT as area_code,
        (data->>'area_code_m49')::TEXT as area_code_m49,
        (data->>'element')::TEXT as element_name,
        (data->>'element_code')::TEXT as element_code,
        (data->>'flag')::TEXT as flag,
        (data->>'item')::TEXT as item_name,
        (data->>'item_code')::TEXT as item_code,
        (data->>'item_code_fbs')::TEXT as item_code_fbs,
        (data->>'unit')::TEXT as unit,
        (data->>'value')::NUMERIC as production_value,
        (data->>'year')::INTEGER as year,
        loaded_at
    FROM raw_production
)

SELECT
    
    md5(
            coalesce(cast(area_code as varchar), '') || '-' || 
            coalesce(cast(item_code as varchar), '') || '-' || 
            coalesce(cast(year as varchar), '')
    )
 as production_id,
    country_name,
    area_code,
    area_code_m49,
    element_name,
    element_code,
    flag,
    item_name,
    item_code,
    item_code_fbs,
    unit,
    production_value,
    year,
    -- Convert to metric tons for consistency
    CASE
        WHEN unit = '1000 t' THEN production_value * 1000
        ELSE production_value
    END as production_metric_tons,
    -- Add data quality flags
    CASE
        WHEN production_value IS NULL OR production_value < 0 THEN FALSE
        ELSE TRUE
    END as is_valid_production,
    -- Add standardized country names
    CASE
        WHEN country_name LIKE '%Côte%' THEN 'Ivory Coast'
        WHEN country_name = 'China, mainland' THEN 'China'
        WHEN country_name = 'United States of America' THEN 'USA'
        WHEN country_name = 'United Kingdom of Great Britain and Northern Ireland' THEN 'UK'
        ELSE country_name
    END as country_name_standardized,
    loaded_at,
    CURRENT_TIMESTAMP as transformed_at
FROM flattened_production
WHERE element_name = 'Production'  -- Focus on production data only
  AND production_value >= 0
  AND year >= 1990
  );
  
[0m16:38:33.402892 [debug] [Thread-1 (]: On model.fao_elt_pipeline.silver_prices_cleaned: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.silver_prices_cleaned"} */

  
    

  create  table "fao"."public_silver"."silver_prices_cleaned__dbt_tmp"
  
  
    as
  
  (
    

WITH raw_prices AS (
    SELECT
        data,
        loaded_at
    FROM "fao"."bronze"."raw_prices"
),

flattened_prices AS (
    SELECT
        (data->>'area')::TEXT as country_name,
        (data->>'area_code')::TEXT as area_code,
        (data->>'area_code_m49')::TEXT as area_code_m49,
        (data->>'element')::TEXT as element_name,
        (data->>'element_code')::TEXT as element_code,
        (data->>'flag')::TEXT as flag,
        (data->>'item')::TEXT as item_name,
        (data->>'item_code')::TEXT as item_code,
        (data->>'item_code_cpc')::TEXT as item_code_cpc,
        (data->>'unit')::TEXT as unit,
        (data->>'value')::NUMERIC as price_value,
        (data->>'year')::INTEGER as year,
        loaded_at
    FROM raw_prices
)

SELECT
    
    md5(
            coalesce(cast(area_code as varchar), '') || '-' || 
            coalesce(cast(item_code as varchar), '') || '-' || 
            coalesce(cast(year as varchar), '')
    )
 as price_id,
    country_name,
    area_code,
    area_code_m49,
    element_name,
    element_code,
    flag,
    item_name,
    item_code,
    item_code_cpc,
    unit,
    price_value,
    year,
    -- Add data quality flags
    CASE
        WHEN price_value IS NULL OR price_value <= 0 THEN FALSE
        ELSE TRUE
    END as is_valid_price,
    -- Add standardized country names (handle special characters)
    CASE
        WHEN country_name LIKE '%Côte%' THEN 'Ivory Coast'
        WHEN country_name = 'China, mainland' THEN 'China'
        WHEN country_name = 'United States of America' THEN 'USA'
        WHEN country_name = 'United Kingdom of Great Britain and Northern Ireland' THEN 'UK'
        ELSE country_name
    END as country_name_standardized,
    loaded_at,
    CURRENT_TIMESTAMP as transformed_at
FROM flattened_prices
WHERE price_value IS NOT NULL
  AND price_value > 0
  AND year >= 1990  -- Focus on more recent data
  );
  
[0m16:38:33.406774 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.003 seconds
[0m16:38:33.407148 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.004 seconds
[0m16:38:33.415356 [debug] [Thread-2 (]: Using postgres connection "model.fao_elt_pipeline.silver_production_cleaned"
[0m16:38:33.416258 [debug] [Thread-1 (]: Using postgres connection "model.fao_elt_pipeline.silver_prices_cleaned"
[0m16:38:33.416617 [debug] [Thread-2 (]: On model.fao_elt_pipeline.silver_production_cleaned: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.silver_production_cleaned"} */

    create  index if not exists
  "53c76f45a064bf01b6d41f98401fad48"
  on "fao"."public_silver"."silver_production_cleaned__dbt_tmp" using btree
  (area_code, year)
  
[0m16:38:33.416952 [debug] [Thread-1 (]: On model.fao_elt_pipeline.silver_prices_cleaned: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.silver_prices_cleaned"} */

    create  index if not exists
  "ba05bb9c707cf7235bdc7501f8d37ca9"
  on "fao"."public_silver"."silver_prices_cleaned__dbt_tmp" using btree
  (area_code, year)
  
[0m16:38:33.422442 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.005 seconds
[0m16:38:33.422794 [debug] [Thread-2 (]: SQL status: CREATE INDEX in 0.006 seconds
[0m16:38:33.423709 [debug] [Thread-1 (]: Using postgres connection "model.fao_elt_pipeline.silver_prices_cleaned"
[0m16:38:33.424510 [debug] [Thread-2 (]: Using postgres connection "model.fao_elt_pipeline.silver_production_cleaned"
[0m16:38:33.424853 [debug] [Thread-1 (]: On model.fao_elt_pipeline.silver_prices_cleaned: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.silver_prices_cleaned"} */

    create  index if not exists
  "6bc0c957153f4c4be8373c6c57d24d9f"
  on "fao"."public_silver"."silver_prices_cleaned__dbt_tmp" using btree
  (item_code)
  
[0m16:38:33.425186 [debug] [Thread-2 (]: On model.fao_elt_pipeline.silver_production_cleaned: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.silver_production_cleaned"} */

    create  index if not exists
  "e4b973ec8e15ff289f7ce1b2613c6d5a"
  on "fao"."public_silver"."silver_production_cleaned__dbt_tmp" using btree
  (item_code)
  
[0m16:38:33.426789 [debug] [Thread-2 (]: SQL status: CREATE INDEX in 0.001 seconds
[0m16:38:33.427119 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.002 seconds
[0m16:38:33.430754 [debug] [Thread-2 (]: Using postgres connection "model.fao_elt_pipeline.silver_production_cleaned"
[0m16:38:33.432540 [debug] [Thread-1 (]: Using postgres connection "model.fao_elt_pipeline.silver_prices_cleaned"
[0m16:38:33.432890 [debug] [Thread-2 (]: On model.fao_elt_pipeline.silver_production_cleaned: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.silver_production_cleaned"} */
alter table "fao"."public_silver"."silver_production_cleaned__dbt_tmp" rename to "silver_production_cleaned"
[0m16:38:33.433225 [debug] [Thread-1 (]: On model.fao_elt_pipeline.silver_prices_cleaned: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.silver_prices_cleaned"} */
alter table "fao"."public_silver"."silver_prices_cleaned__dbt_tmp" rename to "silver_prices_cleaned"
[0m16:38:33.438618 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m16:38:33.445478 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.012 seconds
[0m16:38:33.448133 [debug] [Thread-1 (]: On model.fao_elt_pipeline.silver_prices_cleaned: COMMIT
[0m16:38:33.449099 [debug] [Thread-2 (]: On model.fao_elt_pipeline.silver_production_cleaned: COMMIT
[0m16:38:33.449505 [debug] [Thread-1 (]: Using postgres connection "model.fao_elt_pipeline.silver_prices_cleaned"
[0m16:38:33.449862 [debug] [Thread-2 (]: Using postgres connection "model.fao_elt_pipeline.silver_production_cleaned"
[0m16:38:33.450182 [debug] [Thread-1 (]: On model.fao_elt_pipeline.silver_prices_cleaned: COMMIT
[0m16:38:33.450487 [debug] [Thread-2 (]: On model.fao_elt_pipeline.silver_production_cleaned: COMMIT
[0m16:38:33.454011 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m16:38:33.458432 [debug] [Thread-1 (]: Applying DROP to: "fao"."public_silver"."silver_prices_cleaned__dbt_backup"
[0m16:38:33.458836 [debug] [Thread-2 (]: SQL status: COMMIT in 0.008 seconds
[0m16:38:33.461033 [debug] [Thread-1 (]: Using postgres connection "model.fao_elt_pipeline.silver_prices_cleaned"
[0m16:38:33.462610 [debug] [Thread-2 (]: Applying DROP to: "fao"."public_silver"."silver_production_cleaned__dbt_backup"
[0m16:38:33.463014 [debug] [Thread-1 (]: On model.fao_elt_pipeline.silver_prices_cleaned: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.silver_prices_cleaned"} */
drop table if exists "fao"."public_silver"."silver_prices_cleaned__dbt_backup" cascade
[0m16:38:33.463452 [debug] [Thread-2 (]: Using postgres connection "model.fao_elt_pipeline.silver_production_cleaned"
[0m16:38:33.463858 [debug] [Thread-2 (]: On model.fao_elt_pipeline.silver_production_cleaned: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.silver_production_cleaned"} */
drop table if exists "fao"."public_silver"."silver_production_cleaned__dbt_backup" cascade
[0m16:38:33.464919 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m16:38:33.466414 [debug] [Thread-1 (]: On model.fao_elt_pipeline.silver_prices_cleaned: Close
[0m16:38:33.466770 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.003 seconds
[0m16:38:33.467547 [debug] [Thread-2 (]: On model.fao_elt_pipeline.silver_production_cleaned: Close
[0m16:38:33.469062 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5ab9c03-8321-4c3d-a6b8-e58f10c47cb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e3dae0>]}
[0m16:38:33.469395 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5ab9c03-8321-4c3d-a6b8-e58f10c47cb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071d8b20>]}
[0m16:38:33.469961 [info ] [Thread-1 (]: 1 of 6 OK created sql table model public_silver.silver_prices_cleaned .......... [[32mSELECT 0[0m in 0.11s]
[0m16:38:33.470505 [info ] [Thread-2 (]: 2 of 6 OK created sql table model public_silver.silver_production_cleaned ...... [[32mSELECT 0[0m in 0.11s]
[0m16:38:33.470969 [debug] [Thread-1 (]: Finished running node model.fao_elt_pipeline.silver_prices_cleaned
[0m16:38:33.471396 [debug] [Thread-2 (]: Finished running node model.fao_elt_pipeline.silver_production_cleaned
[0m16:38:33.472080 [debug] [Thread-4 (]: Began running node model.fao_elt_pipeline.gold_country_metrics
[0m16:38:33.472414 [debug] [Thread-3 (]: Began running node model.fao_elt_pipeline.gold_price_production_analysis
[0m16:38:33.472772 [debug] [Thread-1 (]: Began running node model.fao_elt_pipeline.gold_regional_summary
[0m16:38:33.473178 [info ] [Thread-4 (]: 3 of 6 START sql table model public_gold.gold_country_metrics .................. [RUN]
[0m16:38:33.473584 [info ] [Thread-3 (]: 4 of 6 START sql table model public_gold.gold_price_production_analysis ........ [RUN]
[0m16:38:33.473976 [info ] [Thread-1 (]: 5 of 6 START sql table model public_gold.gold_regional_summary ................. [RUN]
[0m16:38:33.474399 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.fao_elt_pipeline.gold_country_metrics'
[0m16:38:33.474730 [debug] [Thread-2 (]: Began running node model.fao_elt_pipeline.silver_top_countries
[0m16:38:33.475134 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.fao_elt_pipeline.gold_price_production_analysis'
[0m16:38:33.475468 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fao_elt_pipeline.silver_prices_cleaned, now model.fao_elt_pipeline.gold_regional_summary)
[0m16:38:33.475834 [debug] [Thread-4 (]: Began compiling node model.fao_elt_pipeline.gold_country_metrics
[0m16:38:33.476223 [info ] [Thread-2 (]: 6 of 6 START sql table model public_silver.silver_top_countries ................ [RUN]
[0m16:38:33.476595 [debug] [Thread-3 (]: Began compiling node model.fao_elt_pipeline.gold_price_production_analysis
[0m16:38:33.476929 [debug] [Thread-1 (]: Began compiling node model.fao_elt_pipeline.gold_regional_summary
[0m16:38:33.479677 [debug] [Thread-4 (]: Writing injected SQL for node "model.fao_elt_pipeline.gold_country_metrics"
[0m16:38:33.480184 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.fao_elt_pipeline.silver_production_cleaned, now model.fao_elt_pipeline.silver_top_countries)
[0m16:38:33.482193 [debug] [Thread-3 (]: Writing injected SQL for node "model.fao_elt_pipeline.gold_price_production_analysis"
[0m16:38:33.484566 [debug] [Thread-1 (]: Writing injected SQL for node "model.fao_elt_pipeline.gold_regional_summary"
[0m16:38:33.484991 [debug] [Thread-2 (]: Began compiling node model.fao_elt_pipeline.silver_top_countries
[0m16:38:33.487496 [debug] [Thread-2 (]: Writing injected SQL for node "model.fao_elt_pipeline.silver_top_countries"
[0m16:38:33.487941 [debug] [Thread-3 (]: Began executing node model.fao_elt_pipeline.gold_price_production_analysis
[0m16:38:33.488412 [debug] [Thread-4 (]: Began executing node model.fao_elt_pipeline.gold_country_metrics
[0m16:38:33.488812 [debug] [Thread-1 (]: Began executing node model.fao_elt_pipeline.gold_regional_summary
[0m16:38:33.490853 [debug] [Thread-3 (]: Writing runtime sql for node "model.fao_elt_pipeline.gold_price_production_analysis"
[0m16:38:33.491282 [debug] [Thread-2 (]: Began executing node model.fao_elt_pipeline.silver_top_countries
[0m16:38:33.493774 [debug] [Thread-4 (]: Writing runtime sql for node "model.fao_elt_pipeline.gold_country_metrics"
[0m16:38:33.495774 [debug] [Thread-1 (]: Writing runtime sql for node "model.fao_elt_pipeline.gold_regional_summary"
[0m16:38:33.498094 [debug] [Thread-2 (]: Writing runtime sql for node "model.fao_elt_pipeline.silver_top_countries"
[0m16:38:33.498779 [debug] [Thread-3 (]: Using postgres connection "model.fao_elt_pipeline.gold_price_production_analysis"
[0m16:38:33.499194 [debug] [Thread-4 (]: Using postgres connection "model.fao_elt_pipeline.gold_country_metrics"
[0m16:38:33.499546 [debug] [Thread-3 (]: On model.fao_elt_pipeline.gold_price_production_analysis: BEGIN
[0m16:38:33.499901 [debug] [Thread-1 (]: Using postgres connection "model.fao_elt_pipeline.gold_regional_summary"
[0m16:38:33.500229 [debug] [Thread-4 (]: On model.fao_elt_pipeline.gold_country_metrics: BEGIN
[0m16:38:33.500577 [debug] [Thread-2 (]: Using postgres connection "model.fao_elt_pipeline.silver_top_countries"
[0m16:38:33.500891 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:38:33.501217 [debug] [Thread-1 (]: On model.fao_elt_pipeline.gold_regional_summary: BEGIN
[0m16:38:33.501536 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:38:33.501871 [debug] [Thread-2 (]: On model.fao_elt_pipeline.silver_top_countries: BEGIN
[0m16:38:33.502290 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:38:33.502692 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:38:33.523590 [debug] [Thread-3 (]: SQL status: BEGIN in 0.023 seconds
[0m16:38:33.524126 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m16:38:33.524591 [debug] [Thread-3 (]: Using postgres connection "model.fao_elt_pipeline.gold_price_production_analysis"
[0m16:38:33.525068 [debug] [Thread-4 (]: SQL status: BEGIN in 0.024 seconds
[0m16:38:33.525396 [debug] [Thread-1 (]: Using postgres connection "model.fao_elt_pipeline.gold_regional_summary"
[0m16:38:33.525698 [debug] [Thread-2 (]: SQL status: BEGIN in 0.023 seconds
[0m16:38:33.526163 [debug] [Thread-3 (]: On model.fao_elt_pipeline.gold_price_production_analysis: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.gold_price_production_analysis"} */

  
    

  create  table "fao"."public_gold"."gold_price_production_analysis__dbt_tmp"
  
  
    as
  
  (
    

WITH item_production AS (
    SELECT
        item_name,
        item_code,
        year,
        SUM(production_metric_tons) as global_production,
        COUNT(DISTINCT area_code) as producing_countries
    FROM "fao"."public_silver"."silver_production_cleaned"
    WHERE is_valid_production = TRUE
    GROUP BY item_name, item_code, year
),

item_prices AS (
    SELECT
        item_name,
        item_code,
        year,
        AVG(price_value) as avg_global_price,
        MAX(price_value) as max_price,
        MIN(price_value) as min_price,
        COUNT(DISTINCT area_code) as countries_with_prices
    FROM "fao"."public_silver"."silver_prices_cleaned"
    WHERE is_valid_price = TRUE
    GROUP BY item_name, item_code, year
),

price_production_combined AS (
    SELECT
        COALESCE(ip.item_name, ipr.item_name) as item_name,
        COALESCE(ip.item_code, ipr.item_code) as item_code,
        COALESCE(ip.year, ipr.year) as year,
        ip.global_production,
        ip.producing_countries,
        ipr.avg_global_price,
        ipr.max_price,
        ipr.min_price,
        ipr.countries_with_prices,
        -- Calculate price-production metrics
        CASE
            WHEN ip.global_production > 0 AND ipr.avg_global_price > 0
            THEN ipr.avg_global_price * ip.global_production
            ELSE NULL
        END as market_value
    FROM item_production ip
    FULL OUTER JOIN item_prices ipr
        ON ip.item_code = ipr.item_code
        AND ip.year = ipr.year
)

SELECT
    item_name,
    item_code,
    -- Aggregate metrics across all years
    ROUND(AVG(global_production), 0) as avg_annual_production,
    ROUND(SUM(global_production), 0) as total_production_all_years,
    ROUND(AVG(avg_global_price), 2) as avg_price_all_years,
    ROUND(AVG(market_value), 0) as avg_annual_market_value,
    ROUND(SUM(market_value), 0) as total_market_value,
    -- Price volatility
    ROUND(AVG(max_price - min_price), 2) as avg_price_spread,
    ROUND(MAX(max_price), 2) as highest_price_recorded,
    -- Market concentration
    ROUND(AVG(producing_countries), 1) as avg_producing_countries,
    ROUND(AVG(countries_with_prices), 1) as avg_countries_with_prices,
    -- Categorization
    CASE
        WHEN AVG(global_production) > 10000000 THEN 'Major Commodity'
        WHEN AVG(global_production) > 1000000 THEN 'Medium Commodity'
        ELSE 'Minor Commodity'
    END as commodity_scale,
    CASE
        WHEN AVG(avg_global_price) > 2000 THEN 'Premium Product'
        WHEN AVG(avg_global_price) > 500 THEN 'Standard Product'
        ELSE 'Basic Product'
    END as price_tier,
    -- Data quality
    COUNT(DISTINCT year) as years_with_data,
    MIN(year) as first_year,
    MAX(year) as last_year,
    CURRENT_TIMESTAMP as calculated_at
FROM price_production_combined
WHERE item_name IS NOT NULL
GROUP BY item_name, item_code
HAVING COUNT(DISTINCT year) >= 5  -- Only include items with sufficient data
ORDER BY total_market_value DESC NULLS LAST
  );
  
[0m16:38:33.526643 [debug] [Thread-4 (]: Using postgres connection "model.fao_elt_pipeline.gold_country_metrics"
[0m16:38:33.527193 [debug] [Thread-1 (]: On model.fao_elt_pipeline.gold_regional_summary: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.gold_regional_summary"} */

  
    

  create  table "fao"."public_gold"."gold_regional_summary__dbt_tmp"
  
  
    as
  
  (
    

WITH country_regions AS (
    -- Simple regional classification based on country names
    -- In production, you'd use a proper country-region mapping table
    SELECT
        country_name_standardized,
        area_code,
        CASE
            WHEN country_name_standardized IN ('China', 'India', 'Japan', 'Republic of Korea',
                                               'Thailand', 'Pakistan', 'Bangladesh', 'Myanmar') THEN 'Asia'
            WHEN country_name_standardized IN ('USA', 'Canada', 'Mexico') THEN 'North America'
            WHEN country_name_standardized IN ('Brazil', 'Argentina', 'Chile', 'Colombia',
                                               'Peru', 'Ecuador', 'Venezuela (Bolivarian Republic of)',
                                               'Paraguay', 'Uruguay', 'Bolivia (Plurinational State of)') THEN 'South America'
            WHEN country_name_standardized IN ('Germany', 'France', 'UK', 'Italy', 'Spain',
                                               'Poland', 'Netherlands (Kingdom of the)', 'Belgium',
                                               'Greece', 'Portugal', 'Sweden', 'Austria',
                                               'Denmark', 'Finland', 'Norway', 'Switzerland') THEN 'Europe'
            WHEN country_name_standardized IN ('Nigeria', 'Egypt', 'South Africa', 'Kenya',
                                               'Ethiopia', 'Morocco', 'Tunisia', 'Algeria',
                                               'Ghana', 'Ivory Coast', 'Senegal') THEN 'Africa'
            WHEN country_name_standardized IN ('Australia', 'New Zealand', 'Fiji') THEN 'Oceania'
            WHEN country_name_standardized IN ('Saudi Arabia', 'Iran (Islamic Republic of)',
                                               'Iraq', 'Syrian Arab Republic', 'Yemen',
                                               'United Arab Emirates', 'Oman') THEN 'Middle East'
            ELSE 'Other'
        END as region
    FROM (
        SELECT DISTINCT country_name_standardized, area_code
        FROM "fao"."public_silver"."silver_production_cleaned"
        UNION
        SELECT DISTINCT country_name_standardized, area_code
        FROM "fao"."public_silver"."silver_prices_cleaned"
    ) countries
),

regional_production AS (
    SELECT
        cr.region,
        p.year,
        p.item_name,
        SUM(p.production_metric_tons) as regional_production,
        COUNT(DISTINCT p.area_code) as countries_producing,
        AVG(p.production_metric_tons) as avg_country_production
    FROM "fao"."public_silver"."silver_production_cleaned" p
    JOIN country_regions cr
        ON p.country_name_standardized = cr.country_name_standardized
    WHERE p.is_valid_production = TRUE
    GROUP BY cr.region, p.year, p.item_name
),

regional_prices AS (
    SELECT
        cr.region,
        pr.year,
        pr.item_name,
        AVG(pr.price_value) as avg_regional_price,
        MAX(pr.price_value) as max_regional_price,
        MIN(pr.price_value) as min_regional_price,
        COUNT(DISTINCT pr.area_code) as countries_with_prices
    FROM "fao"."public_silver"."silver_prices_cleaned" pr
    JOIN country_regions cr
        ON pr.country_name_standardized = cr.country_name_standardized
    WHERE pr.is_valid_price = TRUE
    GROUP BY cr.region, pr.year, pr.item_name
)

SELECT
    COALESCE(rp.region, rpr.region) as region,
    -- Production metrics
    ROUND(SUM(rp.regional_production), 0) as total_production_metric_tons,
    ROUND(AVG(rp.regional_production), 0) as avg_annual_production,
    COUNT(DISTINCT rp.countries_producing) as total_producing_countries,
    COUNT(DISTINCT rp.item_name) as products_produced,
    -- Price metrics
    ROUND(AVG(rpr.avg_regional_price), 2) as avg_price_usd_per_tonne,
    ROUND(MAX(rpr.max_regional_price), 2) as highest_price_recorded,
    ROUND(AVG(rpr.max_regional_price - rpr.min_regional_price), 2) as avg_price_volatility,
    -- Market value
    ROUND(SUM(
        CASE
            WHEN rp.regional_production > 0 AND rpr.avg_regional_price > 0
            THEN rp.regional_production * rpr.avg_regional_price
            ELSE 0
        END
    ), 0) as total_market_value,
    -- Growth metrics (comparing recent vs early years)
    ROUND(
        AVG(CASE WHEN rp.year >= 2018 THEN rp.regional_production END) -
        AVG(CASE WHEN rp.year <= 1995 THEN rp.regional_production END),
        0
    ) as production_growth,
    -- Regional characteristics
    CASE
        WHEN SUM(rp.regional_production) > 100000000 THEN 'Major Agricultural Region'
        WHEN SUM(rp.regional_production) > 10000000 THEN 'Medium Agricultural Region'
        ELSE 'Minor Agricultural Region'
    END as regional_scale,
    -- Data coverage
    COUNT(DISTINCT COALESCE(rp.year, rpr.year)) as years_with_data,
    MIN(COALESCE(rp.year, rpr.year)) as first_year,
    MAX(COALESCE(rp.year, rpr.year)) as last_year,
    CURRENT_TIMESTAMP as calculated_at
FROM regional_production rp
FULL OUTER JOIN regional_prices rpr
    ON rp.region = rpr.region
    AND rp.year = rpr.year
    AND rp.item_name = rpr.item_name
WHERE COALESCE(rp.region, rpr.region) != 'Other'
GROUP BY COALESCE(rp.region, rpr.region)
ORDER BY total_production_metric_tons DESC
  );
  
[0m16:38:33.527742 [debug] [Thread-2 (]: Using postgres connection "model.fao_elt_pipeline.silver_top_countries"
[0m16:38:33.528305 [debug] [Thread-4 (]: On model.fao_elt_pipeline.gold_country_metrics: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.gold_country_metrics"} */

  
    

  create  table "fao"."public_gold"."gold_country_metrics__dbt_tmp"
  
  
    as
  
  (
    

WITH country_production AS (
    SELECT
        country_name_standardized as country_name,
        area_code,
        year,
        SUM(production_metric_tons) as annual_production,
        COUNT(DISTINCT item_code) as products_produced
    FROM "fao"."public_silver"."silver_production_cleaned"
    WHERE is_valid_production = TRUE
    GROUP BY country_name_standardized, area_code, year
),

country_prices AS (
    SELECT
        country_name_standardized as country_name,
        area_code,
        year,
        AVG(price_value) as avg_annual_price,
        COUNT(DISTINCT item_code) as products_priced
    FROM "fao"."public_silver"."silver_prices_cleaned"
    WHERE is_valid_price = TRUE
    GROUP BY country_name_standardized, area_code, year
),

country_trends AS (
    SELECT
        cp.country_name,
        cp.area_code,
        -- Production metrics
        SUM(cp.annual_production) as total_production_all_years,
        AVG(cp.annual_production) as avg_annual_production,
        MAX(cp.annual_production) as peak_annual_production,
        MIN(cp.annual_production) as min_annual_production,
        -- Calculate production growth rate (comparing first and last 3 years)
        AVG(CASE WHEN cp.year >= 2018 THEN cp.annual_production END) -
        AVG(CASE WHEN cp.year <= 1993 THEN cp.annual_production END) as production_change,
        -- Price metrics
        AVG(pc.avg_annual_price) as avg_price_all_years,
        MAX(pc.avg_annual_price) as max_price,
        MIN(pc.avg_annual_price) as min_price,
        -- Product diversity
        MAX(cp.products_produced) as max_products_produced,
        AVG(cp.products_produced) as avg_products_produced,
        -- Data availability
        COUNT(DISTINCT cp.year) as years_with_data,
        MIN(cp.year) as first_year,
        MAX(cp.year) as last_year
    FROM country_production cp
    LEFT JOIN country_prices pc
        ON cp.country_name = pc.country_name
        AND cp.area_code = pc.area_code
        AND cp.year = pc.year
    GROUP BY cp.country_name, cp.area_code
)





SELECT
    country_name,
    area_code,
    -- Production metrics
    ROUND(total_production_all_years, 0) as total_production_metric_tons,
    ROUND(avg_annual_production, 0) as avg_annual_production_metric_tons,
    ROUND(peak_annual_production, 0) as peak_production_metric_tons,
    ROUND(production_change, 0) as production_growth_metric_tons,
    CASE
        WHEN production_change > 0 THEN 'Growing'
        WHEN production_change < 0 THEN 'Declining'
        ELSE 'Stable'
    END as production_trend,
    -- Price metrics
    ROUND(avg_price_all_years, 2) as avg_price_usd_per_tonne,
    ROUND(max_price, 2) as max_price_usd_per_tonne,
    ROUND(min_price, 2) as min_price_usd_per_tonne,
    ROUND(max_price - min_price, 2) as price_volatility,
    -- Product diversity
    max_products_produced,
    ROUND(avg_products_produced, 1) as avg_products_produced,
    -- Classifications
    CASE
        WHEN total_production_all_years > 1000000 THEN 'Major Producer'
        WHEN total_production_all_years > 100000 THEN 'Medium Producer'
        ELSE 'Small Producer'
    END as producer_category,
    CASE
        WHEN avg_price_all_years > 1000 THEN 'High Value'
        WHEN avg_price_all_years > 500 THEN 'Medium Value'
        ELSE 'Low Value'
    END as price_category,
    -- Metadata
    years_with_data,
    first_year,
    last_year,
    CURRENT_TIMESTAMP as calculated_at
FROM country_trends
WHERE total_production_all_years > 0
ORDER BY total_production_all_years DESC
  );
  
[0m16:38:33.528988 [debug] [Thread-2 (]: On model.fao_elt_pipeline.silver_top_countries: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.silver_top_countries"} */

  
    

  create  table "fao"."public_silver"."silver_top_countries__dbt_tmp"
  
  
    as
  
  (
    

WITH production_rankings AS (
    SELECT
        country_name_standardized,
        area_code,
        SUM(production_metric_tons) as total_production,
        COUNT(DISTINCT item_code) as product_diversity,
        COUNT(DISTINCT year) as years_of_data,
        AVG(production_metric_tons) as avg_annual_production,
        MAX(year) as latest_year
    FROM "fao"."public_silver"."silver_production_cleaned"
    WHERE is_valid_production = TRUE
    GROUP BY country_name_standardized, area_code
),

price_rankings AS (
    SELECT
        country_name_standardized,
        area_code,
        AVG(price_value) as avg_price,
        COUNT(DISTINCT item_code) as items_with_prices,
        MAX(price_value) as max_price,
        MIN(price_value) as min_price
    FROM "fao"."public_silver"."silver_prices_cleaned"
    WHERE is_valid_price = TRUE
    GROUP BY country_name_standardized, area_code
),

combined_rankings AS (
    SELECT
        COALESCE(pr.country_name_standardized, pc.country_name_standardized) as country_name,
        COALESCE(pr.area_code, pc.area_code) as area_code,
        pr.total_production,
        pr.product_diversity,
        pr.avg_annual_production,
        pc.avg_price,
        pc.items_with_prices,
        pc.max_price,
        -- Calculate rankings
        RANK() OVER (ORDER BY pr.total_production DESC NULLS LAST) as production_rank,
        RANK() OVER (ORDER BY pc.avg_price DESC NULLS LAST) as price_rank,
        RANK() OVER (ORDER BY pr.product_diversity DESC NULLS LAST) as diversity_rank
    FROM production_rankings pr
    FULL OUTER JOIN price_rankings pc
        ON pr.country_name_standardized = pc.country_name_standardized
        AND pr.area_code = pc.area_code
)

SELECT
    country_name,
    area_code,
    total_production,
    product_diversity,
    ROUND(avg_annual_production, 2) as avg_annual_production,
    ROUND(avg_price, 2) as avg_price_usd_per_tonne,
    items_with_prices,
    ROUND(max_price, 2) as max_price_usd_per_tonne,
    production_rank,
    price_rank,
    diversity_rank,
    -- Identify top performers
    CASE
        WHEN production_rank <= 10 THEN TRUE
        ELSE FALSE
    END as is_top_producer,
    CASE
        WHEN price_rank <= 10 THEN TRUE
        ELSE FALSE
    END as is_high_price_country,
    CASE
        WHEN diversity_rank <= 10 THEN TRUE
        ELSE FALSE
    END as is_diverse_producer,
    CURRENT_TIMESTAMP as calculated_at
FROM combined_rankings
WHERE country_name IS NOT NULL
  );
  
[0m16:38:33.532380 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.004 seconds
[0m16:38:33.532850 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.004 seconds
[0m16:38:33.535113 [debug] [Thread-3 (]: Using postgres connection "model.fao_elt_pipeline.gold_price_production_analysis"
[0m16:38:33.535479 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.006 seconds
[0m16:38:33.535827 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.006 seconds
[0m16:38:33.537522 [debug] [Thread-1 (]: Using postgres connection "model.fao_elt_pipeline.gold_regional_summary"
[0m16:38:33.537870 [debug] [Thread-3 (]: On model.fao_elt_pipeline.gold_price_production_analysis: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.gold_price_production_analysis"} */
alter table "fao"."public_gold"."gold_price_production_analysis__dbt_tmp" rename to "gold_price_production_analysis"
[0m16:38:33.539667 [debug] [Thread-2 (]: Using postgres connection "model.fao_elt_pipeline.silver_top_countries"
[0m16:38:33.540553 [debug] [Thread-4 (]: Using postgres connection "model.fao_elt_pipeline.gold_country_metrics"
[0m16:38:33.540892 [debug] [Thread-1 (]: On model.fao_elt_pipeline.gold_regional_summary: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.gold_regional_summary"} */
alter table "fao"."public_gold"."gold_regional_summary__dbt_tmp" rename to "gold_regional_summary"
[0m16:38:33.541257 [debug] [Thread-2 (]: On model.fao_elt_pipeline.silver_top_countries: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.silver_top_countries"} */
alter table "fao"."public_silver"."silver_top_countries__dbt_tmp" rename to "silver_top_countries"
[0m16:38:33.541604 [debug] [Thread-4 (]: On model.fao_elt_pipeline.gold_country_metrics: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.gold_country_metrics"} */

    create  index if not exists
  "ae5a13575fdc6b0b504f22e9bb8862b0"
  on "fao"."public_gold"."gold_country_metrics__dbt_tmp" using btree
  (country_name)
  
[0m16:38:33.542001 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:38:33.542865 [debug] [Thread-3 (]: On model.fao_elt_pipeline.gold_price_production_analysis: COMMIT
[0m16:38:33.543242 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:38:33.543571 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:38:33.543889 [debug] [Thread-3 (]: Using postgres connection "model.fao_elt_pipeline.gold_price_production_analysis"
[0m16:38:33.544193 [debug] [Thread-4 (]: SQL status: CREATE INDEX in 0.002 seconds
[0m16:38:33.544902 [debug] [Thread-1 (]: On model.fao_elt_pipeline.gold_regional_summary: COMMIT
[0m16:38:33.545643 [debug] [Thread-2 (]: On model.fao_elt_pipeline.silver_top_countries: COMMIT
[0m16:38:33.545966 [debug] [Thread-3 (]: On model.fao_elt_pipeline.gold_price_production_analysis: COMMIT
[0m16:38:33.548328 [debug] [Thread-4 (]: Using postgres connection "model.fao_elt_pipeline.gold_country_metrics"
[0m16:38:33.548691 [debug] [Thread-1 (]: Using postgres connection "model.fao_elt_pipeline.gold_regional_summary"
[0m16:38:33.549020 [debug] [Thread-2 (]: Using postgres connection "model.fao_elt_pipeline.silver_top_countries"
[0m16:38:33.549369 [debug] [Thread-4 (]: On model.fao_elt_pipeline.gold_country_metrics: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.gold_country_metrics"} */
alter table "fao"."public_gold"."gold_country_metrics__dbt_tmp" rename to "gold_country_metrics"
[0m16:38:33.549686 [debug] [Thread-1 (]: On model.fao_elt_pipeline.gold_regional_summary: COMMIT
[0m16:38:33.549985 [debug] [Thread-2 (]: On model.fao_elt_pipeline.silver_top_countries: COMMIT
[0m16:38:33.551432 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m16:38:33.552746 [debug] [Thread-3 (]: Applying DROP to: "fao"."public_gold"."gold_price_production_analysis__dbt_backup"
[0m16:38:33.553155 [debug] [Thread-3 (]: Using postgres connection "model.fao_elt_pipeline.gold_price_production_analysis"
[0m16:38:33.553481 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m16:38:33.553764 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m16:38:33.554064 [debug] [Thread-3 (]: On model.fao_elt_pipeline.gold_price_production_analysis: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.gold_price_production_analysis"} */
drop table if exists "fao"."public_gold"."gold_price_production_analysis__dbt_backup" cascade
[0m16:38:33.554351 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m16:38:33.555682 [debug] [Thread-2 (]: Applying DROP to: "fao"."public_silver"."silver_top_countries__dbt_backup"
[0m16:38:33.556409 [debug] [Thread-4 (]: On model.fao_elt_pipeline.gold_country_metrics: COMMIT
[0m16:38:33.557816 [debug] [Thread-1 (]: Applying DROP to: "fao"."public_gold"."gold_regional_summary__dbt_backup"
[0m16:38:33.558169 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.001 seconds
[0m16:38:33.558572 [debug] [Thread-2 (]: Using postgres connection "model.fao_elt_pipeline.silver_top_countries"
[0m16:38:33.558885 [debug] [Thread-4 (]: Using postgres connection "model.fao_elt_pipeline.gold_country_metrics"
[0m16:38:33.559273 [debug] [Thread-1 (]: Using postgres connection "model.fao_elt_pipeline.gold_regional_summary"
[0m16:38:33.560023 [debug] [Thread-3 (]: On model.fao_elt_pipeline.gold_price_production_analysis: Close
[0m16:38:33.560354 [debug] [Thread-2 (]: On model.fao_elt_pipeline.silver_top_countries: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.silver_top_countries"} */
drop table if exists "fao"."public_silver"."silver_top_countries__dbt_backup" cascade
[0m16:38:33.560667 [debug] [Thread-4 (]: On model.fao_elt_pipeline.gold_country_metrics: COMMIT
[0m16:38:33.560975 [debug] [Thread-1 (]: On model.fao_elt_pipeline.gold_regional_summary: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.gold_regional_summary"} */
drop table if exists "fao"."public_gold"."gold_regional_summary__dbt_backup" cascade
[0m16:38:33.561453 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5ab9c03-8321-4c3d-a6b8-e58f10c47cb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108314fa0>]}
[0m16:38:33.561985 [info ] [Thread-3 (]: 4 of 6 OK created sql table model public_gold.gold_price_production_analysis ... [[32mSELECT 0[0m in 0.09s]
[0m16:38:33.562393 [debug] [Thread-3 (]: Finished running node model.fao_elt_pipeline.gold_price_production_analysis
[0m16:38:33.564984 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m16:38:33.565316 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.004 seconds
[0m16:38:33.565705 [debug] [Thread-4 (]: SQL status: COMMIT in 0.004 seconds
[0m16:38:33.566649 [debug] [Thread-1 (]: On model.fao_elt_pipeline.gold_regional_summary: Close
[0m16:38:33.567438 [debug] [Thread-2 (]: On model.fao_elt_pipeline.silver_top_countries: Close
[0m16:38:33.568898 [debug] [Thread-4 (]: Applying DROP to: "fao"."public_gold"."gold_country_metrics__dbt_backup"
[0m16:38:33.569406 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5ab9c03-8321-4c3d-a6b8-e58f10c47cb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e14eb0>]}
[0m16:38:33.569918 [debug] [Thread-4 (]: Using postgres connection "model.fao_elt_pipeline.gold_country_metrics"
[0m16:38:33.570284 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5ab9c03-8321-4c3d-a6b8-e58f10c47cb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071d8220>]}
[0m16:38:33.570764 [info ] [Thread-1 (]: 5 of 6 OK created sql table model public_gold.gold_regional_summary ............ [[32mSELECT 0[0m in 0.09s]
[0m16:38:33.571129 [debug] [Thread-4 (]: On model.fao_elt_pipeline.gold_country_metrics: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.gold_country_metrics"} */
drop table if exists "fao"."public_gold"."gold_country_metrics__dbt_backup" cascade
[0m16:38:33.571594 [info ] [Thread-2 (]: 6 of 6 OK created sql table model public_silver.silver_top_countries ........... [[32mSELECT 0[0m in 0.09s]
[0m16:38:33.572023 [debug] [Thread-1 (]: Finished running node model.fao_elt_pipeline.gold_regional_summary
[0m16:38:33.572448 [debug] [Thread-2 (]: Finished running node model.fao_elt_pipeline.silver_top_countries
[0m16:38:33.573576 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.001 seconds
[0m16:38:33.574480 [debug] [Thread-4 (]: On model.fao_elt_pipeline.gold_country_metrics: Close
[0m16:38:33.574938 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5ab9c03-8321-4c3d-a6b8-e58f10c47cb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e35f60>]}
[0m16:38:33.575413 [info ] [Thread-4 (]: 3 of 6 OK created sql table model public_gold.gold_country_metrics ............. [[32mSELECT 0[0m in 0.10s]
[0m16:38:33.575820 [debug] [Thread-4 (]: Finished running node model.fao_elt_pipeline.gold_country_metrics
[0m16:38:33.576842 [debug] [MainThread]: Using postgres connection "master"
[0m16:38:33.577242 [debug] [MainThread]: On master: BEGIN
[0m16:38:33.577518 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:38:33.585576 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m16:38:33.585928 [debug] [MainThread]: On master: COMMIT
[0m16:38:33.586214 [debug] [MainThread]: Using postgres connection "master"
[0m16:38:33.586488 [debug] [MainThread]: On master: COMMIT
[0m16:38:33.587061 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:38:33.587444 [debug] [MainThread]: On master: Close
[0m16:38:33.587809 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:38:33.588083 [debug] [MainThread]: Connection 'model.fao_elt_pipeline.gold_regional_summary' was properly closed.
[0m16:38:33.588344 [debug] [MainThread]: Connection 'model.fao_elt_pipeline.silver_top_countries' was properly closed.
[0m16:38:33.588598 [debug] [MainThread]: Connection 'model.fao_elt_pipeline.gold_country_metrics' was properly closed.
[0m16:38:33.588861 [debug] [MainThread]: Connection 'model.fao_elt_pipeline.gold_price_production_analysis' was properly closed.
[0m16:38:33.589185 [info ] [MainThread]: 
[0m16:38:33.589477 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m16:38:33.590258 [debug] [MainThread]: Command end result
[0m16:38:33.606243 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/michaelmalotte/code/personal/fao-elt-pipelines/dbt_project/target/manifest.json
[0m16:38:33.607335 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/michaelmalotte/code/personal/fao-elt-pipelines/dbt_project/target/semantic_manifest.json
[0m16:38:33.611795 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/michaelmalotte/code/personal/fao-elt-pipelines/dbt_project/target/run_results.json
[0m16:38:33.612115 [info ] [MainThread]: 
[0m16:38:33.612448 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:38:33.612740 [info ] [MainThread]: 
[0m16:38:33.613046 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m16:38:33.614877 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.7645882, "process_in_blocks": "0", "process_kernel_time": 0.169793, "process_mem_max_rss": "150126592", "process_out_blocks": "0", "process_user_time": 2.136299}
[0m16:38:33.620316 [debug] [MainThread]: Command `dbt run` succeeded at 16:38:33.620226 after 1.77 seconds
[0m16:38:33.620747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105868bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058fbfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e964a0>]}
[0m16:38:33.621109 [debug] [MainThread]: Flushing usage events
[0m16:38:34.029082 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:38:35.021919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106628bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f5d420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f5cd00>]}


============================== 16:38:35.024386 | d343e4a6-1ce4-4421-9b40-7f89862e87f0 ==============================
[0m16:38:35.024386 [info ] [MainThread]: Running with dbt=1.10.4
[0m16:38:35.024820 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/michaelmalotte/code/personal/fao-elt-pipelines/dbt_project/logs', 'version_check': 'True', 'profiles_dir': '/Users/michaelmalotte/code/personal/fao-elt-pipelines/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test --target dev', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:38:35.131302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd343e4a6-1ce4-4421-9b40-7f89862e87f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f85420>]}
[0m16:38:35.172219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd343e4a6-1ce4-4421-9b40-7f89862e87f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106785db0>]}
[0m16:38:35.172876 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:38:35.237295 [debug] [MainThread]: checksum: 23bc95a42434187059b2384bcd89d8aac150f1bd09bd2e89bfeb67b518f50b75, vars: {}, profile: , target: dev, version: 1.10.4
[0m16:38:35.319550 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:38:35.319956 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:38:35.323879 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.fao_elt_pipeline.bronze
[0m16:38:35.354720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd343e4a6-1ce4-4421-9b40-7f89862e87f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10910cd00>]}
[0m16:38:35.447916 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/michaelmalotte/code/personal/fao-elt-pipelines/dbt_project/target/manifest.json
[0m16:38:35.449302 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/michaelmalotte/code/personal/fao-elt-pipelines/dbt_project/target/semantic_manifest.json
[0m16:38:35.462609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd343e4a6-1ce4-4421-9b40-7f89862e87f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109116f20>]}
[0m16:38:35.463164 [info ] [MainThread]: Found 6 models, 23 data tests, 2 sources, 435 macros
[0m16:38:35.463555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd343e4a6-1ce4-4421-9b40-7f89862e87f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109116d10>]}
[0m16:38:35.465115 [info ] [MainThread]: 
[0m16:38:35.465487 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:38:35.465802 [info ] [MainThread]: 
[0m16:38:35.466214 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:38:35.468804 [debug] [ThreadPool]: Acquiring new postgres connection 'list_fao_public_gold'
[0m16:38:35.476178 [debug] [ThreadPool]: Acquiring new postgres connection 'list_fao_public_silver'
[0m16:38:35.494224 [debug] [ThreadPool]: Using postgres connection "list_fao_public_gold"
[0m16:38:35.494697 [debug] [ThreadPool]: Using postgres connection "list_fao_public_silver"
[0m16:38:35.495075 [debug] [ThreadPool]: On list_fao_public_gold: BEGIN
[0m16:38:35.495406 [debug] [ThreadPool]: On list_fao_public_silver: BEGIN
[0m16:38:35.495729 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:38:35.496028 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:38:35.565324 [debug] [ThreadPool]: SQL status: BEGIN in 0.070 seconds
[0m16:38:35.565768 [debug] [ThreadPool]: SQL status: BEGIN in 0.070 seconds
[0m16:38:35.566212 [debug] [ThreadPool]: Using postgres connection "list_fao_public_gold"
[0m16:38:35.566505 [debug] [ThreadPool]: Using postgres connection "list_fao_public_silver"
[0m16:38:35.566884 [debug] [ThreadPool]: On list_fao_public_gold: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "connection_name": "list_fao_public_gold"} */
select
      'fao' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'fao' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'fao' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m16:38:35.567324 [debug] [ThreadPool]: On list_fao_public_silver: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "connection_name": "list_fao_public_silver"} */
select
      'fao' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'fao' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'fao' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m16:38:35.569621 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m16:38:35.569980 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m16:38:35.570870 [debug] [ThreadPool]: On list_fao_public_silver: ROLLBACK
[0m16:38:35.571669 [debug] [ThreadPool]: On list_fao_public_gold: ROLLBACK
[0m16:38:35.572473 [debug] [ThreadPool]: On list_fao_public_silver: Close
[0m16:38:35.572871 [debug] [ThreadPool]: On list_fao_public_gold: Close
[0m16:38:35.577356 [debug] [MainThread]: Using postgres connection "master"
[0m16:38:35.577789 [debug] [MainThread]: On master: BEGIN
[0m16:38:35.578111 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:38:35.588403 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m16:38:35.588812 [debug] [MainThread]: Using postgres connection "master"
[0m16:38:35.589196 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:38:35.592093 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m16:38:35.593021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd343e4a6-1ce4-4421-9b40-7f89862e87f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109115090>]}
[0m16:38:35.593459 [debug] [MainThread]: On master: ROLLBACK
[0m16:38:35.594196 [debug] [MainThread]: Using postgres connection "master"
[0m16:38:35.594533 [debug] [MainThread]: On master: BEGIN
[0m16:38:35.595340 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:38:35.595640 [debug] [MainThread]: On master: COMMIT
[0m16:38:35.595925 [debug] [MainThread]: Using postgres connection "master"
[0m16:38:35.596201 [debug] [MainThread]: On master: COMMIT
[0m16:38:35.596792 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:38:35.597135 [debug] [MainThread]: On master: Close
[0m16:38:35.598754 [debug] [Thread-1 (]: Began running node test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee
[0m16:38:35.599138 [info ] [Thread-1 (]: 1 of 23 START test accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer  [RUN]
[0m16:38:35.599499 [debug] [Thread-2 (]: Began running node test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd
[0m16:38:35.599838 [debug] [Thread-3 (]: Began running node test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53
[0m16:38:35.600178 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_fao_public_gold, now test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee)
[0m16:38:35.600502 [debug] [Thread-4 (]: Began running node test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69
[0m16:38:35.600834 [info ] [Thread-2 (]: 2 of 23 START test accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable  [RUN]
[0m16:38:35.601173 [info ] [Thread-3 (]: 3 of 23 START test accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity  [RUN]
[0m16:38:35.601502 [debug] [Thread-1 (]: Began compiling node test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee
[0m16:38:35.601826 [info ] [Thread-4 (]: 4 of 23 START test accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product  [RUN]
[0m16:38:35.602160 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_fao_public_silver, now test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd)
[0m16:38:35.602567 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53'
[0m16:38:35.612880 [debug] [Thread-1 (]: Writing injected SQL for node "test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee"
[0m16:38:35.613403 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69'
[0m16:38:35.613757 [debug] [Thread-2 (]: Began compiling node test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd
[0m16:38:35.614078 [debug] [Thread-3 (]: Began compiling node test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53
[0m16:38:35.614631 [debug] [Thread-4 (]: Began compiling node test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69
[0m16:38:35.618288 [debug] [Thread-2 (]: Writing injected SQL for node "test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd"
[0m16:38:35.621523 [debug] [Thread-3 (]: Writing injected SQL for node "test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53"
[0m16:38:35.625042 [debug] [Thread-4 (]: Writing injected SQL for node "test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69"
[0m16:38:35.625503 [debug] [Thread-1 (]: Began executing node test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee
[0m16:38:35.636227 [debug] [Thread-1 (]: Writing runtime sql for node "test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee"
[0m16:38:35.636660 [debug] [Thread-2 (]: Began executing node test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd
[0m16:38:35.637072 [debug] [Thread-4 (]: Began executing node test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69
[0m16:38:35.637448 [debug] [Thread-3 (]: Began executing node test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53
[0m16:38:35.639087 [debug] [Thread-2 (]: Writing runtime sql for node "test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd"
[0m16:38:35.641118 [debug] [Thread-4 (]: Writing runtime sql for node "test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69"
[0m16:38:35.642453 [debug] [Thread-3 (]: Writing runtime sql for node "test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53"
[0m16:38:35.642966 [debug] [Thread-1 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee"
[0m16:38:35.643447 [debug] [Thread-1 (]: On test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee: BEGIN
[0m16:38:35.643788 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:38:35.644144 [debug] [Thread-2 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd"
[0m16:38:35.644545 [debug] [Thread-4 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69"
[0m16:38:35.644959 [debug] [Thread-3 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53"
[0m16:38:35.645311 [debug] [Thread-2 (]: On test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd: BEGIN
[0m16:38:35.645647 [debug] [Thread-4 (]: On test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69: BEGIN
[0m16:38:35.645977 [debug] [Thread-3 (]: On test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53: BEGIN
[0m16:38:35.646309 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:38:35.646634 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:38:35.646963 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:38:35.667038 [debug] [Thread-1 (]: SQL status: BEGIN in 0.023 seconds
[0m16:38:35.667498 [debug] [Thread-2 (]: SQL status: BEGIN in 0.021 seconds
[0m16:38:35.667911 [debug] [Thread-3 (]: SQL status: BEGIN in 0.021 seconds
[0m16:38:35.668220 [debug] [Thread-4 (]: SQL status: BEGIN in 0.022 seconds
[0m16:38:35.668608 [debug] [Thread-1 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee"
[0m16:38:35.668955 [debug] [Thread-2 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd"
[0m16:38:35.669350 [debug] [Thread-3 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53"
[0m16:38:35.669767 [debug] [Thread-4 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69"
[0m16:38:35.670164 [debug] [Thread-1 (]: On test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        producer_category as value_field,
        count(*) as n_records

    from "fao"."public_gold"."gold_country_metrics"
    group by producer_category

)

select *
from all_values
where value_field not in (
    'Major Producer','Medium Producer','Small Producer'
)



  
  
      
    ) dbt_internal_test
[0m16:38:35.670549 [debug] [Thread-2 (]: On test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        production_trend as value_field,
        count(*) as n_records

    from "fao"."public_gold"."gold_country_metrics"
    group by production_trend

)

select *
from all_values
where value_field not in (
    'Growing','Declining','Stable'
)



  
  
      
    ) dbt_internal_test
[0m16:38:35.670945 [debug] [Thread-3 (]: On test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        commodity_scale as value_field,
        count(*) as n_records

    from "fao"."public_gold"."gold_price_production_analysis"
    group by commodity_scale

)

select *
from all_values
where value_field not in (
    'Major Commodity','Medium Commodity','Minor Commodity'
)



  
  
      
    ) dbt_internal_test
[0m16:38:35.671332 [debug] [Thread-4 (]: On test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        price_tier as value_field,
        count(*) as n_records

    from "fao"."public_gold"."gold_price_production_analysis"
    group by price_tier

)

select *
from all_values
where value_field not in (
    'Premium Product','Standard Product','Basic Product'
)



  
  
      
    ) dbt_internal_test
[0m16:38:35.672765 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:38:35.673176 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:38:35.673536 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m16:38:35.673830 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m16:38:35.676568 [debug] [Thread-1 (]: On test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee: ROLLBACK
[0m16:38:35.677611 [debug] [Thread-4 (]: On test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69: ROLLBACK
[0m16:38:35.678445 [debug] [Thread-3 (]: On test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53: ROLLBACK
[0m16:38:35.679202 [debug] [Thread-2 (]: On test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd: ROLLBACK
[0m16:38:35.681398 [debug] [Thread-1 (]: On test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee: Close
[0m16:38:35.681812 [debug] [Thread-4 (]: On test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69: Close
[0m16:38:35.682193 [debug] [Thread-2 (]: On test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd: Close
[0m16:38:35.682696 [info ] [Thread-4 (]: 4 of 23 PASS accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product  [[32mPASS[0m in 0.07s]
[0m16:38:35.683099 [debug] [Thread-3 (]: On test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53: Close
[0m16:38:35.683552 [info ] [Thread-1 (]: 1 of 23 PASS accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer  [[32mPASS[0m in 0.08s]
[0m16:38:35.684046 [info ] [Thread-2 (]: 2 of 23 PASS accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable  [[32mPASS[0m in 0.08s]
[0m16:38:35.684509 [debug] [Thread-4 (]: Finished running node test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69
[0m16:38:35.685131 [debug] [Thread-1 (]: Finished running node test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee
[0m16:38:35.685612 [info ] [Thread-3 (]: 3 of 23 PASS accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity  [[32mPASS[0m in 0.08s]
[0m16:38:35.686041 [debug] [Thread-2 (]: Finished running node test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd
[0m16:38:35.686417 [debug] [Thread-4 (]: Began running node test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6
[0m16:38:35.686760 [debug] [Thread-1 (]: Began running node test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff
[0m16:38:35.687195 [debug] [Thread-3 (]: Finished running node test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53
[0m16:38:35.687529 [debug] [Thread-2 (]: Began running node test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f
[0m16:38:35.687870 [info ] [Thread-4 (]: 5 of 23 START test accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region  [RUN]
[0m16:38:35.688212 [info ] [Thread-1 (]: 6 of 23 START test accepted_values_silver_prices_cleaned_is_valid_price__True__False  [RUN]
[0m16:38:35.688550 [debug] [Thread-3 (]: Began running node test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c
[0m16:38:35.688890 [info ] [Thread-2 (]: 7 of 23 START test accepted_values_silver_production_cleaned_is_valid_production__True__False  [RUN]
[0m16:38:35.689247 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69, now test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6)
[0m16:38:35.689587 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee, now test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff)
[0m16:38:35.689912 [info ] [Thread-3 (]: 8 of 23 START test not_null_gold_country_metrics_country_name .................. [RUN]
[0m16:38:35.690251 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd, now test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f)
[0m16:38:35.690575 [debug] [Thread-4 (]: Began compiling node test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6
[0m16:38:35.690886 [debug] [Thread-1 (]: Began compiling node test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff
[0m16:38:35.691200 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53, now test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c)
[0m16:38:35.691514 [debug] [Thread-2 (]: Began compiling node test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f
[0m16:38:35.694763 [debug] [Thread-4 (]: Writing injected SQL for node "test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6"
[0m16:38:35.696951 [debug] [Thread-1 (]: Writing injected SQL for node "test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff"
[0m16:38:35.697303 [debug] [Thread-3 (]: Began compiling node test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c
[0m16:38:35.699437 [debug] [Thread-2 (]: Writing injected SQL for node "test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f"
[0m16:38:35.703803 [debug] [Thread-3 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c"
[0m16:38:35.704232 [debug] [Thread-4 (]: Began executing node test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6
[0m16:38:35.705925 [debug] [Thread-4 (]: Writing runtime sql for node "test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6"
[0m16:38:35.706311 [debug] [Thread-1 (]: Began executing node test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff
[0m16:38:35.706702 [debug] [Thread-2 (]: Began executing node test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f
[0m16:38:35.708960 [debug] [Thread-1 (]: Writing runtime sql for node "test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff"
[0m16:38:35.709365 [debug] [Thread-3 (]: Began executing node test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c
[0m16:38:35.709792 [debug] [Thread-4 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6"
[0m16:38:35.711357 [debug] [Thread-2 (]: Writing runtime sql for node "test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f"
[0m16:38:35.712945 [debug] [Thread-3 (]: Writing runtime sql for node "test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c"
[0m16:38:35.713379 [debug] [Thread-4 (]: On test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6: BEGIN
[0m16:38:35.713949 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:38:35.714397 [debug] [Thread-2 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f"
[0m16:38:35.714864 [debug] [Thread-1 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff"
[0m16:38:35.715276 [debug] [Thread-3 (]: Using postgres connection "test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c"
[0m16:38:35.715647 [debug] [Thread-2 (]: On test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f: BEGIN
[0m16:38:35.716004 [debug] [Thread-1 (]: On test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff: BEGIN
[0m16:38:35.716354 [debug] [Thread-3 (]: On test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c: BEGIN
[0m16:38:35.716713 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:38:35.717074 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:38:35.717407 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:38:35.733528 [debug] [Thread-4 (]: SQL status: BEGIN in 0.020 seconds
[0m16:38:35.734094 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m16:38:35.734456 [debug] [Thread-3 (]: SQL status: BEGIN in 0.017 seconds
[0m16:38:35.734769 [debug] [Thread-2 (]: SQL status: BEGIN in 0.018 seconds
[0m16:38:35.735152 [debug] [Thread-4 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6"
[0m16:38:35.735486 [debug] [Thread-1 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff"
[0m16:38:35.735799 [debug] [Thread-3 (]: Using postgres connection "test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c"
[0m16:38:35.736128 [debug] [Thread-2 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f"
[0m16:38:35.736507 [debug] [Thread-4 (]: On test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        regional_scale as value_field,
        count(*) as n_records

    from "fao"."public_gold"."gold_regional_summary"
    group by regional_scale

)

select *
from all_values
where value_field not in (
    'Major Agricultural Region','Medium Agricultural Region','Minor Agricultural Region'
)



  
  
      
    ) dbt_internal_test
[0m16:38:35.736901 [debug] [Thread-1 (]: On test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        is_valid_price as value_field,
        count(*) as n_records

    from "fao"."public_silver"."silver_prices_cleaned"
    group by is_valid_price

)

select *
from all_values
where value_field not in (
    'True','False'
)



  
  
      
    ) dbt_internal_test
[0m16:38:35.737360 [debug] [Thread-3 (]: On test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select country_name
from "fao"."public_gold"."gold_country_metrics"
where country_name is null



  
  
      
    ) dbt_internal_test
[0m16:38:35.737766 [debug] [Thread-2 (]: On test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        is_valid_production as value_field,
        count(*) as n_records

    from "fao"."public_silver"."silver_production_cleaned"
    group by is_valid_production

)

select *
from all_values
where value_field not in (
    'True','False'
)



  
  
      
    ) dbt_internal_test
[0m16:38:35.752683 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.014 seconds
[0m16:38:35.753096 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.015 seconds
[0m16:38:35.753475 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.015 seconds
[0m16:38:35.753819 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.016 seconds
[0m16:38:35.754961 [debug] [Thread-3 (]: On test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c: ROLLBACK
[0m16:38:35.755800 [debug] [Thread-4 (]: On test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6: ROLLBACK
[0m16:38:35.756585 [debug] [Thread-1 (]: On test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff: ROLLBACK
[0m16:38:35.757358 [debug] [Thread-2 (]: On test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f: ROLLBACK
[0m16:38:35.758095 [debug] [Thread-3 (]: On test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c: Close
[0m16:38:35.758524 [debug] [Thread-1 (]: On test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff: Close
[0m16:38:35.758878 [debug] [Thread-2 (]: On test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f: Close
[0m16:38:35.759206 [debug] [Thread-4 (]: On test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6: Close
[0m16:38:35.759758 [info ] [Thread-3 (]: 8 of 23 PASS not_null_gold_country_metrics_country_name ........................ [[32mPASS[0m in 0.07s]
[0m16:38:35.760224 [info ] [Thread-1 (]: 6 of 23 PASS accepted_values_silver_prices_cleaned_is_valid_price__True__False . [[32mPASS[0m in 0.07s]
[0m16:38:35.760833 [info ] [Thread-2 (]: 7 of 23 PASS accepted_values_silver_production_cleaned_is_valid_production__True__False  [[32mPASS[0m in 0.07s]
[0m16:38:35.761436 [info ] [Thread-4 (]: 5 of 23 PASS accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region  [[32mPASS[0m in 0.07s]
[0m16:38:35.761916 [debug] [Thread-3 (]: Finished running node test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c
[0m16:38:35.762340 [debug] [Thread-1 (]: Finished running node test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff
[0m16:38:35.762755 [debug] [Thread-2 (]: Finished running node test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f
[0m16:38:35.763160 [debug] [Thread-4 (]: Finished running node test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6
[0m16:38:35.763509 [debug] [Thread-3 (]: Began running node test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b
[0m16:38:35.763885 [debug] [Thread-1 (]: Began running node test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7
[0m16:38:35.764291 [debug] [Thread-2 (]: Began running node test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5
[0m16:38:35.764631 [debug] [Thread-4 (]: Began running node test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df
[0m16:38:35.764980 [info ] [Thread-3 (]: 9 of 23 START test not_null_gold_price_production_analysis_item_name ........... [RUN]
[0m16:38:35.765325 [info ] [Thread-1 (]: 10 of 23 START test not_null_gold_regional_summary_region ...................... [RUN]
[0m16:38:35.765653 [info ] [Thread-2 (]: 11 of 23 START test not_null_silver_prices_cleaned_price_id .................... [RUN]
[0m16:38:35.765989 [info ] [Thread-4 (]: 12 of 23 START test not_null_silver_prices_cleaned_price_value ................. [RUN]
[0m16:38:35.766363 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c, now test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b)
[0m16:38:35.766693 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff, now test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7)
[0m16:38:35.767014 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f, now test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5)
[0m16:38:35.767333 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6, now test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df)
[0m16:38:35.767671 [debug] [Thread-3 (]: Began compiling node test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b
[0m16:38:35.767981 [debug] [Thread-1 (]: Began compiling node test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7
[0m16:38:35.768284 [debug] [Thread-2 (]: Began compiling node test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5
[0m16:38:35.768743 [debug] [Thread-4 (]: Began compiling node test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df
[0m16:38:35.771489 [debug] [Thread-3 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b"
[0m16:38:35.773732 [debug] [Thread-1 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7"
[0m16:38:35.775948 [debug] [Thread-2 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5"
[0m16:38:35.778344 [debug] [Thread-4 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df"
[0m16:38:35.779111 [debug] [Thread-4 (]: Began executing node test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df
[0m16:38:35.781488 [debug] [Thread-4 (]: Writing runtime sql for node "test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df"
[0m16:38:35.781859 [debug] [Thread-3 (]: Began executing node test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b
[0m16:38:35.782170 [debug] [Thread-1 (]: Began executing node test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7
[0m16:38:35.782460 [debug] [Thread-2 (]: Began executing node test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5
[0m16:38:35.783987 [debug] [Thread-3 (]: Writing runtime sql for node "test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b"
[0m16:38:35.785327 [debug] [Thread-1 (]: Writing runtime sql for node "test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7"
[0m16:38:35.786943 [debug] [Thread-2 (]: Writing runtime sql for node "test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5"
[0m16:38:35.787397 [debug] [Thread-4 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df"
[0m16:38:35.788068 [debug] [Thread-4 (]: On test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df: BEGIN
[0m16:38:35.788519 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:38:35.788989 [debug] [Thread-3 (]: Using postgres connection "test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b"
[0m16:38:35.789330 [debug] [Thread-3 (]: On test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b: BEGIN
[0m16:38:35.789633 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:38:35.790082 [debug] [Thread-1 (]: Using postgres connection "test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7"
[0m16:38:35.790457 [debug] [Thread-2 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5"
[0m16:38:35.790768 [debug] [Thread-1 (]: On test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7: BEGIN
[0m16:38:35.791101 [debug] [Thread-2 (]: On test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5: BEGIN
[0m16:38:35.791429 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:38:35.791768 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:38:35.813900 [debug] [Thread-2 (]: SQL status: BEGIN in 0.022 seconds
[0m16:38:35.814407 [debug] [Thread-1 (]: SQL status: BEGIN in 0.023 seconds
[0m16:38:35.814740 [debug] [Thread-2 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5"
[0m16:38:35.815041 [debug] [Thread-4 (]: SQL status: BEGIN in 0.027 seconds
[0m16:38:35.815361 [debug] [Thread-1 (]: Using postgres connection "test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7"
[0m16:38:35.815755 [debug] [Thread-3 (]: SQL status: BEGIN in 0.026 seconds
[0m16:38:35.816267 [debug] [Thread-2 (]: On test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select price_id
from "fao"."public_silver"."silver_prices_cleaned"
where price_id is null



  
  
      
    ) dbt_internal_test
[0m16:38:35.816709 [debug] [Thread-4 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df"
[0m16:38:35.817126 [debug] [Thread-1 (]: On test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region
from "fao"."public_gold"."gold_regional_summary"
where region is null



  
  
      
    ) dbt_internal_test
[0m16:38:35.817497 [debug] [Thread-3 (]: Using postgres connection "test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b"
[0m16:38:35.817964 [debug] [Thread-4 (]: On test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select price_value
from "fao"."public_silver"."silver_prices_cleaned"
where price_value is null



  
  
      
    ) dbt_internal_test
[0m16:38:35.818444 [debug] [Thread-3 (]: On test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select item_name
from "fao"."public_gold"."gold_price_production_analysis"
where item_name is null



  
  
      
    ) dbt_internal_test
[0m16:38:35.818871 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:38:35.819303 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:38:35.820534 [debug] [Thread-2 (]: On test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5: ROLLBACK
[0m16:38:35.820992 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:38:35.821969 [debug] [Thread-1 (]: On test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7: ROLLBACK
[0m16:38:35.822304 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m16:38:35.823276 [debug] [Thread-3 (]: On test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b: ROLLBACK
[0m16:38:35.823645 [debug] [Thread-2 (]: On test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5: Close
[0m16:38:35.824473 [debug] [Thread-4 (]: On test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df: ROLLBACK
[0m16:38:35.825015 [info ] [Thread-2 (]: 11 of 23 PASS not_null_silver_prices_cleaned_price_id .......................... [[32mPASS[0m in 0.06s]
[0m16:38:35.825478 [debug] [Thread-2 (]: Finished running node test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5
[0m16:38:35.825826 [debug] [Thread-2 (]: Began running node test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b
[0m16:38:35.826212 [info ] [Thread-2 (]: 13 of 23 START test not_null_silver_prices_cleaned_year ........................ [RUN]
[0m16:38:35.826639 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5, now test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b)
[0m16:38:35.826993 [debug] [Thread-2 (]: Began compiling node test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b
[0m16:38:35.829898 [debug] [Thread-2 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b"
[0m16:38:35.830328 [debug] [Thread-4 (]: On test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df: Close
[0m16:38:35.830725 [debug] [Thread-1 (]: On test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7: Close
[0m16:38:35.831191 [debug] [Thread-3 (]: On test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b: Close
[0m16:38:35.831797 [info ] [Thread-1 (]: 10 of 23 PASS not_null_gold_regional_summary_region ............................ [[32mPASS[0m in 0.07s]
[0m16:38:35.832347 [info ] [Thread-4 (]: 12 of 23 PASS not_null_silver_prices_cleaned_price_value ....................... [[32mPASS[0m in 0.06s]
[0m16:38:35.832820 [debug] [Thread-2 (]: Began executing node test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b
[0m16:38:35.833329 [info ] [Thread-3 (]: 9 of 23 PASS not_null_gold_price_production_analysis_item_name ................. [[32mPASS[0m in 0.07s]
[0m16:38:35.833854 [debug] [Thread-1 (]: Finished running node test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7
[0m16:38:35.834346 [debug] [Thread-4 (]: Finished running node test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df
[0m16:38:35.835936 [debug] [Thread-2 (]: Writing runtime sql for node "test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b"
[0m16:38:35.836408 [debug] [Thread-3 (]: Finished running node test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b
[0m16:38:35.836939 [debug] [Thread-1 (]: Began running node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74
[0m16:38:35.837433 [debug] [Thread-4 (]: Began running node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d
[0m16:38:35.837927 [debug] [Thread-3 (]: Began running node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df
[0m16:38:35.838350 [info ] [Thread-1 (]: 14 of 23 START test not_null_silver_production_cleaned_production_id ........... [RUN]
[0m16:38:35.838792 [debug] [Thread-2 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b"
[0m16:38:35.839160 [info ] [Thread-4 (]: 15 of 23 START test not_null_silver_production_cleaned_production_metric_tons .. [RUN]
[0m16:38:35.839546 [info ] [Thread-3 (]: 16 of 23 START test not_null_silver_production_cleaned_production_value ........ [RUN]
[0m16:38:35.839952 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7, now test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74)
[0m16:38:35.840309 [debug] [Thread-2 (]: On test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b: BEGIN
[0m16:38:35.840647 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df, now test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d)
[0m16:38:35.840992 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b, now test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df)
[0m16:38:35.841387 [debug] [Thread-1 (]: Began compiling node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74
[0m16:38:35.841776 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:38:35.842147 [debug] [Thread-4 (]: Began compiling node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d
[0m16:38:35.842500 [debug] [Thread-3 (]: Began compiling node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df
[0m16:38:35.845107 [debug] [Thread-1 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74"
[0m16:38:35.848716 [debug] [Thread-4 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d"
[0m16:38:35.851224 [debug] [Thread-3 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df"
[0m16:38:35.851958 [debug] [Thread-3 (]: Began executing node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df
[0m16:38:35.853567 [debug] [Thread-3 (]: Writing runtime sql for node "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df"
[0m16:38:35.853995 [debug] [Thread-4 (]: Began executing node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d
[0m16:38:35.854475 [debug] [Thread-1 (]: Began executing node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74
[0m16:38:35.855989 [debug] [Thread-4 (]: Writing runtime sql for node "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d"
[0m16:38:35.857757 [debug] [Thread-1 (]: Writing runtime sql for node "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74"
[0m16:38:35.858244 [debug] [Thread-3 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df"
[0m16:38:35.858889 [debug] [Thread-3 (]: On test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df: BEGIN
[0m16:38:35.859342 [debug] [Thread-2 (]: SQL status: BEGIN in 0.018 seconds
[0m16:38:35.859839 [debug] [Thread-4 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d"
[0m16:38:35.860217 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:38:35.860562 [debug] [Thread-1 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74"
[0m16:38:35.860936 [debug] [Thread-2 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b"
[0m16:38:35.861322 [debug] [Thread-4 (]: On test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d: BEGIN
[0m16:38:35.861831 [debug] [Thread-1 (]: On test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74: BEGIN
[0m16:38:35.862249 [debug] [Thread-2 (]: On test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select year
from "fao"."public_silver"."silver_prices_cleaned"
where year is null



  
  
      
    ) dbt_internal_test
[0m16:38:35.862699 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:38:35.863072 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:38:35.864495 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:38:35.865583 [debug] [Thread-2 (]: On test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b: ROLLBACK
[0m16:38:35.866357 [debug] [Thread-2 (]: On test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b: Close
[0m16:38:35.866988 [info ] [Thread-2 (]: 13 of 23 PASS not_null_silver_prices_cleaned_year .............................. [[32mPASS[0m in 0.04s]
[0m16:38:35.867449 [debug] [Thread-2 (]: Finished running node test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b
[0m16:38:35.867809 [debug] [Thread-2 (]: Began running node test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd
[0m16:38:35.868293 [info ] [Thread-2 (]: 17 of 23 START test not_null_silver_top_countries_area_code .................... [RUN]
[0m16:38:35.868756 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b, now test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd)
[0m16:38:35.869174 [debug] [Thread-2 (]: Began compiling node test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd
[0m16:38:35.869521 [debug] [Thread-3 (]: SQL status: BEGIN in 0.009 seconds
[0m16:38:35.872177 [debug] [Thread-2 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd"
[0m16:38:35.872709 [debug] [Thread-3 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df"
[0m16:38:35.873299 [debug] [Thread-3 (]: On test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select production_value
from "fao"."public_silver"."silver_production_cleaned"
where production_value is null



  
  
      
    ) dbt_internal_test
[0m16:38:35.873745 [debug] [Thread-4 (]: SQL status: BEGIN in 0.011 seconds
[0m16:38:35.874240 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m16:38:35.874640 [debug] [Thread-2 (]: Began executing node test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd
[0m16:38:35.874999 [debug] [Thread-4 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d"
[0m16:38:35.875371 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:38:35.875692 [debug] [Thread-1 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74"
[0m16:38:35.877390 [debug] [Thread-2 (]: Writing runtime sql for node "test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd"
[0m16:38:35.877815 [debug] [Thread-4 (]: On test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select production_metric_tons
from "fao"."public_silver"."silver_production_cleaned"
where production_metric_tons is null



  
  
      
    ) dbt_internal_test
[0m16:38:35.878812 [debug] [Thread-3 (]: On test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df: ROLLBACK
[0m16:38:35.879234 [debug] [Thread-1 (]: On test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select production_id
from "fao"."public_silver"."silver_production_cleaned"
where production_id is null



  
  
      
    ) dbt_internal_test
[0m16:38:35.879852 [debug] [Thread-2 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd"
[0m16:38:35.880176 [debug] [Thread-2 (]: On test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd: BEGIN
[0m16:38:35.880484 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:38:35.883201 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m16:38:35.883555 [debug] [Thread-3 (]: On test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df: Close
[0m16:38:35.883914 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.004 seconds
[0m16:38:35.885004 [debug] [Thread-1 (]: On test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74: ROLLBACK
[0m16:38:35.885976 [debug] [Thread-4 (]: On test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d: ROLLBACK
[0m16:38:35.886460 [info ] [Thread-3 (]: 16 of 23 PASS not_null_silver_production_cleaned_production_value .............. [[32mPASS[0m in 0.05s]
[0m16:38:35.887067 [debug] [Thread-3 (]: Finished running node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df
[0m16:38:35.887421 [debug] [Thread-1 (]: On test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74: Close
[0m16:38:35.887768 [debug] [Thread-4 (]: On test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d: Close
[0m16:38:35.888168 [debug] [Thread-3 (]: Began running node test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a
[0m16:38:35.888593 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m16:38:35.889069 [info ] [Thread-1 (]: 14 of 23 PASS not_null_silver_production_cleaned_production_id ................. [[32mPASS[0m in 0.05s]
[0m16:38:35.889584 [info ] [Thread-4 (]: 15 of 23 PASS not_null_silver_production_cleaned_production_metric_tons ........ [[32mPASS[0m in 0.05s]
[0m16:38:35.889847 [info ] [Thread-3 (]: 18 of 23 START test not_null_silver_top_countries_country_name ................. [RUN]
[0m16:38:35.890455 [debug] [Thread-2 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd"
[0m16:38:35.890905 [debug] [Thread-1 (]: Finished running node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74
[0m16:38:35.891333 [debug] [Thread-4 (]: Finished running node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d
[0m16:38:35.891717 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df, now test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a)
[0m16:38:35.892086 [debug] [Thread-2 (]: On test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select area_code
from "fao"."public_silver"."silver_top_countries"
where area_code is null



  
  
      
    ) dbt_internal_test
[0m16:38:35.892451 [debug] [Thread-1 (]: Began running node test.fao_elt_pipeline.test_data_quality
[0m16:38:35.892777 [debug] [Thread-4 (]: Began running node test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4
[0m16:38:35.893122 [debug] [Thread-3 (]: Began compiling node test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a
[0m16:38:35.893507 [info ] [Thread-1 (]: 19 of 23 START test test_data_quality .......................................... [RUN]
[0m16:38:35.893867 [info ] [Thread-4 (]: 20 of 23 START test unique_gold_country_metrics_country_name ................... [RUN]
[0m16:38:35.894273 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:38:35.897623 [debug] [Thread-3 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a"
[0m16:38:35.898040 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74, now test.fao_elt_pipeline.test_data_quality)
[0m16:38:35.898379 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d, now test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4)
[0m16:38:35.899275 [debug] [Thread-2 (]: On test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd: ROLLBACK
[0m16:38:35.899699 [debug] [Thread-1 (]: Began compiling node test.fao_elt_pipeline.test_data_quality
[0m16:38:35.900027 [debug] [Thread-4 (]: Began compiling node test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4
[0m16:38:35.900424 [debug] [Thread-3 (]: Began executing node test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a
[0m16:38:35.902222 [debug] [Thread-1 (]: Writing injected SQL for node "test.fao_elt_pipeline.test_data_quality"
[0m16:38:35.905583 [debug] [Thread-4 (]: Writing injected SQL for node "test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4"
[0m16:38:35.905914 [debug] [Thread-2 (]: On test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd: Close
[0m16:38:35.907326 [debug] [Thread-3 (]: Writing runtime sql for node "test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a"
[0m16:38:35.907943 [info ] [Thread-2 (]: 17 of 23 PASS not_null_silver_top_countries_area_code .......................... [[32mPASS[0m in 0.04s]
[0m16:38:35.908476 [debug] [Thread-2 (]: Finished running node test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd
[0m16:38:35.908824 [debug] [Thread-4 (]: Began executing node test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4
[0m16:38:35.909197 [debug] [Thread-3 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a"
[0m16:38:35.909511 [debug] [Thread-1 (]: Began executing node test.fao_elt_pipeline.test_data_quality
[0m16:38:35.909838 [debug] [Thread-2 (]: Began running node test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1
[0m16:38:35.911389 [debug] [Thread-4 (]: Writing runtime sql for node "test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4"
[0m16:38:35.911773 [debug] [Thread-3 (]: On test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a: BEGIN
[0m16:38:35.913189 [debug] [Thread-1 (]: Writing runtime sql for node "test.fao_elt_pipeline.test_data_quality"
[0m16:38:35.913537 [info ] [Thread-2 (]: 21 of 23 START test unique_gold_regional_summary_region ........................ [RUN]
[0m16:38:35.913928 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:38:35.914355 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd, now test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1)
[0m16:38:35.914709 [debug] [Thread-4 (]: Using postgres connection "test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4"
[0m16:38:35.915132 [debug] [Thread-2 (]: Began compiling node test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1
[0m16:38:35.915496 [debug] [Thread-1 (]: Using postgres connection "test.fao_elt_pipeline.test_data_quality"
[0m16:38:35.915824 [debug] [Thread-4 (]: On test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4: BEGIN
[0m16:38:35.918014 [debug] [Thread-2 (]: Writing injected SQL for node "test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1"
[0m16:38:35.918421 [debug] [Thread-1 (]: On test.fao_elt_pipeline.test_data_quality: BEGIN
[0m16:38:35.918782 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:38:35.919174 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:38:35.919657 [debug] [Thread-2 (]: Began executing node test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1
[0m16:38:35.921943 [debug] [Thread-2 (]: Writing runtime sql for node "test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1"
[0m16:38:35.922705 [debug] [Thread-2 (]: Using postgres connection "test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1"
[0m16:38:35.923059 [debug] [Thread-3 (]: SQL status: BEGIN in 0.009 seconds
[0m16:38:35.923395 [debug] [Thread-2 (]: On test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1: BEGIN
[0m16:38:35.923715 [debug] [Thread-3 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a"
[0m16:38:35.924025 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:38:35.924353 [debug] [Thread-3 (]: On test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select country_name
from "fao"."public_silver"."silver_top_countries"
where country_name is null



  
  
      
    ) dbt_internal_test
[0m16:38:35.927902 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m16:38:35.929040 [debug] [Thread-3 (]: On test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a: ROLLBACK
[0m16:38:35.929408 [debug] [Thread-4 (]: SQL status: BEGIN in 0.011 seconds
[0m16:38:35.929737 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m16:38:35.930106 [debug] [Thread-4 (]: Using postgres connection "test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4"
[0m16:38:35.930415 [debug] [Thread-3 (]: On test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a: Close
[0m16:38:35.930735 [debug] [Thread-1 (]: Using postgres connection "test.fao_elt_pipeline.test_data_quality"
[0m16:38:35.931090 [debug] [Thread-4 (]: On test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    country_name as unique_field,
    count(*) as n_records

from "fao"."public_gold"."gold_country_metrics"
where country_name is not null
group by country_name
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:38:35.931613 [info ] [Thread-3 (]: 18 of 23 PASS not_null_silver_top_countries_country_name ....................... [[32mPASS[0m in 0.04s]
[0m16:38:35.932060 [debug] [Thread-1 (]: On test.fao_elt_pipeline.test_data_quality: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.test_data_quality"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Test to ensure we have data for major countries
-- This test will fail if we don't have data for these important agricultural producers

SELECT country_name
FROM (
    VALUES
        ('China'),
        ('India'),
        ('USA'),
        ('Brazil'),
        ('Germany')
) AS required_countries(country_name)
WHERE country_name NOT IN (
    SELECT DISTINCT country_name_standardized
    FROM "fao"."public_silver"."silver_production_cleaned"
)
  
  
      
    ) dbt_internal_test
[0m16:38:35.932592 [debug] [Thread-3 (]: Finished running node test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a
[0m16:38:35.933039 [debug] [Thread-2 (]: SQL status: BEGIN in 0.009 seconds
[0m16:38:35.933412 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:38:35.933848 [debug] [Thread-3 (]: Began running node test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31
[0m16:38:35.934228 [debug] [Thread-2 (]: Using postgres connection "test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1"
[0m16:38:35.934610 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:38:35.935515 [debug] [Thread-4 (]: On test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4: ROLLBACK
[0m16:38:35.935890 [info ] [Thread-3 (]: 22 of 23 START test unique_silver_prices_cleaned_price_id ...................... [RUN]
[0m16:38:35.936268 [debug] [Thread-2 (]: On test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    region as unique_field,
    count(*) as n_records

from "fao"."public_gold"."gold_regional_summary"
where region is not null
group by region
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:38:35.937094 [debug] [Thread-1 (]: On test.fao_elt_pipeline.test_data_quality: ROLLBACK
[0m16:38:35.937498 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a, now test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31)
[0m16:38:35.937885 [debug] [Thread-3 (]: Began compiling node test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31
[0m16:38:35.940377 [debug] [Thread-3 (]: Writing injected SQL for node "test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31"
[0m16:38:35.940748 [debug] [Thread-4 (]: On test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4: Close
[0m16:38:35.941067 [debug] [Thread-1 (]: On test.fao_elt_pipeline.test_data_quality: Close
[0m16:38:35.941427 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.004 seconds
[0m16:38:35.941889 [info ] [Thread-4 (]: 20 of 23 PASS unique_gold_country_metrics_country_name ......................... [[32mPASS[0m in 0.04s]
[0m16:38:35.942297 [debug] [Thread-3 (]: Began executing node test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31
[0m16:38:35.942744 [warn ] [Thread-1 (]: 19 of 23 WARN 5 test_data_quality .............................................. [[33mWARN 5[0m in 0.04s]
[0m16:38:35.943654 [debug] [Thread-2 (]: On test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1: ROLLBACK
[0m16:38:35.944116 [debug] [Thread-4 (]: Finished running node test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4
[0m16:38:35.945564 [debug] [Thread-3 (]: Writing runtime sql for node "test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31"
[0m16:38:35.945994 [debug] [Thread-1 (]: Finished running node test.fao_elt_pipeline.test_data_quality
[0m16:38:35.946373 [debug] [Thread-4 (]: Began running node test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048
[0m16:38:35.946739 [debug] [Thread-2 (]: On test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1: Close
[0m16:38:35.947180 [info ] [Thread-4 (]: 23 of 23 START test unique_silver_production_cleaned_production_id ............. [RUN]
[0m16:38:35.947668 [info ] [Thread-2 (]: 21 of 23 PASS unique_gold_regional_summary_region .............................. [[32mPASS[0m in 0.03s]
[0m16:38:35.948050 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4, now test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048)
[0m16:38:35.948466 [debug] [Thread-2 (]: Finished running node test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1
[0m16:38:35.948811 [debug] [Thread-3 (]: Using postgres connection "test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31"
[0m16:38:35.949134 [debug] [Thread-4 (]: Began compiling node test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048
[0m16:38:35.949529 [debug] [Thread-3 (]: On test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31: BEGIN
[0m16:38:35.951763 [debug] [Thread-4 (]: Writing injected SQL for node "test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048"
[0m16:38:35.952149 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:38:35.952665 [debug] [Thread-4 (]: Began executing node test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048
[0m16:38:35.954200 [debug] [Thread-4 (]: Writing runtime sql for node "test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048"
[0m16:38:35.954789 [debug] [Thread-4 (]: Using postgres connection "test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048"
[0m16:38:35.955126 [debug] [Thread-4 (]: On test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048: BEGIN
[0m16:38:35.955434 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:38:35.958960 [debug] [Thread-3 (]: SQL status: BEGIN in 0.007 seconds
[0m16:38:35.959362 [debug] [Thread-3 (]: Using postgres connection "test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31"
[0m16:38:35.959713 [debug] [Thread-3 (]: On test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    price_id as unique_field,
    count(*) as n_records

from "fao"."public_silver"."silver_prices_cleaned"
where price_id is not null
group by price_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:38:35.960930 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:38:35.961931 [debug] [Thread-3 (]: On test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31: ROLLBACK
[0m16:38:35.962559 [debug] [Thread-3 (]: On test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31: Close
[0m16:38:35.962920 [debug] [Thread-4 (]: SQL status: BEGIN in 0.007 seconds
[0m16:38:35.963679 [debug] [Thread-4 (]: Using postgres connection "test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048"
[0m16:38:35.963423 [info ] [Thread-3 (]: 22 of 23 PASS unique_silver_prices_cleaned_price_id ............................ [[32mPASS[0m in 0.03s]
[0m16:38:35.964179 [debug] [Thread-4 (]: On test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    production_id as unique_field,
    count(*) as n_records

from "fao"."public_silver"."silver_production_cleaned"
where production_id is not null
group by production_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:38:35.964634 [debug] [Thread-3 (]: Finished running node test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31
[0m16:38:35.965809 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:38:35.966688 [debug] [Thread-4 (]: On test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048: ROLLBACK
[0m16:38:35.967341 [debug] [Thread-4 (]: On test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048: Close
[0m16:38:35.967832 [info ] [Thread-4 (]: 23 of 23 PASS unique_silver_production_cleaned_production_id ................... [[32mPASS[0m in 0.02s]
[0m16:38:35.968291 [debug] [Thread-4 (]: Finished running node test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048
[0m16:38:35.969282 [debug] [MainThread]: Using postgres connection "master"
[0m16:38:35.969586 [debug] [MainThread]: On master: BEGIN
[0m16:38:35.969853 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:38:35.979429 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m16:38:35.979833 [debug] [MainThread]: On master: COMMIT
[0m16:38:35.980127 [debug] [MainThread]: Using postgres connection "master"
[0m16:38:35.980401 [debug] [MainThread]: On master: COMMIT
[0m16:38:35.981034 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:38:35.981436 [debug] [MainThread]: On master: Close
[0m16:38:35.981802 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:38:35.982108 [debug] [MainThread]: Connection 'test.fao_elt_pipeline.test_data_quality' was properly closed.
[0m16:38:35.982393 [debug] [MainThread]: Connection 'test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1' was properly closed.
[0m16:38:35.982669 [debug] [MainThread]: Connection 'test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31' was properly closed.
[0m16:38:35.982934 [debug] [MainThread]: Connection 'test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048' was properly closed.
[0m16:38:35.983250 [info ] [MainThread]: 
[0m16:38:35.983563 [info ] [MainThread]: Finished running 23 data tests in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m16:38:35.985442 [debug] [MainThread]: Command end result
[0m16:38:36.001965 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/michaelmalotte/code/personal/fao-elt-pipelines/dbt_project/target/manifest.json
[0m16:38:36.003170 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/michaelmalotte/code/personal/fao-elt-pipelines/dbt_project/target/semantic_manifest.json
[0m16:38:36.007910 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/michaelmalotte/code/personal/fao-elt-pipelines/dbt_project/target/run_results.json
[0m16:38:36.008252 [info ] [MainThread]: 
[0m16:38:36.008591 [info ] [MainThread]: [33mCompleted with 1 warning:[0m
[0m16:38:36.008892 [info ] [MainThread]: 
[0m16:38:36.009238 [warn ] [MainThread]: [33mWarning in test test_data_quality (tests/test_data_quality.sql)[0m
[0m16:38:36.009558 [warn ] [MainThread]: Got 5 results, configured to warn if != 0
[0m16:38:36.009825 [info ] [MainThread]: 
[0m16:38:36.010133 [info ] [MainThread]:   compiled code at target/compiled/fao_elt_pipeline/tests/test_data_quality.sql
[0m16:38:36.010440 [info ] [MainThread]: 
[0m16:38:36.010747 [info ] [MainThread]: Done. PASS=22 WARN=1 ERROR=0 SKIP=0 NO-OP=0 TOTAL=23
[0m16:38:36.012599 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.0373694, "process_in_blocks": "0", "process_kernel_time": 0.168178, "process_mem_max_rss": "141459456", "process_out_blocks": "0", "process_user_time": 1.597684}
[0m16:38:36.012963 [debug] [MainThread]: Command `dbt test` succeeded at 16:38:36.012917 after 1.04 seconds
[0m16:38:36.013295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106628bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fcbc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109116350>]}
[0m16:38:36.013622 [debug] [MainThread]: Flushing usage events
[0m16:38:36.336780 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:38:37.357300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106868c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c55480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c54d60>]}


============================== 16:38:37.359846 | 7e30e60a-df75-48f3-ae1d-fcb3115c4e84 ==============================
[0m16:38:37.359846 [info ] [MainThread]: Running with dbt=1.10.4
[0m16:38:37.360297 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/michaelmalotte/code/personal/fao-elt-pipelines/dbt_project/logs', 'profiles_dir': '/Users/michaelmalotte/code/personal/fao-elt-pipelines/dbt_project', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt docs generate --target dev', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:38:37.468809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7e30e60a-df75-48f3-ae1d-fcb3115c4e84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100f69b0>]}
[0m16:38:37.512739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7e30e60a-df75-48f3-ae1d-fcb3115c4e84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101fbf10>]}
[0m16:38:37.513469 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:38:37.577406 [debug] [MainThread]: checksum: 23bc95a42434187059b2384bcd89d8aac150f1bd09bd2e89bfeb67b518f50b75, vars: {}, profile: , target: dev, version: 1.10.4
[0m16:38:37.664574 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:38:37.665021 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:38:37.668736 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.fao_elt_pipeline.bronze
[0m16:38:37.699208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7e30e60a-df75-48f3-ae1d-fcb3115c4e84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f0cd60>]}
[0m16:38:37.709266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7e30e60a-df75-48f3-ae1d-fcb3115c4e84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110bca1a0>]}
[0m16:38:37.709725 [info ] [MainThread]: Found 6 models, 23 data tests, 2 sources, 435 macros
[0m16:38:37.710056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e30e60a-df75-48f3-ae1d-fcb3115c4e84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102a73a0>]}
[0m16:38:37.711397 [info ] [MainThread]: 
[0m16:38:37.711718 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:38:37.712000 [info ] [MainThread]: 
[0m16:38:37.712394 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:38:37.715431 [debug] [ThreadPool]: Acquiring new postgres connection 'list_fao_public_silver'
[0m16:38:37.746493 [debug] [ThreadPool]: Acquiring new postgres connection 'list_fao_public_gold'
[0m16:38:37.773778 [debug] [ThreadPool]: Using postgres connection "list_fao_public_silver"
[0m16:38:37.774322 [debug] [ThreadPool]: Using postgres connection "list_fao_public_gold"
[0m16:38:37.774721 [debug] [ThreadPool]: On list_fao_public_silver: BEGIN
[0m16:38:37.775029 [debug] [ThreadPool]: On list_fao_public_gold: BEGIN
[0m16:38:37.775320 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:38:37.775597 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:38:37.805220 [debug] [ThreadPool]: SQL status: BEGIN in 0.030 seconds
[0m16:38:37.805698 [debug] [ThreadPool]: SQL status: BEGIN in 0.030 seconds
[0m16:38:37.806174 [debug] [ThreadPool]: Using postgres connection "list_fao_public_gold"
[0m16:38:37.806535 [debug] [ThreadPool]: Using postgres connection "list_fao_public_silver"
[0m16:38:37.806855 [debug] [ThreadPool]: On list_fao_public_gold: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "connection_name": "list_fao_public_gold"} */
select
      'fao' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'fao' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'fao' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m16:38:37.807209 [debug] [ThreadPool]: On list_fao_public_silver: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "connection_name": "list_fao_public_silver"} */
select
      'fao' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'fao' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'fao' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m16:38:37.809418 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m16:38:37.809799 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m16:38:37.810694 [debug] [ThreadPool]: On list_fao_public_silver: ROLLBACK
[0m16:38:37.811423 [debug] [ThreadPool]: On list_fao_public_gold: ROLLBACK
[0m16:38:37.812064 [debug] [ThreadPool]: On list_fao_public_gold: Close
[0m16:38:37.812416 [debug] [ThreadPool]: On list_fao_public_silver: Close
[0m16:38:37.816030 [debug] [MainThread]: Using postgres connection "master"
[0m16:38:37.816444 [debug] [MainThread]: On master: BEGIN
[0m16:38:37.816739 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:38:37.824086 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m16:38:37.824478 [debug] [MainThread]: Using postgres connection "master"
[0m16:38:37.824849 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:38:37.828185 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m16:38:37.829174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e30e60a-df75-48f3-ae1d-fcb3115c4e84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ef6530>]}
[0m16:38:37.829624 [debug] [MainThread]: On master: ROLLBACK
[0m16:38:37.830480 [debug] [MainThread]: On master: Close
[0m16:38:37.831964 [debug] [Thread-1 (]: Began running node model.fao_elt_pipeline.silver_prices_cleaned
[0m16:38:37.832333 [debug] [Thread-2 (]: Began running node model.fao_elt_pipeline.silver_production_cleaned
[0m16:38:37.832701 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_fao_public_silver, now model.fao_elt_pipeline.silver_prices_cleaned)
[0m16:38:37.833062 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_fao_public_gold, now model.fao_elt_pipeline.silver_production_cleaned)
[0m16:38:37.833400 [debug] [Thread-1 (]: Began compiling node model.fao_elt_pipeline.silver_prices_cleaned
[0m16:38:37.833758 [debug] [Thread-2 (]: Began compiling node model.fao_elt_pipeline.silver_production_cleaned
[0m16:38:37.840852 [debug] [Thread-1 (]: Writing injected SQL for node "model.fao_elt_pipeline.silver_prices_cleaned"
[0m16:38:37.843533 [debug] [Thread-2 (]: Writing injected SQL for node "model.fao_elt_pipeline.silver_production_cleaned"
[0m16:38:37.844209 [debug] [Thread-1 (]: Began executing node model.fao_elt_pipeline.silver_prices_cleaned
[0m16:38:37.844724 [debug] [Thread-1 (]: Finished running node model.fao_elt_pipeline.silver_prices_cleaned
[0m16:38:37.845118 [debug] [Thread-2 (]: Began executing node model.fao_elt_pipeline.silver_production_cleaned
[0m16:38:37.845561 [debug] [Thread-2 (]: Finished running node model.fao_elt_pipeline.silver_production_cleaned
[0m16:38:37.846180 [debug] [Thread-4 (]: Began running node model.fao_elt_pipeline.gold_country_metrics
[0m16:38:37.846577 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.fao_elt_pipeline.gold_country_metrics'
[0m16:38:37.846970 [debug] [Thread-4 (]: Began compiling node model.fao_elt_pipeline.gold_country_metrics
[0m16:38:37.849183 [debug] [Thread-4 (]: Writing injected SQL for node "model.fao_elt_pipeline.gold_country_metrics"
[0m16:38:37.849595 [debug] [Thread-3 (]: Began running node model.fao_elt_pipeline.gold_price_production_analysis
[0m16:38:37.849964 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.fao_elt_pipeline.gold_price_production_analysis'
[0m16:38:37.850273 [debug] [Thread-3 (]: Began compiling node model.fao_elt_pipeline.gold_price_production_analysis
[0m16:38:37.852236 [debug] [Thread-3 (]: Writing injected SQL for node "model.fao_elt_pipeline.gold_price_production_analysis"
[0m16:38:37.852613 [debug] [Thread-1 (]: Began running node model.fao_elt_pipeline.gold_regional_summary
[0m16:38:37.853045 [debug] [Thread-2 (]: Began running node model.fao_elt_pipeline.silver_top_countries
[0m16:38:37.853472 [debug] [Thread-4 (]: Began executing node model.fao_elt_pipeline.gold_country_metrics
[0m16:38:37.853867 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fao_elt_pipeline.silver_prices_cleaned, now model.fao_elt_pipeline.gold_regional_summary)
[0m16:38:37.854260 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.fao_elt_pipeline.silver_production_cleaned, now model.fao_elt_pipeline.silver_top_countries)
[0m16:38:37.854739 [debug] [Thread-4 (]: Finished running node model.fao_elt_pipeline.gold_country_metrics
[0m16:38:37.855136 [debug] [Thread-3 (]: Began executing node model.fao_elt_pipeline.gold_price_production_analysis
[0m16:38:37.855531 [debug] [Thread-1 (]: Began compiling node model.fao_elt_pipeline.gold_regional_summary
[0m16:38:37.855856 [debug] [Thread-2 (]: Began compiling node model.fao_elt_pipeline.silver_top_countries
[0m16:38:37.856201 [debug] [Thread-4 (]: Began running node test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff
[0m16:38:37.856871 [debug] [Thread-3 (]: Finished running node model.fao_elt_pipeline.gold_price_production_analysis
[0m16:38:37.859448 [debug] [Thread-1 (]: Writing injected SQL for node "model.fao_elt_pipeline.gold_regional_summary"
[0m16:38:37.861330 [debug] [Thread-2 (]: Writing injected SQL for node "model.fao_elt_pipeline.silver_top_countries"
[0m16:38:37.861707 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.fao_elt_pipeline.gold_country_metrics, now test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff)
[0m16:38:37.862068 [debug] [Thread-3 (]: Began running node test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f
[0m16:38:37.862641 [debug] [Thread-4 (]: Began compiling node test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff
[0m16:38:37.863041 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.fao_elt_pipeline.gold_price_production_analysis, now test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f)
[0m16:38:37.863427 [debug] [Thread-1 (]: Began executing node model.fao_elt_pipeline.gold_regional_summary
[0m16:38:37.863797 [debug] [Thread-2 (]: Began executing node model.fao_elt_pipeline.silver_top_countries
[0m16:38:37.869577 [debug] [Thread-4 (]: Writing injected SQL for node "test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff"
[0m16:38:37.870036 [debug] [Thread-3 (]: Began compiling node test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f
[0m16:38:37.870658 [debug] [Thread-1 (]: Finished running node model.fao_elt_pipeline.gold_regional_summary
[0m16:38:37.871196 [debug] [Thread-2 (]: Finished running node model.fao_elt_pipeline.silver_top_countries
[0m16:38:37.874394 [debug] [Thread-3 (]: Writing injected SQL for node "test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f"
[0m16:38:37.874912 [debug] [Thread-1 (]: Began running node test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5
[0m16:38:37.875350 [debug] [Thread-4 (]: Began executing node test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff
[0m16:38:37.875775 [debug] [Thread-2 (]: Began running node test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df
[0m16:38:37.876295 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fao_elt_pipeline.gold_regional_summary, now test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5)
[0m16:38:37.876839 [debug] [Thread-4 (]: Finished running node test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff
[0m16:38:37.877209 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.fao_elt_pipeline.silver_top_countries, now test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df)
[0m16:38:37.877552 [debug] [Thread-1 (]: Began compiling node test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5
[0m16:38:37.877872 [debug] [Thread-3 (]: Began executing node test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f
[0m16:38:37.878227 [debug] [Thread-4 (]: Began running node test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b
[0m16:38:37.878579 [debug] [Thread-2 (]: Began compiling node test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df
[0m16:38:37.883201 [debug] [Thread-1 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5"
[0m16:38:37.883745 [debug] [Thread-3 (]: Finished running node test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f
[0m16:38:37.884090 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff, now test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b)
[0m16:38:37.886445 [debug] [Thread-2 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df"
[0m16:38:37.887144 [debug] [Thread-3 (]: Began running node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74
[0m16:38:37.887677 [debug] [Thread-1 (]: Began executing node test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5
[0m16:38:37.888075 [debug] [Thread-4 (]: Began compiling node test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b
[0m16:38:37.888546 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f, now test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74)
[0m16:38:37.889049 [debug] [Thread-1 (]: Finished running node test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5
[0m16:38:37.891514 [debug] [Thread-4 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b"
[0m16:38:37.891882 [debug] [Thread-2 (]: Began executing node test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df
[0m16:38:37.892216 [debug] [Thread-3 (]: Began compiling node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74
[0m16:38:37.892589 [debug] [Thread-1 (]: Began running node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d
[0m16:38:37.893140 [debug] [Thread-2 (]: Finished running node test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df
[0m16:38:37.895377 [debug] [Thread-3 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74"
[0m16:38:37.895858 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5, now test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d)
[0m16:38:37.896260 [debug] [Thread-2 (]: Began running node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df
[0m16:38:37.896648 [debug] [Thread-4 (]: Began executing node test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b
[0m16:38:37.897026 [debug] [Thread-1 (]: Began compiling node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d
[0m16:38:37.897398 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df, now test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df)
[0m16:38:37.897991 [debug] [Thread-4 (]: Finished running node test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b
[0m16:38:37.900152 [debug] [Thread-1 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d"
[0m16:38:37.900495 [debug] [Thread-3 (]: Began executing node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74
[0m16:38:37.900842 [debug] [Thread-2 (]: Began compiling node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df
[0m16:38:37.901190 [debug] [Thread-4 (]: Began running node test.fao_elt_pipeline.test_data_quality
[0m16:38:37.901750 [debug] [Thread-3 (]: Finished running node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74
[0m16:38:37.904019 [debug] [Thread-2 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df"
[0m16:38:37.904420 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b, now test.fao_elt_pipeline.test_data_quality)
[0m16:38:37.904762 [debug] [Thread-1 (]: Began executing node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d
[0m16:38:37.905208 [debug] [Thread-3 (]: Began running node test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31
[0m16:38:37.905706 [debug] [Thread-4 (]: Began compiling node test.fao_elt_pipeline.test_data_quality
[0m16:38:37.906266 [debug] [Thread-1 (]: Finished running node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d
[0m16:38:37.906639 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74, now test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31)
[0m16:38:37.909339 [debug] [Thread-4 (]: Writing injected SQL for node "test.fao_elt_pipeline.test_data_quality"
[0m16:38:37.909686 [debug] [Thread-2 (]: Began executing node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df
[0m16:38:37.910038 [debug] [Thread-1 (]: Began running node test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048
[0m16:38:37.910363 [debug] [Thread-3 (]: Began compiling node test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31
[0m16:38:37.910944 [debug] [Thread-2 (]: Finished running node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df
[0m16:38:37.911312 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d, now test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048)
[0m16:38:37.914621 [debug] [Thread-3 (]: Writing injected SQL for node "test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31"
[0m16:38:37.914984 [debug] [Thread-4 (]: Began executing node test.fao_elt_pipeline.test_data_quality
[0m16:38:37.915324 [debug] [Thread-2 (]: Began running node test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee
[0m16:38:37.915657 [debug] [Thread-1 (]: Began compiling node test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048
[0m16:38:37.916207 [debug] [Thread-4 (]: Finished running node test.fao_elt_pipeline.test_data_quality
[0m16:38:37.916549 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df, now test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee)
[0m16:38:37.916930 [debug] [Thread-3 (]: Began executing node test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31
[0m16:38:37.919028 [debug] [Thread-1 (]: Writing injected SQL for node "test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048"
[0m16:38:37.919434 [debug] [Thread-4 (]: Began running node test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd
[0m16:38:37.919822 [debug] [Thread-2 (]: Began compiling node test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee
[0m16:38:37.920351 [debug] [Thread-3 (]: Finished running node test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31
[0m16:38:37.920797 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.test_data_quality, now test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd)
[0m16:38:37.924047 [debug] [Thread-2 (]: Writing injected SQL for node "test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee"
[0m16:38:37.924471 [debug] [Thread-3 (]: Began running node test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c
[0m16:38:37.924832 [debug] [Thread-1 (]: Began executing node test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048
[0m16:38:37.925191 [debug] [Thread-4 (]: Began compiling node test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd
[0m16:38:37.925591 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31, now test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c)
[0m16:38:37.926081 [debug] [Thread-1 (]: Finished running node test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048
[0m16:38:37.929147 [debug] [Thread-4 (]: Writing injected SQL for node "test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd"
[0m16:38:37.929515 [debug] [Thread-2 (]: Began executing node test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee
[0m16:38:37.929847 [debug] [Thread-3 (]: Began compiling node test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c
[0m16:38:37.930195 [debug] [Thread-1 (]: Began running node test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4
[0m16:38:37.930741 [debug] [Thread-2 (]: Finished running node test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee
[0m16:38:37.932795 [debug] [Thread-3 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c"
[0m16:38:37.933189 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048, now test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4)
[0m16:38:37.933563 [debug] [Thread-2 (]: Began running node test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53
[0m16:38:37.933894 [debug] [Thread-4 (]: Began executing node test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd
[0m16:38:37.934274 [debug] [Thread-1 (]: Began compiling node test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4
[0m16:38:37.934637 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee, now test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53)
[0m16:38:37.934957 [debug] [Thread-3 (]: Began executing node test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c
[0m16:38:37.935422 [debug] [Thread-4 (]: Finished running node test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd
[0m16:38:37.937778 [debug] [Thread-1 (]: Writing injected SQL for node "test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4"
[0m16:38:37.938211 [debug] [Thread-2 (]: Began compiling node test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53
[0m16:38:37.938904 [debug] [Thread-3 (]: Finished running node test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c
[0m16:38:37.939380 [debug] [Thread-4 (]: Began running node test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69
[0m16:38:37.943938 [debug] [Thread-2 (]: Writing injected SQL for node "test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53"
[0m16:38:37.944444 [debug] [Thread-3 (]: Began running node test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b
[0m16:38:37.944895 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd, now test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69)
[0m16:38:37.945232 [debug] [Thread-1 (]: Began executing node test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4
[0m16:38:37.945617 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c, now test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b)
[0m16:38:37.945981 [debug] [Thread-4 (]: Began compiling node test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69
[0m16:38:37.946326 [debug] [Thread-2 (]: Began executing node test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53
[0m16:38:37.946848 [debug] [Thread-1 (]: Finished running node test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4
[0m16:38:37.947170 [debug] [Thread-3 (]: Began compiling node test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b
[0m16:38:37.950318 [debug] [Thread-4 (]: Writing injected SQL for node "test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69"
[0m16:38:37.950861 [debug] [Thread-2 (]: Finished running node test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53
[0m16:38:37.951233 [debug] [Thread-1 (]: Began running node test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6
[0m16:38:37.953442 [debug] [Thread-3 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b"
[0m16:38:37.953984 [debug] [Thread-2 (]: Began running node test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7
[0m16:38:37.954475 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4, now test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6)
[0m16:38:37.954901 [debug] [Thread-4 (]: Began executing node test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69
[0m16:38:37.955253 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53, now test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7)
[0m16:38:37.955645 [debug] [Thread-1 (]: Began compiling node test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6
[0m16:38:37.955969 [debug] [Thread-3 (]: Began executing node test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b
[0m16:38:37.956472 [debug] [Thread-4 (]: Finished running node test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69
[0m16:38:37.956797 [debug] [Thread-2 (]: Began compiling node test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7
[0m16:38:37.959903 [debug] [Thread-1 (]: Writing injected SQL for node "test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6"
[0m16:38:37.960417 [debug] [Thread-3 (]: Finished running node test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b
[0m16:38:37.960769 [debug] [Thread-4 (]: Began running node test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1
[0m16:38:37.962849 [debug] [Thread-2 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7"
[0m16:38:37.963269 [debug] [Thread-3 (]: Began running node test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd
[0m16:38:37.963653 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69, now test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1)
[0m16:38:37.964053 [debug] [Thread-1 (]: Began executing node test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6
[0m16:38:37.964418 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b, now test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd)
[0m16:38:37.964812 [debug] [Thread-4 (]: Began compiling node test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1
[0m16:38:37.965289 [debug] [Thread-1 (]: Finished running node test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6
[0m16:38:37.965613 [debug] [Thread-2 (]: Began executing node test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7
[0m16:38:37.965933 [debug] [Thread-3 (]: Began compiling node test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd
[0m16:38:37.968098 [debug] [Thread-4 (]: Writing injected SQL for node "test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1"
[0m16:38:37.968478 [debug] [Thread-1 (]: Began running node test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a
[0m16:38:37.968961 [debug] [Thread-2 (]: Finished running node test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7
[0m16:38:37.971374 [debug] [Thread-3 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd"
[0m16:38:37.971990 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6, now test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a)
[0m16:38:37.972546 [debug] [Thread-4 (]: Began executing node test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1
[0m16:38:37.972922 [debug] [Thread-1 (]: Began compiling node test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a
[0m16:38:37.973450 [debug] [Thread-4 (]: Finished running node test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1
[0m16:38:37.973794 [debug] [Thread-3 (]: Began executing node test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd
[0m16:38:37.976873 [debug] [Thread-1 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a"
[0m16:38:37.977463 [debug] [Thread-3 (]: Finished running node test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd
[0m16:38:37.977931 [debug] [Thread-1 (]: Began executing node test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a
[0m16:38:37.978383 [debug] [Thread-1 (]: Finished running node test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a
[0m16:38:37.978990 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:38:37.979279 [debug] [MainThread]: Connection 'test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a' was properly closed.
[0m16:38:37.979534 [debug] [MainThread]: Connection 'test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7' was properly closed.
[0m16:38:37.979788 [debug] [MainThread]: Connection 'test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1' was properly closed.
[0m16:38:37.980045 [debug] [MainThread]: Connection 'test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd' was properly closed.
[0m16:38:37.981956 [debug] [MainThread]: Command end result
[0m16:38:38.047842 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/michaelmalotte/code/personal/fao-elt-pipelines/dbt_project/target/manifest.json
[0m16:38:38.049155 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/michaelmalotte/code/personal/fao-elt-pipelines/dbt_project/target/semantic_manifest.json
[0m16:38:38.053969 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/michaelmalotte/code/personal/fao-elt-pipelines/dbt_project/target/run_results.json
[0m16:38:38.055903 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m16:38:38.056259 [info ] [MainThread]: Building catalog
[0m16:38:38.061954 [debug] [ThreadPool]: Acquiring new postgres connection 'fao.information_schema'
[0m16:38:38.066000 [debug] [ThreadPool]: Using postgres connection "fao.information_schema"
[0m16:38:38.066320 [debug] [ThreadPool]: On fao.information_schema: BEGIN
[0m16:38:38.066594 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:38:38.080107 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m16:38:38.080514 [debug] [ThreadPool]: Using postgres connection "fao.information_schema"
[0m16:38:38.080939 [debug] [ThreadPool]: On fao.information_schema: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "connection_name": "fao.information_schema"} */

    
    

    select
        'fao' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public_gold') and
           upper(tbl.relname) = upper('gold_regional_summary')) or (upper(sch.nspname) = upper('bronze') and
           upper(tbl.relname) = upper('raw_prices')) or (upper(sch.nspname) = upper('public_silver') and
           upper(tbl.relname) = upper('silver_top_countries')) or (upper(sch.nspname) = upper('public_silver') and
           upper(tbl.relname) = upper('silver_production_cleaned')) or (upper(sch.nspname) = upper('public_gold') and
           upper(tbl.relname) = upper('gold_price_production_analysis')) or (upper(sch.nspname) = upper('bronze') and
           upper(tbl.relname) = upper('raw_food_balance')) or (upper(sch.nspname) = upper('public_gold') and
           upper(tbl.relname) = upper('gold_country_metrics')) or (upper(sch.nspname) = upper('public_silver') and
           upper(tbl.relname) = upper('silver_prices_cleaned')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m16:38:38.084037 [debug] [ThreadPool]: SQL status: SELECT 111 in 0.003 seconds
[0m16:38:38.087474 [debug] [ThreadPool]: On fao.information_schema: ROLLBACK
[0m16:38:38.089632 [debug] [ThreadPool]: On fao.information_schema: Close
[0m16:38:38.098975 [debug] [MainThread]: Wrote artifact CatalogArtifact to /Users/michaelmalotte/code/personal/fao-elt-pipelines/dbt_project/target/catalog.json
[0m16:38:38.114707 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/michaelmalotte/code/personal/fao-elt-pipelines/dbt_project/target/manifest.json
[0m16:38:38.115768 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/michaelmalotte/code/personal/fao-elt-pipelines/dbt_project/target/semantic_manifest.json
[0m16:38:38.116083 [info ] [MainThread]: Catalog written to /Users/michaelmalotte/code/personal/fao-elt-pipelines/dbt_project/target/catalog.json
[0m16:38:38.117957 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 0.8094405, "process_in_blocks": "0", "process_kernel_time": 0.149705, "process_mem_max_rss": "140066816", "process_out_blocks": "0", "process_user_time": 1.395687}
[0m16:38:38.118341 [debug] [MainThread]: Command `dbt docs generate` succeeded at 16:38:38.118295 after 0.81 seconds
[0m16:38:38.118649 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m16:38:38.118919 [debug] [MainThread]: Connection 'fao.information_schema' was properly closed.
[0m16:38:38.119285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106868c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bac880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e86530>]}
[0m16:38:38.119669 [debug] [MainThread]: Flushing usage events
[0m16:38:38.446572 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:40:53.687839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cd8bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e5e6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e5dfc0>]}


============================== 16:40:53.690278 | c81016ac-ea22-4b94-9572-61b597b568ab ==============================
[0m16:40:53.690278 [info ] [MainThread]: Running with dbt=1.10.4
[0m16:40:53.690749 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/michaelmalotte/code/personal/fao-elt-pipelines/dbt_project', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/michaelmalotte/code/personal/fao-elt-pipelines/dbt_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt test --target dev', 'send_anonymous_usage_stats': 'True'}
[0m16:40:53.799707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c81016ac-ea22-4b94-9572-61b597b568ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102dd9420>]}
[0m16:40:53.840517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c81016ac-ea22-4b94-9572-61b597b568ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e35db0>]}
[0m16:40:53.841270 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:40:53.905190 [debug] [MainThread]: checksum: 23bc95a42434187059b2384bcd89d8aac150f1bd09bd2e89bfeb67b518f50b75, vars: {}, profile: , target: dev, version: 1.10.4
[0m16:40:53.985539 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:40:53.985924 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:40:53.989295 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.fao_elt_pipeline.bronze
[0m16:40:54.018935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c81016ac-ea22-4b94-9572-61b597b568ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10700cd00>]}
[0m16:40:54.107716 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/michaelmalotte/code/personal/fao-elt-pipelines/dbt_project/target/manifest.json
[0m16:40:54.108927 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/michaelmalotte/code/personal/fao-elt-pipelines/dbt_project/target/semantic_manifest.json
[0m16:40:54.120769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c81016ac-ea22-4b94-9572-61b597b568ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107016f20>]}
[0m16:40:54.121199 [info ] [MainThread]: Found 6 models, 23 data tests, 2 sources, 435 macros
[0m16:40:54.121529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c81016ac-ea22-4b94-9572-61b597b568ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107016d10>]}
[0m16:40:54.122979 [info ] [MainThread]: 
[0m16:40:54.123314 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:40:54.123604 [info ] [MainThread]: 
[0m16:40:54.124002 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:40:54.126428 [debug] [ThreadPool]: Acquiring new postgres connection 'list_fao_public_silver'
[0m16:40:54.133677 [debug] [ThreadPool]: Acquiring new postgres connection 'list_fao_public_gold'
[0m16:40:54.154496 [debug] [ThreadPool]: Using postgres connection "list_fao_public_silver"
[0m16:40:54.154900 [debug] [ThreadPool]: Using postgres connection "list_fao_public_gold"
[0m16:40:54.155208 [debug] [ThreadPool]: On list_fao_public_silver: BEGIN
[0m16:40:54.155503 [debug] [ThreadPool]: On list_fao_public_gold: BEGIN
[0m16:40:54.155780 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:40:54.156051 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:40:54.181617 [debug] [ThreadPool]: SQL status: BEGIN in 0.026 seconds
[0m16:40:54.181995 [debug] [ThreadPool]: SQL status: BEGIN in 0.026 seconds
[0m16:40:54.182302 [debug] [ThreadPool]: Using postgres connection "list_fao_public_silver"
[0m16:40:54.182620 [debug] [ThreadPool]: Using postgres connection "list_fao_public_gold"
[0m16:40:54.182942 [debug] [ThreadPool]: On list_fao_public_silver: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "connection_name": "list_fao_public_silver"} */
select
      'fao' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'fao' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'fao' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m16:40:54.183282 [debug] [ThreadPool]: On list_fao_public_gold: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "connection_name": "list_fao_public_gold"} */
select
      'fao' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'fao' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'fao' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m16:40:54.186220 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.003 seconds
[0m16:40:54.186557 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.003 seconds
[0m16:40:54.187457 [debug] [ThreadPool]: On list_fao_public_silver: ROLLBACK
[0m16:40:54.188149 [debug] [ThreadPool]: On list_fao_public_gold: ROLLBACK
[0m16:40:54.188857 [debug] [ThreadPool]: On list_fao_public_gold: Close
[0m16:40:54.189148 [debug] [ThreadPool]: On list_fao_public_silver: Close
[0m16:40:54.192723 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:54.193096 [debug] [MainThread]: On master: BEGIN
[0m16:40:54.193382 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:40:54.202584 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m16:40:54.202967 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:54.203349 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:40:54.206384 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m16:40:54.207232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c81016ac-ea22-4b94-9572-61b597b568ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107015090>]}
[0m16:40:54.207648 [debug] [MainThread]: On master: ROLLBACK
[0m16:40:54.208224 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:54.208526 [debug] [MainThread]: On master: BEGIN
[0m16:40:54.209283 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:40:54.209591 [debug] [MainThread]: On master: COMMIT
[0m16:40:54.209877 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:54.210167 [debug] [MainThread]: On master: COMMIT
[0m16:40:54.210707 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:40:54.211001 [debug] [MainThread]: On master: Close
[0m16:40:54.212653 [debug] [Thread-1 (]: Began running node test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee
[0m16:40:54.213039 [debug] [Thread-2 (]: Began running node test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd
[0m16:40:54.213406 [debug] [Thread-3 (]: Began running node test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53
[0m16:40:54.213733 [debug] [Thread-4 (]: Began running node test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69
[0m16:40:54.214075 [info ] [Thread-1 (]: 1 of 23 START test accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer  [RUN]
[0m16:40:54.214495 [info ] [Thread-2 (]: 2 of 23 START test accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable  [RUN]
[0m16:40:54.214888 [info ] [Thread-3 (]: 3 of 23 START test accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity  [RUN]
[0m16:40:54.215246 [info ] [Thread-4 (]: 4 of 23 START test accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product  [RUN]
[0m16:40:54.215635 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_fao_public_silver, now test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee)
[0m16:40:54.215983 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_fao_public_gold, now test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd)
[0m16:40:54.216376 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53'
[0m16:40:54.216759 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69'
[0m16:40:54.217096 [debug] [Thread-1 (]: Began compiling node test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee
[0m16:40:54.217425 [debug] [Thread-2 (]: Began compiling node test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd
[0m16:40:54.217750 [debug] [Thread-3 (]: Began compiling node test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53
[0m16:40:54.218067 [debug] [Thread-4 (]: Began compiling node test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69
[0m16:40:54.228483 [debug] [Thread-1 (]: Writing injected SQL for node "test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee"
[0m16:40:54.231745 [debug] [Thread-2 (]: Writing injected SQL for node "test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd"
[0m16:40:54.234544 [debug] [Thread-3 (]: Writing injected SQL for node "test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53"
[0m16:40:54.237804 [debug] [Thread-4 (]: Writing injected SQL for node "test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69"
[0m16:40:54.238572 [debug] [Thread-2 (]: Began executing node test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd
[0m16:40:54.248337 [debug] [Thread-2 (]: Writing runtime sql for node "test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd"
[0m16:40:54.248771 [debug] [Thread-1 (]: Began executing node test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee
[0m16:40:54.250205 [debug] [Thread-1 (]: Writing runtime sql for node "test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee"
[0m16:40:54.250612 [debug] [Thread-4 (]: Began executing node test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69
[0m16:40:54.251023 [debug] [Thread-3 (]: Began executing node test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53
[0m16:40:54.253017 [debug] [Thread-4 (]: Writing runtime sql for node "test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69"
[0m16:40:54.253444 [debug] [Thread-2 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd"
[0m16:40:54.254750 [debug] [Thread-3 (]: Writing runtime sql for node "test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53"
[0m16:40:54.255097 [debug] [Thread-1 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee"
[0m16:40:54.255500 [debug] [Thread-2 (]: On test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd: BEGIN
[0m16:40:54.255937 [debug] [Thread-4 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69"
[0m16:40:54.256305 [debug] [Thread-1 (]: On test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee: BEGIN
[0m16:40:54.256700 [debug] [Thread-3 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53"
[0m16:40:54.257018 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:40:54.257361 [debug] [Thread-4 (]: On test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69: BEGIN
[0m16:40:54.257683 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:40:54.258003 [debug] [Thread-3 (]: On test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53: BEGIN
[0m16:40:54.258405 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:40:54.258796 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:40:54.278258 [debug] [Thread-3 (]: SQL status: BEGIN in 0.019 seconds
[0m16:40:54.278806 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m16:40:54.279250 [debug] [Thread-2 (]: SQL status: BEGIN in 0.022 seconds
[0m16:40:54.279578 [debug] [Thread-4 (]: SQL status: BEGIN in 0.021 seconds
[0m16:40:54.279976 [debug] [Thread-3 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53"
[0m16:40:54.280330 [debug] [Thread-1 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee"
[0m16:40:54.280663 [debug] [Thread-2 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd"
[0m16:40:54.280996 [debug] [Thread-4 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69"
[0m16:40:54.281352 [debug] [Thread-3 (]: On test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        commodity_scale as value_field,
        count(*) as n_records

    from "fao"."public_gold"."gold_price_production_analysis"
    group by commodity_scale

)

select *
from all_values
where value_field not in (
    'Major Commodity','Medium Commodity','Minor Commodity'
)



  
  
      
    ) dbt_internal_test
[0m16:40:54.281745 [debug] [Thread-1 (]: On test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        producer_category as value_field,
        count(*) as n_records

    from "fao"."public_gold"."gold_country_metrics"
    group by producer_category

)

select *
from all_values
where value_field not in (
    'Major Producer','Medium Producer','Small Producer'
)



  
  
      
    ) dbt_internal_test
[0m16:40:54.282117 [debug] [Thread-2 (]: On test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        production_trend as value_field,
        count(*) as n_records

    from "fao"."public_gold"."gold_country_metrics"
    group by production_trend

)

select *
from all_values
where value_field not in (
    'Growing','Declining','Stable'
)



  
  
      
    ) dbt_internal_test
[0m16:40:54.282491 [debug] [Thread-4 (]: On test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        price_tier as value_field,
        count(*) as n_records

    from "fao"."public_gold"."gold_price_production_analysis"
    group by price_tier

)

select *
from all_values
where value_field not in (
    'Premium Product','Standard Product','Basic Product'
)



  
  
      
    ) dbt_internal_test
[0m16:40:54.283778 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:40:54.284219 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:40:54.284650 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m16:40:54.285024 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m16:40:54.287549 [debug] [Thread-3 (]: On test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53: ROLLBACK
[0m16:40:54.288430 [debug] [Thread-2 (]: On test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd: ROLLBACK
[0m16:40:54.289219 [debug] [Thread-4 (]: On test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69: ROLLBACK
[0m16:40:54.289969 [debug] [Thread-1 (]: On test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee: ROLLBACK
[0m16:40:54.291499 [debug] [Thread-4 (]: On test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69: Close
[0m16:40:54.291911 [debug] [Thread-2 (]: On test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd: Close
[0m16:40:54.292414 [info ] [Thread-4 (]: 4 of 23 PASS accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product  [[32mPASS[0m in 0.08s]
[0m16:40:54.292791 [debug] [Thread-3 (]: On test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53: Close
[0m16:40:54.293208 [info ] [Thread-2 (]: 2 of 23 PASS accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable  [[32mPASS[0m in 0.08s]
[0m16:40:54.293544 [debug] [Thread-1 (]: On test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee: Close
[0m16:40:54.293966 [debug] [Thread-4 (]: Finished running node test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69
[0m16:40:54.294421 [info ] [Thread-3 (]: 3 of 23 PASS accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity  [[32mPASS[0m in 0.08s]
[0m16:40:54.294990 [debug] [Thread-2 (]: Finished running node test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd
[0m16:40:54.295538 [info ] [Thread-1 (]: 1 of 23 PASS accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer  [[32mPASS[0m in 0.08s]
[0m16:40:54.295978 [debug] [Thread-4 (]: Began running node test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6
[0m16:40:54.296521 [debug] [Thread-3 (]: Finished running node test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53
[0m16:40:54.296883 [debug] [Thread-2 (]: Began running node test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff
[0m16:40:54.297278 [debug] [Thread-1 (]: Finished running node test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee
[0m16:40:54.297731 [info ] [Thread-4 (]: 5 of 23 START test accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region  [RUN]
[0m16:40:54.298198 [debug] [Thread-3 (]: Began running node test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f
[0m16:40:54.298548 [info ] [Thread-2 (]: 6 of 23 START test accepted_values_silver_prices_cleaned_is_valid_price__True__False  [RUN]
[0m16:40:54.298918 [debug] [Thread-1 (]: Began running node test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c
[0m16:40:54.299314 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69, now test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6)
[0m16:40:54.299661 [info ] [Thread-3 (]: 7 of 23 START test accepted_values_silver_production_cleaned_is_valid_production__True__False  [RUN]
[0m16:40:54.300006 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd, now test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff)
[0m16:40:54.300329 [info ] [Thread-1 (]: 8 of 23 START test not_null_gold_country_metrics_country_name .................. [RUN]
[0m16:40:54.300664 [debug] [Thread-4 (]: Began compiling node test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6
[0m16:40:54.301022 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53, now test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f)
[0m16:40:54.301337 [debug] [Thread-2 (]: Began compiling node test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff
[0m16:40:54.301647 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee, now test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c)
[0m16:40:54.304836 [debug] [Thread-4 (]: Writing injected SQL for node "test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6"
[0m16:40:54.305213 [debug] [Thread-3 (]: Began compiling node test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f
[0m16:40:54.307363 [debug] [Thread-2 (]: Writing injected SQL for node "test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff"
[0m16:40:54.307713 [debug] [Thread-1 (]: Began compiling node test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c
[0m16:40:54.310545 [debug] [Thread-3 (]: Writing injected SQL for node "test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f"
[0m16:40:54.311098 [debug] [Thread-4 (]: Began executing node test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6
[0m16:40:54.314507 [debug] [Thread-1 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c"
[0m16:40:54.314963 [debug] [Thread-2 (]: Began executing node test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff
[0m16:40:54.316363 [debug] [Thread-4 (]: Writing runtime sql for node "test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6"
[0m16:40:54.316745 [debug] [Thread-3 (]: Began executing node test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f
[0m16:40:54.319003 [debug] [Thread-2 (]: Writing runtime sql for node "test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff"
[0m16:40:54.320667 [debug] [Thread-3 (]: Writing runtime sql for node "test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f"
[0m16:40:54.321051 [debug] [Thread-1 (]: Began executing node test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c
[0m16:40:54.321687 [debug] [Thread-4 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6"
[0m16:40:54.323297 [debug] [Thread-1 (]: Writing runtime sql for node "test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c"
[0m16:40:54.323759 [debug] [Thread-2 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff"
[0m16:40:54.324098 [debug] [Thread-3 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f"
[0m16:40:54.324423 [debug] [Thread-4 (]: On test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6: BEGIN
[0m16:40:54.324813 [debug] [Thread-2 (]: On test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff: BEGIN
[0m16:40:54.325138 [debug] [Thread-3 (]: On test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f: BEGIN
[0m16:40:54.325508 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:40:54.325888 [debug] [Thread-1 (]: Using postgres connection "test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c"
[0m16:40:54.326292 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:40:54.326639 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:40:54.327066 [debug] [Thread-1 (]: On test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c: BEGIN
[0m16:40:54.327561 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:40:54.337532 [debug] [Thread-4 (]: SQL status: BEGIN in 0.012 seconds
[0m16:40:54.338054 [debug] [Thread-4 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6"
[0m16:40:54.338570 [debug] [Thread-4 (]: On test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        regional_scale as value_field,
        count(*) as n_records

    from "fao"."public_gold"."gold_regional_summary"
    group by regional_scale

)

select *
from all_values
where value_field not in (
    'Major Agricultural Region','Medium Agricultural Region','Minor Agricultural Region'
)



  
  
      
    ) dbt_internal_test
[0m16:40:54.339073 [debug] [Thread-2 (]: SQL status: BEGIN in 0.013 seconds
[0m16:40:54.339509 [debug] [Thread-3 (]: SQL status: BEGIN in 0.013 seconds
[0m16:40:54.339895 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m16:40:54.340457 [debug] [Thread-2 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff"
[0m16:40:54.340854 [debug] [Thread-3 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f"
[0m16:40:54.341193 [debug] [Thread-1 (]: Using postgres connection "test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c"
[0m16:40:54.341583 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:40:54.341973 [debug] [Thread-2 (]: On test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        is_valid_price as value_field,
        count(*) as n_records

    from "fao"."public_silver"."silver_prices_cleaned"
    group by is_valid_price

)

select *
from all_values
where value_field not in (
    'True','False'
)



  
  
      
    ) dbt_internal_test
[0m16:40:54.342374 [debug] [Thread-3 (]: On test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        is_valid_production as value_field,
        count(*) as n_records

    from "fao"."public_silver"."silver_production_cleaned"
    group by is_valid_production

)

select *
from all_values
where value_field not in (
    'True','False'
)



  
  
      
    ) dbt_internal_test
[0m16:40:54.342754 [debug] [Thread-1 (]: On test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select country_name
from "fao"."public_gold"."gold_country_metrics"
where country_name is null



  
  
      
    ) dbt_internal_test
[0m16:40:54.343769 [debug] [Thread-4 (]: On test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6: ROLLBACK
[0m16:40:54.344554 [debug] [Thread-4 (]: On test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6: Close
[0m16:40:54.344930 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:40:54.345265 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:40:54.345620 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:40:54.346522 [debug] [Thread-3 (]: On test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f: ROLLBACK
[0m16:40:54.347042 [info ] [Thread-4 (]: 5 of 23 PASS accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region  [[32mPASS[0m in 0.05s]
[0m16:40:54.347917 [debug] [Thread-1 (]: On test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c: ROLLBACK
[0m16:40:54.348680 [debug] [Thread-2 (]: On test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff: ROLLBACK
[0m16:40:54.349151 [debug] [Thread-4 (]: Finished running node test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6
[0m16:40:54.349577 [debug] [Thread-3 (]: On test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f: Close
[0m16:40:54.349981 [debug] [Thread-2 (]: On test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff: Close
[0m16:40:54.350322 [debug] [Thread-1 (]: On test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c: Close
[0m16:40:54.350684 [debug] [Thread-4 (]: Began running node test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b
[0m16:40:54.351242 [info ] [Thread-3 (]: 7 of 23 PASS accepted_values_silver_production_cleaned_is_valid_production__True__False  [[32mPASS[0m in 0.05s]
[0m16:40:54.351726 [info ] [Thread-2 (]: 6 of 23 PASS accepted_values_silver_prices_cleaned_is_valid_price__True__False . [[32mPASS[0m in 0.05s]
[0m16:40:54.352190 [info ] [Thread-1 (]: 8 of 23 PASS not_null_gold_country_metrics_country_name ........................ [[32mPASS[0m in 0.05s]
[0m16:40:54.352683 [info ] [Thread-4 (]: 9 of 23 START test not_null_gold_price_production_analysis_item_name ........... [RUN]
[0m16:40:54.353347 [debug] [Thread-3 (]: Finished running node test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f
[0m16:40:54.353839 [debug] [Thread-2 (]: Finished running node test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff
[0m16:40:54.354230 [debug] [Thread-1 (]: Finished running node test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c
[0m16:40:54.354599 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6, now test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b)
[0m16:40:54.354947 [debug] [Thread-3 (]: Began running node test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7
[0m16:40:54.355324 [debug] [Thread-2 (]: Began running node test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5
[0m16:40:54.355772 [debug] [Thread-1 (]: Began running node test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df
[0m16:40:54.356219 [debug] [Thread-4 (]: Began compiling node test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b
[0m16:40:54.356694 [info ] [Thread-3 (]: 10 of 23 START test not_null_gold_regional_summary_region ...................... [RUN]
[0m16:40:54.357119 [info ] [Thread-2 (]: 11 of 23 START test not_null_silver_prices_cleaned_price_id .................... [RUN]
[0m16:40:54.357515 [info ] [Thread-1 (]: 12 of 23 START test not_null_silver_prices_cleaned_price_value ................. [RUN]
[0m16:40:54.360105 [debug] [Thread-4 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b"
[0m16:40:54.360598 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f, now test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7)
[0m16:40:54.361100 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff, now test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5)
[0m16:40:54.361533 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c, now test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df)
[0m16:40:54.361999 [debug] [Thread-3 (]: Began compiling node test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7
[0m16:40:54.362380 [debug] [Thread-2 (]: Began compiling node test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5
[0m16:40:54.362760 [debug] [Thread-1 (]: Began compiling node test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df
[0m16:40:54.365269 [debug] [Thread-3 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7"
[0m16:40:54.365652 [debug] [Thread-4 (]: Began executing node test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b
[0m16:40:54.368242 [debug] [Thread-2 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5"
[0m16:40:54.370982 [debug] [Thread-1 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df"
[0m16:40:54.373947 [debug] [Thread-4 (]: Writing runtime sql for node "test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b"
[0m16:40:54.374641 [debug] [Thread-3 (]: Began executing node test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7
[0m16:40:54.375164 [debug] [Thread-2 (]: Began executing node test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5
[0m16:40:54.375561 [debug] [Thread-1 (]: Began executing node test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df
[0m16:40:54.377160 [debug] [Thread-3 (]: Writing runtime sql for node "test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7"
[0m16:40:54.378632 [debug] [Thread-2 (]: Writing runtime sql for node "test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5"
[0m16:40:54.379049 [debug] [Thread-4 (]: Using postgres connection "test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b"
[0m16:40:54.380561 [debug] [Thread-1 (]: Writing runtime sql for node "test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df"
[0m16:40:54.381090 [debug] [Thread-4 (]: On test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b: BEGIN
[0m16:40:54.381559 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:40:54.382016 [debug] [Thread-3 (]: Using postgres connection "test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7"
[0m16:40:54.382373 [debug] [Thread-3 (]: On test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7: BEGIN
[0m16:40:54.382723 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:40:54.383135 [debug] [Thread-2 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5"
[0m16:40:54.383621 [debug] [Thread-1 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df"
[0m16:40:54.383994 [debug] [Thread-2 (]: On test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5: BEGIN
[0m16:40:54.384359 [debug] [Thread-1 (]: On test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df: BEGIN
[0m16:40:54.384885 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:40:54.385332 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:40:54.389500 [debug] [Thread-4 (]: SQL status: BEGIN in 0.008 seconds
[0m16:40:54.389907 [debug] [Thread-4 (]: Using postgres connection "test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b"
[0m16:40:54.390261 [debug] [Thread-4 (]: On test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select item_name
from "fao"."public_gold"."gold_price_production_analysis"
where item_name is null



  
  
      
    ) dbt_internal_test
[0m16:40:54.391259 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:40:54.392359 [debug] [Thread-4 (]: On test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b: ROLLBACK
[0m16:40:54.393062 [debug] [Thread-4 (]: On test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b: Close
[0m16:40:54.393483 [debug] [Thread-3 (]: SQL status: BEGIN in 0.011 seconds
[0m16:40:54.394498 [debug] [Thread-3 (]: Using postgres connection "test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7"
[0m16:40:54.394884 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m16:40:54.394133 [info ] [Thread-4 (]: 9 of 23 PASS not_null_gold_price_production_analysis_item_name ................. [[32mPASS[0m in 0.04s]
[0m16:40:54.395366 [debug] [Thread-2 (]: SQL status: BEGIN in 0.010 seconds
[0m16:40:54.395743 [debug] [Thread-3 (]: On test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region
from "fao"."public_gold"."gold_regional_summary"
where region is null



  
  
      
    ) dbt_internal_test
[0m16:40:54.396110 [debug] [Thread-1 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df"
[0m16:40:54.396534 [debug] [Thread-4 (]: Finished running node test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b
[0m16:40:54.396887 [debug] [Thread-2 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5"
[0m16:40:54.397276 [debug] [Thread-1 (]: On test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select price_value
from "fao"."public_silver"."silver_prices_cleaned"
where price_value is null



  
  
      
    ) dbt_internal_test
[0m16:40:54.397690 [debug] [Thread-4 (]: Began running node test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b
[0m16:40:54.398108 [debug] [Thread-2 (]: On test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select price_id
from "fao"."public_silver"."silver_prices_cleaned"
where price_id is null



  
  
      
    ) dbt_internal_test
[0m16:40:54.398539 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:40:54.398921 [info ] [Thread-4 (]: 13 of 23 START test not_null_silver_prices_cleaned_year ........................ [RUN]
[0m16:40:54.400002 [debug] [Thread-3 (]: On test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7: ROLLBACK
[0m16:40:54.400375 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m16:40:54.400727 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:40:54.401088 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b, now test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b)
[0m16:40:54.402122 [debug] [Thread-1 (]: On test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df: ROLLBACK
[0m16:40:54.402514 [debug] [Thread-3 (]: On test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7: Close
[0m16:40:54.403591 [debug] [Thread-2 (]: On test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5: ROLLBACK
[0m16:40:54.403995 [debug] [Thread-4 (]: Began compiling node test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b
[0m16:40:54.404558 [info ] [Thread-3 (]: 10 of 23 PASS not_null_gold_regional_summary_region ............................ [[32mPASS[0m in 0.04s]
[0m16:40:54.404953 [debug] [Thread-1 (]: On test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df: Close
[0m16:40:54.407863 [debug] [Thread-4 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b"
[0m16:40:54.408313 [debug] [Thread-2 (]: On test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5: Close
[0m16:40:54.408725 [debug] [Thread-3 (]: Finished running node test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7
[0m16:40:54.409204 [info ] [Thread-1 (]: 12 of 23 PASS not_null_silver_prices_cleaned_price_value ....................... [[32mPASS[0m in 0.05s]
[0m16:40:54.409780 [debug] [Thread-3 (]: Began running node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74
[0m16:40:54.410262 [info ] [Thread-2 (]: 11 of 23 PASS not_null_silver_prices_cleaned_price_id .......................... [[32mPASS[0m in 0.05s]
[0m16:40:54.410841 [debug] [Thread-1 (]: Finished running node test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df
[0m16:40:54.411205 [info ] [Thread-3 (]: 14 of 23 START test not_null_silver_production_cleaned_production_id ........... [RUN]
[0m16:40:54.411669 [debug] [Thread-2 (]: Finished running node test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5
[0m16:40:54.411982 [debug] [Thread-4 (]: Began executing node test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b
[0m16:40:54.412331 [debug] [Thread-1 (]: Began running node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d
[0m16:40:54.412690 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7, now test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74)
[0m16:40:54.413054 [debug] [Thread-2 (]: Began running node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df
[0m16:40:54.414549 [debug] [Thread-4 (]: Writing runtime sql for node "test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b"
[0m16:40:54.414916 [info ] [Thread-1 (]: 15 of 23 START test not_null_silver_production_cleaned_production_metric_tons .. [RUN]
[0m16:40:54.415278 [debug] [Thread-3 (]: Began compiling node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74
[0m16:40:54.415673 [info ] [Thread-2 (]: 16 of 23 START test not_null_silver_production_cleaned_production_value ........ [RUN]
[0m16:40:54.416153 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df, now test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d)
[0m16:40:54.418582 [debug] [Thread-3 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74"
[0m16:40:54.419017 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5, now test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df)
[0m16:40:54.419412 [debug] [Thread-4 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b"
[0m16:40:54.419771 [debug] [Thread-1 (]: Began compiling node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d
[0m16:40:54.420170 [debug] [Thread-2 (]: Began compiling node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df
[0m16:40:54.420584 [debug] [Thread-4 (]: On test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b: BEGIN
[0m16:40:54.424029 [debug] [Thread-1 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d"
[0m16:40:54.424488 [debug] [Thread-3 (]: Began executing node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74
[0m16:40:54.427164 [debug] [Thread-2 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df"
[0m16:40:54.427596 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:40:54.429143 [debug] [Thread-3 (]: Writing runtime sql for node "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74"
[0m16:40:54.429697 [debug] [Thread-1 (]: Began executing node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d
[0m16:40:54.430116 [debug] [Thread-2 (]: Began executing node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df
[0m16:40:54.431654 [debug] [Thread-1 (]: Writing runtime sql for node "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d"
[0m16:40:54.433080 [debug] [Thread-2 (]: Writing runtime sql for node "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df"
[0m16:40:54.433637 [debug] [Thread-3 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74"
[0m16:40:54.434415 [debug] [Thread-1 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d"
[0m16:40:54.434825 [debug] [Thread-2 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df"
[0m16:40:54.435251 [debug] [Thread-3 (]: On test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74: BEGIN
[0m16:40:54.435682 [debug] [Thread-1 (]: On test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d: BEGIN
[0m16:40:54.436076 [debug] [Thread-2 (]: On test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df: BEGIN
[0m16:40:54.436530 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:40:54.436977 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:40:54.437424 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:40:54.441835 [debug] [Thread-4 (]: SQL status: BEGIN in 0.014 seconds
[0m16:40:54.442281 [debug] [Thread-4 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b"
[0m16:40:54.442640 [debug] [Thread-4 (]: On test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select year
from "fao"."public_silver"."silver_prices_cleaned"
where year is null



  
  
      
    ) dbt_internal_test
[0m16:40:54.443792 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:40:54.444826 [debug] [Thread-4 (]: On test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b: ROLLBACK
[0m16:40:54.445607 [debug] [Thread-4 (]: On test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b: Close
[0m16:40:54.446269 [info ] [Thread-4 (]: 13 of 23 PASS not_null_silver_prices_cleaned_year .............................. [[32mPASS[0m in 0.05s]
[0m16:40:54.446777 [debug] [Thread-4 (]: Finished running node test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b
[0m16:40:54.447294 [debug] [Thread-4 (]: Began running node test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd
[0m16:40:54.447794 [debug] [Thread-2 (]: SQL status: BEGIN in 0.010 seconds
[0m16:40:54.448223 [debug] [Thread-3 (]: SQL status: BEGIN in 0.012 seconds
[0m16:40:54.448608 [info ] [Thread-4 (]: 17 of 23 START test not_null_silver_top_countries_area_code .................... [RUN]
[0m16:40:54.448997 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m16:40:54.449348 [debug] [Thread-2 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df"
[0m16:40:54.449694 [debug] [Thread-3 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74"
[0m16:40:54.450086 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b, now test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd)
[0m16:40:54.450445 [debug] [Thread-1 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d"
[0m16:40:54.450790 [debug] [Thread-2 (]: On test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select production_value
from "fao"."public_silver"."silver_production_cleaned"
where production_value is null



  
  
      
    ) dbt_internal_test
[0m16:40:54.451159 [debug] [Thread-3 (]: On test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select production_id
from "fao"."public_silver"."silver_production_cleaned"
where production_id is null



  
  
      
    ) dbt_internal_test
[0m16:40:54.451497 [debug] [Thread-4 (]: Began compiling node test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd
[0m16:40:54.451903 [debug] [Thread-1 (]: On test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select production_metric_tons
from "fao"."public_silver"."silver_production_cleaned"
where production_metric_tons is null



  
  
      
    ) dbt_internal_test
[0m16:40:54.454666 [debug] [Thread-4 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd"
[0m16:40:54.455120 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m16:40:54.455625 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m16:40:54.457035 [debug] [Thread-3 (]: On test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74: ROLLBACK
[0m16:40:54.457503 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m16:40:54.458332 [debug] [Thread-2 (]: On test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df: ROLLBACK
[0m16:40:54.459380 [debug] [Thread-1 (]: On test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d: ROLLBACK
[0m16:40:54.459747 [debug] [Thread-4 (]: Began executing node test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd
[0m16:40:54.460093 [debug] [Thread-3 (]: On test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74: Close
[0m16:40:54.461865 [debug] [Thread-4 (]: Writing runtime sql for node "test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd"
[0m16:40:54.462298 [debug] [Thread-2 (]: On test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df: Close
[0m16:40:54.462653 [debug] [Thread-1 (]: On test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d: Close
[0m16:40:54.463159 [info ] [Thread-3 (]: 14 of 23 PASS not_null_silver_production_cleaned_production_id ................. [[32mPASS[0m in 0.05s]
[0m16:40:54.463747 [info ] [Thread-2 (]: 16 of 23 PASS not_null_silver_production_cleaned_production_value .............. [[32mPASS[0m in 0.04s]
[0m16:40:54.464714 [debug] [Thread-3 (]: Finished running node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74
[0m16:40:54.465081 [debug] [Thread-4 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd"
[0m16:40:54.464351 [info ] [Thread-1 (]: 15 of 23 PASS not_null_silver_production_cleaned_production_metric_tons ........ [[32mPASS[0m in 0.05s]
[0m16:40:54.465624 [debug] [Thread-2 (]: Finished running node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df
[0m16:40:54.465987 [debug] [Thread-3 (]: Began running node test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a
[0m16:40:54.466328 [debug] [Thread-4 (]: On test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd: BEGIN
[0m16:40:54.466754 [debug] [Thread-1 (]: Finished running node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d
[0m16:40:54.467091 [debug] [Thread-2 (]: Began running node test.fao_elt_pipeline.test_data_quality
[0m16:40:54.467435 [info ] [Thread-3 (]: 18 of 23 START test not_null_silver_top_countries_country_name ................. [RUN]
[0m16:40:54.467839 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:40:54.468234 [debug] [Thread-1 (]: Began running node test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4
[0m16:40:54.468606 [info ] [Thread-2 (]: 19 of 23 START test test_data_quality .......................................... [RUN]
[0m16:40:54.469083 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74, now test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a)
[0m16:40:54.469631 [info ] [Thread-1 (]: 20 of 23 START test unique_gold_country_metrics_country_name ................... [RUN]
[0m16:40:54.470308 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df, now test.fao_elt_pipeline.test_data_quality)
[0m16:40:54.470740 [debug] [Thread-3 (]: Began compiling node test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a
[0m16:40:54.471234 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d, now test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4)
[0m16:40:54.471704 [debug] [Thread-2 (]: Began compiling node test.fao_elt_pipeline.test_data_quality
[0m16:40:54.475383 [debug] [Thread-3 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a"
[0m16:40:54.475827 [debug] [Thread-1 (]: Began compiling node test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4
[0m16:40:54.477759 [debug] [Thread-2 (]: Writing injected SQL for node "test.fao_elt_pipeline.test_data_quality"
[0m16:40:54.478167 [debug] [Thread-4 (]: SQL status: BEGIN in 0.010 seconds
[0m16:40:54.481807 [debug] [Thread-1 (]: Writing injected SQL for node "test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4"
[0m16:40:54.482279 [debug] [Thread-4 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd"
[0m16:40:54.482775 [debug] [Thread-2 (]: Began executing node test.fao_elt_pipeline.test_data_quality
[0m16:40:54.483091 [debug] [Thread-3 (]: Began executing node test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a
[0m16:40:54.483433 [debug] [Thread-4 (]: On test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select area_code
from "fao"."public_silver"."silver_top_countries"
where area_code is null



  
  
      
    ) dbt_internal_test
[0m16:40:54.483791 [debug] [Thread-1 (]: Began executing node test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4
[0m16:40:54.485300 [debug] [Thread-2 (]: Writing runtime sql for node "test.fao_elt_pipeline.test_data_quality"
[0m16:40:54.486945 [debug] [Thread-3 (]: Writing runtime sql for node "test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a"
[0m16:40:54.488664 [debug] [Thread-1 (]: Writing runtime sql for node "test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4"
[0m16:40:54.489068 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m16:40:54.490357 [debug] [Thread-4 (]: On test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd: ROLLBACK
[0m16:40:54.490844 [debug] [Thread-2 (]: Using postgres connection "test.fao_elt_pipeline.test_data_quality"
[0m16:40:54.491221 [debug] [Thread-1 (]: Using postgres connection "test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4"
[0m16:40:54.491563 [debug] [Thread-3 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a"
[0m16:40:54.491895 [debug] [Thread-2 (]: On test.fao_elt_pipeline.test_data_quality: BEGIN
[0m16:40:54.492201 [debug] [Thread-4 (]: On test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd: Close
[0m16:40:54.492534 [debug] [Thread-1 (]: On test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4: BEGIN
[0m16:40:54.492869 [debug] [Thread-3 (]: On test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a: BEGIN
[0m16:40:54.493200 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:40:54.493557 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:40:54.494018 [info ] [Thread-4 (]: 17 of 23 PASS not_null_silver_top_countries_area_code .......................... [[32mPASS[0m in 0.04s]
[0m16:40:54.494417 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:40:54.495093 [debug] [Thread-4 (]: Finished running node test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd
[0m16:40:54.495587 [debug] [Thread-4 (]: Began running node test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1
[0m16:40:54.495962 [info ] [Thread-4 (]: 21 of 23 START test unique_gold_regional_summary_region ........................ [RUN]
[0m16:40:54.496408 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd, now test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1)
[0m16:40:54.496776 [debug] [Thread-4 (]: Began compiling node test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1
[0m16:40:54.499242 [debug] [Thread-4 (]: Writing injected SQL for node "test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1"
[0m16:40:54.499837 [debug] [Thread-4 (]: Began executing node test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1
[0m16:40:54.502741 [debug] [Thread-4 (]: Writing runtime sql for node "test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1"
[0m16:40:54.503413 [debug] [Thread-4 (]: Using postgres connection "test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1"
[0m16:40:54.503769 [debug] [Thread-4 (]: On test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1: BEGIN
[0m16:40:54.504083 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:40:54.508661 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m16:40:54.509089 [debug] [Thread-3 (]: SQL status: BEGIN in 0.015 seconds
[0m16:40:54.509494 [debug] [Thread-2 (]: SQL status: BEGIN in 0.016 seconds
[0m16:40:54.509880 [debug] [Thread-1 (]: Using postgres connection "test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4"
[0m16:40:54.510245 [debug] [Thread-3 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a"
[0m16:40:54.510582 [debug] [Thread-2 (]: Using postgres connection "test.fao_elt_pipeline.test_data_quality"
[0m16:40:54.510961 [debug] [Thread-1 (]: On test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    country_name as unique_field,
    count(*) as n_records

from "fao"."public_gold"."gold_country_metrics"
where country_name is not null
group by country_name
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:40:54.511340 [debug] [Thread-3 (]: On test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select country_name
from "fao"."public_silver"."silver_top_countries"
where country_name is null



  
  
      
    ) dbt_internal_test
[0m16:40:54.511716 [debug] [Thread-2 (]: On test.fao_elt_pipeline.test_data_quality: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.test_data_quality"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Test to ensure we have data for major countries
-- This test will fail if we don't have data for these important agricultural producers

SELECT country_name
FROM (
    VALUES
        ('China'),
        ('India'),
        ('USA'),
        ('Brazil'),
        ('Germany')
) AS required_countries(country_name)
WHERE country_name NOT IN (
    SELECT DISTINCT country_name_standardized
    FROM "fao"."public_silver"."silver_production_cleaned"
)
  
  
      
    ) dbt_internal_test
[0m16:40:54.512783 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:40:54.513190 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:40:54.513549 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:40:54.513911 [debug] [Thread-4 (]: SQL status: BEGIN in 0.010 seconds
[0m16:40:54.514945 [debug] [Thread-3 (]: On test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a: ROLLBACK
[0m16:40:54.515758 [debug] [Thread-2 (]: On test.fao_elt_pipeline.test_data_quality: ROLLBACK
[0m16:40:54.516605 [debug] [Thread-1 (]: On test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4: ROLLBACK
[0m16:40:54.516962 [debug] [Thread-4 (]: Using postgres connection "test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1"
[0m16:40:54.517541 [debug] [Thread-4 (]: On test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    region as unique_field,
    count(*) as n_records

from "fao"."public_gold"."gold_regional_summary"
where region is not null
group by region
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:40:54.518033 [debug] [Thread-2 (]: On test.fao_elt_pipeline.test_data_quality: Close
[0m16:40:54.518356 [debug] [Thread-3 (]: On test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a: Close
[0m16:40:54.518767 [debug] [Thread-1 (]: On test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4: Close
[0m16:40:54.519491 [warn ] [Thread-2 (]: 19 of 23 WARN 5 test_data_quality .............................................. [[33mWARN 5[0m in 0.05s]
[0m16:40:54.520445 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:40:54.519982 [info ] [Thread-3 (]: 18 of 23 PASS not_null_silver_top_countries_country_name ....................... [[32mPASS[0m in 0.05s]
[0m16:40:54.521479 [debug] [Thread-2 (]: Finished running node test.fao_elt_pipeline.test_data_quality
[0m16:40:54.520975 [info ] [Thread-1 (]: 20 of 23 PASS unique_gold_country_metrics_country_name ......................... [[32mPASS[0m in 0.05s]
[0m16:40:54.522494 [debug] [Thread-4 (]: On test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1: ROLLBACK
[0m16:40:54.522917 [debug] [Thread-3 (]: Finished running node test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a
[0m16:40:54.523272 [debug] [Thread-2 (]: Began running node test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31
[0m16:40:54.523720 [debug] [Thread-1 (]: Finished running node test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4
[0m16:40:54.524128 [debug] [Thread-3 (]: Began running node test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048
[0m16:40:54.524501 [info ] [Thread-2 (]: 22 of 23 START test unique_silver_prices_cleaned_price_id ...................... [RUN]
[0m16:40:54.524830 [debug] [Thread-4 (]: On test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1: Close
[0m16:40:54.525349 [info ] [Thread-3 (]: 23 of 23 START test unique_silver_production_cleaned_production_id ............. [RUN]
[0m16:40:54.525782 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.test_data_quality, now test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31)
[0m16:40:54.526167 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a, now test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048)
[0m16:40:54.526616 [info ] [Thread-4 (]: 21 of 23 PASS unique_gold_regional_summary_region .............................. [[32mPASS[0m in 0.03s]
[0m16:40:54.526998 [debug] [Thread-2 (]: Began compiling node test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31
[0m16:40:54.527337 [debug] [Thread-3 (]: Began compiling node test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048
[0m16:40:54.527748 [debug] [Thread-4 (]: Finished running node test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1
[0m16:40:54.530287 [debug] [Thread-2 (]: Writing injected SQL for node "test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31"
[0m16:40:54.532767 [debug] [Thread-3 (]: Writing injected SQL for node "test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048"
[0m16:40:54.533463 [debug] [Thread-3 (]: Began executing node test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048
[0m16:40:54.535059 [debug] [Thread-3 (]: Writing runtime sql for node "test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048"
[0m16:40:54.535457 [debug] [Thread-2 (]: Began executing node test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31
[0m16:40:54.537159 [debug] [Thread-2 (]: Writing runtime sql for node "test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31"
[0m16:40:54.537868 [debug] [Thread-2 (]: Using postgres connection "test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31"
[0m16:40:54.538288 [debug] [Thread-3 (]: Using postgres connection "test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048"
[0m16:40:54.538732 [debug] [Thread-2 (]: On test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31: BEGIN
[0m16:40:54.539138 [debug] [Thread-3 (]: On test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048: BEGIN
[0m16:40:54.539527 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:40:54.539875 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:40:54.555317 [debug] [Thread-3 (]: SQL status: BEGIN in 0.015 seconds
[0m16:40:54.555783 [debug] [Thread-2 (]: SQL status: BEGIN in 0.016 seconds
[0m16:40:54.556244 [debug] [Thread-3 (]: Using postgres connection "test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048"
[0m16:40:54.556572 [debug] [Thread-2 (]: Using postgres connection "test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31"
[0m16:40:54.556907 [debug] [Thread-3 (]: On test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    production_id as unique_field,
    count(*) as n_records

from "fao"."public_silver"."silver_production_cleaned"
where production_id is not null
group by production_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:40:54.557263 [debug] [Thread-2 (]: On test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    price_id as unique_field,
    count(*) as n_records

from "fao"."public_silver"."silver_prices_cleaned"
where price_id is not null
group by price_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:40:54.558484 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:40:54.558844 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m16:40:54.559822 [debug] [Thread-3 (]: On test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048: ROLLBACK
[0m16:40:54.560620 [debug] [Thread-2 (]: On test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31: ROLLBACK
[0m16:40:54.561347 [debug] [Thread-3 (]: On test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048: Close
[0m16:40:54.561737 [debug] [Thread-2 (]: On test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31: Close
[0m16:40:54.562310 [info ] [Thread-3 (]: 23 of 23 PASS unique_silver_production_cleaned_production_id ................... [[32mPASS[0m in 0.04s]
[0m16:40:54.562866 [info ] [Thread-2 (]: 22 of 23 PASS unique_silver_prices_cleaned_price_id ............................ [[32mPASS[0m in 0.04s]
[0m16:40:54.563333 [debug] [Thread-3 (]: Finished running node test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048
[0m16:40:54.563859 [debug] [Thread-2 (]: Finished running node test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31
[0m16:40:54.564827 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:54.565238 [debug] [MainThread]: On master: BEGIN
[0m16:40:54.565541 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:40:54.584761 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m16:40:54.585202 [debug] [MainThread]: On master: COMMIT
[0m16:40:54.585592 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:54.586049 [debug] [MainThread]: On master: COMMIT
[0m16:40:54.586889 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:40:54.587322 [debug] [MainThread]: On master: Close
[0m16:40:54.587734 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:40:54.588039 [debug] [MainThread]: Connection 'test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4' was properly closed.
[0m16:40:54.588343 [debug] [MainThread]: Connection 'test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31' was properly closed.
[0m16:40:54.588624 [debug] [MainThread]: Connection 'test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048' was properly closed.
[0m16:40:54.588906 [debug] [MainThread]: Connection 'test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1' was properly closed.
[0m16:40:54.589314 [info ] [MainThread]: 
[0m16:40:54.589668 [info ] [MainThread]: Finished running 23 data tests in 0 hours 0 minutes and 0.47 seconds (0.47s).
[0m16:40:54.591546 [debug] [MainThread]: Command end result
[0m16:40:54.608008 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/michaelmalotte/code/personal/fao-elt-pipelines/dbt_project/target/manifest.json
[0m16:40:54.609194 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/michaelmalotte/code/personal/fao-elt-pipelines/dbt_project/target/semantic_manifest.json
[0m16:40:54.614142 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/michaelmalotte/code/personal/fao-elt-pipelines/dbt_project/target/run_results.json
[0m16:40:54.614548 [info ] [MainThread]: 
[0m16:40:54.614903 [info ] [MainThread]: [33mCompleted with 1 warning:[0m
[0m16:40:54.615233 [info ] [MainThread]: 
[0m16:40:54.615581 [warn ] [MainThread]: [33mWarning in test test_data_quality (tests/test_data_quality.sql)[0m
[0m16:40:54.615917 [warn ] [MainThread]: Got 5 results, configured to warn if != 0
[0m16:40:54.616215 [info ] [MainThread]: 
[0m16:40:54.616536 [info ] [MainThread]:   compiled code at target/compiled/fao_elt_pipeline/tests/test_data_quality.sql
[0m16:40:54.616853 [info ] [MainThread]: 
[0m16:40:54.617177 [info ] [MainThread]: Done. PASS=22 WARN=1 ERROR=0 SKIP=0 NO-OP=0 TOTAL=23
[0m16:40:54.619083 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.9768156, "process_in_blocks": "0", "process_kernel_time": 0.181685, "process_mem_max_rss": "142295040", "process_out_blocks": "0", "process_user_time": 1.59151}
[0m16:40:54.619524 [debug] [MainThread]: Command `dbt test` succeeded at 16:40:54.619468 after 0.98 seconds
[0m16:40:54.619886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cd8bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e1fc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107016350>]}
[0m16:40:54.620366 [debug] [MainThread]: Flushing usage events
[0m16:40:55.030740 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:08:08.598926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018215617C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018215056500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018218578EE0>]}


============================== 09:08:08.603927 | 5e4f30db-25eb-4f1b-b263-84474ed33a73 ==============================
[0m09:08:08.603927 [info ] [MainThread]: Running with dbt=1.7.4
[0m09:08:08.605539 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'warn_error': 'None', 'profiles_dir': 'c:\\Users\\18057\\Documents\\Coding\\fao-elt-pipelines\\dbt_project', 'debug': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'quiet': 'False', 'log_format': 'default', 'use_colors': 'True', 'partial_parse': 'True', 'version_check': 'True', 'log_path': 'c:\\Users\\18057\\Documents\\Coding\\fao-elt-pipelines\\dbt_project\\logs', 'introspect': 'True', 'no_print': 'None', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'target_path': 'None', 'write_json': 'True'}
[0m09:08:08.855334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e4f30db-25eb-4f1b-b263-84474ed33a73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182185A6860>]}
[0m09:08:08.857331 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m09:08:08.858331 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m09:08:08.860332 [debug] [MainThread]: Command `cli deps` succeeded at 09:08:08.859331 after 0.36 seconds
[0m09:08:08.860332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018215617C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001821857A8C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182186A4FD0>]}
[0m09:08:08.861331 [debug] [MainThread]: Flushing usage events
[0m10:38:22.300014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC19777550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC1C4E3520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC1C4E3340>]}


============================== 10:38:22.304014 | f1888fc6-8b31-4e0e-975a-183397e6c017 ==============================
[0m10:38:22.304014 [info ] [MainThread]: Running with dbt=1.8.0
[0m10:38:22.305014 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\18057\\Documents\\Coding\\fao-elt-pipelines\\dbt_project', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\18057\\Documents\\Coding\\fao-elt-pipelines\\dbt_project\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m10:38:22.322013 [info ] [MainThread]: dbt version: 1.8.0
[0m10:38:22.323081 [info ] [MainThread]: python version: 3.10.18
[0m10:38:22.323588 [info ] [MainThread]: python path: C:\Users\18057\.conda\envs\elt-pipelines\python.exe
[0m10:38:22.324595 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m10:38:22.333597 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'LOCAL_DB_PASSWORD'
[0m10:38:22.335596 [debug] [MainThread]: Command `dbt debug` failed at 10:38:22.334600 after 0.13 seconds
[0m10:38:22.335596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC19777550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC1BE61180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC1C4E33D0>]}
[0m10:38:22.336595 [debug] [MainThread]: Flushing usage events
[0m10:47:38.244885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012969A47580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001296C7B3670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001296C7B3490>]}


============================== 10:47:38.248888 | b469a0a2-a460-491c-a7cc-1a74b20a9e98 ==============================
[0m10:47:38.248888 [info ] [MainThread]: Running with dbt=1.8.0
[0m10:47:38.249888 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\18057\\Documents\\Coding\\fao-elt-pipelines\\dbt_project\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\18057\\Documents\\Coding\\fao-elt-pipelines\\dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --target dev', 'send_anonymous_usage_stats': 'True'}
[0m10:47:38.409127 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m10:47:38.410125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b469a0a2-a460-491c-a7cc-1a74b20a9e98', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001296C737760>]}
[0m10:47:38.526125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b469a0a2-a460-491c-a7cc-1a74b20a9e98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012969D14670>]}
[0m10:47:38.610169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b469a0a2-a460-491c-a7cc-1a74b20a9e98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012969661780>]}
[0m10:47:38.612170 [info ] [MainThread]: Registered adapter: postgres=1.8.0
[0m10:47:38.645175 [debug] [MainThread]: checksum: 2a6c64e758918535ccc035b9d143fb4c91b01df5f630e583361ba23a87d2a511, vars: {}, profile: , target: dev, version: 1.8.0
[0m10:47:38.830767 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m10:47:38.831766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b469a0a2-a460-491c-a7cc-1a74b20a9e98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001296BB81C30>]}
[0m10:47:41.551242 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.fao_elt_pipeline.bronze
[0m10:47:41.566239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b469a0a2-a460-491c-a7cc-1a74b20a9e98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001296E090130>]}
[0m10:47:41.746779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b469a0a2-a460-491c-a7cc-1a74b20a9e98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001296E09A0B0>]}
[0m10:47:41.747780 [info ] [MainThread]: Found 6 models, 23 data tests, 2 sources, 414 macros
[0m10:47:41.747780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b469a0a2-a460-491c-a7cc-1a74b20a9e98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001296E09A200>]}
[0m10:47:41.750778 [info ] [MainThread]: 
[0m10:47:41.751778 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:47:41.757780 [debug] [ThreadPool]: Acquiring new postgres connection 'list_fao'
[0m10:47:41.758781 [debug] [ThreadPool]: Acquiring new postgres connection 'list_fao'
[0m10:47:43.471529 [debug] [ThreadPool]: Using postgres connection "list_fao"
[0m10:47:43.472528 [debug] [ThreadPool]: Using postgres connection "list_fao"
[0m10:47:43.473530 [debug] [ThreadPool]: On list_fao: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "connection_name": "list_fao"} */

    select distinct nspname from pg_namespace
  
[0m10:47:43.473530 [debug] [ThreadPool]: On list_fao: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "connection_name": "list_fao"} */

    select distinct nspname from pg_namespace
  
[0m10:47:43.474529 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:47:43.475533 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:47:43.492529 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m10:47:43.494528 [debug] [ThreadPool]: On list_fao: Close
[0m10:47:43.509529 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m10:47:43.511529 [debug] [ThreadPool]: On list_fao: Close
[0m10:47:43.512532 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_fao, now create_fao_public_gold)
[0m10:47:43.512532 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_fao, now create_fao_public_silver)
[0m10:47:43.513532 [debug] [ThreadPool]: Creating schema "database: "fao"
schema: "public_gold"
"
[0m10:47:43.514533 [debug] [ThreadPool]: Creating schema "database: "fao"
schema: "public_silver"
"
[0m10:47:43.521529 [debug] [ThreadPool]: Using postgres connection "create_fao_public_gold"
[0m10:47:43.524528 [debug] [ThreadPool]: Using postgres connection "create_fao_public_silver"
[0m10:47:43.524528 [debug] [ThreadPool]: On create_fao_public_gold: BEGIN
[0m10:47:43.525534 [debug] [ThreadPool]: On create_fao_public_silver: BEGIN
[0m10:47:43.526529 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:47:43.527529 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:47:43.540528 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:47:43.541531 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:47:43.542532 [debug] [ThreadPool]: Using postgres connection "create_fao_public_gold"
[0m10:47:43.542532 [debug] [ThreadPool]: Using postgres connection "create_fao_public_silver"
[0m10:47:43.543533 [debug] [ThreadPool]: On create_fao_public_gold: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "connection_name": "create_fao_public_gold"} */
create schema if not exists "public_gold"
[0m10:47:43.544530 [debug] [ThreadPool]: On create_fao_public_silver: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "connection_name": "create_fao_public_silver"} */
create schema if not exists "public_silver"
[0m10:47:43.545532 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m10:47:43.546531 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m10:47:43.547530 [debug] [ThreadPool]: On create_fao_public_gold: COMMIT
[0m10:47:43.548530 [debug] [ThreadPool]: On create_fao_public_silver: COMMIT
[0m10:47:43.549529 [debug] [ThreadPool]: Using postgres connection "create_fao_public_gold"
[0m10:47:43.550529 [debug] [ThreadPool]: Using postgres connection "create_fao_public_silver"
[0m10:47:43.550529 [debug] [ThreadPool]: On create_fao_public_gold: COMMIT
[0m10:47:43.551533 [debug] [ThreadPool]: On create_fao_public_silver: COMMIT
[0m10:47:43.553532 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m10:47:43.554531 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m10:47:43.554531 [debug] [ThreadPool]: On create_fao_public_gold: Close
[0m10:47:43.555530 [debug] [ThreadPool]: On create_fao_public_silver: Close
[0m10:47:43.558531 [debug] [ThreadPool]: Acquiring new postgres connection 'list_fao_public_gold'
[0m10:47:43.558531 [debug] [ThreadPool]: Acquiring new postgres connection 'list_fao_public_silver'
[0m10:47:43.567528 [debug] [ThreadPool]: Using postgres connection "list_fao_public_gold"
[0m10:47:43.570530 [debug] [ThreadPool]: Using postgres connection "list_fao_public_silver"
[0m10:47:43.570530 [debug] [ThreadPool]: On list_fao_public_gold: BEGIN
[0m10:47:43.571529 [debug] [ThreadPool]: On list_fao_public_silver: BEGIN
[0m10:47:43.572529 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:47:43.573530 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:47:43.587092 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:47:43.588093 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:47:43.588093 [debug] [ThreadPool]: Using postgres connection "list_fao_public_gold"
[0m10:47:43.589093 [debug] [ThreadPool]: Using postgres connection "list_fao_public_silver"
[0m10:47:43.590093 [debug] [ThreadPool]: On list_fao_public_gold: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "connection_name": "list_fao_public_gold"} */
select
      'fao' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'fao' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'fao' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m10:47:43.590093 [debug] [ThreadPool]: On list_fao_public_silver: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "connection_name": "list_fao_public_silver"} */
select
      'fao' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'fao' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'fao' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m10:47:43.595092 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m10:47:43.596092 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m10:47:43.597094 [debug] [ThreadPool]: On list_fao_public_gold: ROLLBACK
[0m10:47:43.598092 [debug] [ThreadPool]: On list_fao_public_silver: ROLLBACK
[0m10:47:43.600092 [debug] [ThreadPool]: On list_fao_public_gold: Close
[0m10:47:43.600092 [debug] [ThreadPool]: On list_fao_public_silver: Close
[0m10:47:43.606092 [debug] [MainThread]: Using postgres connection "master"
[0m10:47:43.607092 [debug] [MainThread]: On master: BEGIN
[0m10:47:43.608094 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:47:43.632092 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:47:43.633094 [debug] [MainThread]: Using postgres connection "master"
[0m10:47:43.634092 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:47:43.638092 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m10:47:43.640093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b469a0a2-a460-491c-a7cc-1a74b20a9e98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001296DFFD990>]}
[0m10:47:43.641092 [debug] [MainThread]: On master: ROLLBACK
[0m10:47:43.642094 [debug] [MainThread]: Using postgres connection "master"
[0m10:47:43.643093 [debug] [MainThread]: On master: BEGIN
[0m10:47:43.644094 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:47:43.645093 [debug] [MainThread]: On master: COMMIT
[0m10:47:43.645093 [debug] [MainThread]: Using postgres connection "master"
[0m10:47:43.646094 [debug] [MainThread]: On master: COMMIT
[0m10:47:43.647091 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:47:43.648092 [debug] [MainThread]: On master: Close
[0m10:47:43.649093 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:47:43.649093 [info ] [MainThread]: 
[0m10:47:43.653093 [debug] [Thread-1 (]: Began running node model.fao_elt_pipeline.silver_prices_cleaned
[0m10:47:43.653093 [debug] [Thread-2 (]: Began running node model.fao_elt_pipeline.silver_production_cleaned
[0m10:47:43.654094 [info ] [Thread-1 (]: 1 of 6 START sql table model public_silver.silver_prices_cleaned ............... [RUN]
[0m10:47:43.655093 [info ] [Thread-2 (]: 2 of 6 START sql table model public_silver.silver_production_cleaned ........... [RUN]
[0m10:47:43.656094 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.fao_elt_pipeline.silver_prices_cleaned'
[0m10:47:43.657094 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.fao_elt_pipeline.silver_production_cleaned'
[0m10:47:43.658094 [debug] [Thread-1 (]: Began compiling node model.fao_elt_pipeline.silver_prices_cleaned
[0m10:47:43.659092 [debug] [Thread-2 (]: Began compiling node model.fao_elt_pipeline.silver_production_cleaned
[0m10:47:43.671093 [debug] [Thread-1 (]: Writing injected SQL for node "model.fao_elt_pipeline.silver_prices_cleaned"
[0m10:47:43.677094 [debug] [Thread-2 (]: Writing injected SQL for node "model.fao_elt_pipeline.silver_production_cleaned"
[0m10:47:43.678093 [debug] [Thread-1 (]: Began executing node model.fao_elt_pipeline.silver_prices_cleaned
[0m10:47:43.679094 [debug] [Thread-2 (]: Began executing node model.fao_elt_pipeline.silver_production_cleaned
[0m10:47:43.729092 [debug] [Thread-1 (]: Writing runtime sql for node "model.fao_elt_pipeline.silver_prices_cleaned"
[0m10:47:43.734092 [debug] [Thread-2 (]: Writing runtime sql for node "model.fao_elt_pipeline.silver_production_cleaned"
[0m10:47:43.735093 [debug] [Thread-1 (]: Using postgres connection "model.fao_elt_pipeline.silver_prices_cleaned"
[0m10:47:43.736094 [debug] [Thread-1 (]: On model.fao_elt_pipeline.silver_prices_cleaned: BEGIN
[0m10:47:43.737095 [debug] [Thread-2 (]: Using postgres connection "model.fao_elt_pipeline.silver_production_cleaned"
[0m10:47:43.738093 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:47:43.738093 [debug] [Thread-2 (]: On model.fao_elt_pipeline.silver_production_cleaned: BEGIN
[0m10:47:43.739094 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:47:43.752092 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:47:43.753094 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m10:47:43.754092 [debug] [Thread-1 (]: Using postgres connection "model.fao_elt_pipeline.silver_prices_cleaned"
[0m10:47:43.754092 [debug] [Thread-2 (]: Using postgres connection "model.fao_elt_pipeline.silver_production_cleaned"
[0m10:47:43.755095 [debug] [Thread-1 (]: On model.fao_elt_pipeline.silver_prices_cleaned: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.silver_prices_cleaned"} */

  
    

  create  table "fao"."public_silver"."silver_prices_cleaned__dbt_tmp"
  
  
    as
  
  (
    

WITH raw_prices AS (
    SELECT
        data,
        loaded_at
    FROM "fao"."bronze"."raw_prices"
),

flattened_prices AS (
    SELECT
        (data->>'area')::TEXT as country_name,
        (data->>'area_code')::TEXT as area_code,
        (data->>'area_code_m49')::TEXT as area_code_m49,
        (data->>'element')::TEXT as element_name,
        (data->>'element_code')::TEXT as element_code,
        (data->>'flag')::TEXT as flag,
        (data->>'item')::TEXT as item_name,
        (data->>'item_code')::TEXT as item_code,
        (data->>'item_code_cpc')::TEXT as item_code_cpc,
        (data->>'unit')::TEXT as unit,
        (data->>'value')::NUMERIC as price_value,
        (data->>'year')::INTEGER as year,
        loaded_at
    FROM raw_prices
)

SELECT
    
    md5(
            coalesce(cast(area_code as varchar), '') || '-' || 
            coalesce(cast(item_code as varchar), '') || '-' || 
            coalesce(cast(year as varchar), '')
    )
 as price_id,
    country_name,
    area_code,
    area_code_m49,
    element_name,
    element_code,
    flag,
    item_name,
    item_code,
    item_code_cpc,
    unit,
    price_value,
    year,
    -- Add data quality flags
    CASE
        WHEN price_value IS NULL OR price_value <= 0 THEN FALSE
        ELSE TRUE
    END as is_valid_price,
    -- Add standardized country names (handle special characters)
    CASE
        WHEN country_name LIKE '%Côte%' THEN 'Ivory Coast'
        WHEN country_name = 'China, mainland' THEN 'China'
        WHEN country_name = 'United States of America' THEN 'USA'
        WHEN country_name = 'United Kingdom of Great Britain and Northern Ireland' THEN 'UK'
        ELSE country_name
    END as country_name_standardized,
    loaded_at,
    CURRENT_TIMESTAMP as transformed_at
FROM flattened_prices
WHERE price_value IS NOT NULL
  AND price_value > 0
  AND year >= 1990  -- Focus on more recent data
  );
  
[0m10:47:43.756092 [debug] [Thread-2 (]: On model.fao_elt_pipeline.silver_production_cleaned: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.silver_production_cleaned"} */

  
    

  create  table "fao"."public_silver"."silver_production_cleaned__dbt_tmp"
  
  
    as
  
  (
    

WITH raw_production AS (
    SELECT
        data,
        loaded_at
    FROM "fao"."bronze"."raw_food_balance"
),

flattened_production AS (
    SELECT
        (data->>'area')::TEXT as country_name,
        (data->>'area_code')::TEXT as area_code,
        (data->>'area_code_m49')::TEXT as area_code_m49,
        (data->>'element')::TEXT as element_name,
        (data->>'element_code')::TEXT as element_code,
        (data->>'flag')::TEXT as flag,
        (data->>'item')::TEXT as item_name,
        (data->>'item_code')::TEXT as item_code,
        (data->>'item_code_fbs')::TEXT as item_code_fbs,
        (data->>'unit')::TEXT as unit,
        (data->>'value')::NUMERIC as production_value,
        (data->>'year')::INTEGER as year,
        loaded_at
    FROM raw_production
)

SELECT
    
    md5(
            coalesce(cast(area_code as varchar), '') || '-' || 
            coalesce(cast(item_code as varchar), '') || '-' || 
            coalesce(cast(year as varchar), '')
    )
 as production_id,
    country_name,
    area_code,
    area_code_m49,
    element_name,
    element_code,
    flag,
    item_name,
    item_code,
    item_code_fbs,
    unit,
    production_value,
    year,
    -- Convert to metric tons for consistency
    CASE
        WHEN unit = '1000 t' THEN production_value * 1000
        ELSE production_value
    END as production_metric_tons,
    -- Add data quality flags
    CASE
        WHEN production_value IS NULL OR production_value < 0 THEN FALSE
        ELSE TRUE
    END as is_valid_production,
    -- Add standardized country names
    CASE
        WHEN country_name LIKE '%Côte%' THEN 'Ivory Coast'
        WHEN country_name = 'China, mainland' THEN 'China'
        WHEN country_name = 'United States of America' THEN 'USA'
        WHEN country_name = 'United Kingdom of Great Britain and Northern Ireland' THEN 'UK'
        ELSE country_name
    END as country_name_standardized,
    loaded_at,
    CURRENT_TIMESTAMP as transformed_at
FROM flattened_production
WHERE element_name = 'Production'  -- Focus on production data only
  AND production_value >= 0
  AND year >= 1990
  );
  
[0m10:47:43.763092 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.0 seconds
[0m10:47:43.771092 [debug] [Thread-1 (]: Using postgres connection "model.fao_elt_pipeline.silver_prices_cleaned"
[0m10:47:43.772092 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.0 seconds
[0m10:47:43.773093 [debug] [Thread-1 (]: On model.fao_elt_pipeline.silver_prices_cleaned: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.silver_prices_cleaned"} */
alter table "fao"."public_silver"."silver_prices_cleaned__dbt_tmp" rename to "silver_prices_cleaned"
[0m10:47:43.776092 [debug] [Thread-2 (]: Using postgres connection "model.fao_elt_pipeline.silver_production_cleaned"
[0m10:47:43.777093 [debug] [Thread-2 (]: On model.fao_elt_pipeline.silver_production_cleaned: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.silver_production_cleaned"} */
alter table "fao"."public_silver"."silver_production_cleaned__dbt_tmp" rename to "silver_production_cleaned"
[0m10:47:43.778093 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:47:43.796683 [debug] [Thread-1 (]: Using postgres connection "model.fao_elt_pipeline.silver_prices_cleaned"
[0m10:47:43.797683 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:47:43.797683 [debug] [Thread-1 (]: On model.fao_elt_pipeline.silver_prices_cleaned: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.silver_prices_cleaned"} */

    create  index if not exists
  "3e15d909245006059c670d2d0797b9f7"
  on "fao"."public_silver"."silver_prices_cleaned" using btree
  (area_code, year)
  
[0m10:47:43.799685 [debug] [Thread-2 (]: Using postgres connection "model.fao_elt_pipeline.silver_production_cleaned"
[0m10:47:43.800683 [debug] [Thread-2 (]: On model.fao_elt_pipeline.silver_production_cleaned: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.silver_production_cleaned"} */

    create  index if not exists
  "360e39c3f61e314fefde7cb50d1d0efc"
  on "fao"."public_silver"."silver_production_cleaned" using btree
  (area_code, year)
  
[0m10:47:43.803683 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m10:47:43.805685 [debug] [Thread-1 (]: Using postgres connection "model.fao_elt_pipeline.silver_prices_cleaned"
[0m10:47:43.806685 [debug] [Thread-2 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m10:47:43.807684 [debug] [Thread-1 (]: On model.fao_elt_pipeline.silver_prices_cleaned: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.silver_prices_cleaned"} */

    create  index if not exists
  "341dd2382b80b97c1855512ec7423002"
  on "fao"."public_silver"."silver_prices_cleaned" using btree
  (item_code)
  
[0m10:47:43.809685 [debug] [Thread-2 (]: Using postgres connection "model.fao_elt_pipeline.silver_production_cleaned"
[0m10:47:43.810684 [debug] [Thread-2 (]: On model.fao_elt_pipeline.silver_production_cleaned: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.silver_production_cleaned"} */

    create  index if not exists
  "068b8d31ffb6b569b76998fe907d01e4"
  on "fao"."public_silver"."silver_production_cleaned" using btree
  (item_code)
  
[0m10:47:43.812685 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m10:47:43.829683 [debug] [Thread-2 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m10:47:43.831684 [debug] [Thread-1 (]: On model.fao_elt_pipeline.silver_prices_cleaned: COMMIT
[0m10:47:43.833684 [debug] [Thread-2 (]: On model.fao_elt_pipeline.silver_production_cleaned: COMMIT
[0m10:47:43.834684 [debug] [Thread-1 (]: Using postgres connection "model.fao_elt_pipeline.silver_prices_cleaned"
[0m10:47:43.834684 [debug] [Thread-2 (]: Using postgres connection "model.fao_elt_pipeline.silver_production_cleaned"
[0m10:47:43.835684 [debug] [Thread-1 (]: On model.fao_elt_pipeline.silver_prices_cleaned: COMMIT
[0m10:47:43.836684 [debug] [Thread-2 (]: On model.fao_elt_pipeline.silver_production_cleaned: COMMIT
[0m10:47:43.838440 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m10:47:43.839451 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m10:47:43.846451 [debug] [Thread-1 (]: Applying DROP to: "fao"."public_silver"."silver_prices_cleaned__dbt_backup"
[0m10:47:43.849451 [debug] [Thread-2 (]: Applying DROP to: "fao"."public_silver"."silver_production_cleaned__dbt_backup"
[0m10:47:43.855449 [debug] [Thread-1 (]: Using postgres connection "model.fao_elt_pipeline.silver_prices_cleaned"
[0m10:47:43.856449 [debug] [Thread-2 (]: Using postgres connection "model.fao_elt_pipeline.silver_production_cleaned"
[0m10:47:43.857451 [debug] [Thread-1 (]: On model.fao_elt_pipeline.silver_prices_cleaned: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.silver_prices_cleaned"} */
drop table if exists "fao"."public_silver"."silver_prices_cleaned__dbt_backup" cascade
[0m10:47:43.857451 [debug] [Thread-2 (]: On model.fao_elt_pipeline.silver_production_cleaned: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.silver_production_cleaned"} */
drop table if exists "fao"."public_silver"."silver_production_cleaned__dbt_backup" cascade
[0m10:47:43.859452 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:47:43.859452 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:47:43.862449 [debug] [Thread-2 (]: On model.fao_elt_pipeline.silver_production_cleaned: Close
[0m10:47:43.864451 [debug] [Thread-1 (]: On model.fao_elt_pipeline.silver_prices_cleaned: Close
[0m10:47:43.866450 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b469a0a2-a460-491c-a7cc-1a74b20a9e98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012969CE3880>]}
[0m10:47:43.868117 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b469a0a2-a460-491c-a7cc-1a74b20a9e98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001296DC9A260>]}
[0m10:47:43.869200 [info ] [Thread-2 (]: 2 of 6 OK created sql table model public_silver.silver_production_cleaned ...... [[32mSELECT 0[0m in 0.21s]
[0m10:47:43.870335 [info ] [Thread-1 (]: 1 of 6 OK created sql table model public_silver.silver_prices_cleaned .......... [[32mSELECT 0[0m in 0.21s]
[0m10:47:43.871435 [debug] [Thread-2 (]: Finished running node model.fao_elt_pipeline.silver_production_cleaned
[0m10:47:43.873047 [debug] [Thread-1 (]: Finished running node model.fao_elt_pipeline.silver_prices_cleaned
[0m10:47:43.874127 [debug] [Thread-4 (]: Began running node model.fao_elt_pipeline.gold_country_metrics
[0m10:47:43.874654 [debug] [Thread-3 (]: Began running node model.fao_elt_pipeline.gold_price_production_analysis
[0m10:47:43.875768 [debug] [Thread-2 (]: Began running node model.fao_elt_pipeline.gold_regional_summary
[0m10:47:43.876811 [debug] [Thread-1 (]: Began running node model.fao_elt_pipeline.silver_top_countries
[0m10:47:43.877341 [info ] [Thread-4 (]: 3 of 6 START sql table model public_gold.gold_country_metrics .................. [RUN]
[0m10:47:43.878380 [info ] [Thread-3 (]: 4 of 6 START sql table model public_gold.gold_price_production_analysis ........ [RUN]
[0m10:47:43.879391 [info ] [Thread-2 (]: 5 of 6 START sql table model public_gold.gold_regional_summary ................. [RUN]
[0m10:47:43.880391 [info ] [Thread-1 (]: 6 of 6 START sql table model public_silver.silver_top_countries ................ [RUN]
[0m10:47:43.881390 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.fao_elt_pipeline.gold_country_metrics'
[0m10:47:43.882391 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.fao_elt_pipeline.gold_price_production_analysis'
[0m10:47:43.882391 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.fao_elt_pipeline.silver_production_cleaned, now model.fao_elt_pipeline.gold_regional_summary)
[0m10:47:43.883391 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fao_elt_pipeline.silver_prices_cleaned, now model.fao_elt_pipeline.silver_top_countries)
[0m10:47:43.884390 [debug] [Thread-4 (]: Began compiling node model.fao_elt_pipeline.gold_country_metrics
[0m10:47:43.885390 [debug] [Thread-3 (]: Began compiling node model.fao_elt_pipeline.gold_price_production_analysis
[0m10:47:43.886390 [debug] [Thread-2 (]: Began compiling node model.fao_elt_pipeline.gold_regional_summary
[0m10:47:43.886390 [debug] [Thread-1 (]: Began compiling node model.fao_elt_pipeline.silver_top_countries
[0m10:47:43.893390 [debug] [Thread-4 (]: Writing injected SQL for node "model.fao_elt_pipeline.gold_country_metrics"
[0m10:47:43.897388 [debug] [Thread-3 (]: Writing injected SQL for node "model.fao_elt_pipeline.gold_price_production_analysis"
[0m10:47:43.902388 [debug] [Thread-2 (]: Writing injected SQL for node "model.fao_elt_pipeline.gold_regional_summary"
[0m10:47:43.906388 [debug] [Thread-1 (]: Writing injected SQL for node "model.fao_elt_pipeline.silver_top_countries"
[0m10:47:43.907391 [debug] [Thread-4 (]: Began executing node model.fao_elt_pipeline.gold_country_metrics
[0m10:47:43.908390 [debug] [Thread-3 (]: Began executing node model.fao_elt_pipeline.gold_price_production_analysis
[0m10:47:43.913389 [debug] [Thread-4 (]: Writing runtime sql for node "model.fao_elt_pipeline.gold_country_metrics"
[0m10:47:43.913389 [debug] [Thread-2 (]: Began executing node model.fao_elt_pipeline.gold_regional_summary
[0m10:47:43.917390 [debug] [Thread-3 (]: Writing runtime sql for node "model.fao_elt_pipeline.gold_price_production_analysis"
[0m10:47:43.918390 [debug] [Thread-1 (]: Began executing node model.fao_elt_pipeline.silver_top_countries
[0m10:47:43.923391 [debug] [Thread-2 (]: Writing runtime sql for node "model.fao_elt_pipeline.gold_regional_summary"
[0m10:47:43.924391 [debug] [Thread-4 (]: Using postgres connection "model.fao_elt_pipeline.gold_country_metrics"
[0m10:47:43.929390 [debug] [Thread-1 (]: Writing runtime sql for node "model.fao_elt_pipeline.silver_top_countries"
[0m10:47:43.930392 [debug] [Thread-3 (]: Using postgres connection "model.fao_elt_pipeline.gold_price_production_analysis"
[0m10:47:43.930392 [debug] [Thread-4 (]: On model.fao_elt_pipeline.gold_country_metrics: BEGIN
[0m10:47:43.931389 [debug] [Thread-2 (]: Using postgres connection "model.fao_elt_pipeline.gold_regional_summary"
[0m10:47:43.932390 [debug] [Thread-3 (]: On model.fao_elt_pipeline.gold_price_production_analysis: BEGIN
[0m10:47:43.933388 [debug] [Thread-1 (]: Using postgres connection "model.fao_elt_pipeline.silver_top_countries"
[0m10:47:43.933388 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:47:43.934388 [debug] [Thread-2 (]: On model.fao_elt_pipeline.gold_regional_summary: BEGIN
[0m10:47:43.935388 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:47:43.936390 [debug] [Thread-1 (]: On model.fao_elt_pipeline.silver_top_countries: BEGIN
[0m10:47:43.936390 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:47:43.938391 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:47:43.951391 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m10:47:43.952392 [debug] [Thread-4 (]: Using postgres connection "model.fao_elt_pipeline.gold_country_metrics"
[0m10:47:43.953391 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m10:47:43.954392 [debug] [Thread-4 (]: On model.fao_elt_pipeline.gold_country_metrics: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.gold_country_metrics"} */

  
    

  create  table "fao"."public_gold"."gold_country_metrics__dbt_tmp"
  
  
    as
  
  (
    

WITH country_production AS (
    SELECT
        country_name_standardized as country_name,
        area_code,
        year,
        SUM(production_metric_tons) as annual_production,
        COUNT(DISTINCT item_code) as products_produced
    FROM "fao"."public_silver"."silver_production_cleaned"
    WHERE is_valid_production = TRUE
    GROUP BY country_name_standardized, area_code, year
),

country_prices AS (
    SELECT
        country_name_standardized as country_name,
        area_code,
        year,
        AVG(price_value) as avg_annual_price,
        COUNT(DISTINCT item_code) as products_priced
    FROM "fao"."public_silver"."silver_prices_cleaned"
    WHERE is_valid_price = TRUE
    GROUP BY country_name_standardized, area_code, year
),

country_trends AS (
    SELECT
        cp.country_name,
        cp.area_code,
        -- Production metrics
        SUM(cp.annual_production) as total_production_all_years,
        AVG(cp.annual_production) as avg_annual_production,
        MAX(cp.annual_production) as peak_annual_production,
        MIN(cp.annual_production) as min_annual_production,
        -- Calculate production growth rate (comparing first and last 3 years)
        AVG(CASE WHEN cp.year >= 2018 THEN cp.annual_production END) -
        AVG(CASE WHEN cp.year <= 1993 THEN cp.annual_production END) as production_change,
        -- Price metrics
        AVG(pc.avg_annual_price) as avg_price_all_years,
        MAX(pc.avg_annual_price) as max_price,
        MIN(pc.avg_annual_price) as min_price,
        -- Product diversity
        MAX(cp.products_produced) as max_products_produced,
        AVG(cp.products_produced) as avg_products_produced,
        -- Data availability
        COUNT(DISTINCT cp.year) as years_with_data,
        MIN(cp.year) as first_year,
        MAX(cp.year) as last_year
    FROM country_production cp
    LEFT JOIN country_prices pc
        ON cp.country_name = pc.country_name
        AND cp.area_code = pc.area_code
        AND cp.year = pc.year
    GROUP BY cp.country_name, cp.area_code
)





SELECT
    country_name,
    area_code,
    -- Production metrics
    ROUND(total_production_all_years, 0) as total_production_metric_tons,
    ROUND(avg_annual_production, 0) as avg_annual_production_metric_tons,
    ROUND(peak_annual_production, 0) as peak_production_metric_tons,
    ROUND(production_change, 0) as production_growth_metric_tons,
    CASE
        WHEN production_change > 0 THEN 'Growing'
        WHEN production_change < 0 THEN 'Declining'
        ELSE 'Stable'
    END as production_trend,
    -- Price metrics
    ROUND(avg_price_all_years, 2) as avg_price_usd_per_tonne,
    ROUND(max_price, 2) as max_price_usd_per_tonne,
    ROUND(min_price, 2) as min_price_usd_per_tonne,
    ROUND(max_price - min_price, 2) as price_volatility,
    -- Product diversity
    max_products_produced,
    ROUND(avg_products_produced, 1) as avg_products_produced,
    -- Classifications
    CASE
        WHEN total_production_all_years > 1000000 THEN 'Major Producer'
        WHEN total_production_all_years > 100000 THEN 'Medium Producer'
        ELSE 'Small Producer'
    END as producer_category,
    CASE
        WHEN avg_price_all_years > 1000 THEN 'High Value'
        WHEN avg_price_all_years > 500 THEN 'Medium Value'
        ELSE 'Low Value'
    END as price_category,
    -- Metadata
    years_with_data,
    first_year,
    last_year,
    CURRENT_TIMESTAMP as calculated_at
FROM country_trends
WHERE total_production_all_years > 0
ORDER BY total_production_all_years DESC
  );
  
[0m10:47:43.955389 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m10:47:43.956392 [debug] [Thread-3 (]: Using postgres connection "model.fao_elt_pipeline.gold_price_production_analysis"
[0m10:47:43.957392 [debug] [Thread-2 (]: Using postgres connection "model.fao_elt_pipeline.gold_regional_summary"
[0m10:47:43.957392 [debug] [Thread-3 (]: On model.fao_elt_pipeline.gold_price_production_analysis: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.gold_price_production_analysis"} */

  
    

  create  table "fao"."public_gold"."gold_price_production_analysis__dbt_tmp"
  
  
    as
  
  (
    

WITH item_production AS (
    SELECT
        item_name,
        item_code,
        year,
        SUM(production_metric_tons) as global_production,
        COUNT(DISTINCT area_code) as producing_countries
    FROM "fao"."public_silver"."silver_production_cleaned"
    WHERE is_valid_production = TRUE
    GROUP BY item_name, item_code, year
),

item_prices AS (
    SELECT
        item_name,
        item_code,
        year,
        AVG(price_value) as avg_global_price,
        MAX(price_value) as max_price,
        MIN(price_value) as min_price,
        COUNT(DISTINCT area_code) as countries_with_prices
    FROM "fao"."public_silver"."silver_prices_cleaned"
    WHERE is_valid_price = TRUE
    GROUP BY item_name, item_code, year
),

price_production_combined AS (
    SELECT
        COALESCE(ip.item_name, ipr.item_name) as item_name,
        COALESCE(ip.item_code, ipr.item_code) as item_code,
        COALESCE(ip.year, ipr.year) as year,
        ip.global_production,
        ip.producing_countries,
        ipr.avg_global_price,
        ipr.max_price,
        ipr.min_price,
        ipr.countries_with_prices,
        -- Calculate price-production metrics
        CASE
            WHEN ip.global_production > 0 AND ipr.avg_global_price > 0
            THEN ipr.avg_global_price * ip.global_production
            ELSE NULL
        END as market_value
    FROM item_production ip
    FULL OUTER JOIN item_prices ipr
        ON ip.item_code = ipr.item_code
        AND ip.year = ipr.year
)

SELECT
    item_name,
    item_code,
    -- Aggregate metrics across all years
    ROUND(AVG(global_production), 0) as avg_annual_production,
    ROUND(SUM(global_production), 0) as total_production_all_years,
    ROUND(AVG(avg_global_price), 2) as avg_price_all_years,
    ROUND(AVG(market_value), 0) as avg_annual_market_value,
    ROUND(SUM(market_value), 0) as total_market_value,
    -- Price volatility
    ROUND(AVG(max_price - min_price), 2) as avg_price_spread,
    ROUND(MAX(max_price), 2) as highest_price_recorded,
    -- Market concentration
    ROUND(AVG(producing_countries), 1) as avg_producing_countries,
    ROUND(AVG(countries_with_prices), 1) as avg_countries_with_prices,
    -- Categorization
    CASE
        WHEN AVG(global_production) > 10000000 THEN 'Major Commodity'
        WHEN AVG(global_production) > 1000000 THEN 'Medium Commodity'
        ELSE 'Minor Commodity'
    END as commodity_scale,
    CASE
        WHEN AVG(avg_global_price) > 2000 THEN 'Premium Product'
        WHEN AVG(avg_global_price) > 500 THEN 'Standard Product'
        ELSE 'Basic Product'
    END as price_tier,
    -- Data quality
    COUNT(DISTINCT year) as years_with_data,
    MIN(year) as first_year,
    MAX(year) as last_year,
    CURRENT_TIMESTAMP as calculated_at
FROM price_production_combined
WHERE item_name IS NOT NULL
GROUP BY item_name, item_code
HAVING COUNT(DISTINCT year) >= 5  -- Only include items with sufficient data
ORDER BY total_market_value DESC NULLS LAST
  );
  
[0m10:47:43.959391 [debug] [Thread-2 (]: On model.fao_elt_pipeline.gold_regional_summary: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.gold_regional_summary"} */

  
    

  create  table "fao"."public_gold"."gold_regional_summary__dbt_tmp"
  
  
    as
  
  (
    

WITH country_regions AS (
    -- Simple regional classification based on country names
    -- In production, you'd use a proper country-region mapping table
    SELECT
        country_name_standardized,
        area_code,
        CASE
            WHEN country_name_standardized IN ('China', 'India', 'Japan', 'Republic of Korea',
                                               'Thailand', 'Pakistan', 'Bangladesh', 'Myanmar') THEN 'Asia'
            WHEN country_name_standardized IN ('USA', 'Canada', 'Mexico') THEN 'North America'
            WHEN country_name_standardized IN ('Brazil', 'Argentina', 'Chile', 'Colombia',
                                               'Peru', 'Ecuador', 'Venezuela (Bolivarian Republic of)',
                                               'Paraguay', 'Uruguay', 'Bolivia (Plurinational State of)') THEN 'South America'
            WHEN country_name_standardized IN ('Germany', 'France', 'UK', 'Italy', 'Spain',
                                               'Poland', 'Netherlands (Kingdom of the)', 'Belgium',
                                               'Greece', 'Portugal', 'Sweden', 'Austria',
                                               'Denmark', 'Finland', 'Norway', 'Switzerland') THEN 'Europe'
            WHEN country_name_standardized IN ('Nigeria', 'Egypt', 'South Africa', 'Kenya',
                                               'Ethiopia', 'Morocco', 'Tunisia', 'Algeria',
                                               'Ghana', 'Ivory Coast', 'Senegal') THEN 'Africa'
            WHEN country_name_standardized IN ('Australia', 'New Zealand', 'Fiji') THEN 'Oceania'
            WHEN country_name_standardized IN ('Saudi Arabia', 'Iran (Islamic Republic of)',
                                               'Iraq', 'Syrian Arab Republic', 'Yemen',
                                               'United Arab Emirates', 'Oman') THEN 'Middle East'
            ELSE 'Other'
        END as region
    FROM (
        SELECT DISTINCT country_name_standardized, area_code
        FROM "fao"."public_silver"."silver_production_cleaned"
        UNION
        SELECT DISTINCT country_name_standardized, area_code
        FROM "fao"."public_silver"."silver_prices_cleaned"
    ) countries
),

regional_production AS (
    SELECT
        cr.region,
        p.year,
        p.item_name,
        SUM(p.production_metric_tons) as regional_production,
        COUNT(DISTINCT p.area_code) as countries_producing,
        AVG(p.production_metric_tons) as avg_country_production
    FROM "fao"."public_silver"."silver_production_cleaned" p
    JOIN country_regions cr
        ON p.country_name_standardized = cr.country_name_standardized
    WHERE p.is_valid_production = TRUE
    GROUP BY cr.region, p.year, p.item_name
),

regional_prices AS (
    SELECT
        cr.region,
        pr.year,
        pr.item_name,
        AVG(pr.price_value) as avg_regional_price,
        MAX(pr.price_value) as max_regional_price,
        MIN(pr.price_value) as min_regional_price,
        COUNT(DISTINCT pr.area_code) as countries_with_prices
    FROM "fao"."public_silver"."silver_prices_cleaned" pr
    JOIN country_regions cr
        ON pr.country_name_standardized = cr.country_name_standardized
    WHERE pr.is_valid_price = TRUE
    GROUP BY cr.region, pr.year, pr.item_name
)

SELECT
    COALESCE(rp.region, rpr.region) as region,
    -- Production metrics
    ROUND(SUM(rp.regional_production), 0) as total_production_metric_tons,
    ROUND(AVG(rp.regional_production), 0) as avg_annual_production,
    COUNT(DISTINCT rp.countries_producing) as total_producing_countries,
    COUNT(DISTINCT rp.item_name) as products_produced,
    -- Price metrics
    ROUND(AVG(rpr.avg_regional_price), 2) as avg_price_usd_per_tonne,
    ROUND(MAX(rpr.max_regional_price), 2) as highest_price_recorded,
    ROUND(AVG(rpr.max_regional_price - rpr.min_regional_price), 2) as avg_price_volatility,
    -- Market value
    ROUND(SUM(
        CASE
            WHEN rp.regional_production > 0 AND rpr.avg_regional_price > 0
            THEN rp.regional_production * rpr.avg_regional_price
            ELSE 0
        END
    ), 0) as total_market_value,
    -- Growth metrics (comparing recent vs early years)
    ROUND(
        AVG(CASE WHEN rp.year >= 2018 THEN rp.regional_production END) -
        AVG(CASE WHEN rp.year <= 1995 THEN rp.regional_production END),
        0
    ) as production_growth,
    -- Regional characteristics
    CASE
        WHEN SUM(rp.regional_production) > 100000000 THEN 'Major Agricultural Region'
        WHEN SUM(rp.regional_production) > 10000000 THEN 'Medium Agricultural Region'
        ELSE 'Minor Agricultural Region'
    END as regional_scale,
    -- Data coverage
    COUNT(DISTINCT COALESCE(rp.year, rpr.year)) as years_with_data,
    MIN(COALESCE(rp.year, rpr.year)) as first_year,
    MAX(COALESCE(rp.year, rpr.year)) as last_year,
    CURRENT_TIMESTAMP as calculated_at
FROM regional_production rp
FULL OUTER JOIN regional_prices rpr
    ON rp.region = rpr.region
    AND rp.year = rpr.year
    AND rp.item_name = rpr.item_name
WHERE COALESCE(rp.region, rpr.region) != 'Other'
GROUP BY COALESCE(rp.region, rpr.region)
ORDER BY total_production_metric_tons DESC
  );
  
[0m10:47:43.963393 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:47:43.963393 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.0 seconds
[0m10:47:43.964392 [debug] [Thread-1 (]: Using postgres connection "model.fao_elt_pipeline.silver_top_countries"
[0m10:47:43.968390 [debug] [Thread-4 (]: Using postgres connection "model.fao_elt_pipeline.gold_country_metrics"
[0m10:47:43.969391 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.0 seconds
[0m10:47:43.969391 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.0 seconds
[0m10:47:43.970392 [debug] [Thread-1 (]: On model.fao_elt_pipeline.silver_top_countries: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.silver_top_countries"} */

  
    

  create  table "fao"."public_silver"."silver_top_countries__dbt_tmp"
  
  
    as
  
  (
    

WITH production_rankings AS (
    SELECT
        country_name_standardized,
        area_code,
        SUM(production_metric_tons) as total_production,
        COUNT(DISTINCT item_code) as product_diversity,
        COUNT(DISTINCT year) as years_of_data,
        AVG(production_metric_tons) as avg_annual_production,
        MAX(year) as latest_year
    FROM "fao"."public_silver"."silver_production_cleaned"
    WHERE is_valid_production = TRUE
    GROUP BY country_name_standardized, area_code
),

price_rankings AS (
    SELECT
        country_name_standardized,
        area_code,
        AVG(price_value) as avg_price,
        COUNT(DISTINCT item_code) as items_with_prices,
        MAX(price_value) as max_price,
        MIN(price_value) as min_price
    FROM "fao"."public_silver"."silver_prices_cleaned"
    WHERE is_valid_price = TRUE
    GROUP BY country_name_standardized, area_code
),

combined_rankings AS (
    SELECT
        COALESCE(pr.country_name_standardized, pc.country_name_standardized) as country_name,
        COALESCE(pr.area_code, pc.area_code) as area_code,
        pr.total_production,
        pr.product_diversity,
        pr.avg_annual_production,
        pc.avg_price,
        pc.items_with_prices,
        pc.max_price,
        -- Calculate rankings
        RANK() OVER (ORDER BY pr.total_production DESC NULLS LAST) as production_rank,
        RANK() OVER (ORDER BY pc.avg_price DESC NULLS LAST) as price_rank,
        RANK() OVER (ORDER BY pr.product_diversity DESC NULLS LAST) as diversity_rank
    FROM production_rankings pr
    FULL OUTER JOIN price_rankings pc
        ON pr.country_name_standardized = pc.country_name_standardized
        AND pr.area_code = pc.area_code
)

SELECT
    country_name,
    area_code,
    total_production,
    product_diversity,
    ROUND(avg_annual_production, 2) as avg_annual_production,
    ROUND(avg_price, 2) as avg_price_usd_per_tonne,
    items_with_prices,
    ROUND(max_price, 2) as max_price_usd_per_tonne,
    production_rank,
    price_rank,
    diversity_rank,
    -- Identify top performers
    CASE
        WHEN production_rank <= 10 THEN TRUE
        ELSE FALSE
    END as is_top_producer,
    CASE
        WHEN price_rank <= 10 THEN TRUE
        ELSE FALSE
    END as is_high_price_country,
    CASE
        WHEN diversity_rank <= 10 THEN TRUE
        ELSE FALSE
    END as is_diverse_producer,
    CURRENT_TIMESTAMP as calculated_at
FROM combined_rankings
WHERE country_name IS NOT NULL
  );
  
[0m10:47:43.971391 [debug] [Thread-4 (]: On model.fao_elt_pipeline.gold_country_metrics: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.gold_country_metrics"} */
alter table "fao"."public_gold"."gold_country_metrics__dbt_tmp" rename to "gold_country_metrics"
[0m10:47:43.975391 [debug] [Thread-3 (]: Using postgres connection "model.fao_elt_pipeline.gold_price_production_analysis"
[0m10:47:43.978388 [debug] [Thread-2 (]: Using postgres connection "model.fao_elt_pipeline.gold_regional_summary"
[0m10:47:43.980391 [debug] [Thread-3 (]: On model.fao_elt_pipeline.gold_price_production_analysis: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.gold_price_production_analysis"} */
alter table "fao"."public_gold"."gold_price_production_analysis__dbt_tmp" rename to "gold_price_production_analysis"
[0m10:47:43.980391 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:47:43.981390 [debug] [Thread-2 (]: On model.fao_elt_pipeline.gold_regional_summary: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.gold_regional_summary"} */
alter table "fao"."public_gold"."gold_regional_summary__dbt_tmp" rename to "gold_regional_summary"
[0m10:47:43.983388 [debug] [Thread-4 (]: Using postgres connection "model.fao_elt_pipeline.gold_country_metrics"
[0m10:47:43.984483 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:47:43.985004 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.0 seconds
[0m10:47:43.986004 [debug] [Thread-4 (]: On model.fao_elt_pipeline.gold_country_metrics: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.gold_country_metrics"} */

    create  index if not exists
  "e57b1ba16d07c0923fe7c2f6f7554c0c"
  on "fao"."public_gold"."gold_country_metrics" using btree
  (country_name)
  
[0m10:47:43.987004 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:47:43.989005 [debug] [Thread-3 (]: On model.fao_elt_pipeline.gold_price_production_analysis: COMMIT
[0m10:47:43.992004 [debug] [Thread-1 (]: Using postgres connection "model.fao_elt_pipeline.silver_top_countries"
[0m10:47:43.994005 [debug] [Thread-2 (]: On model.fao_elt_pipeline.gold_regional_summary: COMMIT
[0m10:47:43.995658 [debug] [Thread-3 (]: Using postgres connection "model.fao_elt_pipeline.gold_price_production_analysis"
[0m10:47:43.996198 [debug] [Thread-4 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m10:47:43.997277 [debug] [Thread-1 (]: On model.fao_elt_pipeline.silver_top_countries: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.silver_top_countries"} */
alter table "fao"."public_silver"."silver_top_countries__dbt_tmp" rename to "silver_top_countries"
[0m10:47:43.997801 [debug] [Thread-2 (]: Using postgres connection "model.fao_elt_pipeline.gold_regional_summary"
[0m10:47:43.998850 [debug] [Thread-3 (]: On model.fao_elt_pipeline.gold_price_production_analysis: COMMIT
[0m10:47:44.000470 [debug] [Thread-4 (]: On model.fao_elt_pipeline.gold_country_metrics: COMMIT
[0m10:47:44.001519 [debug] [Thread-2 (]: On model.fao_elt_pipeline.gold_regional_summary: COMMIT
[0m10:47:44.002048 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:47:44.003098 [debug] [Thread-4 (]: Using postgres connection "model.fao_elt_pipeline.gold_country_metrics"
[0m10:47:44.005208 [debug] [Thread-1 (]: On model.fao_elt_pipeline.silver_top_countries: COMMIT
[0m10:47:44.005733 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m10:47:44.006266 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m10:47:44.006773 [debug] [Thread-4 (]: On model.fao_elt_pipeline.gold_country_metrics: COMMIT
[0m10:47:44.007779 [debug] [Thread-1 (]: Using postgres connection "model.fao_elt_pipeline.silver_top_countries"
[0m10:47:44.010781 [debug] [Thread-3 (]: Applying DROP to: "fao"."public_gold"."gold_price_production_analysis__dbt_backup"
[0m10:47:44.014781 [debug] [Thread-2 (]: Applying DROP to: "fao"."public_gold"."gold_regional_summary__dbt_backup"
[0m10:47:44.015780 [debug] [Thread-1 (]: On model.fao_elt_pipeline.silver_top_countries: COMMIT
[0m10:47:44.016782 [debug] [Thread-3 (]: Using postgres connection "model.fao_elt_pipeline.gold_price_production_analysis"
[0m10:47:44.016782 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m10:47:44.017781 [debug] [Thread-2 (]: Using postgres connection "model.fao_elt_pipeline.gold_regional_summary"
[0m10:47:44.018781 [debug] [Thread-3 (]: On model.fao_elt_pipeline.gold_price_production_analysis: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.gold_price_production_analysis"} */
drop table if exists "fao"."public_gold"."gold_price_production_analysis__dbt_backup" cascade
[0m10:47:44.021781 [debug] [Thread-4 (]: Applying DROP to: "fao"."public_gold"."gold_country_metrics__dbt_backup"
[0m10:47:44.022779 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m10:47:44.023779 [debug] [Thread-2 (]: On model.fao_elt_pipeline.gold_regional_summary: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.gold_regional_summary"} */
drop table if exists "fao"."public_gold"."gold_regional_summary__dbt_backup" cascade
[0m10:47:44.024781 [debug] [Thread-4 (]: Using postgres connection "model.fao_elt_pipeline.gold_country_metrics"
[0m10:47:44.025781 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:47:44.027778 [debug] [Thread-1 (]: Applying DROP to: "fao"."public_silver"."silver_top_countries__dbt_backup"
[0m10:47:44.028779 [debug] [Thread-4 (]: On model.fao_elt_pipeline.gold_country_metrics: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.gold_country_metrics"} */
drop table if exists "fao"."public_gold"."gold_country_metrics__dbt_backup" cascade
[0m10:47:44.029781 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:47:44.031779 [debug] [Thread-3 (]: On model.fao_elt_pipeline.gold_price_production_analysis: Close
[0m10:47:44.032779 [debug] [Thread-1 (]: Using postgres connection "model.fao_elt_pipeline.silver_top_countries"
[0m10:47:44.033780 [debug] [Thread-2 (]: On model.fao_elt_pipeline.gold_regional_summary: Close
[0m10:47:44.034779 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:47:44.035778 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b469a0a2-a460-491c-a7cc-1a74b20a9e98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001296E46A500>]}
[0m10:47:44.036780 [debug] [Thread-1 (]: On model.fao_elt_pipeline.silver_top_countries: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.silver_top_countries"} */
drop table if exists "fao"."public_silver"."silver_top_countries__dbt_backup" cascade
[0m10:47:44.037780 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b469a0a2-a460-491c-a7cc-1a74b20a9e98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001296DEE9150>]}
[0m10:47:44.038782 [debug] [Thread-4 (]: On model.fao_elt_pipeline.gold_country_metrics: Close
[0m10:47:44.039781 [info ] [Thread-3 (]: 4 of 6 OK created sql table model public_gold.gold_price_production_analysis ... [[32mSELECT 0[0m in 0.15s]
[0m10:47:44.040780 [info ] [Thread-2 (]: 5 of 6 OK created sql table model public_gold.gold_regional_summary ............ [[32mSELECT 0[0m in 0.15s]
[0m10:47:44.041780 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:47:44.042779 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b469a0a2-a460-491c-a7cc-1a74b20a9e98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001296CC40910>]}
[0m10:47:44.043780 [debug] [Thread-3 (]: Finished running node model.fao_elt_pipeline.gold_price_production_analysis
[0m10:47:44.044779 [debug] [Thread-2 (]: Finished running node model.fao_elt_pipeline.gold_regional_summary
[0m10:47:44.046779 [debug] [Thread-1 (]: On model.fao_elt_pipeline.silver_top_countries: Close
[0m10:47:44.047779 [info ] [Thread-4 (]: 3 of 6 OK created sql table model public_gold.gold_country_metrics ............. [[32mSELECT 0[0m in 0.16s]
[0m10:47:44.048780 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b469a0a2-a460-491c-a7cc-1a74b20a9e98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001296DC9BA90>]}
[0m10:47:44.049780 [debug] [Thread-4 (]: Finished running node model.fao_elt_pipeline.gold_country_metrics
[0m10:47:44.050779 [info ] [Thread-1 (]: 6 of 6 OK created sql table model public_silver.silver_top_countries ........... [[32mSELECT 0[0m in 0.17s]
[0m10:47:44.051780 [debug] [Thread-1 (]: Finished running node model.fao_elt_pipeline.silver_top_countries
[0m10:47:44.053781 [debug] [MainThread]: Using postgres connection "master"
[0m10:47:44.053781 [debug] [MainThread]: On master: BEGIN
[0m10:47:44.054779 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:47:44.067779 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:47:44.068781 [debug] [MainThread]: On master: COMMIT
[0m10:47:44.069779 [debug] [MainThread]: Using postgres connection "master"
[0m10:47:44.070778 [debug] [MainThread]: On master: COMMIT
[0m10:47:44.071780 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:47:44.071780 [debug] [MainThread]: On master: Close
[0m10:47:44.072780 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:47:44.073781 [debug] [MainThread]: Connection 'create_fao_public_silver' was properly closed.
[0m10:47:44.073781 [debug] [MainThread]: Connection 'create_fao_public_gold' was properly closed.
[0m10:47:44.074781 [debug] [MainThread]: Connection 'list_fao_public_gold' was properly closed.
[0m10:47:44.075781 [debug] [MainThread]: Connection 'list_fao_public_silver' was properly closed.
[0m10:47:44.075781 [debug] [MainThread]: Connection 'model.fao_elt_pipeline.silver_top_countries' was properly closed.
[0m10:47:44.076781 [debug] [MainThread]: Connection 'model.fao_elt_pipeline.gold_regional_summary' was properly closed.
[0m10:47:44.077781 [debug] [MainThread]: Connection 'model.fao_elt_pipeline.gold_country_metrics' was properly closed.
[0m10:47:44.078779 [debug] [MainThread]: Connection 'model.fao_elt_pipeline.gold_price_production_analysis' was properly closed.
[0m10:47:44.078779 [info ] [MainThread]: 
[0m10:47:44.079781 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 2.33 seconds (2.33s).
[0m10:47:44.081778 [debug] [MainThread]: Command end result
[0m10:47:44.123779 [info ] [MainThread]: 
[0m10:47:44.124778 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:47:44.125778 [info ] [MainThread]: 
[0m10:47:44.125778 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m10:47:44.127778 [debug] [MainThread]: Command `dbt run` succeeded at 10:47:44.127778 after 5.97 seconds
[0m10:47:44.127778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012969A47580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012969661780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001296E0D30A0>]}
[0m10:47:44.128778 [debug] [MainThread]: Flushing usage events
[0m10:53:21.959981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002315D85B4F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231605C3610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231605C3430>]}


============================== 10:53:21.963982 | 5cafca92-5664-4e3e-b775-8bfc932a7129 ==============================
[0m10:53:21.963982 [info ] [MainThread]: Running with dbt=1.8.0
[0m10:53:21.963982 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\18057\\Documents\\Coding\\fao-elt-pipelines\\dbt_project', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\18057\\Documents\\Coding\\fao-elt-pipelines\\dbt_project\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --target dev', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:53:22.122591 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m10:53:22.123592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5cafca92-5664-4e3e-b775-8bfc932a7129', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002316057A290>]}
[0m10:53:22.226182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5cafca92-5664-4e3e-b775-8bfc932a7129', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002315DB244C0>]}
[0m10:53:22.309081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5cafca92-5664-4e3e-b775-8bfc932a7129', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002315D4B1900>]}
[0m10:53:22.311082 [info ] [MainThread]: Registered adapter: postgres=1.8.0
[0m10:53:22.321079 [debug] [MainThread]: checksum: 2a6c64e758918535ccc035b9d143fb4c91b01df5f630e583361ba23a87d2a511, vars: {}, profile: , target: dev, version: 1.8.0
[0m10:53:22.566333 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:53:22.567333 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:53:22.575333 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.fao_elt_pipeline.bronze
[0m10:53:22.644898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5cafca92-5664-4e3e-b775-8bfc932a7129', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023160A79F90>]}
[0m10:53:22.823483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5cafca92-5664-4e3e-b775-8bfc932a7129', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023160A100D0>]}
[0m10:53:22.824484 [info ] [MainThread]: Found 6 models, 23 data tests, 2 sources, 414 macros
[0m10:53:22.825485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5cafca92-5664-4e3e-b775-8bfc932a7129', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023160A11DE0>]}
[0m10:53:22.828483 [info ] [MainThread]: 
[0m10:53:22.829484 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:53:22.834483 [debug] [ThreadPool]: Acquiring new postgres connection 'list_fao'
[0m10:53:22.835484 [debug] [ThreadPool]: Acquiring new postgres connection 'list_fao'
[0m10:53:22.924483 [debug] [ThreadPool]: Using postgres connection "list_fao"
[0m10:53:22.924483 [debug] [ThreadPool]: Using postgres connection "list_fao"
[0m10:53:22.925484 [debug] [ThreadPool]: On list_fao: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "connection_name": "list_fao"} */

    select distinct nspname from pg_namespace
  
[0m10:53:22.926483 [debug] [ThreadPool]: On list_fao: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "connection_name": "list_fao"} */

    select distinct nspname from pg_namespace
  
[0m10:53:22.926483 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:53:22.927483 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:53:22.947483 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m10:53:22.948483 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m10:53:22.949484 [debug] [ThreadPool]: On list_fao: Close
[0m10:53:22.951482 [debug] [ThreadPool]: On list_fao: Close
[0m10:53:22.954484 [debug] [ThreadPool]: Acquiring new postgres connection 'list_fao_public_silver'
[0m10:53:22.955485 [debug] [ThreadPool]: Acquiring new postgres connection 'list_fao_public_gold'
[0m10:53:23.003485 [debug] [ThreadPool]: Using postgres connection "list_fao_public_silver"
[0m10:53:23.006486 [debug] [ThreadPool]: Using postgres connection "list_fao_public_gold"
[0m10:53:23.007485 [debug] [ThreadPool]: On list_fao_public_silver: BEGIN
[0m10:53:23.007485 [debug] [ThreadPool]: On list_fao_public_gold: BEGIN
[0m10:53:23.008484 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:53:23.009482 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:53:23.023120 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:53:23.023120 [debug] [ThreadPool]: Using postgres connection "list_fao_public_silver"
[0m10:53:23.024129 [debug] [ThreadPool]: On list_fao_public_silver: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "connection_name": "list_fao_public_silver"} */
select
      'fao' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'fao' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'fao' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m10:53:23.028129 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m10:53:23.029129 [debug] [ThreadPool]: On list_fao_public_silver: ROLLBACK
[0m10:53:23.031132 [debug] [ThreadPool]: On list_fao_public_silver: Close
[0m10:53:23.032131 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:53:23.033130 [debug] [ThreadPool]: Using postgres connection "list_fao_public_gold"
[0m10:53:23.034130 [debug] [ThreadPool]: On list_fao_public_gold: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "connection_name": "list_fao_public_gold"} */
select
      'fao' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'fao' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'fao' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m10:53:23.037129 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m10:53:23.039131 [debug] [ThreadPool]: On list_fao_public_gold: ROLLBACK
[0m10:53:23.040127 [debug] [ThreadPool]: On list_fao_public_gold: Close
[0m10:53:23.047131 [debug] [MainThread]: Using postgres connection "master"
[0m10:53:23.047131 [debug] [MainThread]: On master: BEGIN
[0m10:53:23.048127 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:53:23.078542 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:53:23.079543 [debug] [MainThread]: Using postgres connection "master"
[0m10:53:23.080543 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:53:23.085542 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m10:53:23.087543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5cafca92-5664-4e3e-b775-8bfc932a7129', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023160997B20>]}
[0m10:53:23.088543 [debug] [MainThread]: On master: ROLLBACK
[0m10:53:23.089543 [debug] [MainThread]: Using postgres connection "master"
[0m10:53:23.090543 [debug] [MainThread]: On master: BEGIN
[0m10:53:23.092542 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:53:23.092542 [debug] [MainThread]: On master: COMMIT
[0m10:53:23.093543 [debug] [MainThread]: Using postgres connection "master"
[0m10:53:23.093543 [debug] [MainThread]: On master: COMMIT
[0m10:53:23.095543 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:53:23.095543 [debug] [MainThread]: On master: Close
[0m10:53:23.096544 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:53:23.097542 [info ] [MainThread]: 
[0m10:53:23.100543 [debug] [Thread-1 (]: Began running node model.fao_elt_pipeline.silver_prices_cleaned
[0m10:53:23.101543 [debug] [Thread-2 (]: Began running node model.fao_elt_pipeline.silver_production_cleaned
[0m10:53:23.102543 [info ] [Thread-1 (]: 1 of 6 START sql table model public_silver.silver_prices_cleaned ............... [RUN]
[0m10:53:23.103543 [info ] [Thread-2 (]: 2 of 6 START sql table model public_silver.silver_production_cleaned ........... [RUN]
[0m10:53:23.104544 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.fao_elt_pipeline.silver_prices_cleaned'
[0m10:53:23.105543 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.fao_elt_pipeline.silver_production_cleaned'
[0m10:53:23.106543 [debug] [Thread-1 (]: Began compiling node model.fao_elt_pipeline.silver_prices_cleaned
[0m10:53:23.107543 [debug] [Thread-2 (]: Began compiling node model.fao_elt_pipeline.silver_production_cleaned
[0m10:53:23.121543 [debug] [Thread-1 (]: Writing injected SQL for node "model.fao_elt_pipeline.silver_prices_cleaned"
[0m10:53:23.126542 [debug] [Thread-2 (]: Writing injected SQL for node "model.fao_elt_pipeline.silver_production_cleaned"
[0m10:53:23.127543 [debug] [Thread-1 (]: Began executing node model.fao_elt_pipeline.silver_prices_cleaned
[0m10:53:23.148541 [debug] [Thread-2 (]: Began executing node model.fao_elt_pipeline.silver_production_cleaned
[0m10:53:23.177541 [debug] [Thread-1 (]: Writing runtime sql for node "model.fao_elt_pipeline.silver_prices_cleaned"
[0m10:53:23.182542 [debug] [Thread-2 (]: Writing runtime sql for node "model.fao_elt_pipeline.silver_production_cleaned"
[0m10:53:23.183543 [debug] [Thread-1 (]: Using postgres connection "model.fao_elt_pipeline.silver_prices_cleaned"
[0m10:53:23.184545 [debug] [Thread-1 (]: On model.fao_elt_pipeline.silver_prices_cleaned: BEGIN
[0m10:53:23.184545 [debug] [Thread-2 (]: Using postgres connection "model.fao_elt_pipeline.silver_production_cleaned"
[0m10:53:23.185543 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:53:23.186542 [debug] [Thread-2 (]: On model.fao_elt_pipeline.silver_production_cleaned: BEGIN
[0m10:53:23.187542 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:53:23.200541 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:53:23.200541 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m10:53:23.201543 [debug] [Thread-1 (]: Using postgres connection "model.fao_elt_pipeline.silver_prices_cleaned"
[0m10:53:23.202541 [debug] [Thread-2 (]: Using postgres connection "model.fao_elt_pipeline.silver_production_cleaned"
[0m10:53:23.203542 [debug] [Thread-1 (]: On model.fao_elt_pipeline.silver_prices_cleaned: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.silver_prices_cleaned"} */

  
    

  create  table "fao"."public_silver"."silver_prices_cleaned__dbt_tmp"
  
  
    as
  
  (
    

WITH raw_prices AS (
    SELECT
        data,
        loaded_at
    FROM "fao"."bronze"."raw_prices"
),

flattened_prices AS (
    SELECT
        (data->>'area')::TEXT as country_name,
        (data->>'area_code')::TEXT as area_code,
        (data->>'area_code_m49')::TEXT as area_code_m49,
        (data->>'element')::TEXT as element_name,
        (data->>'element_code')::TEXT as element_code,
        (data->>'flag')::TEXT as flag,
        (data->>'item')::TEXT as item_name,
        (data->>'item_code')::TEXT as item_code,
        (data->>'item_code_cpc')::TEXT as item_code_cpc,
        (data->>'unit')::TEXT as unit,
        (data->>'value')::NUMERIC as price_value,
        (data->>'year')::INTEGER as year,
        loaded_at
    FROM raw_prices
)

SELECT
    
    md5(
            coalesce(cast(area_code as varchar), '') || '-' || 
            coalesce(cast(item_code as varchar), '') || '-' || 
            coalesce(cast(year as varchar), '')
    )
 as price_id,
    country_name,
    area_code,
    area_code_m49,
    element_name,
    element_code,
    flag,
    item_name,
    item_code,
    item_code_cpc,
    unit,
    price_value,
    year,
    -- Add data quality flags
    CASE
        WHEN price_value IS NULL OR price_value <= 0 THEN FALSE
        ELSE TRUE
    END as is_valid_price,
    -- Add standardized country names (handle special characters)
    CASE
        WHEN country_name LIKE '%Côte%' THEN 'Ivory Coast'
        WHEN country_name = 'China, mainland' THEN 'China'
        WHEN country_name = 'United States of America' THEN 'USA'
        WHEN country_name = 'United Kingdom of Great Britain and Northern Ireland' THEN 'UK'
        ELSE country_name
    END as country_name_standardized,
    loaded_at,
    CURRENT_TIMESTAMP as transformed_at
FROM flattened_prices
WHERE price_value IS NOT NULL
  AND price_value > 0
  AND year >= 1990  -- Focus on more recent data
  );
  
[0m10:53:23.204543 [debug] [Thread-2 (]: On model.fao_elt_pipeline.silver_production_cleaned: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.silver_production_cleaned"} */

  
    

  create  table "fao"."public_silver"."silver_production_cleaned__dbt_tmp"
  
  
    as
  
  (
    

WITH raw_production AS (
    SELECT
        data,
        loaded_at
    FROM "fao"."bronze"."raw_food_balance"
),

flattened_production AS (
    SELECT
        (data->>'area')::TEXT as country_name,
        (data->>'area_code')::TEXT as area_code,
        (data->>'area_code_m49')::TEXT as area_code_m49,
        (data->>'element')::TEXT as element_name,
        (data->>'element_code')::TEXT as element_code,
        (data->>'flag')::TEXT as flag,
        (data->>'item')::TEXT as item_name,
        (data->>'item_code')::TEXT as item_code,
        (data->>'item_code_fbs')::TEXT as item_code_fbs,
        (data->>'unit')::TEXT as unit,
        (data->>'value')::NUMERIC as production_value,
        (data->>'year')::INTEGER as year,
        loaded_at
    FROM raw_production
)

SELECT
    
    md5(
            coalesce(cast(area_code as varchar), '') || '-' || 
            coalesce(cast(item_code as varchar), '') || '-' || 
            coalesce(cast(year as varchar), '')
    )
 as production_id,
    country_name,
    area_code,
    area_code_m49,
    element_name,
    element_code,
    flag,
    item_name,
    item_code,
    item_code_fbs,
    unit,
    production_value,
    year,
    -- Convert to metric tons for consistency
    CASE
        WHEN unit = '1000 t' THEN production_value * 1000
        ELSE production_value
    END as production_metric_tons,
    -- Add data quality flags
    CASE
        WHEN production_value IS NULL OR production_value < 0 THEN FALSE
        ELSE TRUE
    END as is_valid_production,
    -- Add standardized country names
    CASE
        WHEN country_name LIKE '%Côte%' THEN 'Ivory Coast'
        WHEN country_name = 'China, mainland' THEN 'China'
        WHEN country_name = 'United States of America' THEN 'USA'
        WHEN country_name = 'United Kingdom of Great Britain and Northern Ireland' THEN 'UK'
        ELSE country_name
    END as country_name_standardized,
    loaded_at,
    CURRENT_TIMESTAMP as transformed_at
FROM flattened_production
WHERE element_name = 'Production'  -- Focus on production data only
  AND production_value >= 0
  AND year >= 1990
  );
  
[0m10:53:23.210240 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.0 seconds
[0m10:53:23.211238 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.0 seconds
[0m10:53:23.219241 [debug] [Thread-2 (]: Using postgres connection "model.fao_elt_pipeline.silver_production_cleaned"
[0m10:53:23.223237 [debug] [Thread-1 (]: Using postgres connection "model.fao_elt_pipeline.silver_prices_cleaned"
[0m10:53:23.224238 [debug] [Thread-2 (]: On model.fao_elt_pipeline.silver_production_cleaned: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.silver_production_cleaned"} */
alter table "fao"."public_silver"."silver_production_cleaned" rename to "silver_production_cleaned__dbt_backup"
[0m10:53:23.225239 [debug] [Thread-1 (]: On model.fao_elt_pipeline.silver_prices_cleaned: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.silver_prices_cleaned"} */
alter table "fao"."public_silver"."silver_prices_cleaned" rename to "silver_prices_cleaned__dbt_backup"
[0m10:53:23.226776 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:53:23.226776 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:53:23.230786 [debug] [Thread-2 (]: Using postgres connection "model.fao_elt_pipeline.silver_production_cleaned"
[0m10:53:23.233785 [debug] [Thread-1 (]: Using postgres connection "model.fao_elt_pipeline.silver_prices_cleaned"
[0m10:53:23.234786 [debug] [Thread-2 (]: On model.fao_elt_pipeline.silver_production_cleaned: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.silver_production_cleaned"} */
alter table "fao"."public_silver"."silver_production_cleaned__dbt_tmp" rename to "silver_production_cleaned"
[0m10:53:23.235786 [debug] [Thread-1 (]: On model.fao_elt_pipeline.silver_prices_cleaned: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.silver_prices_cleaned"} */
alter table "fao"."public_silver"."silver_prices_cleaned__dbt_tmp" rename to "silver_prices_cleaned"
[0m10:53:23.236786 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:53:23.237786 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:53:23.255787 [debug] [Thread-2 (]: Using postgres connection "model.fao_elt_pipeline.silver_production_cleaned"
[0m10:53:23.259786 [debug] [Thread-1 (]: Using postgres connection "model.fao_elt_pipeline.silver_prices_cleaned"
[0m10:53:23.259786 [debug] [Thread-2 (]: On model.fao_elt_pipeline.silver_production_cleaned: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.silver_production_cleaned"} */

    create  index if not exists
  "b5ec2bccdd37925680883c05d31978ac"
  on "fao"."public_silver"."silver_production_cleaned" using btree
  (area_code, year)
  
[0m10:53:23.260784 [debug] [Thread-1 (]: On model.fao_elt_pipeline.silver_prices_cleaned: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.silver_prices_cleaned"} */

    create  index if not exists
  "fd43941aee4e4abd93609e7fcf4fbb61"
  on "fao"."public_silver"."silver_prices_cleaned" using btree
  (area_code, year)
  
[0m10:53:23.264787 [debug] [Thread-2 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m10:53:23.264787 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m10:53:23.266786 [debug] [Thread-2 (]: Using postgres connection "model.fao_elt_pipeline.silver_production_cleaned"
[0m10:53:23.268787 [debug] [Thread-1 (]: Using postgres connection "model.fao_elt_pipeline.silver_prices_cleaned"
[0m10:53:23.269784 [debug] [Thread-2 (]: On model.fao_elt_pipeline.silver_production_cleaned: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.silver_production_cleaned"} */

    create  index if not exists
  "6856473badd4fb83390aa8117ee8716f"
  on "fao"."public_silver"."silver_production_cleaned" using btree
  (item_code)
  
[0m10:53:23.270784 [debug] [Thread-1 (]: On model.fao_elt_pipeline.silver_prices_cleaned: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.silver_prices_cleaned"} */

    create  index if not exists
  "22d451488618fce3f255f89afa1337c6"
  on "fao"."public_silver"."silver_prices_cleaned" using btree
  (item_code)
  
[0m10:53:23.273786 [debug] [Thread-2 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m10:53:23.293787 [debug] [Thread-2 (]: On model.fao_elt_pipeline.silver_production_cleaned: COMMIT
[0m10:53:23.294788 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m10:53:23.295788 [debug] [Thread-2 (]: Using postgres connection "model.fao_elt_pipeline.silver_production_cleaned"
[0m10:53:23.297786 [debug] [Thread-1 (]: On model.fao_elt_pipeline.silver_prices_cleaned: COMMIT
[0m10:53:23.298785 [debug] [Thread-2 (]: On model.fao_elt_pipeline.silver_production_cleaned: COMMIT
[0m10:53:23.298785 [debug] [Thread-1 (]: Using postgres connection "model.fao_elt_pipeline.silver_prices_cleaned"
[0m10:53:23.299786 [debug] [Thread-1 (]: On model.fao_elt_pipeline.silver_prices_cleaned: COMMIT
[0m10:53:23.301785 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m10:53:23.301785 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m10:53:23.309786 [debug] [Thread-2 (]: Applying DROP to: "fao"."public_silver"."silver_production_cleaned__dbt_backup"
[0m10:53:23.313784 [debug] [Thread-1 (]: Applying DROP to: "fao"."public_silver"."silver_prices_cleaned__dbt_backup"
[0m10:53:23.318786 [debug] [Thread-2 (]: Using postgres connection "model.fao_elt_pipeline.silver_production_cleaned"
[0m10:53:23.319786 [debug] [Thread-1 (]: Using postgres connection "model.fao_elt_pipeline.silver_prices_cleaned"
[0m10:53:23.320784 [debug] [Thread-2 (]: On model.fao_elt_pipeline.silver_production_cleaned: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.silver_production_cleaned"} */
drop table if exists "fao"."public_silver"."silver_production_cleaned__dbt_backup" cascade
[0m10:53:23.320784 [debug] [Thread-1 (]: On model.fao_elt_pipeline.silver_prices_cleaned: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.silver_prices_cleaned"} */
drop table if exists "fao"."public_silver"."silver_prices_cleaned__dbt_backup" cascade
[0m10:53:23.326115 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:53:23.327116 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:53:23.330113 [debug] [Thread-1 (]: On model.fao_elt_pipeline.silver_prices_cleaned: Close
[0m10:53:23.331114 [debug] [Thread-2 (]: On model.fao_elt_pipeline.silver_production_cleaned: Close
[0m10:53:23.333115 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5cafca92-5664-4e3e-b775-8bfc932a7129', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231607069E0>]}
[0m10:53:23.334116 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5cafca92-5664-4e3e-b775-8bfc932a7129', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023160707700>]}
[0m10:53:23.335116 [info ] [Thread-1 (]: 1 of 6 OK created sql table model public_silver.silver_prices_cleaned .......... [[32mSELECT 0[0m in 0.23s]
[0m10:53:23.336115 [info ] [Thread-2 (]: 2 of 6 OK created sql table model public_silver.silver_production_cleaned ...... [[32mSELECT 0[0m in 0.23s]
[0m10:53:23.337115 [debug] [Thread-1 (]: Finished running node model.fao_elt_pipeline.silver_prices_cleaned
[0m10:53:23.338115 [debug] [Thread-2 (]: Finished running node model.fao_elt_pipeline.silver_production_cleaned
[0m10:53:23.340113 [debug] [Thread-4 (]: Began running node model.fao_elt_pipeline.gold_country_metrics
[0m10:53:23.340113 [debug] [Thread-3 (]: Began running node model.fao_elt_pipeline.gold_price_production_analysis
[0m10:53:23.341116 [debug] [Thread-1 (]: Began running node model.fao_elt_pipeline.gold_regional_summary
[0m10:53:23.342114 [debug] [Thread-2 (]: Began running node model.fao_elt_pipeline.silver_top_countries
[0m10:53:23.342114 [info ] [Thread-4 (]: 3 of 6 START sql table model public_gold.gold_country_metrics .................. [RUN]
[0m10:53:23.343113 [info ] [Thread-3 (]: 4 of 6 START sql table model public_gold.gold_price_production_analysis ........ [RUN]
[0m10:53:23.344113 [info ] [Thread-1 (]: 5 of 6 START sql table model public_gold.gold_regional_summary ................. [RUN]
[0m10:53:23.345115 [info ] [Thread-2 (]: 6 of 6 START sql table model public_silver.silver_top_countries ................ [RUN]
[0m10:53:23.346114 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.fao_elt_pipeline.gold_country_metrics'
[0m10:53:23.347112 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.fao_elt_pipeline.gold_price_production_analysis'
[0m10:53:23.348113 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fao_elt_pipeline.silver_prices_cleaned, now model.fao_elt_pipeline.gold_regional_summary)
[0m10:53:23.348113 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.fao_elt_pipeline.silver_production_cleaned, now model.fao_elt_pipeline.silver_top_countries)
[0m10:53:23.349115 [debug] [Thread-4 (]: Began compiling node model.fao_elt_pipeline.gold_country_metrics
[0m10:53:23.350114 [debug] [Thread-3 (]: Began compiling node model.fao_elt_pipeline.gold_price_production_analysis
[0m10:53:23.351115 [debug] [Thread-1 (]: Began compiling node model.fao_elt_pipeline.gold_regional_summary
[0m10:53:23.351115 [debug] [Thread-2 (]: Began compiling node model.fao_elt_pipeline.silver_top_countries
[0m10:53:23.357115 [debug] [Thread-4 (]: Writing injected SQL for node "model.fao_elt_pipeline.gold_country_metrics"
[0m10:53:23.361115 [debug] [Thread-3 (]: Writing injected SQL for node "model.fao_elt_pipeline.gold_price_production_analysis"
[0m10:53:23.366113 [debug] [Thread-1 (]: Writing injected SQL for node "model.fao_elt_pipeline.gold_regional_summary"
[0m10:53:23.370112 [debug] [Thread-2 (]: Writing injected SQL for node "model.fao_elt_pipeline.silver_top_countries"
[0m10:53:23.371115 [debug] [Thread-4 (]: Began executing node model.fao_elt_pipeline.gold_country_metrics
[0m10:53:23.372114 [debug] [Thread-3 (]: Began executing node model.fao_elt_pipeline.gold_price_production_analysis
[0m10:53:23.373115 [debug] [Thread-1 (]: Began executing node model.fao_elt_pipeline.gold_regional_summary
[0m10:53:23.378112 [debug] [Thread-4 (]: Writing runtime sql for node "model.fao_elt_pipeline.gold_country_metrics"
[0m10:53:23.382112 [debug] [Thread-3 (]: Writing runtime sql for node "model.fao_elt_pipeline.gold_price_production_analysis"
[0m10:53:23.383116 [debug] [Thread-2 (]: Began executing node model.fao_elt_pipeline.silver_top_countries
[0m10:53:23.387113 [debug] [Thread-1 (]: Writing runtime sql for node "model.fao_elt_pipeline.gold_regional_summary"
[0m10:53:23.388115 [debug] [Thread-4 (]: Using postgres connection "model.fao_elt_pipeline.gold_country_metrics"
[0m10:53:23.393116 [debug] [Thread-2 (]: Writing runtime sql for node "model.fao_elt_pipeline.silver_top_countries"
[0m10:53:23.393116 [debug] [Thread-3 (]: Using postgres connection "model.fao_elt_pipeline.gold_price_production_analysis"
[0m10:53:23.394113 [debug] [Thread-4 (]: On model.fao_elt_pipeline.gold_country_metrics: BEGIN
[0m10:53:23.395115 [debug] [Thread-1 (]: Using postgres connection "model.fao_elt_pipeline.gold_regional_summary"
[0m10:53:23.396113 [debug] [Thread-3 (]: On model.fao_elt_pipeline.gold_price_production_analysis: BEGIN
[0m10:53:23.397113 [debug] [Thread-2 (]: Using postgres connection "model.fao_elt_pipeline.silver_top_countries"
[0m10:53:23.397113 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:53:23.398114 [debug] [Thread-1 (]: On model.fao_elt_pipeline.gold_regional_summary: BEGIN
[0m10:53:23.399112 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:53:23.400114 [debug] [Thread-2 (]: On model.fao_elt_pipeline.silver_top_countries: BEGIN
[0m10:53:23.401117 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:53:23.402116 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:53:23.414115 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m10:53:23.415115 [debug] [Thread-4 (]: Using postgres connection "model.fao_elt_pipeline.gold_country_metrics"
[0m10:53:23.416174 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m10:53:23.416682 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:53:23.417692 [debug] [Thread-4 (]: On model.fao_elt_pipeline.gold_country_metrics: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.gold_country_metrics"} */

  
    

  create  table "fao"."public_gold"."gold_country_metrics__dbt_tmp"
  
  
    as
  
  (
    

WITH country_production AS (
    SELECT
        country_name_standardized as country_name,
        area_code,
        year,
        SUM(production_metric_tons) as annual_production,
        COUNT(DISTINCT item_code) as products_produced
    FROM "fao"."public_silver"."silver_production_cleaned"
    WHERE is_valid_production = TRUE
    GROUP BY country_name_standardized, area_code, year
),

country_prices AS (
    SELECT
        country_name_standardized as country_name,
        area_code,
        year,
        AVG(price_value) as avg_annual_price,
        COUNT(DISTINCT item_code) as products_priced
    FROM "fao"."public_silver"."silver_prices_cleaned"
    WHERE is_valid_price = TRUE
    GROUP BY country_name_standardized, area_code, year
),

country_trends AS (
    SELECT
        cp.country_name,
        cp.area_code,
        -- Production metrics
        SUM(cp.annual_production) as total_production_all_years,
        AVG(cp.annual_production) as avg_annual_production,
        MAX(cp.annual_production) as peak_annual_production,
        MIN(cp.annual_production) as min_annual_production,
        -- Calculate production growth rate (comparing first and last 3 years)
        AVG(CASE WHEN cp.year >= 2018 THEN cp.annual_production END) -
        AVG(CASE WHEN cp.year <= 1993 THEN cp.annual_production END) as production_change,
        -- Price metrics
        AVG(pc.avg_annual_price) as avg_price_all_years,
        MAX(pc.avg_annual_price) as max_price,
        MIN(pc.avg_annual_price) as min_price,
        -- Product diversity
        MAX(cp.products_produced) as max_products_produced,
        AVG(cp.products_produced) as avg_products_produced,
        -- Data availability
        COUNT(DISTINCT cp.year) as years_with_data,
        MIN(cp.year) as first_year,
        MAX(cp.year) as last_year
    FROM country_production cp
    LEFT JOIN country_prices pc
        ON cp.country_name = pc.country_name
        AND cp.area_code = pc.area_code
        AND cp.year = pc.year
    GROUP BY cp.country_name, cp.area_code
)





SELECT
    country_name,
    area_code,
    -- Production metrics
    ROUND(total_production_all_years, 0) as total_production_metric_tons,
    ROUND(avg_annual_production, 0) as avg_annual_production_metric_tons,
    ROUND(peak_annual_production, 0) as peak_production_metric_tons,
    ROUND(production_change, 0) as production_growth_metric_tons,
    CASE
        WHEN production_change > 0 THEN 'Growing'
        WHEN production_change < 0 THEN 'Declining'
        ELSE 'Stable'
    END as production_trend,
    -- Price metrics
    ROUND(avg_price_all_years, 2) as avg_price_usd_per_tonne,
    ROUND(max_price, 2) as max_price_usd_per_tonne,
    ROUND(min_price, 2) as min_price_usd_per_tonne,
    ROUND(max_price - min_price, 2) as price_volatility,
    -- Product diversity
    max_products_produced,
    ROUND(avg_products_produced, 1) as avg_products_produced,
    -- Classifications
    CASE
        WHEN total_production_all_years > 1000000 THEN 'Major Producer'
        WHEN total_production_all_years > 100000 THEN 'Medium Producer'
        ELSE 'Small Producer'
    END as producer_category,
    CASE
        WHEN avg_price_all_years > 1000 THEN 'High Value'
        WHEN avg_price_all_years > 500 THEN 'Medium Value'
        ELSE 'Low Value'
    END as price_category,
    -- Metadata
    years_with_data,
    first_year,
    last_year,
    CURRENT_TIMESTAMP as calculated_at
FROM country_trends
WHERE total_production_all_years > 0
ORDER BY total_production_all_years DESC
  );
  
[0m10:53:23.418691 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m10:53:23.419690 [debug] [Thread-3 (]: Using postgres connection "model.fao_elt_pipeline.gold_price_production_analysis"
[0m10:53:23.419690 [debug] [Thread-1 (]: Using postgres connection "model.fao_elt_pipeline.gold_regional_summary"
[0m10:53:23.420692 [debug] [Thread-2 (]: Using postgres connection "model.fao_elt_pipeline.silver_top_countries"
[0m10:53:23.421693 [debug] [Thread-3 (]: On model.fao_elt_pipeline.gold_price_production_analysis: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.gold_price_production_analysis"} */

  
    

  create  table "fao"."public_gold"."gold_price_production_analysis__dbt_tmp"
  
  
    as
  
  (
    

WITH item_production AS (
    SELECT
        item_name,
        item_code,
        year,
        SUM(production_metric_tons) as global_production,
        COUNT(DISTINCT area_code) as producing_countries
    FROM "fao"."public_silver"."silver_production_cleaned"
    WHERE is_valid_production = TRUE
    GROUP BY item_name, item_code, year
),

item_prices AS (
    SELECT
        item_name,
        item_code,
        year,
        AVG(price_value) as avg_global_price,
        MAX(price_value) as max_price,
        MIN(price_value) as min_price,
        COUNT(DISTINCT area_code) as countries_with_prices
    FROM "fao"."public_silver"."silver_prices_cleaned"
    WHERE is_valid_price = TRUE
    GROUP BY item_name, item_code, year
),

price_production_combined AS (
    SELECT
        COALESCE(ip.item_name, ipr.item_name) as item_name,
        COALESCE(ip.item_code, ipr.item_code) as item_code,
        COALESCE(ip.year, ipr.year) as year,
        ip.global_production,
        ip.producing_countries,
        ipr.avg_global_price,
        ipr.max_price,
        ipr.min_price,
        ipr.countries_with_prices,
        -- Calculate price-production metrics
        CASE
            WHEN ip.global_production > 0 AND ipr.avg_global_price > 0
            THEN ipr.avg_global_price * ip.global_production
            ELSE NULL
        END as market_value
    FROM item_production ip
    FULL OUTER JOIN item_prices ipr
        ON ip.item_code = ipr.item_code
        AND ip.year = ipr.year
)

SELECT
    item_name,
    item_code,
    -- Aggregate metrics across all years
    ROUND(AVG(global_production), 0) as avg_annual_production,
    ROUND(SUM(global_production), 0) as total_production_all_years,
    ROUND(AVG(avg_global_price), 2) as avg_price_all_years,
    ROUND(AVG(market_value), 0) as avg_annual_market_value,
    ROUND(SUM(market_value), 0) as total_market_value,
    -- Price volatility
    ROUND(AVG(max_price - min_price), 2) as avg_price_spread,
    ROUND(MAX(max_price), 2) as highest_price_recorded,
    -- Market concentration
    ROUND(AVG(producing_countries), 1) as avg_producing_countries,
    ROUND(AVG(countries_with_prices), 1) as avg_countries_with_prices,
    -- Categorization
    CASE
        WHEN AVG(global_production) > 10000000 THEN 'Major Commodity'
        WHEN AVG(global_production) > 1000000 THEN 'Medium Commodity'
        ELSE 'Minor Commodity'
    END as commodity_scale,
    CASE
        WHEN AVG(avg_global_price) > 2000 THEN 'Premium Product'
        WHEN AVG(avg_global_price) > 500 THEN 'Standard Product'
        ELSE 'Basic Product'
    END as price_tier,
    -- Data quality
    COUNT(DISTINCT year) as years_with_data,
    MIN(year) as first_year,
    MAX(year) as last_year,
    CURRENT_TIMESTAMP as calculated_at
FROM price_production_combined
WHERE item_name IS NOT NULL
GROUP BY item_name, item_code
HAVING COUNT(DISTINCT year) >= 5  -- Only include items with sufficient data
ORDER BY total_market_value DESC NULLS LAST
  );
  
[0m10:53:23.422694 [debug] [Thread-1 (]: On model.fao_elt_pipeline.gold_regional_summary: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.gold_regional_summary"} */

  
    

  create  table "fao"."public_gold"."gold_regional_summary__dbt_tmp"
  
  
    as
  
  (
    

WITH country_regions AS (
    -- Simple regional classification based on country names
    -- In production, you'd use a proper country-region mapping table
    SELECT
        country_name_standardized,
        area_code,
        CASE
            WHEN country_name_standardized IN ('China', 'India', 'Japan', 'Republic of Korea',
                                               'Thailand', 'Pakistan', 'Bangladesh', 'Myanmar') THEN 'Asia'
            WHEN country_name_standardized IN ('USA', 'Canada', 'Mexico') THEN 'North America'
            WHEN country_name_standardized IN ('Brazil', 'Argentina', 'Chile', 'Colombia',
                                               'Peru', 'Ecuador', 'Venezuela (Bolivarian Republic of)',
                                               'Paraguay', 'Uruguay', 'Bolivia (Plurinational State of)') THEN 'South America'
            WHEN country_name_standardized IN ('Germany', 'France', 'UK', 'Italy', 'Spain',
                                               'Poland', 'Netherlands (Kingdom of the)', 'Belgium',
                                               'Greece', 'Portugal', 'Sweden', 'Austria',
                                               'Denmark', 'Finland', 'Norway', 'Switzerland') THEN 'Europe'
            WHEN country_name_standardized IN ('Nigeria', 'Egypt', 'South Africa', 'Kenya',
                                               'Ethiopia', 'Morocco', 'Tunisia', 'Algeria',
                                               'Ghana', 'Ivory Coast', 'Senegal') THEN 'Africa'
            WHEN country_name_standardized IN ('Australia', 'New Zealand', 'Fiji') THEN 'Oceania'
            WHEN country_name_standardized IN ('Saudi Arabia', 'Iran (Islamic Republic of)',
                                               'Iraq', 'Syrian Arab Republic', 'Yemen',
                                               'United Arab Emirates', 'Oman') THEN 'Middle East'
            ELSE 'Other'
        END as region
    FROM (
        SELECT DISTINCT country_name_standardized, area_code
        FROM "fao"."public_silver"."silver_production_cleaned"
        UNION
        SELECT DISTINCT country_name_standardized, area_code
        FROM "fao"."public_silver"."silver_prices_cleaned"
    ) countries
),

regional_production AS (
    SELECT
        cr.region,
        p.year,
        p.item_name,
        SUM(p.production_metric_tons) as regional_production,
        COUNT(DISTINCT p.area_code) as countries_producing,
        AVG(p.production_metric_tons) as avg_country_production
    FROM "fao"."public_silver"."silver_production_cleaned" p
    JOIN country_regions cr
        ON p.country_name_standardized = cr.country_name_standardized
    WHERE p.is_valid_production = TRUE
    GROUP BY cr.region, p.year, p.item_name
),

regional_prices AS (
    SELECT
        cr.region,
        pr.year,
        pr.item_name,
        AVG(pr.price_value) as avg_regional_price,
        MAX(pr.price_value) as max_regional_price,
        MIN(pr.price_value) as min_regional_price,
        COUNT(DISTINCT pr.area_code) as countries_with_prices
    FROM "fao"."public_silver"."silver_prices_cleaned" pr
    JOIN country_regions cr
        ON pr.country_name_standardized = cr.country_name_standardized
    WHERE pr.is_valid_price = TRUE
    GROUP BY cr.region, pr.year, pr.item_name
)

SELECT
    COALESCE(rp.region, rpr.region) as region,
    -- Production metrics
    ROUND(SUM(rp.regional_production), 0) as total_production_metric_tons,
    ROUND(AVG(rp.regional_production), 0) as avg_annual_production,
    COUNT(DISTINCT rp.countries_producing) as total_producing_countries,
    COUNT(DISTINCT rp.item_name) as products_produced,
    -- Price metrics
    ROUND(AVG(rpr.avg_regional_price), 2) as avg_price_usd_per_tonne,
    ROUND(MAX(rpr.max_regional_price), 2) as highest_price_recorded,
    ROUND(AVG(rpr.max_regional_price - rpr.min_regional_price), 2) as avg_price_volatility,
    -- Market value
    ROUND(SUM(
        CASE
            WHEN rp.regional_production > 0 AND rpr.avg_regional_price > 0
            THEN rp.regional_production * rpr.avg_regional_price
            ELSE 0
        END
    ), 0) as total_market_value,
    -- Growth metrics (comparing recent vs early years)
    ROUND(
        AVG(CASE WHEN rp.year >= 2018 THEN rp.regional_production END) -
        AVG(CASE WHEN rp.year <= 1995 THEN rp.regional_production END),
        0
    ) as production_growth,
    -- Regional characteristics
    CASE
        WHEN SUM(rp.regional_production) > 100000000 THEN 'Major Agricultural Region'
        WHEN SUM(rp.regional_production) > 10000000 THEN 'Medium Agricultural Region'
        ELSE 'Minor Agricultural Region'
    END as regional_scale,
    -- Data coverage
    COUNT(DISTINCT COALESCE(rp.year, rpr.year)) as years_with_data,
    MIN(COALESCE(rp.year, rpr.year)) as first_year,
    MAX(COALESCE(rp.year, rpr.year)) as last_year,
    CURRENT_TIMESTAMP as calculated_at
FROM regional_production rp
FULL OUTER JOIN regional_prices rpr
    ON rp.region = rpr.region
    AND rp.year = rpr.year
    AND rp.item_name = rpr.item_name
WHERE COALESCE(rp.region, rpr.region) != 'Other'
GROUP BY COALESCE(rp.region, rpr.region)
ORDER BY total_production_metric_tons DESC
  );
  
[0m10:53:23.423694 [debug] [Thread-2 (]: On model.fao_elt_pipeline.silver_top_countries: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.silver_top_countries"} */

  
    

  create  table "fao"."public_silver"."silver_top_countries__dbt_tmp"
  
  
    as
  
  (
    

WITH production_rankings AS (
    SELECT
        country_name_standardized,
        area_code,
        SUM(production_metric_tons) as total_production,
        COUNT(DISTINCT item_code) as product_diversity,
        COUNT(DISTINCT year) as years_of_data,
        AVG(production_metric_tons) as avg_annual_production,
        MAX(year) as latest_year
    FROM "fao"."public_silver"."silver_production_cleaned"
    WHERE is_valid_production = TRUE
    GROUP BY country_name_standardized, area_code
),

price_rankings AS (
    SELECT
        country_name_standardized,
        area_code,
        AVG(price_value) as avg_price,
        COUNT(DISTINCT item_code) as items_with_prices,
        MAX(price_value) as max_price,
        MIN(price_value) as min_price
    FROM "fao"."public_silver"."silver_prices_cleaned"
    WHERE is_valid_price = TRUE
    GROUP BY country_name_standardized, area_code
),

combined_rankings AS (
    SELECT
        COALESCE(pr.country_name_standardized, pc.country_name_standardized) as country_name,
        COALESCE(pr.area_code, pc.area_code) as area_code,
        pr.total_production,
        pr.product_diversity,
        pr.avg_annual_production,
        pc.avg_price,
        pc.items_with_prices,
        pc.max_price,
        -- Calculate rankings
        RANK() OVER (ORDER BY pr.total_production DESC NULLS LAST) as production_rank,
        RANK() OVER (ORDER BY pc.avg_price DESC NULLS LAST) as price_rank,
        RANK() OVER (ORDER BY pr.product_diversity DESC NULLS LAST) as diversity_rank
    FROM production_rankings pr
    FULL OUTER JOIN price_rankings pc
        ON pr.country_name_standardized = pc.country_name_standardized
        AND pr.area_code = pc.area_code
)

SELECT
    country_name,
    area_code,
    total_production,
    product_diversity,
    ROUND(avg_annual_production, 2) as avg_annual_production,
    ROUND(avg_price, 2) as avg_price_usd_per_tonne,
    items_with_prices,
    ROUND(max_price, 2) as max_price_usd_per_tonne,
    production_rank,
    price_rank,
    diversity_rank,
    -- Identify top performers
    CASE
        WHEN production_rank <= 10 THEN TRUE
        ELSE FALSE
    END as is_top_producer,
    CASE
        WHEN price_rank <= 10 THEN TRUE
        ELSE FALSE
    END as is_high_price_country,
    CASE
        WHEN diversity_rank <= 10 THEN TRUE
        ELSE FALSE
    END as is_diverse_producer,
    CURRENT_TIMESTAMP as calculated_at
FROM combined_rankings
WHERE country_name IS NOT NULL
  );
  
[0m10:53:23.427694 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.0 seconds
[0m10:53:23.431693 [debug] [Thread-4 (]: Using postgres connection "model.fao_elt_pipeline.gold_country_metrics"
[0m10:53:23.431693 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.0 seconds
[0m10:53:23.432692 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.0 seconds
[0m10:53:23.433693 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.0 seconds
[0m10:53:23.434694 [debug] [Thread-4 (]: On model.fao_elt_pipeline.gold_country_metrics: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.gold_country_metrics"} */
alter table "fao"."public_gold"."gold_country_metrics" rename to "gold_country_metrics__dbt_backup"
[0m10:53:23.438690 [debug] [Thread-2 (]: Using postgres connection "model.fao_elt_pipeline.silver_top_countries"
[0m10:53:23.442692 [debug] [Thread-1 (]: Using postgres connection "model.fao_elt_pipeline.gold_regional_summary"
[0m10:53:23.446690 [debug] [Thread-3 (]: Using postgres connection "model.fao_elt_pipeline.gold_price_production_analysis"
[0m10:53:23.447693 [debug] [Thread-2 (]: On model.fao_elt_pipeline.silver_top_countries: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.silver_top_countries"} */
alter table "fao"."public_silver"."silver_top_countries" rename to "silver_top_countries__dbt_backup"
[0m10:53:23.447693 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:53:23.448691 [debug] [Thread-1 (]: On model.fao_elt_pipeline.gold_regional_summary: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.gold_regional_summary"} */
alter table "fao"."public_gold"."gold_regional_summary" rename to "gold_regional_summary__dbt_backup"
[0m10:53:23.449690 [debug] [Thread-3 (]: On model.fao_elt_pipeline.gold_price_production_analysis: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.gold_price_production_analysis"} */
alter table "fao"."public_gold"."gold_price_production_analysis" rename to "gold_price_production_analysis__dbt_backup"
[0m10:53:23.453692 [debug] [Thread-4 (]: Using postgres connection "model.fao_elt_pipeline.gold_country_metrics"
[0m10:53:23.453692 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:53:23.455693 [debug] [Thread-4 (]: On model.fao_elt_pipeline.gold_country_metrics: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.gold_country_metrics"} */
alter table "fao"."public_gold"."gold_country_metrics__dbt_tmp" rename to "gold_country_metrics"
[0m10:53:23.455693 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:53:23.456691 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:53:23.460690 [debug] [Thread-2 (]: Using postgres connection "model.fao_elt_pipeline.silver_top_countries"
[0m10:53:23.464692 [debug] [Thread-1 (]: Using postgres connection "model.fao_elt_pipeline.gold_regional_summary"
[0m10:53:23.464692 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:53:23.468690 [debug] [Thread-3 (]: Using postgres connection "model.fao_elt_pipeline.gold_price_production_analysis"
[0m10:53:23.469690 [debug] [Thread-2 (]: On model.fao_elt_pipeline.silver_top_countries: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.silver_top_countries"} */
alter table "fao"."public_silver"."silver_top_countries__dbt_tmp" rename to "silver_top_countries"
[0m10:53:23.469690 [debug] [Thread-1 (]: On model.fao_elt_pipeline.gold_regional_summary: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.gold_regional_summary"} */
alter table "fao"."public_gold"."gold_regional_summary__dbt_tmp" rename to "gold_regional_summary"
[0m10:53:23.471690 [debug] [Thread-4 (]: Using postgres connection "model.fao_elt_pipeline.gold_country_metrics"
[0m10:53:23.472691 [debug] [Thread-3 (]: On model.fao_elt_pipeline.gold_price_production_analysis: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.gold_price_production_analysis"} */
alter table "fao"."public_gold"."gold_price_production_analysis__dbt_tmp" rename to "gold_price_production_analysis"
[0m10:53:23.473690 [debug] [Thread-4 (]: On model.fao_elt_pipeline.gold_country_metrics: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.gold_country_metrics"} */

    create  index if not exists
  "70760ef9e7f0fdbe5e9dd1b21ec7081d"
  on "fao"."public_gold"."gold_country_metrics" using btree
  (country_name)
  
[0m10:53:23.474692 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:53:23.474692 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:53:23.476693 [debug] [Thread-2 (]: On model.fao_elt_pipeline.silver_top_countries: COMMIT
[0m10:53:23.477691 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:53:23.478692 [debug] [Thread-4 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m10:53:23.480692 [debug] [Thread-1 (]: On model.fao_elt_pipeline.gold_regional_summary: COMMIT
[0m10:53:23.480692 [debug] [Thread-2 (]: Using postgres connection "model.fao_elt_pipeline.silver_top_countries"
[0m10:53:23.482693 [debug] [Thread-3 (]: On model.fao_elt_pipeline.gold_price_production_analysis: COMMIT
[0m10:53:23.484692 [debug] [Thread-4 (]: On model.fao_elt_pipeline.gold_country_metrics: COMMIT
[0m10:53:23.485690 [debug] [Thread-1 (]: Using postgres connection "model.fao_elt_pipeline.gold_regional_summary"
[0m10:53:23.485690 [debug] [Thread-2 (]: On model.fao_elt_pipeline.silver_top_countries: COMMIT
[0m10:53:23.486692 [debug] [Thread-3 (]: Using postgres connection "model.fao_elt_pipeline.gold_price_production_analysis"
[0m10:53:23.487690 [debug] [Thread-4 (]: Using postgres connection "model.fao_elt_pipeline.gold_country_metrics"
[0m10:53:23.488690 [debug] [Thread-1 (]: On model.fao_elt_pipeline.gold_regional_summary: COMMIT
[0m10:53:23.489690 [debug] [Thread-3 (]: On model.fao_elt_pipeline.gold_price_production_analysis: COMMIT
[0m10:53:23.489690 [debug] [Thread-4 (]: On model.fao_elt_pipeline.gold_country_metrics: COMMIT
[0m10:53:23.490692 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m10:53:23.494690 [debug] [Thread-2 (]: Applying DROP to: "fao"."public_silver"."silver_top_countries__dbt_backup"
[0m10:53:23.494690 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m10:53:23.495690 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m10:53:23.496690 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m10:53:23.497690 [debug] [Thread-2 (]: Using postgres connection "model.fao_elt_pipeline.silver_top_countries"
[0m10:53:23.500692 [debug] [Thread-1 (]: Applying DROP to: "fao"."public_gold"."gold_regional_summary__dbt_backup"
[0m10:53:23.503692 [debug] [Thread-4 (]: Applying DROP to: "fao"."public_gold"."gold_country_metrics__dbt_backup"
[0m10:53:23.507690 [debug] [Thread-3 (]: Applying DROP to: "fao"."public_gold"."gold_price_production_analysis__dbt_backup"
[0m10:53:23.507690 [debug] [Thread-2 (]: On model.fao_elt_pipeline.silver_top_countries: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.silver_top_countries"} */
drop table if exists "fao"."public_silver"."silver_top_countries__dbt_backup" cascade
[0m10:53:23.508690 [debug] [Thread-1 (]: Using postgres connection "model.fao_elt_pipeline.gold_regional_summary"
[0m10:53:23.509691 [debug] [Thread-4 (]: Using postgres connection "model.fao_elt_pipeline.gold_country_metrics"
[0m10:53:23.510692 [debug] [Thread-3 (]: Using postgres connection "model.fao_elt_pipeline.gold_price_production_analysis"
[0m10:53:23.511692 [debug] [Thread-1 (]: On model.fao_elt_pipeline.gold_regional_summary: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.gold_regional_summary"} */
drop table if exists "fao"."public_gold"."gold_regional_summary__dbt_backup" cascade
[0m10:53:23.512692 [debug] [Thread-4 (]: On model.fao_elt_pipeline.gold_country_metrics: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.gold_country_metrics"} */
drop table if exists "fao"."public_gold"."gold_country_metrics__dbt_backup" cascade
[0m10:53:23.513691 [debug] [Thread-3 (]: On model.fao_elt_pipeline.gold_price_production_analysis: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.gold_price_production_analysis"} */
drop table if exists "fao"."public_gold"."gold_price_production_analysis__dbt_backup" cascade
[0m10:53:23.513691 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:53:23.516693 [debug] [Thread-2 (]: On model.fao_elt_pipeline.silver_top_countries: Close
[0m10:53:23.516693 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:53:23.517693 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:53:23.517693 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:53:23.518692 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5cafca92-5664-4e3e-b775-8bfc932a7129', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023160EEC4F0>]}
[0m10:53:23.520693 [debug] [Thread-1 (]: On model.fao_elt_pipeline.gold_regional_summary: Close
[0m10:53:23.521693 [debug] [Thread-3 (]: On model.fao_elt_pipeline.gold_price_production_analysis: Close
[0m10:53:23.523692 [debug] [Thread-4 (]: On model.fao_elt_pipeline.gold_country_metrics: Close
[0m10:53:23.524692 [info ] [Thread-2 (]: 6 of 6 OK created sql table model public_silver.silver_top_countries ........... [[32mSELECT 0[0m in 0.17s]
[0m10:53:23.525692 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5cafca92-5664-4e3e-b775-8bfc932a7129', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002316057BF10>]}
[0m10:53:23.526691 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5cafca92-5664-4e3e-b775-8bfc932a7129', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023160EEF640>]}
[0m10:53:23.527692 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5cafca92-5664-4e3e-b775-8bfc932a7129', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023161017370>]}
[0m10:53:23.528693 [debug] [Thread-2 (]: Finished running node model.fao_elt_pipeline.silver_top_countries
[0m10:53:23.528693 [info ] [Thread-1 (]: 5 of 6 OK created sql table model public_gold.gold_regional_summary ............ [[32mSELECT 0[0m in 0.18s]
[0m10:53:23.529693 [info ] [Thread-3 (]: 4 of 6 OK created sql table model public_gold.gold_price_production_analysis ... [[32mSELECT 0[0m in 0.18s]
[0m10:53:23.530692 [info ] [Thread-4 (]: 3 of 6 OK created sql table model public_gold.gold_country_metrics ............. [[32mSELECT 0[0m in 0.18s]
[0m10:53:23.532692 [debug] [Thread-1 (]: Finished running node model.fao_elt_pipeline.gold_regional_summary
[0m10:53:23.533690 [debug] [Thread-3 (]: Finished running node model.fao_elt_pipeline.gold_price_production_analysis
[0m10:53:23.533690 [debug] [Thread-4 (]: Finished running node model.fao_elt_pipeline.gold_country_metrics
[0m10:53:23.535690 [debug] [MainThread]: Using postgres connection "master"
[0m10:53:23.536692 [debug] [MainThread]: On master: BEGIN
[0m10:53:23.537689 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:53:23.550692 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:53:23.551692 [debug] [MainThread]: On master: COMMIT
[0m10:53:23.551692 [debug] [MainThread]: Using postgres connection "master"
[0m10:53:23.552692 [debug] [MainThread]: On master: COMMIT
[0m10:53:23.553690 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:53:23.554691 [debug] [MainThread]: On master: Close
[0m10:53:23.555690 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:53:23.555690 [debug] [MainThread]: Connection 'list_fao' was properly closed.
[0m10:53:23.556692 [debug] [MainThread]: Connection 'list_fao' was properly closed.
[0m10:53:23.557693 [debug] [MainThread]: Connection 'list_fao_public_silver' was properly closed.
[0m10:53:23.557693 [debug] [MainThread]: Connection 'list_fao_public_gold' was properly closed.
[0m10:53:23.558693 [debug] [MainThread]: Connection 'model.fao_elt_pipeline.gold_regional_summary' was properly closed.
[0m10:53:23.558693 [debug] [MainThread]: Connection 'model.fao_elt_pipeline.silver_top_countries' was properly closed.
[0m10:53:23.559692 [debug] [MainThread]: Connection 'model.fao_elt_pipeline.gold_country_metrics' was properly closed.
[0m10:53:23.560692 [debug] [MainThread]: Connection 'model.fao_elt_pipeline.gold_price_production_analysis' was properly closed.
[0m10:53:23.561690 [info ] [MainThread]: 
[0m10:53:23.561690 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 0.73 seconds (0.73s).
[0m10:53:23.563692 [debug] [MainThread]: Command end result
[0m10:53:23.607691 [info ] [MainThread]: 
[0m10:53:23.607691 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:53:23.608691 [info ] [MainThread]: 
[0m10:53:23.609691 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m10:53:23.610691 [debug] [MainThread]: Command `dbt run` succeeded at 10:53:23.610691 after 1.74 seconds
[0m10:53:23.611691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002315D85B4F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002315D4B1900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023160EC22F0>]}
[0m10:53:23.612691 [debug] [MainThread]: Flushing usage events
[0m10:53:26.867522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280DAE9B4F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280DDC03610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280DDC03430>]}


============================== 10:53:26.871522 | f3e88a4e-9a18-4ae6-b9be-0176554d2d02 ==============================
[0m10:53:26.871522 [info ] [MainThread]: Running with dbt=1.8.0
[0m10:53:26.872522 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\18057\\Documents\\Coding\\fao-elt-pipelines\\dbt_project\\logs', 'profiles_dir': 'C:\\Users\\18057\\Documents\\Coding\\fao-elt-pipelines\\dbt_project', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt test --target dev', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:53:27.043365 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m10:53:27.044364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f3e88a4e-9a18-4ae6-b9be-0176554d2d02', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280DDBB6290>]}
[0m10:53:27.150366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f3e88a4e-9a18-4ae6-b9be-0176554d2d02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280DB1644C0>]}
[0m10:53:27.235945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f3e88a4e-9a18-4ae6-b9be-0176554d2d02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280DAAF1900>]}
[0m10:53:27.237945 [info ] [MainThread]: Registered adapter: postgres=1.8.0
[0m10:53:27.247945 [debug] [MainThread]: checksum: 2a6c64e758918535ccc035b9d143fb4c91b01df5f630e583361ba23a87d2a511, vars: {}, profile: , target: dev, version: 1.8.0
[0m10:53:27.494547 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:53:27.494547 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:53:27.502547 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.fao_elt_pipeline.bronze
[0m10:53:27.570947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f3e88a4e-9a18-4ae6-b9be-0176554d2d02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280DE0B5F90>]}
[0m10:53:27.761625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f3e88a4e-9a18-4ae6-b9be-0176554d2d02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280DE0AF9A0>]}
[0m10:53:27.762625 [info ] [MainThread]: Found 6 models, 23 data tests, 2 sources, 414 macros
[0m10:53:27.763624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3e88a4e-9a18-4ae6-b9be-0176554d2d02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280DE068B50>]}
[0m10:53:27.766623 [info ] [MainThread]: 
[0m10:53:27.767623 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:53:27.773623 [debug] [ThreadPool]: Acquiring new postgres connection 'list_fao_public_silver'
[0m10:53:27.774624 [debug] [ThreadPool]: Acquiring new postgres connection 'list_fao_public_gold'
[0m10:53:27.905655 [debug] [ThreadPool]: Using postgres connection "list_fao_public_silver"
[0m10:53:27.905655 [debug] [ThreadPool]: Using postgres connection "list_fao_public_gold"
[0m10:53:27.906656 [debug] [ThreadPool]: On list_fao_public_silver: BEGIN
[0m10:53:27.907655 [debug] [ThreadPool]: On list_fao_public_gold: BEGIN
[0m10:53:27.908657 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:53:27.909658 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:53:27.926658 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:53:27.926658 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:53:27.927656 [debug] [ThreadPool]: Using postgres connection "list_fao_public_silver"
[0m10:53:27.928656 [debug] [ThreadPool]: Using postgres connection "list_fao_public_gold"
[0m10:53:27.929658 [debug] [ThreadPool]: On list_fao_public_silver: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "connection_name": "list_fao_public_silver"} */
select
      'fao' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'fao' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'fao' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m10:53:27.930655 [debug] [ThreadPool]: On list_fao_public_gold: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "connection_name": "list_fao_public_gold"} */
select
      'fao' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'fao' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'fao' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m10:53:27.933658 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m10:53:27.934657 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m10:53:27.936656 [debug] [ThreadPool]: On list_fao_public_silver: ROLLBACK
[0m10:53:27.937657 [debug] [ThreadPool]: On list_fao_public_gold: ROLLBACK
[0m10:53:27.939716 [debug] [ThreadPool]: On list_fao_public_silver: Close
[0m10:53:27.940222 [debug] [ThreadPool]: On list_fao_public_gold: Close
[0m10:53:27.947231 [debug] [MainThread]: Using postgres connection "master"
[0m10:53:27.948229 [debug] [MainThread]: On master: BEGIN
[0m10:53:27.949232 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:53:27.980918 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:53:27.981920 [debug] [MainThread]: Using postgres connection "master"
[0m10:53:27.981920 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:53:27.986919 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m10:53:27.988920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3e88a4e-9a18-4ae6-b9be-0176554d2d02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280DB1A9C60>]}
[0m10:53:27.989919 [debug] [MainThread]: On master: ROLLBACK
[0m10:53:27.990917 [debug] [MainThread]: Using postgres connection "master"
[0m10:53:27.991919 [debug] [MainThread]: On master: BEGIN
[0m10:53:27.992919 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:53:27.993918 [debug] [MainThread]: On master: COMMIT
[0m10:53:27.994918 [debug] [MainThread]: Using postgres connection "master"
[0m10:53:27.994918 [debug] [MainThread]: On master: COMMIT
[0m10:53:27.995919 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:53:27.996919 [debug] [MainThread]: On master: Close
[0m10:53:27.997918 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:53:27.997918 [info ] [MainThread]: 
[0m10:53:28.001920 [debug] [Thread-1 (]: Began running node test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee
[0m10:53:28.002919 [debug] [Thread-2 (]: Began running node test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd
[0m10:53:28.003919 [debug] [Thread-3 (]: Began running node test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53
[0m10:53:28.003919 [debug] [Thread-4 (]: Began running node test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69
[0m10:53:28.004919 [info ] [Thread-1 (]: 1 of 23 START test accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer  [RUN]
[0m10:53:28.005918 [info ] [Thread-2 (]: 2 of 23 START test accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable  [RUN]
[0m10:53:28.006919 [info ] [Thread-3 (]: 3 of 23 START test accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity  [RUN]
[0m10:53:28.007918 [info ] [Thread-4 (]: 4 of 23 START test accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product  [RUN]
[0m10:53:28.008918 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee'
[0m10:53:28.009918 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd'
[0m10:53:28.010919 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53'
[0m10:53:28.011918 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69'
[0m10:53:28.011918 [debug] [Thread-1 (]: Began compiling node test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee
[0m10:53:28.012918 [debug] [Thread-2 (]: Began compiling node test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd
[0m10:53:28.013920 [debug] [Thread-3 (]: Began compiling node test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53
[0m10:53:28.014919 [debug] [Thread-4 (]: Began compiling node test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69
[0m10:53:28.036513 [debug] [Thread-1 (]: Writing injected SQL for node "test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee"
[0m10:53:28.043513 [debug] [Thread-2 (]: Writing injected SQL for node "test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd"
[0m10:53:28.051514 [debug] [Thread-3 (]: Writing injected SQL for node "test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53"
[0m10:53:28.058513 [debug] [Thread-4 (]: Writing injected SQL for node "test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69"
[0m10:53:28.059513 [debug] [Thread-1 (]: Began executing node test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee
[0m10:53:28.061320 [debug] [Thread-2 (]: Began executing node test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd
[0m10:53:28.062393 [debug] [Thread-3 (]: Began executing node test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53
[0m10:53:28.084340 [debug] [Thread-1 (]: Writing runtime sql for node "test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee"
[0m10:53:28.087342 [debug] [Thread-2 (]: Writing runtime sql for node "test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd"
[0m10:53:28.088340 [debug] [Thread-4 (]: Began executing node test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69
[0m10:53:28.091340 [debug] [Thread-3 (]: Writing runtime sql for node "test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53"
[0m10:53:28.092340 [debug] [Thread-1 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee"
[0m10:53:28.096341 [debug] [Thread-4 (]: Writing runtime sql for node "test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69"
[0m10:53:28.097339 [debug] [Thread-2 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd"
[0m10:53:28.098343 [debug] [Thread-1 (]: On test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee: BEGIN
[0m10:53:28.099341 [debug] [Thread-3 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53"
[0m10:53:28.100341 [debug] [Thread-2 (]: On test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd: BEGIN
[0m10:53:28.101340 [debug] [Thread-4 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69"
[0m10:53:28.101340 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:53:28.102342 [debug] [Thread-3 (]: On test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53: BEGIN
[0m10:53:28.103340 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:53:28.104340 [debug] [Thread-4 (]: On test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69: BEGIN
[0m10:53:28.105342 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:53:28.106341 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:53:28.120340 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m10:53:28.121343 [debug] [Thread-2 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd"
[0m10:53:28.122341 [debug] [Thread-2 (]: On test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        production_trend as value_field,
        count(*) as n_records

    from "fao"."public_gold"."gold_country_metrics"
    group by production_trend

)

select *
from all_values
where value_field not in (
    'Growing','Declining','Stable'
)



      
    ) dbt_internal_test
[0m10:53:28.123342 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m10:53:28.124340 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m10:53:28.125344 [debug] [Thread-4 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69"
[0m10:53:28.126344 [debug] [Thread-3 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53"
[0m10:53:28.127345 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m10:53:28.128342 [debug] [Thread-4 (]: On test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        price_tier as value_field,
        count(*) as n_records

    from "fao"."public_gold"."gold_price_production_analysis"
    group by price_tier

)

select *
from all_values
where value_field not in (
    'Premium Product','Standard Product','Basic Product'
)



      
    ) dbt_internal_test
[0m10:53:28.129340 [debug] [Thread-3 (]: On test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        commodity_scale as value_field,
        count(*) as n_records

    from "fao"."public_gold"."gold_price_production_analysis"
    group by commodity_scale

)

select *
from all_values
where value_field not in (
    'Major Commodity','Medium Commodity','Minor Commodity'
)



      
    ) dbt_internal_test
[0m10:53:28.135341 [debug] [Thread-2 (]: On test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd: ROLLBACK
[0m10:53:28.137341 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:53:28.138345 [debug] [Thread-2 (]: On test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd: Close
[0m10:53:28.139135 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m10:53:28.140134 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m10:53:28.140134 [debug] [Thread-1 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee"
[0m10:53:28.142619 [info ] [Thread-2 (]: 2 of 23 PASS accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable  [[32mPASS[0m in 0.13s]
[0m10:53:28.144837 [debug] [Thread-4 (]: On test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69: ROLLBACK
[0m10:53:28.146927 [debug] [Thread-3 (]: On test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53: ROLLBACK
[0m10:53:28.147993 [debug] [Thread-1 (]: On test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        producer_category as value_field,
        count(*) as n_records

    from "fao"."public_gold"."gold_country_metrics"
    group by producer_category

)

select *
from all_values
where value_field not in (
    'Major Producer','Medium Producer','Small Producer'
)



      
    ) dbt_internal_test
[0m10:53:28.149042 [debug] [Thread-2 (]: Finished running node test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd
[0m10:53:28.150615 [debug] [Thread-2 (]: Began running node test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6
[0m10:53:28.151146 [debug] [Thread-4 (]: On test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69: Close
[0m10:53:28.152227 [debug] [Thread-3 (]: On test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53: Close
[0m10:53:28.152756 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m10:53:28.153280 [info ] [Thread-2 (]: 5 of 23 START test accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region  [RUN]
[0m10:53:28.154897 [info ] [Thread-4 (]: 4 of 23 PASS accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product  [[32mPASS[0m in 0.14s]
[0m10:53:28.155984 [info ] [Thread-3 (]: 3 of 23 PASS accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity  [[32mPASS[0m in 0.15s]
[0m10:53:28.157660 [debug] [Thread-1 (]: On test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee: ROLLBACK
[0m10:53:28.158728 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd, now test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6)
[0m10:53:28.159787 [debug] [Thread-4 (]: Finished running node test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69
[0m10:53:28.160848 [debug] [Thread-3 (]: Finished running node test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53
[0m10:53:28.162419 [debug] [Thread-2 (]: Began compiling node test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6
[0m10:53:28.162419 [debug] [Thread-1 (]: On test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee: Close
[0m10:53:28.163429 [debug] [Thread-4 (]: Began running node test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff
[0m10:53:28.165031 [debug] [Thread-3 (]: Began running node test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f
[0m10:53:28.174078 [debug] [Thread-2 (]: Writing injected SQL for node "test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6"
[0m10:53:28.175137 [info ] [Thread-1 (]: 1 of 23 PASS accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer  [[32mPASS[0m in 0.17s]
[0m10:53:28.175649 [info ] [Thread-4 (]: 6 of 23 START test accepted_values_silver_prices_cleaned_is_valid_price__True__False  [RUN]
[0m10:53:28.176659 [info ] [Thread-3 (]: 7 of 23 START test accepted_values_silver_production_cleaned_is_valid_production__True__False  [RUN]
[0m10:53:28.177659 [debug] [Thread-1 (]: Finished running node test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee
[0m10:53:28.178660 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69, now test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff)
[0m10:53:28.179660 [debug] [Thread-2 (]: Began executing node test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6
[0m10:53:28.180658 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53, now test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f)
[0m10:53:28.181659 [debug] [Thread-1 (]: Began running node test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c
[0m10:53:28.182660 [debug] [Thread-4 (]: Began compiling node test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff
[0m10:53:28.185659 [debug] [Thread-2 (]: Writing runtime sql for node "test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6"
[0m10:53:28.186661 [debug] [Thread-3 (]: Began compiling node test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f
[0m10:53:28.187659 [info ] [Thread-1 (]: 8 of 23 START test not_null_gold_country_metrics_country_name .................. [RUN]
[0m10:53:28.192659 [debug] [Thread-4 (]: Writing injected SQL for node "test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff"
[0m10:53:28.197659 [debug] [Thread-3 (]: Writing injected SQL for node "test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f"
[0m10:53:28.198661 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee, now test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c)
[0m10:53:28.199658 [debug] [Thread-2 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6"
[0m10:53:28.200661 [debug] [Thread-4 (]: Began executing node test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff
[0m10:53:28.201660 [debug] [Thread-1 (]: Began compiling node test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c
[0m10:53:28.202660 [debug] [Thread-3 (]: Began executing node test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f
[0m10:53:28.202660 [debug] [Thread-2 (]: On test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6: BEGIN
[0m10:53:28.206659 [debug] [Thread-4 (]: Writing runtime sql for node "test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff"
[0m10:53:28.214659 [debug] [Thread-1 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c"
[0m10:53:28.218660 [debug] [Thread-3 (]: Writing runtime sql for node "test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f"
[0m10:53:28.218660 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:53:28.220660 [debug] [Thread-4 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff"
[0m10:53:28.221658 [debug] [Thread-1 (]: Began executing node test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c
[0m10:53:28.222658 [debug] [Thread-4 (]: On test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff: BEGIN
[0m10:53:28.222658 [debug] [Thread-3 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f"
[0m10:53:28.227659 [debug] [Thread-1 (]: Writing runtime sql for node "test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c"
[0m10:53:28.228660 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:53:28.228660 [debug] [Thread-3 (]: On test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f: BEGIN
[0m10:53:28.230659 [debug] [Thread-1 (]: Using postgres connection "test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c"
[0m10:53:28.230659 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:53:28.231660 [debug] [Thread-1 (]: On test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c: BEGIN
[0m10:53:28.232660 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:53:28.235279 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m10:53:28.236277 [debug] [Thread-2 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6"
[0m10:53:28.237276 [debug] [Thread-2 (]: On test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        regional_scale as value_field,
        count(*) as n_records

    from "fao"."public_gold"."gold_regional_summary"
    group by regional_scale

)

select *
from all_values
where value_field not in (
    'Major Agricultural Region','Medium Agricultural Region','Minor Agricultural Region'
)



      
    ) dbt_internal_test
[0m10:53:28.240275 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m10:53:28.242274 [debug] [Thread-2 (]: On test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6: ROLLBACK
[0m10:53:28.243275 [debug] [Thread-2 (]: On test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6: Close
[0m10:53:28.244275 [info ] [Thread-2 (]: 5 of 23 PASS accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region  [[32mPASS[0m in 0.09s]
[0m10:53:28.245277 [debug] [Thread-2 (]: Finished running node test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6
[0m10:53:28.246277 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m10:53:28.247279 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m10:53:28.247279 [debug] [Thread-2 (]: Began running node test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b
[0m10:53:28.248277 [debug] [Thread-4 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff"
[0m10:53:28.249276 [debug] [Thread-3 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f"
[0m10:53:28.250278 [info ] [Thread-2 (]: 9 of 23 START test not_null_gold_price_production_analysis_item_name ........... [RUN]
[0m10:53:28.251278 [debug] [Thread-4 (]: On test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        is_valid_price as value_field,
        count(*) as n_records

    from "fao"."public_silver"."silver_prices_cleaned"
    group by is_valid_price

)

select *
from all_values
where value_field not in (
    'True','False'
)



      
    ) dbt_internal_test
[0m10:53:28.252277 [debug] [Thread-3 (]: On test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        is_valid_production as value_field,
        count(*) as n_records

    from "fao"."public_silver"."silver_production_cleaned"
    group by is_valid_production

)

select *
from all_values
where value_field not in (
    'True','False'
)



      
    ) dbt_internal_test
[0m10:53:28.253275 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6, now test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b)
[0m10:53:28.254275 [debug] [Thread-2 (]: Began compiling node test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b
[0m10:53:28.259277 [debug] [Thread-2 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b"
[0m10:53:28.260275 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m10:53:28.261276 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m10:53:28.262276 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:53:28.264275 [debug] [Thread-3 (]: On test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f: ROLLBACK
[0m10:53:28.266275 [debug] [Thread-4 (]: On test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff: ROLLBACK
[0m10:53:28.266275 [debug] [Thread-2 (]: Began executing node test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b
[0m10:53:28.267276 [debug] [Thread-1 (]: Using postgres connection "test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c"
[0m10:53:28.271276 [debug] [Thread-2 (]: Writing runtime sql for node "test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b"
[0m10:53:28.272275 [debug] [Thread-3 (]: On test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f: Close
[0m10:53:28.272275 [debug] [Thread-4 (]: On test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff: Close
[0m10:53:28.273276 [debug] [Thread-1 (]: On test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select country_name
from "fao"."public_gold"."gold_country_metrics"
where country_name is null



      
    ) dbt_internal_test
[0m10:53:28.275277 [info ] [Thread-3 (]: 7 of 23 PASS accepted_values_silver_production_cleaned_is_valid_production__True__False  [[32mPASS[0m in 0.09s]
[0m10:53:28.275277 [debug] [Thread-2 (]: Using postgres connection "test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b"
[0m10:53:28.276277 [info ] [Thread-4 (]: 6 of 23 PASS accepted_values_silver_prices_cleaned_is_valid_price__True__False . [[32mPASS[0m in 0.10s]
[0m10:53:28.278276 [debug] [Thread-3 (]: Finished running node test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f
[0m10:53:28.278276 [debug] [Thread-2 (]: On test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b: BEGIN
[0m10:53:28.279277 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m10:53:28.280275 [debug] [Thread-4 (]: Finished running node test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff
[0m10:53:28.281275 [debug] [Thread-3 (]: Began running node test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7
[0m10:53:28.282277 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:53:28.284274 [debug] [Thread-1 (]: On test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c: ROLLBACK
[0m10:53:28.285278 [debug] [Thread-4 (]: Began running node test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5
[0m10:53:28.286276 [info ] [Thread-3 (]: 10 of 23 START test not_null_gold_regional_summary_region ...................... [RUN]
[0m10:53:28.287276 [debug] [Thread-1 (]: On test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c: Close
[0m10:53:28.287276 [info ] [Thread-4 (]: 11 of 23 START test not_null_silver_prices_cleaned_price_id .................... [RUN]
[0m10:53:28.288278 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f, now test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7)
[0m10:53:28.289277 [info ] [Thread-1 (]: 8 of 23 PASS not_null_gold_country_metrics_country_name ........................ [[32mPASS[0m in 0.09s]
[0m10:53:28.290276 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff, now test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5)
[0m10:53:28.291275 [debug] [Thread-3 (]: Began compiling node test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7
[0m10:53:28.292275 [debug] [Thread-1 (]: Finished running node test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c
[0m10:53:28.293277 [debug] [Thread-4 (]: Began compiling node test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5
[0m10:53:28.298276 [debug] [Thread-3 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7"
[0m10:53:28.299277 [debug] [Thread-1 (]: Began running node test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df
[0m10:53:28.304275 [debug] [Thread-4 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5"
[0m10:53:28.305277 [info ] [Thread-1 (]: 12 of 23 START test not_null_silver_prices_cleaned_price_value ................. [RUN]
[0m10:53:28.306275 [debug] [Thread-3 (]: Began executing node test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7
[0m10:53:28.307277 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c, now test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df)
[0m10:53:28.308275 [debug] [Thread-4 (]: Began executing node test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5
[0m10:53:28.311275 [debug] [Thread-3 (]: Writing runtime sql for node "test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7"
[0m10:53:28.312276 [debug] [Thread-1 (]: Began compiling node test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df
[0m10:53:28.315364 [debug] [Thread-4 (]: Writing runtime sql for node "test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5"
[0m10:53:28.322183 [debug] [Thread-1 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df"
[0m10:53:28.323224 [debug] [Thread-3 (]: Using postgres connection "test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7"
[0m10:53:28.323749 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m10:53:28.324818 [debug] [Thread-4 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5"
[0m10:53:28.325857 [debug] [Thread-3 (]: On test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7: BEGIN
[0m10:53:28.325857 [debug] [Thread-1 (]: Began executing node test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df
[0m10:53:28.326858 [debug] [Thread-2 (]: Using postgres connection "test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b"
[0m10:53:28.327856 [debug] [Thread-4 (]: On test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5: BEGIN
[0m10:53:28.328857 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:53:28.331856 [debug] [Thread-1 (]: Writing runtime sql for node "test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df"
[0m10:53:28.332856 [debug] [Thread-2 (]: On test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select item_name
from "fao"."public_gold"."gold_price_production_analysis"
where item_name is null



      
    ) dbt_internal_test
[0m10:53:28.333857 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:53:28.334857 [debug] [Thread-1 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df"
[0m10:53:28.335865 [debug] [Thread-1 (]: On test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df: BEGIN
[0m10:53:28.336859 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m10:53:28.337858 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:53:28.339858 [debug] [Thread-2 (]: On test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b: ROLLBACK
[0m10:53:28.340857 [debug] [Thread-2 (]: On test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b: Close
[0m10:53:28.341858 [info ] [Thread-2 (]: 9 of 23 PASS not_null_gold_price_production_analysis_item_name ................. [[32mPASS[0m in 0.09s]
[0m10:53:28.343432 [debug] [Thread-2 (]: Finished running node test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b
[0m10:53:28.344444 [debug] [Thread-2 (]: Began running node test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b
[0m10:53:28.345441 [info ] [Thread-2 (]: 13 of 23 START test not_null_silver_prices_cleaned_year ........................ [RUN]
[0m10:53:28.346444 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b, now test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b)
[0m10:53:28.347444 [debug] [Thread-2 (]: Began compiling node test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b
[0m10:53:28.352442 [debug] [Thread-2 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b"
[0m10:53:28.353441 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m10:53:28.354442 [debug] [Thread-3 (]: Using postgres connection "test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7"
[0m10:53:28.355443 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m10:53:28.356444 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:53:28.357442 [debug] [Thread-3 (]: On test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select region
from "fao"."public_gold"."gold_regional_summary"
where region is null



      
    ) dbt_internal_test
[0m10:53:28.357442 [debug] [Thread-2 (]: Began executing node test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b
[0m10:53:28.358442 [debug] [Thread-4 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5"
[0m10:53:28.359443 [debug] [Thread-1 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df"
[0m10:53:28.362443 [debug] [Thread-2 (]: Writing runtime sql for node "test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b"
[0m10:53:28.363443 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m10:53:28.364441 [debug] [Thread-4 (]: On test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select price_id
from "fao"."public_silver"."silver_prices_cleaned"
where price_id is null



      
    ) dbt_internal_test
[0m10:53:28.365444 [debug] [Thread-1 (]: On test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select price_value
from "fao"."public_silver"."silver_prices_cleaned"
where price_value is null



      
    ) dbt_internal_test
[0m10:53:28.367442 [debug] [Thread-3 (]: On test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7: ROLLBACK
[0m10:53:28.368442 [debug] [Thread-2 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b"
[0m10:53:28.369442 [debug] [Thread-2 (]: On test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b: BEGIN
[0m10:53:28.369442 [debug] [Thread-3 (]: On test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7: Close
[0m10:53:28.370442 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m10:53:28.371444 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m10:53:28.372441 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:53:28.373444 [info ] [Thread-3 (]: 10 of 23 PASS not_null_gold_regional_summary_region ............................ [[32mPASS[0m in 0.08s]
[0m10:53:28.375443 [debug] [Thread-4 (]: On test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5: ROLLBACK
[0m10:53:28.377442 [debug] [Thread-1 (]: On test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df: ROLLBACK
[0m10:53:28.378442 [debug] [Thread-3 (]: Finished running node test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7
[0m10:53:28.379444 [debug] [Thread-3 (]: Began running node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74
[0m10:53:28.380447 [debug] [Thread-4 (]: On test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5: Close
[0m10:53:28.381444 [debug] [Thread-1 (]: On test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df: Close
[0m10:53:28.382442 [info ] [Thread-3 (]: 14 of 23 START test not_null_silver_production_cleaned_production_id ........... [RUN]
[0m10:53:28.383444 [info ] [Thread-4 (]: 11 of 23 PASS not_null_silver_prices_cleaned_price_id .......................... [[32mPASS[0m in 0.09s]
[0m10:53:28.384444 [info ] [Thread-1 (]: 12 of 23 PASS not_null_silver_prices_cleaned_price_value ....................... [[32mPASS[0m in 0.08s]
[0m10:53:28.385444 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7, now test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74)
[0m10:53:28.386443 [debug] [Thread-4 (]: Finished running node test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5
[0m10:53:28.387444 [debug] [Thread-1 (]: Finished running node test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df
[0m10:53:28.388443 [debug] [Thread-3 (]: Began compiling node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74
[0m10:53:28.389444 [debug] [Thread-4 (]: Began running node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d
[0m10:53:28.390442 [debug] [Thread-1 (]: Began running node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df
[0m10:53:28.395442 [debug] [Thread-3 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74"
[0m10:53:28.396441 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m10:53:28.397444 [info ] [Thread-4 (]: 15 of 23 START test not_null_silver_production_cleaned_production_metric_tons .. [RUN]
[0m10:53:28.397444 [info ] [Thread-1 (]: 16 of 23 START test not_null_silver_production_cleaned_production_value ........ [RUN]
[0m10:53:28.398442 [debug] [Thread-2 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b"
[0m10:53:28.399444 [debug] [Thread-3 (]: Began executing node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74
[0m10:53:28.400443 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5, now test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d)
[0m10:53:28.401443 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df, now test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df)
[0m10:53:28.402443 [debug] [Thread-2 (]: On test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select year
from "fao"."public_silver"."silver_prices_cleaned"
where year is null



      
    ) dbt_internal_test
[0m10:53:28.405444 [debug] [Thread-3 (]: Writing runtime sql for node "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74"
[0m10:53:28.406443 [debug] [Thread-4 (]: Began compiling node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d
[0m10:53:28.407442 [debug] [Thread-1 (]: Began compiling node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df
[0m10:53:28.412444 [debug] [Thread-4 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d"
[0m10:53:28.413442 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m10:53:28.418441 [debug] [Thread-1 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df"
[0m10:53:28.419441 [debug] [Thread-3 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74"
[0m10:53:28.421442 [debug] [Thread-2 (]: On test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b: ROLLBACK
[0m10:53:28.422441 [debug] [Thread-4 (]: Began executing node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d
[0m10:53:28.423441 [debug] [Thread-3 (]: On test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74: BEGIN
[0m10:53:28.423441 [debug] [Thread-1 (]: Began executing node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df
[0m10:53:28.424443 [debug] [Thread-2 (]: On test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b: Close
[0m10:53:28.429441 [debug] [Thread-4 (]: Writing runtime sql for node "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d"
[0m10:53:28.430445 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:53:28.433442 [debug] [Thread-1 (]: Writing runtime sql for node "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df"
[0m10:53:28.434443 [info ] [Thread-2 (]: 13 of 23 PASS not_null_silver_prices_cleaned_year .............................. [[32mPASS[0m in 0.09s]
[0m10:53:28.435441 [debug] [Thread-4 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d"
[0m10:53:28.437039 [debug] [Thread-2 (]: Finished running node test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b
[0m10:53:28.438051 [debug] [Thread-1 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df"
[0m10:53:28.438051 [debug] [Thread-4 (]: On test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d: BEGIN
[0m10:53:28.439049 [debug] [Thread-2 (]: Began running node test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd
[0m10:53:28.440049 [debug] [Thread-1 (]: On test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df: BEGIN
[0m10:53:28.441049 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:53:28.442048 [info ] [Thread-2 (]: 17 of 23 START test not_null_silver_top_countries_area_code .................... [RUN]
[0m10:53:28.443049 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:53:28.444049 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b, now test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd)
[0m10:53:28.445048 [debug] [Thread-2 (]: Began compiling node test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd
[0m10:53:28.450048 [debug] [Thread-2 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd"
[0m10:53:28.452048 [debug] [Thread-2 (]: Began executing node test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd
[0m10:53:28.453048 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m10:53:28.456047 [debug] [Thread-2 (]: Writing runtime sql for node "test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd"
[0m10:53:28.457049 [debug] [Thread-3 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74"
[0m10:53:28.458047 [debug] [Thread-3 (]: On test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select production_id
from "fao"."public_silver"."silver_production_cleaned"
where production_id is null



      
    ) dbt_internal_test
[0m10:53:28.458047 [debug] [Thread-2 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd"
[0m10:53:28.459049 [debug] [Thread-2 (]: On test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd: BEGIN
[0m10:53:28.460048 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m10:53:28.461048 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:53:28.463048 [debug] [Thread-3 (]: On test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74: ROLLBACK
[0m10:53:28.464048 [debug] [Thread-3 (]: On test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74: Close
[0m10:53:28.465049 [info ] [Thread-3 (]: 14 of 23 PASS not_null_silver_production_cleaned_production_id ................. [[32mPASS[0m in 0.08s]
[0m10:53:28.466049 [debug] [Thread-3 (]: Finished running node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74
[0m10:53:28.467048 [debug] [Thread-3 (]: Began running node test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a
[0m10:53:28.468047 [info ] [Thread-3 (]: 18 of 23 START test not_null_silver_top_countries_country_name ................. [RUN]
[0m10:53:28.469048 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74, now test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a)
[0m10:53:28.470048 [debug] [Thread-3 (]: Began compiling node test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a
[0m10:53:28.475047 [debug] [Thread-3 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a"
[0m10:53:28.476049 [debug] [Thread-3 (]: Began executing node test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a
[0m10:53:28.480048 [debug] [Thread-3 (]: Writing runtime sql for node "test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a"
[0m10:53:28.481047 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:53:28.482048 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m10:53:28.482048 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m10:53:28.483050 [debug] [Thread-1 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df"
[0m10:53:28.484048 [debug] [Thread-3 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a"
[0m10:53:28.485049 [debug] [Thread-4 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d"
[0m10:53:28.486050 [debug] [Thread-2 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd"
[0m10:53:28.486050 [debug] [Thread-1 (]: On test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select production_value
from "fao"."public_silver"."silver_production_cleaned"
where production_value is null



      
    ) dbt_internal_test
[0m10:53:28.487047 [debug] [Thread-3 (]: On test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a: BEGIN
[0m10:53:28.488047 [debug] [Thread-4 (]: On test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select production_metric_tons
from "fao"."public_silver"."silver_production_cleaned"
where production_metric_tons is null



      
    ) dbt_internal_test
[0m10:53:28.489049 [debug] [Thread-2 (]: On test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select area_code
from "fao"."public_silver"."silver_top_countries"
where area_code is null



      
    ) dbt_internal_test
[0m10:53:28.490048 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:53:28.491048 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m10:53:28.492051 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m10:53:28.492051 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m10:53:28.494048 [debug] [Thread-1 (]: On test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df: ROLLBACK
[0m10:53:28.496051 [debug] [Thread-4 (]: On test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d: ROLLBACK
[0m10:53:28.498049 [debug] [Thread-2 (]: On test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd: ROLLBACK
[0m10:53:28.499051 [debug] [Thread-1 (]: On test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df: Close
[0m10:53:28.500049 [debug] [Thread-4 (]: On test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d: Close
[0m10:53:28.501049 [debug] [Thread-2 (]: On test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd: Close
[0m10:53:28.502050 [info ] [Thread-1 (]: 16 of 23 PASS not_null_silver_production_cleaned_production_value .............. [[32mPASS[0m in 0.10s]
[0m10:53:28.503049 [info ] [Thread-4 (]: 15 of 23 PASS not_null_silver_production_cleaned_production_metric_tons ........ [[32mPASS[0m in 0.10s]
[0m10:53:28.504050 [info ] [Thread-2 (]: 17 of 23 PASS not_null_silver_top_countries_area_code .......................... [[32mPASS[0m in 0.06s]
[0m10:53:28.505050 [debug] [Thread-1 (]: Finished running node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df
[0m10:53:28.506050 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m10:53:28.507050 [debug] [Thread-4 (]: Finished running node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d
[0m10:53:28.508049 [debug] [Thread-2 (]: Finished running node test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd
[0m10:53:28.509049 [debug] [Thread-1 (]: Began running node test.fao_elt_pipeline.test_data_quality
[0m10:53:28.510048 [debug] [Thread-3 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a"
[0m10:53:28.510048 [debug] [Thread-4 (]: Began running node test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4
[0m10:53:28.511048 [debug] [Thread-2 (]: Began running node test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1
[0m10:53:28.512049 [info ] [Thread-1 (]: 19 of 23 START test test_data_quality .......................................... [RUN]
[0m10:53:28.513049 [debug] [Thread-3 (]: On test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select country_name
from "fao"."public_silver"."silver_top_countries"
where country_name is null



      
    ) dbt_internal_test
[0m10:53:28.514049 [info ] [Thread-4 (]: 20 of 23 START test unique_gold_country_metrics_country_name ................... [RUN]
[0m10:53:28.515048 [info ] [Thread-2 (]: 21 of 23 START test unique_gold_regional_summary_region ........................ [RUN]
[0m10:53:28.516048 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df, now test.fao_elt_pipeline.test_data_quality)
[0m10:53:28.517048 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d, now test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4)
[0m10:53:28.518049 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd, now test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1)
[0m10:53:28.518049 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m10:53:28.519047 [debug] [Thread-1 (]: Began compiling node test.fao_elt_pipeline.test_data_quality
[0m10:53:28.520049 [debug] [Thread-4 (]: Began compiling node test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4
[0m10:53:28.521047 [debug] [Thread-2 (]: Began compiling node test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1
[0m10:53:28.522047 [debug] [Thread-3 (]: On test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a: ROLLBACK
[0m10:53:28.526047 [debug] [Thread-1 (]: Writing injected SQL for node "test.fao_elt_pipeline.test_data_quality"
[0m10:53:28.536047 [debug] [Thread-4 (]: Writing injected SQL for node "test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4"
[0m10:53:28.541047 [debug] [Thread-2 (]: Writing injected SQL for node "test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1"
[0m10:53:28.543050 [debug] [Thread-1 (]: Began executing node test.fao_elt_pipeline.test_data_quality
[0m10:53:28.543050 [debug] [Thread-3 (]: On test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a: Close
[0m10:53:28.544048 [debug] [Thread-4 (]: Began executing node test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4
[0m10:53:28.548048 [debug] [Thread-1 (]: Writing runtime sql for node "test.fao_elt_pipeline.test_data_quality"
[0m10:53:28.548048 [debug] [Thread-2 (]: Began executing node test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1
[0m10:53:28.549048 [info ] [Thread-3 (]: 18 of 23 PASS not_null_silver_top_countries_country_name ....................... [[32mPASS[0m in 0.08s]
[0m10:53:28.553050 [debug] [Thread-4 (]: Writing runtime sql for node "test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4"
[0m10:53:28.556047 [debug] [Thread-2 (]: Writing runtime sql for node "test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1"
[0m10:53:28.557048 [debug] [Thread-3 (]: Finished running node test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a
[0m10:53:28.558049 [debug] [Thread-1 (]: Using postgres connection "test.fao_elt_pipeline.test_data_quality"
[0m10:53:28.559047 [debug] [Thread-4 (]: Using postgres connection "test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4"
[0m10:53:28.560048 [debug] [Thread-3 (]: Began running node test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31
[0m10:53:28.561048 [debug] [Thread-2 (]: Using postgres connection "test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1"
[0m10:53:28.562049 [debug] [Thread-1 (]: On test.fao_elt_pipeline.test_data_quality: BEGIN
[0m10:53:28.562049 [debug] [Thread-4 (]: On test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4: BEGIN
[0m10:53:28.563048 [info ] [Thread-3 (]: 22 of 23 START test unique_silver_prices_cleaned_price_id ...................... [RUN]
[0m10:53:28.564048 [debug] [Thread-2 (]: On test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1: BEGIN
[0m10:53:28.565048 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:53:28.566049 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:53:28.567048 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a, now test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31)
[0m10:53:28.567048 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:53:28.569047 [debug] [Thread-3 (]: Began compiling node test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31
[0m10:53:28.575049 [debug] [Thread-3 (]: Writing injected SQL for node "test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31"
[0m10:53:28.576049 [debug] [Thread-3 (]: Began executing node test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31
[0m10:53:28.580047 [debug] [Thread-3 (]: Writing runtime sql for node "test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31"
[0m10:53:28.581048 [debug] [Thread-3 (]: Using postgres connection "test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31"
[0m10:53:28.581048 [debug] [Thread-3 (]: On test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31: BEGIN
[0m10:53:28.582048 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:53:28.583048 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:53:28.584049 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m10:53:28.585049 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m10:53:28.585049 [debug] [Thread-1 (]: Using postgres connection "test.fao_elt_pipeline.test_data_quality"
[0m10:53:28.586047 [debug] [Thread-4 (]: Using postgres connection "test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4"
[0m10:53:28.587050 [debug] [Thread-2 (]: Using postgres connection "test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1"
[0m10:53:28.588049 [debug] [Thread-1 (]: On test.fao_elt_pipeline.test_data_quality: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.test_data_quality"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- Test to ensure we have data for major countries
-- This test will fail if we don't have data for these important agricultural producers

SELECT country_name
FROM (
    VALUES
        ('China'),
        ('India'),
        ('USA'),
        ('Brazil'),
        ('Germany')
) AS required_countries(country_name)
WHERE country_name NOT IN (
    SELECT DISTINCT country_name_standardized
    FROM "fao"."public_silver"."silver_production_cleaned"
)
      
    ) dbt_internal_test
[0m10:53:28.589049 [debug] [Thread-4 (]: On test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    country_name as unique_field,
    count(*) as n_records

from "fao"."public_gold"."gold_country_metrics"
where country_name is not null
group by country_name
having count(*) > 1



      
    ) dbt_internal_test
[0m10:53:28.589049 [debug] [Thread-2 (]: On test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    region as unique_field,
    count(*) as n_records

from "fao"."public_gold"."gold_regional_summary"
where region is not null
group by region
having count(*) > 1



      
    ) dbt_internal_test
[0m10:53:28.592051 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m10:53:28.593050 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m10:53:28.593050 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m10:53:28.595048 [debug] [Thread-2 (]: On test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1: ROLLBACK
[0m10:53:28.597048 [debug] [Thread-1 (]: On test.fao_elt_pipeline.test_data_quality: ROLLBACK
[0m10:53:28.599048 [debug] [Thread-4 (]: On test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4: ROLLBACK
[0m10:53:28.600049 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m10:53:28.601049 [debug] [Thread-2 (]: On test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1: Close
[0m10:53:28.602050 [debug] [Thread-1 (]: On test.fao_elt_pipeline.test_data_quality: Close
[0m10:53:28.603048 [debug] [Thread-3 (]: Using postgres connection "test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31"
[0m10:53:28.603048 [debug] [Thread-4 (]: On test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4: Close
[0m10:53:28.605049 [info ] [Thread-2 (]: 21 of 23 PASS unique_gold_regional_summary_region .............................. [[32mPASS[0m in 0.09s]
[0m10:53:28.606048 [warn ] [Thread-1 (]: 19 of 23 WARN 5 test_data_quality .............................................. [[33mWARN 5[0m in 0.09s]
[0m10:53:28.607049 [debug] [Thread-3 (]: On test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    price_id as unique_field,
    count(*) as n_records

from "fao"."public_silver"."silver_prices_cleaned"
where price_id is not null
group by price_id
having count(*) > 1



      
    ) dbt_internal_test
[0m10:53:28.608048 [info ] [Thread-4 (]: 20 of 23 PASS unique_gold_country_metrics_country_name ......................... [[32mPASS[0m in 0.09s]
[0m10:53:28.609051 [debug] [Thread-2 (]: Finished running node test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1
[0m10:53:28.610048 [debug] [Thread-1 (]: Finished running node test.fao_elt_pipeline.test_data_quality
[0m10:53:28.612048 [debug] [Thread-4 (]: Finished running node test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4
[0m10:53:28.613048 [debug] [Thread-2 (]: Began running node test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048
[0m10:53:28.613048 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m10:53:28.615047 [info ] [Thread-2 (]: 23 of 23 START test unique_silver_production_cleaned_production_id ............. [RUN]
[0m10:53:28.617048 [debug] [Thread-3 (]: On test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31: ROLLBACK
[0m10:53:28.618048 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1, now test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048)
[0m10:53:28.619050 [debug] [Thread-2 (]: Began compiling node test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048
[0m10:53:28.619050 [debug] [Thread-3 (]: On test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31: Close
[0m10:53:28.625048 [debug] [Thread-2 (]: Writing injected SQL for node "test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048"
[0m10:53:28.626048 [info ] [Thread-3 (]: 22 of 23 PASS unique_silver_prices_cleaned_price_id ............................ [[32mPASS[0m in 0.06s]
[0m10:53:28.628050 [debug] [Thread-3 (]: Finished running node test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31
[0m10:53:28.629047 [debug] [Thread-2 (]: Began executing node test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048
[0m10:53:28.634050 [debug] [Thread-2 (]: Writing runtime sql for node "test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048"
[0m10:53:28.635048 [debug] [Thread-2 (]: Using postgres connection "test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048"
[0m10:53:28.636050 [debug] [Thread-2 (]: On test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048: BEGIN
[0m10:53:28.637047 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:53:28.652677 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m10:53:28.653678 [debug] [Thread-2 (]: Using postgres connection "test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048"
[0m10:53:28.654674 [debug] [Thread-2 (]: On test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    production_id as unique_field,
    count(*) as n_records

from "fao"."public_silver"."silver_production_cleaned"
where production_id is not null
group by production_id
having count(*) > 1



      
    ) dbt_internal_test
[0m10:53:28.656674 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m10:53:28.658675 [debug] [Thread-2 (]: On test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048: ROLLBACK
[0m10:53:28.660673 [debug] [Thread-2 (]: On test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048: Close
[0m10:53:28.661675 [info ] [Thread-2 (]: 23 of 23 PASS unique_silver_production_cleaned_production_id ................... [[32mPASS[0m in 0.04s]
[0m10:53:28.662677 [debug] [Thread-2 (]: Finished running node test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048
[0m10:53:28.674675 [error] [MainThread]: CANCEL query list_fao_public_silver ............................................ [[31mCANCEL[0m]
[0m10:53:28.675676 [error] [MainThread]: CANCEL query list_fao_public_gold .............................................. [[31mCANCEL[0m]
[0m10:53:28.676675 [error] [MainThread]: CANCEL query test.fao_elt_pipeline.test_data_quality ........................... [[31mCANCEL[0m]
[0m10:53:28.677675 [error] [MainThread]: CANCEL query test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048  [[31mCANCEL[0m]
[0m10:53:28.677675 [error] [MainThread]: CANCEL query test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31  [[31mCANCEL[0m]
[0m10:53:28.678674 [error] [MainThread]: CANCEL query test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4  [[31mCANCEL[0m]
[0m10:53:28.679673 [info ] [MainThread]: 
[0m10:53:28.679673 [info ] [MainThread]: [33mExited because of keyboard interrupt[0m
[0m10:53:28.680674 [info ] [MainThread]: 
[0m10:53:28.681673 [warn ] [MainThread]: [33mWarning in test test_data_quality (tests\test_data_quality.sql)[0m
[0m10:53:28.682673 [warn ] [MainThread]: Got 5 results, configured to warn if != 0
[0m10:53:28.682673 [info ] [MainThread]: 
[0m10:53:28.683673 [info ] [MainThread]:   compiled code at target\compiled\fao_elt_pipeline\tests\test_data_quality.sql
[0m10:53:28.684674 [info ] [MainThread]: 
[0m10:53:28.685674 [info ] [MainThread]: Done. PASS=22 WARN=1 ERROR=0 SKIP=0 TOTAL=23
[0m10:53:28.685674 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:53:28.686674 [debug] [MainThread]: Connection 'list_fao_public_silver' was properly closed.
[0m10:53:28.687674 [debug] [MainThread]: Connection 'list_fao_public_gold' was properly closed.
[0m10:53:28.687674 [debug] [MainThread]: Connection 'test.fao_elt_pipeline.test_data_quality' was properly closed.
[0m10:53:28.688673 [debug] [MainThread]: Connection 'test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048' was properly closed.
[0m10:53:28.689673 [debug] [MainThread]: Connection 'test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31' was properly closed.
[0m10:53:28.689673 [debug] [MainThread]: Connection 'test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4' was properly closed.
[0m10:53:28.690673 [info ] [MainThread]: 
[0m10:53:28.691674 [info ] [MainThread]: Finished running 23 data tests in 0 hours 0 minutes and 0.92 seconds (0.92s).
[0m10:53:28.691674 [error] [MainThread]: Encountered an error:

[0m10:53:28.716673 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\18057\.conda\envs\elt-pipelines\lib\site-packages\dbt\cli\requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
  File "C:\Users\18057\.conda\envs\elt-pipelines\lib\site-packages\dbt\cli\requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\18057\.conda\envs\elt-pipelines\lib\site-packages\dbt\cli\requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\18057\.conda\envs\elt-pipelines\lib\site-packages\dbt\cli\requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\18057\.conda\envs\elt-pipelines\lib\site-packages\dbt\cli\requires.py", line 294, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\18057\.conda\envs\elt-pipelines\lib\site-packages\dbt\cli\requires.py", line 332, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\18057\.conda\envs\elt-pipelines\lib\site-packages\dbt\cli\main.py", line 815, in test
    results = task.run()
  File "C:\Users\18057\.conda\envs\elt-pipelines\lib\site-packages\dbt\task\runnable.py", line 526, in run
    result = self.execute_with_hooks(selected_uids)
  File "C:\Users\18057\.conda\envs\elt-pipelines\lib\site-packages\dbt\task\runnable.py", line 487, in execute_with_hooks
    res = self.execute_nodes()
  File "C:\Users\18057\.conda\envs\elt-pipelines\lib\site-packages\dbt\task\runnable.py", line 397, in execute_nodes
    self.run_queue(pool)
  File "C:\Users\18057\.conda\envs\elt-pipelines\lib\site-packages\dbt\task\runnable.py", line 315, in run_queue
    self.job_queue.join()
  File "C:\Users\18057\.conda\envs\elt-pipelines\lib\site-packages\dbt\graph\queue.py", line 198, in join
    self.inner.join()
  File "C:\Users\18057\.conda\envs\elt-pipelines\lib\queue.py", line 90, in join
    self.all_tasks_done.wait()
  File "C:\Users\18057\.conda\envs\elt-pipelines\lib\threading.py", line 320, in wait
    waiter.acquire()
KeyboardInterrupt

[0m10:53:28.717673 [debug] [MainThread]: Command `dbt test` failed at 10:53:28.717673 after 1.94 seconds
[0m10:53:28.718675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280DAE9B4F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280DF7DE530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280DF7DE620>]}
[0m10:53:28.719674 [debug] [MainThread]: Flushing usage events
[0m10:55:32.725092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD6FFA75B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD72D136A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD72D134C0>]}


============================== 10:55:32.729092 | e1e6c1a5-2da9-464d-80b1-98cb5ebd5bd4 ==============================
[0m10:55:32.729092 [info ] [MainThread]: Running with dbt=1.8.0
[0m10:55:32.730093 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\18057\\Documents\\Coding\\fao-elt-pipelines\\dbt_project', 'log_path': 'C:\\Users\\18057\\Documents\\Coding\\fao-elt-pipelines\\dbt_project\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --target dev', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:55:32.885647 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m10:55:32.886650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e1e6c1a5-2da9-464d-80b1-98cb5ebd5bd4', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD72C955A0>]}
[0m10:55:32.989215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e1e6c1a5-2da9-464d-80b1-98cb5ebd5bd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD702746D0>]}
[0m10:55:33.071215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e1e6c1a5-2da9-464d-80b1-98cb5ebd5bd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD720E3940>]}
[0m10:55:33.073215 [info ] [MainThread]: Registered adapter: postgres=1.8.0
[0m10:55:33.082214 [debug] [MainThread]: checksum: 2a6c64e758918535ccc035b9d143fb4c91b01df5f630e583361ba23a87d2a511, vars: {}, profile: , target: dev, version: 1.8.0
[0m10:55:33.324798 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:55:33.325798 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:55:33.333798 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.fao_elt_pipeline.bronze
[0m10:55:33.401390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e1e6c1a5-2da9-464d-80b1-98cb5ebd5bd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD731CA050>]}
[0m10:55:33.579970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e1e6c1a5-2da9-464d-80b1-98cb5ebd5bd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD73174E50>]}
[0m10:55:33.580970 [info ] [MainThread]: Found 6 models, 23 data tests, 2 sources, 414 macros
[0m10:55:33.581970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1e6c1a5-2da9-464d-80b1-98cb5ebd5bd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD73174DF0>]}
[0m10:55:33.583970 [info ] [MainThread]: 
[0m10:55:33.584970 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:55:33.590970 [debug] [ThreadPool]: Acquiring new postgres connection 'list_fao'
[0m10:55:33.591970 [debug] [ThreadPool]: Acquiring new postgres connection 'list_fao'
[0m10:55:33.680972 [debug] [ThreadPool]: Using postgres connection "list_fao"
[0m10:55:33.681970 [debug] [ThreadPool]: Using postgres connection "list_fao"
[0m10:55:33.682971 [debug] [ThreadPool]: On list_fao: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "connection_name": "list_fao"} */

    select distinct nspname from pg_namespace
  
[0m10:55:33.683971 [debug] [ThreadPool]: On list_fao: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "connection_name": "list_fao"} */

    select distinct nspname from pg_namespace
  
[0m10:55:33.683971 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:55:33.684971 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:55:33.703973 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m10:55:33.704970 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m10:55:33.705970 [debug] [ThreadPool]: On list_fao: Close
[0m10:55:33.707972 [debug] [ThreadPool]: On list_fao: Close
[0m10:55:33.710972 [debug] [ThreadPool]: Acquiring new postgres connection 'list_fao_public_gold'
[0m10:55:33.752970 [debug] [ThreadPool]: Acquiring new postgres connection 'list_fao_public_silver'
[0m10:55:33.759541 [debug] [ThreadPool]: Using postgres connection "list_fao_public_gold"
[0m10:55:33.763051 [debug] [ThreadPool]: Using postgres connection "list_fao_public_silver"
[0m10:55:33.764087 [debug] [ThreadPool]: On list_fao_public_gold: BEGIN
[0m10:55:33.764620 [debug] [ThreadPool]: On list_fao_public_silver: BEGIN
[0m10:55:33.765140 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:55:33.765664 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:55:33.781085 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:55:33.781085 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:55:33.782085 [debug] [ThreadPool]: Using postgres connection "list_fao_public_gold"
[0m10:55:33.783083 [debug] [ThreadPool]: Using postgres connection "list_fao_public_silver"
[0m10:55:33.784085 [debug] [ThreadPool]: On list_fao_public_gold: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "connection_name": "list_fao_public_gold"} */
select
      'fao' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'fao' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'fao' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m10:55:33.784085 [debug] [ThreadPool]: On list_fao_public_silver: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "connection_name": "list_fao_public_silver"} */
select
      'fao' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'fao' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'fao' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m10:55:33.788085 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m10:55:33.789083 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m10:55:33.791083 [debug] [ThreadPool]: On list_fao_public_gold: ROLLBACK
[0m10:55:33.793085 [debug] [ThreadPool]: On list_fao_public_silver: ROLLBACK
[0m10:55:33.794085 [debug] [ThreadPool]: On list_fao_public_gold: Close
[0m10:55:33.794085 [debug] [ThreadPool]: On list_fao_public_silver: Close
[0m10:55:33.802083 [debug] [MainThread]: Using postgres connection "master"
[0m10:55:33.803085 [debug] [MainThread]: On master: BEGIN
[0m10:55:33.803085 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:55:33.818083 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:55:33.819085 [debug] [MainThread]: Using postgres connection "master"
[0m10:55:33.819085 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:55:33.825083 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m10:55:33.826086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1e6c1a5-2da9-464d-80b1-98cb5ebd5bd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD72FAF4F0>]}
[0m10:55:33.827086 [debug] [MainThread]: On master: ROLLBACK
[0m10:55:33.828083 [debug] [MainThread]: Using postgres connection "master"
[0m10:55:33.829084 [debug] [MainThread]: On master: BEGIN
[0m10:55:33.830085 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:55:33.831085 [debug] [MainThread]: On master: COMMIT
[0m10:55:33.832083 [debug] [MainThread]: Using postgres connection "master"
[0m10:55:33.832083 [debug] [MainThread]: On master: COMMIT
[0m10:55:33.834084 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:55:33.834084 [debug] [MainThread]: On master: Close
[0m10:55:33.835229 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:55:33.836084 [info ] [MainThread]: 
[0m10:55:33.840083 [debug] [Thread-1 (]: Began running node model.fao_elt_pipeline.silver_prices_cleaned
[0m10:55:33.840763 [debug] [Thread-2 (]: Began running node model.fao_elt_pipeline.silver_production_cleaned
[0m10:55:33.841830 [info ] [Thread-1 (]: 1 of 6 START sql table model public_silver.silver_prices_cleaned ............... [RUN]
[0m10:55:33.842892 [info ] [Thread-2 (]: 2 of 6 START sql table model public_silver.silver_production_cleaned ........... [RUN]
[0m10:55:33.843931 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.fao_elt_pipeline.silver_prices_cleaned'
[0m10:55:33.844964 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.fao_elt_pipeline.silver_production_cleaned'
[0m10:55:33.845989 [debug] [Thread-1 (]: Began compiling node model.fao_elt_pipeline.silver_prices_cleaned
[0m10:55:33.846503 [debug] [Thread-2 (]: Began compiling node model.fao_elt_pipeline.silver_production_cleaned
[0m10:55:33.861167 [debug] [Thread-1 (]: Writing injected SQL for node "model.fao_elt_pipeline.silver_prices_cleaned"
[0m10:55:33.867169 [debug] [Thread-2 (]: Writing injected SQL for node "model.fao_elt_pipeline.silver_production_cleaned"
[0m10:55:33.869167 [debug] [Thread-1 (]: Began executing node model.fao_elt_pipeline.silver_prices_cleaned
[0m10:55:33.886164 [debug] [Thread-2 (]: Began executing node model.fao_elt_pipeline.silver_production_cleaned
[0m10:55:33.925165 [debug] [Thread-1 (]: Writing runtime sql for node "model.fao_elt_pipeline.silver_prices_cleaned"
[0m10:55:33.929164 [debug] [Thread-2 (]: Writing runtime sql for node "model.fao_elt_pipeline.silver_production_cleaned"
[0m10:55:33.931166 [debug] [Thread-1 (]: Using postgres connection "model.fao_elt_pipeline.silver_prices_cleaned"
[0m10:55:33.932168 [debug] [Thread-1 (]: On model.fao_elt_pipeline.silver_prices_cleaned: BEGIN
[0m10:55:33.932168 [debug] [Thread-2 (]: Using postgres connection "model.fao_elt_pipeline.silver_production_cleaned"
[0m10:55:33.933165 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:55:33.934166 [debug] [Thread-2 (]: On model.fao_elt_pipeline.silver_production_cleaned: BEGIN
[0m10:55:33.935167 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:55:33.948167 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:55:33.949167 [debug] [Thread-1 (]: Using postgres connection "model.fao_elt_pipeline.silver_prices_cleaned"
[0m10:55:33.950165 [debug] [Thread-1 (]: On model.fao_elt_pipeline.silver_prices_cleaned: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.silver_prices_cleaned"} */

  
    

  create  table "fao"."public_silver"."silver_prices_cleaned__dbt_tmp"
  
  
    as
  
  (
    

WITH raw_prices AS (
    SELECT
        data,
        loaded_at
    FROM "fao"."bronze"."raw_prices"
),

flattened_prices AS (
    SELECT
        (data->>'area')::TEXT as country_name,
        (data->>'area_code')::TEXT as area_code,
        (data->>'area_code_m49')::TEXT as area_code_m49,
        (data->>'element')::TEXT as element_name,
        (data->>'element_code')::TEXT as element_code,
        (data->>'flag')::TEXT as flag,
        (data->>'item')::TEXT as item_name,
        (data->>'item_code')::TEXT as item_code,
        (data->>'item_code_cpc')::TEXT as item_code_cpc,
        (data->>'unit')::TEXT as unit,
        (data->>'value')::NUMERIC as price_value,
        (data->>'year')::INTEGER as year,
        loaded_at
    FROM raw_prices
)

SELECT
    
    md5(
            coalesce(cast(area_code as varchar), '') || '-' || 
            coalesce(cast(item_code as varchar), '') || '-' || 
            coalesce(cast(year as varchar), '')
    )
 as price_id,
    country_name,
    area_code,
    area_code_m49,
    element_name,
    element_code,
    flag,
    item_name,
    item_code,
    item_code_cpc,
    unit,
    price_value,
    year,
    -- Add data quality flags
    CASE
        WHEN price_value IS NULL OR price_value <= 0 THEN FALSE
        ELSE TRUE
    END as is_valid_price,
    -- Add standardized country names (handle special characters)
    CASE
        WHEN country_name LIKE '%Côte%' THEN 'Ivory Coast'
        WHEN country_name = 'China, mainland' THEN 'China'
        WHEN country_name = 'United States of America' THEN 'USA'
        WHEN country_name = 'United Kingdom of Great Britain and Northern Ireland' THEN 'UK'
        ELSE country_name
    END as country_name_standardized,
    loaded_at,
    CURRENT_TIMESTAMP as transformed_at
FROM flattened_prices
WHERE price_value IS NOT NULL
  AND price_value > 0
  AND year >= 1990  -- Focus on more recent data
  );
  
[0m10:55:33.958165 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m10:55:33.958165 [debug] [Thread-2 (]: Using postgres connection "model.fao_elt_pipeline.silver_production_cleaned"
[0m10:55:33.959922 [debug] [Thread-2 (]: On model.fao_elt_pipeline.silver_production_cleaned: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.silver_production_cleaned"} */

  
    

  create  table "fao"."public_silver"."silver_production_cleaned__dbt_tmp"
  
  
    as
  
  (
    

WITH raw_production AS (
    SELECT
        data,
        loaded_at
    FROM "fao"."bronze"."raw_food_balance"
),

flattened_production AS (
    SELECT
        (data->>'area')::TEXT as country_name,
        (data->>'area_code')::TEXT as area_code,
        (data->>'area_code_m49')::TEXT as area_code_m49,
        (data->>'element')::TEXT as element_name,
        (data->>'element_code')::TEXT as element_code,
        (data->>'flag')::TEXT as flag,
        (data->>'item')::TEXT as item_name,
        (data->>'item_code')::TEXT as item_code,
        (data->>'item_code_fbs')::TEXT as item_code_fbs,
        (data->>'unit')::TEXT as unit,
        (data->>'value')::NUMERIC as production_value,
        (data->>'year')::INTEGER as year,
        loaded_at
    FROM raw_production
)

SELECT
    
    md5(
            coalesce(cast(area_code as varchar), '') || '-' || 
            coalesce(cast(item_code as varchar), '') || '-' || 
            coalesce(cast(year as varchar), '')
    )
 as production_id,
    country_name,
    area_code,
    area_code_m49,
    element_name,
    element_code,
    flag,
    item_name,
    item_code,
    item_code_fbs,
    unit,
    production_value,
    year,
    -- Convert to metric tons for consistency
    CASE
        WHEN unit = '1000 t' THEN production_value * 1000
        ELSE production_value
    END as production_metric_tons,
    -- Add data quality flags
    CASE
        WHEN production_value IS NULL OR production_value < 0 THEN FALSE
        ELSE TRUE
    END as is_valid_production,
    -- Add standardized country names
    CASE
        WHEN country_name LIKE '%Côte%' THEN 'Ivory Coast'
        WHEN country_name = 'China, mainland' THEN 'China'
        WHEN country_name = 'United States of America' THEN 'USA'
        WHEN country_name = 'United Kingdom of Great Britain and Northern Ireland' THEN 'UK'
        ELSE country_name
    END as country_name_standardized,
    loaded_at,
    CURRENT_TIMESTAMP as transformed_at
FROM flattened_production
WHERE element_name = 'Production'  -- Focus on production data only
  AND production_value >= 0
  AND year >= 1990
  );
  
[0m10:55:33.962164 [debug] [Thread-1 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m10:55:33.970492 [debug] [Thread-1 (]: Using postgres connection "model.fao_elt_pipeline.silver_prices_cleaned"
[0m10:55:33.971492 [debug] [Thread-1 (]: On model.fao_elt_pipeline.silver_prices_cleaned: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.silver_prices_cleaned"} */
alter table "fao"."public_silver"."silver_prices_cleaned" rename to "silver_prices_cleaned__dbt_backup"
[0m10:55:33.972493 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m10:55:33.972493 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:55:33.976496 [debug] [Thread-2 (]: Using postgres connection "model.fao_elt_pipeline.silver_production_cleaned"
[0m10:55:33.980492 [debug] [Thread-1 (]: Using postgres connection "model.fao_elt_pipeline.silver_prices_cleaned"
[0m10:55:33.981491 [debug] [Thread-2 (]: On model.fao_elt_pipeline.silver_production_cleaned: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.silver_production_cleaned"} */
alter table "fao"."public_silver"."silver_production_cleaned" rename to "silver_production_cleaned__dbt_backup"
[0m10:55:33.982492 [debug] [Thread-1 (]: On model.fao_elt_pipeline.silver_prices_cleaned: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.silver_prices_cleaned"} */
alter table "fao"."public_silver"."silver_prices_cleaned__dbt_tmp" rename to "silver_prices_cleaned"
[0m10:55:33.984493 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:55:33.985494 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:55:33.989494 [debug] [Thread-2 (]: Using postgres connection "model.fao_elt_pipeline.silver_production_cleaned"
[0m10:55:34.007492 [debug] [Thread-1 (]: Using postgres connection "model.fao_elt_pipeline.silver_prices_cleaned"
[0m10:55:34.008492 [debug] [Thread-2 (]: On model.fao_elt_pipeline.silver_production_cleaned: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.silver_production_cleaned"} */
alter table "fao"."public_silver"."silver_production_cleaned__dbt_tmp" rename to "silver_production_cleaned"
[0m10:55:34.009492 [debug] [Thread-1 (]: On model.fao_elt_pipeline.silver_prices_cleaned: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.silver_prices_cleaned"} */

    create  index if not exists
  "eba4ed9de08cee62e5b76a4fdf25c3e1"
  on "fao"."public_silver"."silver_prices_cleaned" using btree
  (area_code, year)
  
[0m10:55:34.011494 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:55:34.014492 [debug] [Thread-2 (]: Using postgres connection "model.fao_elt_pipeline.silver_production_cleaned"
[0m10:55:34.015492 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m10:55:34.016492 [debug] [Thread-2 (]: On model.fao_elt_pipeline.silver_production_cleaned: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.silver_production_cleaned"} */

    create  index if not exists
  "91beb722c4e5c776d7af2eef7f74f84c"
  on "fao"."public_silver"."silver_production_cleaned" using btree
  (area_code, year)
  
[0m10:55:34.018492 [debug] [Thread-1 (]: Using postgres connection "model.fao_elt_pipeline.silver_prices_cleaned"
[0m10:55:34.019492 [debug] [Thread-1 (]: On model.fao_elt_pipeline.silver_prices_cleaned: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.silver_prices_cleaned"} */

    create  index if not exists
  "c82422f63646ef5329752b7bd7784c1c"
  on "fao"."public_silver"."silver_prices_cleaned" using btree
  (item_code)
  
[0m10:55:34.023492 [debug] [Thread-2 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m10:55:34.025494 [debug] [Thread-2 (]: Using postgres connection "model.fao_elt_pipeline.silver_production_cleaned"
[0m10:55:34.026495 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m10:55:34.026495 [debug] [Thread-2 (]: On model.fao_elt_pipeline.silver_production_cleaned: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.silver_production_cleaned"} */

    create  index if not exists
  "cc1186412d3ec212a0ef2733666eb2ec"
  on "fao"."public_silver"."silver_production_cleaned" using btree
  (item_code)
  
[0m10:55:34.047492 [debug] [Thread-1 (]: On model.fao_elt_pipeline.silver_prices_cleaned: COMMIT
[0m10:55:34.048492 [debug] [Thread-1 (]: Using postgres connection "model.fao_elt_pipeline.silver_prices_cleaned"
[0m10:55:34.049494 [debug] [Thread-1 (]: On model.fao_elt_pipeline.silver_prices_cleaned: COMMIT
[0m10:55:34.051492 [debug] [Thread-2 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m10:55:34.053492 [debug] [Thread-2 (]: On model.fao_elt_pipeline.silver_production_cleaned: COMMIT
[0m10:55:34.054491 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m10:55:34.054491 [debug] [Thread-2 (]: Using postgres connection "model.fao_elt_pipeline.silver_production_cleaned"
[0m10:55:34.063492 [debug] [Thread-1 (]: Applying DROP to: "fao"."public_silver"."silver_prices_cleaned__dbt_backup"
[0m10:55:34.064492 [debug] [Thread-2 (]: On model.fao_elt_pipeline.silver_production_cleaned: COMMIT
[0m10:55:34.069492 [debug] [Thread-1 (]: Using postgres connection "model.fao_elt_pipeline.silver_prices_cleaned"
[0m10:55:34.070492 [debug] [Thread-1 (]: On model.fao_elt_pipeline.silver_prices_cleaned: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.silver_prices_cleaned"} */
drop table if exists "fao"."public_silver"."silver_prices_cleaned__dbt_backup" cascade
[0m10:55:34.071493 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m10:55:34.074492 [debug] [Thread-2 (]: Applying DROP to: "fao"."public_silver"."silver_production_cleaned__dbt_backup"
[0m10:55:34.075492 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:55:34.076492 [debug] [Thread-2 (]: Using postgres connection "model.fao_elt_pipeline.silver_production_cleaned"
[0m10:55:34.079492 [debug] [Thread-1 (]: On model.fao_elt_pipeline.silver_prices_cleaned: Close
[0m10:55:34.080492 [debug] [Thread-2 (]: On model.fao_elt_pipeline.silver_production_cleaned: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.silver_production_cleaned"} */
drop table if exists "fao"."public_silver"."silver_production_cleaned__dbt_backup" cascade
[0m10:55:34.082496 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1e6c1a5-2da9-464d-80b1-98cb5ebd5bd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD72DE98D0>]}
[0m10:55:34.084493 [info ] [Thread-1 (]: 1 of 6 OK created sql table model public_silver.silver_prices_cleaned .......... [[32mSELECT 1000[0m in 0.24s]
[0m10:55:34.085492 [debug] [Thread-1 (]: Finished running node model.fao_elt_pipeline.silver_prices_cleaned
[0m10:55:34.086495 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:55:34.087492 [debug] [Thread-2 (]: On model.fao_elt_pipeline.silver_production_cleaned: Close
[0m10:55:34.088492 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1e6c1a5-2da9-464d-80b1-98cb5ebd5bd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD72DEAA10>]}
[0m10:55:34.089494 [info ] [Thread-2 (]: 2 of 6 OK created sql table model public_silver.silver_production_cleaned ...... [[32mSELECT 1000[0m in 0.24s]
[0m10:55:34.090492 [debug] [Thread-2 (]: Finished running node model.fao_elt_pipeline.silver_production_cleaned
[0m10:55:34.091492 [debug] [Thread-4 (]: Began running node model.fao_elt_pipeline.gold_country_metrics
[0m10:55:34.092492 [debug] [Thread-3 (]: Began running node model.fao_elt_pipeline.gold_price_production_analysis
[0m10:55:34.093494 [debug] [Thread-1 (]: Began running node model.fao_elt_pipeline.gold_regional_summary
[0m10:55:34.094492 [debug] [Thread-2 (]: Began running node model.fao_elt_pipeline.silver_top_countries
[0m10:55:34.094492 [info ] [Thread-4 (]: 3 of 6 START sql table model public_gold.gold_country_metrics .................. [RUN]
[0m10:55:34.095492 [info ] [Thread-3 (]: 4 of 6 START sql table model public_gold.gold_price_production_analysis ........ [RUN]
[0m10:55:34.096492 [info ] [Thread-1 (]: 5 of 6 START sql table model public_gold.gold_regional_summary ................. [RUN]
[0m10:55:34.097494 [info ] [Thread-2 (]: 6 of 6 START sql table model public_silver.silver_top_countries ................ [RUN]
[0m10:55:34.098492 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.fao_elt_pipeline.gold_country_metrics'
[0m10:55:34.099492 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.fao_elt_pipeline.gold_price_production_analysis'
[0m10:55:34.100492 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fao_elt_pipeline.silver_prices_cleaned, now model.fao_elt_pipeline.gold_regional_summary)
[0m10:55:34.101494 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.fao_elt_pipeline.silver_production_cleaned, now model.fao_elt_pipeline.silver_top_countries)
[0m10:55:34.102493 [debug] [Thread-4 (]: Began compiling node model.fao_elt_pipeline.gold_country_metrics
[0m10:55:34.102493 [debug] [Thread-3 (]: Began compiling node model.fao_elt_pipeline.gold_price_production_analysis
[0m10:55:34.103494 [debug] [Thread-1 (]: Began compiling node model.fao_elt_pipeline.gold_regional_summary
[0m10:55:34.104493 [debug] [Thread-2 (]: Began compiling node model.fao_elt_pipeline.silver_top_countries
[0m10:55:34.109494 [debug] [Thread-4 (]: Writing injected SQL for node "model.fao_elt_pipeline.gold_country_metrics"
[0m10:55:34.114492 [debug] [Thread-3 (]: Writing injected SQL for node "model.fao_elt_pipeline.gold_price_production_analysis"
[0m10:55:34.119492 [debug] [Thread-1 (]: Writing injected SQL for node "model.fao_elt_pipeline.gold_regional_summary"
[0m10:55:34.125491 [debug] [Thread-2 (]: Writing injected SQL for node "model.fao_elt_pipeline.silver_top_countries"
[0m10:55:34.127493 [debug] [Thread-4 (]: Began executing node model.fao_elt_pipeline.gold_country_metrics
[0m10:55:34.128493 [debug] [Thread-3 (]: Began executing node model.fao_elt_pipeline.gold_price_production_analysis
[0m10:55:34.134492 [debug] [Thread-4 (]: Writing runtime sql for node "model.fao_elt_pipeline.gold_country_metrics"
[0m10:55:34.135493 [debug] [Thread-1 (]: Began executing node model.fao_elt_pipeline.gold_regional_summary
[0m10:55:34.139492 [debug] [Thread-3 (]: Writing runtime sql for node "model.fao_elt_pipeline.gold_price_production_analysis"
[0m10:55:34.140492 [debug] [Thread-2 (]: Began executing node model.fao_elt_pipeline.silver_top_countries
[0m10:55:34.144492 [debug] [Thread-1 (]: Writing runtime sql for node "model.fao_elt_pipeline.gold_regional_summary"
[0m10:55:34.145492 [debug] [Thread-4 (]: Using postgres connection "model.fao_elt_pipeline.gold_country_metrics"
[0m10:55:34.150493 [debug] [Thread-2 (]: Writing runtime sql for node "model.fao_elt_pipeline.silver_top_countries"
[0m10:55:34.151493 [debug] [Thread-3 (]: Using postgres connection "model.fao_elt_pipeline.gold_price_production_analysis"
[0m10:55:34.151493 [debug] [Thread-4 (]: On model.fao_elt_pipeline.gold_country_metrics: BEGIN
[0m10:55:34.152493 [debug] [Thread-1 (]: Using postgres connection "model.fao_elt_pipeline.gold_regional_summary"
[0m10:55:34.153492 [debug] [Thread-3 (]: On model.fao_elt_pipeline.gold_price_production_analysis: BEGIN
[0m10:55:34.154492 [debug] [Thread-2 (]: Using postgres connection "model.fao_elt_pipeline.silver_top_countries"
[0m10:55:34.155493 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:55:34.155493 [debug] [Thread-1 (]: On model.fao_elt_pipeline.gold_regional_summary: BEGIN
[0m10:55:34.156495 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:55:34.157494 [debug] [Thread-2 (]: On model.fao_elt_pipeline.silver_top_countries: BEGIN
[0m10:55:34.158492 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:55:34.159492 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:55:34.172136 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m10:55:34.173137 [debug] [Thread-4 (]: Using postgres connection "model.fao_elt_pipeline.gold_country_metrics"
[0m10:55:34.173137 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:55:34.174135 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m10:55:34.175134 [debug] [Thread-4 (]: On model.fao_elt_pipeline.gold_country_metrics: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.gold_country_metrics"} */

  
    

  create  table "fao"."public_gold"."gold_country_metrics__dbt_tmp"
  
  
    as
  
  (
    

WITH country_production AS (
    SELECT
        country_name_standardized as country_name,
        area_code,
        year,
        SUM(production_metric_tons) as annual_production,
        COUNT(DISTINCT item_code) as products_produced
    FROM "fao"."public_silver"."silver_production_cleaned"
    WHERE is_valid_production = TRUE
    GROUP BY country_name_standardized, area_code, year
),

country_prices AS (
    SELECT
        country_name_standardized as country_name,
        area_code,
        year,
        AVG(price_value) as avg_annual_price,
        COUNT(DISTINCT item_code) as products_priced
    FROM "fao"."public_silver"."silver_prices_cleaned"
    WHERE is_valid_price = TRUE
    GROUP BY country_name_standardized, area_code, year
),

country_trends AS (
    SELECT
        cp.country_name,
        cp.area_code,
        -- Production metrics
        SUM(cp.annual_production) as total_production_all_years,
        AVG(cp.annual_production) as avg_annual_production,
        MAX(cp.annual_production) as peak_annual_production,
        MIN(cp.annual_production) as min_annual_production,
        -- Calculate production growth rate (comparing first and last 3 years)
        AVG(CASE WHEN cp.year >= 2018 THEN cp.annual_production END) -
        AVG(CASE WHEN cp.year <= 1993 THEN cp.annual_production END) as production_change,
        -- Price metrics
        AVG(pc.avg_annual_price) as avg_price_all_years,
        MAX(pc.avg_annual_price) as max_price,
        MIN(pc.avg_annual_price) as min_price,
        -- Product diversity
        MAX(cp.products_produced) as max_products_produced,
        AVG(cp.products_produced) as avg_products_produced,
        -- Data availability
        COUNT(DISTINCT cp.year) as years_with_data,
        MIN(cp.year) as first_year,
        MAX(cp.year) as last_year
    FROM country_production cp
    LEFT JOIN country_prices pc
        ON cp.country_name = pc.country_name
        AND cp.area_code = pc.area_code
        AND cp.year = pc.year
    GROUP BY cp.country_name, cp.area_code
)





SELECT
    country_name,
    area_code,
    -- Production metrics
    ROUND(total_production_all_years, 0) as total_production_metric_tons,
    ROUND(avg_annual_production, 0) as avg_annual_production_metric_tons,
    ROUND(peak_annual_production, 0) as peak_production_metric_tons,
    ROUND(production_change, 0) as production_growth_metric_tons,
    CASE
        WHEN production_change > 0 THEN 'Growing'
        WHEN production_change < 0 THEN 'Declining'
        ELSE 'Stable'
    END as production_trend,
    -- Price metrics
    ROUND(avg_price_all_years, 2) as avg_price_usd_per_tonne,
    ROUND(max_price, 2) as max_price_usd_per_tonne,
    ROUND(min_price, 2) as min_price_usd_per_tonne,
    ROUND(max_price - min_price, 2) as price_volatility,
    -- Product diversity
    max_products_produced,
    ROUND(avg_products_produced, 1) as avg_products_produced,
    -- Classifications
    CASE
        WHEN total_production_all_years > 1000000 THEN 'Major Producer'
        WHEN total_production_all_years > 100000 THEN 'Medium Producer'
        ELSE 'Small Producer'
    END as producer_category,
    CASE
        WHEN avg_price_all_years > 1000 THEN 'High Value'
        WHEN avg_price_all_years > 500 THEN 'Medium Value'
        ELSE 'Low Value'
    END as price_category,
    -- Metadata
    years_with_data,
    first_year,
    last_year,
    CURRENT_TIMESTAMP as calculated_at
FROM country_trends
WHERE total_production_all_years > 0
ORDER BY total_production_all_years DESC
  );
  
[0m10:55:34.176134 [debug] [Thread-1 (]: Using postgres connection "model.fao_elt_pipeline.gold_regional_summary"
[0m10:55:34.177134 [debug] [Thread-2 (]: Using postgres connection "model.fao_elt_pipeline.silver_top_countries"
[0m10:55:34.178136 [debug] [Thread-1 (]: On model.fao_elt_pipeline.gold_regional_summary: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.gold_regional_summary"} */

  
    

  create  table "fao"."public_gold"."gold_regional_summary__dbt_tmp"
  
  
    as
  
  (
    

WITH country_regions AS (
    -- Simple regional classification based on country names
    -- In production, you'd use a proper country-region mapping table
    SELECT
        country_name_standardized,
        area_code,
        CASE
            WHEN country_name_standardized IN ('China', 'India', 'Japan', 'Republic of Korea',
                                               'Thailand', 'Pakistan', 'Bangladesh', 'Myanmar') THEN 'Asia'
            WHEN country_name_standardized IN ('USA', 'Canada', 'Mexico') THEN 'North America'
            WHEN country_name_standardized IN ('Brazil', 'Argentina', 'Chile', 'Colombia',
                                               'Peru', 'Ecuador', 'Venezuela (Bolivarian Republic of)',
                                               'Paraguay', 'Uruguay', 'Bolivia (Plurinational State of)') THEN 'South America'
            WHEN country_name_standardized IN ('Germany', 'France', 'UK', 'Italy', 'Spain',
                                               'Poland', 'Netherlands (Kingdom of the)', 'Belgium',
                                               'Greece', 'Portugal', 'Sweden', 'Austria',
                                               'Denmark', 'Finland', 'Norway', 'Switzerland') THEN 'Europe'
            WHEN country_name_standardized IN ('Nigeria', 'Egypt', 'South Africa', 'Kenya',
                                               'Ethiopia', 'Morocco', 'Tunisia', 'Algeria',
                                               'Ghana', 'Ivory Coast', 'Senegal') THEN 'Africa'
            WHEN country_name_standardized IN ('Australia', 'New Zealand', 'Fiji') THEN 'Oceania'
            WHEN country_name_standardized IN ('Saudi Arabia', 'Iran (Islamic Republic of)',
                                               'Iraq', 'Syrian Arab Republic', 'Yemen',
                                               'United Arab Emirates', 'Oman') THEN 'Middle East'
            ELSE 'Other'
        END as region
    FROM (
        SELECT DISTINCT country_name_standardized, area_code
        FROM "fao"."public_silver"."silver_production_cleaned"
        UNION
        SELECT DISTINCT country_name_standardized, area_code
        FROM "fao"."public_silver"."silver_prices_cleaned"
    ) countries
),

regional_production AS (
    SELECT
        cr.region,
        p.year,
        p.item_name,
        SUM(p.production_metric_tons) as regional_production,
        COUNT(DISTINCT p.area_code) as countries_producing,
        AVG(p.production_metric_tons) as avg_country_production
    FROM "fao"."public_silver"."silver_production_cleaned" p
    JOIN country_regions cr
        ON p.country_name_standardized = cr.country_name_standardized
    WHERE p.is_valid_production = TRUE
    GROUP BY cr.region, p.year, p.item_name
),

regional_prices AS (
    SELECT
        cr.region,
        pr.year,
        pr.item_name,
        AVG(pr.price_value) as avg_regional_price,
        MAX(pr.price_value) as max_regional_price,
        MIN(pr.price_value) as min_regional_price,
        COUNT(DISTINCT pr.area_code) as countries_with_prices
    FROM "fao"."public_silver"."silver_prices_cleaned" pr
    JOIN country_regions cr
        ON pr.country_name_standardized = cr.country_name_standardized
    WHERE pr.is_valid_price = TRUE
    GROUP BY cr.region, pr.year, pr.item_name
)

SELECT
    COALESCE(rp.region, rpr.region) as region,
    -- Production metrics
    ROUND(SUM(rp.regional_production), 0) as total_production_metric_tons,
    ROUND(AVG(rp.regional_production), 0) as avg_annual_production,
    COUNT(DISTINCT rp.countries_producing) as total_producing_countries,
    COUNT(DISTINCT rp.item_name) as products_produced,
    -- Price metrics
    ROUND(AVG(rpr.avg_regional_price), 2) as avg_price_usd_per_tonne,
    ROUND(MAX(rpr.max_regional_price), 2) as highest_price_recorded,
    ROUND(AVG(rpr.max_regional_price - rpr.min_regional_price), 2) as avg_price_volatility,
    -- Market value
    ROUND(SUM(
        CASE
            WHEN rp.regional_production > 0 AND rpr.avg_regional_price > 0
            THEN rp.regional_production * rpr.avg_regional_price
            ELSE 0
        END
    ), 0) as total_market_value,
    -- Growth metrics (comparing recent vs early years)
    ROUND(
        AVG(CASE WHEN rp.year >= 2018 THEN rp.regional_production END) -
        AVG(CASE WHEN rp.year <= 1995 THEN rp.regional_production END),
        0
    ) as production_growth,
    -- Regional characteristics
    CASE
        WHEN SUM(rp.regional_production) > 100000000 THEN 'Major Agricultural Region'
        WHEN SUM(rp.regional_production) > 10000000 THEN 'Medium Agricultural Region'
        ELSE 'Minor Agricultural Region'
    END as regional_scale,
    -- Data coverage
    COUNT(DISTINCT COALESCE(rp.year, rpr.year)) as years_with_data,
    MIN(COALESCE(rp.year, rpr.year)) as first_year,
    MAX(COALESCE(rp.year, rpr.year)) as last_year,
    CURRENT_TIMESTAMP as calculated_at
FROM regional_production rp
FULL OUTER JOIN regional_prices rpr
    ON rp.region = rpr.region
    AND rp.year = rpr.year
    AND rp.item_name = rpr.item_name
WHERE COALESCE(rp.region, rpr.region) != 'Other'
GROUP BY COALESCE(rp.region, rpr.region)
ORDER BY total_production_metric_tons DESC
  );
  
[0m10:55:34.179136 [debug] [Thread-2 (]: On model.fao_elt_pipeline.silver_top_countries: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.silver_top_countries"} */

  
    

  create  table "fao"."public_silver"."silver_top_countries__dbt_tmp"
  
  
    as
  
  (
    

WITH production_rankings AS (
    SELECT
        country_name_standardized,
        area_code,
        SUM(production_metric_tons) as total_production,
        COUNT(DISTINCT item_code) as product_diversity,
        COUNT(DISTINCT year) as years_of_data,
        AVG(production_metric_tons) as avg_annual_production,
        MAX(year) as latest_year
    FROM "fao"."public_silver"."silver_production_cleaned"
    WHERE is_valid_production = TRUE
    GROUP BY country_name_standardized, area_code
),

price_rankings AS (
    SELECT
        country_name_standardized,
        area_code,
        AVG(price_value) as avg_price,
        COUNT(DISTINCT item_code) as items_with_prices,
        MAX(price_value) as max_price,
        MIN(price_value) as min_price
    FROM "fao"."public_silver"."silver_prices_cleaned"
    WHERE is_valid_price = TRUE
    GROUP BY country_name_standardized, area_code
),

combined_rankings AS (
    SELECT
        COALESCE(pr.country_name_standardized, pc.country_name_standardized) as country_name,
        COALESCE(pr.area_code, pc.area_code) as area_code,
        pr.total_production,
        pr.product_diversity,
        pr.avg_annual_production,
        pc.avg_price,
        pc.items_with_prices,
        pc.max_price,
        -- Calculate rankings
        RANK() OVER (ORDER BY pr.total_production DESC NULLS LAST) as production_rank,
        RANK() OVER (ORDER BY pc.avg_price DESC NULLS LAST) as price_rank,
        RANK() OVER (ORDER BY pr.product_diversity DESC NULLS LAST) as diversity_rank
    FROM production_rankings pr
    FULL OUTER JOIN price_rankings pc
        ON pr.country_name_standardized = pc.country_name_standardized
        AND pr.area_code = pc.area_code
)

SELECT
    country_name,
    area_code,
    total_production,
    product_diversity,
    ROUND(avg_annual_production, 2) as avg_annual_production,
    ROUND(avg_price, 2) as avg_price_usd_per_tonne,
    items_with_prices,
    ROUND(max_price, 2) as max_price_usd_per_tonne,
    production_rank,
    price_rank,
    diversity_rank,
    -- Identify top performers
    CASE
        WHEN production_rank <= 10 THEN TRUE
        ELSE FALSE
    END as is_top_producer,
    CASE
        WHEN price_rank <= 10 THEN TRUE
        ELSE FALSE
    END as is_high_price_country,
    CASE
        WHEN diversity_rank <= 10 THEN TRUE
        ELSE FALSE
    END as is_diverse_producer,
    CURRENT_TIMESTAMP as calculated_at
FROM combined_rankings
WHERE country_name IS NOT NULL
  );
  
[0m10:55:34.188136 [debug] [Thread-4 (]: SQL status: SELECT 193 in 0.0 seconds
[0m10:55:34.192134 [debug] [Thread-4 (]: Using postgres connection "model.fao_elt_pipeline.gold_country_metrics"
[0m10:55:34.193136 [debug] [Thread-2 (]: SQL status: SELECT 210 in 0.0 seconds
[0m10:55:34.194136 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.0 seconds
[0m10:55:34.195134 [debug] [Thread-4 (]: On model.fao_elt_pipeline.gold_country_metrics: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.gold_country_metrics"} */
alter table "fao"."public_gold"."gold_country_metrics" rename to "gold_country_metrics__dbt_backup"
[0m10:55:34.198134 [debug] [Thread-2 (]: Using postgres connection "model.fao_elt_pipeline.silver_top_countries"
[0m10:55:34.199134 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m10:55:34.203134 [debug] [Thread-1 (]: Using postgres connection "model.fao_elt_pipeline.gold_regional_summary"
[0m10:55:34.204134 [debug] [Thread-2 (]: On model.fao_elt_pipeline.silver_top_countries: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.silver_top_countries"} */
alter table "fao"."public_silver"."silver_top_countries" rename to "silver_top_countries__dbt_backup"
[0m10:55:34.205135 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:55:34.206134 [debug] [Thread-3 (]: Using postgres connection "model.fao_elt_pipeline.gold_price_production_analysis"
[0m10:55:34.207138 [debug] [Thread-1 (]: On model.fao_elt_pipeline.gold_regional_summary: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.gold_regional_summary"} */
alter table "fao"."public_gold"."gold_regional_summary" rename to "gold_regional_summary__dbt_backup"
[0m10:55:34.211134 [debug] [Thread-4 (]: Using postgres connection "model.fao_elt_pipeline.gold_country_metrics"
[0m10:55:34.211134 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:55:34.212134 [debug] [Thread-3 (]: On model.fao_elt_pipeline.gold_price_production_analysis: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.gold_price_production_analysis"} */

  
    

  create  table "fao"."public_gold"."gold_price_production_analysis__dbt_tmp"
  
  
    as
  
  (
    

WITH item_production AS (
    SELECT
        item_name,
        item_code,
        year,
        SUM(production_metric_tons) as global_production,
        COUNT(DISTINCT area_code) as producing_countries
    FROM "fao"."public_silver"."silver_production_cleaned"
    WHERE is_valid_production = TRUE
    GROUP BY item_name, item_code, year
),

item_prices AS (
    SELECT
        item_name,
        item_code,
        year,
        AVG(price_value) as avg_global_price,
        MAX(price_value) as max_price,
        MIN(price_value) as min_price,
        COUNT(DISTINCT area_code) as countries_with_prices
    FROM "fao"."public_silver"."silver_prices_cleaned"
    WHERE is_valid_price = TRUE
    GROUP BY item_name, item_code, year
),

price_production_combined AS (
    SELECT
        COALESCE(ip.item_name, ipr.item_name) as item_name,
        COALESCE(ip.item_code, ipr.item_code) as item_code,
        COALESCE(ip.year, ipr.year) as year,
        ip.global_production,
        ip.producing_countries,
        ipr.avg_global_price,
        ipr.max_price,
        ipr.min_price,
        ipr.countries_with_prices,
        -- Calculate price-production metrics
        CASE
            WHEN ip.global_production > 0 AND ipr.avg_global_price > 0
            THEN ipr.avg_global_price * ip.global_production
            ELSE NULL
        END as market_value
    FROM item_production ip
    FULL OUTER JOIN item_prices ipr
        ON ip.item_code = ipr.item_code
        AND ip.year = ipr.year
)

SELECT
    item_name,
    item_code,
    -- Aggregate metrics across all years
    ROUND(AVG(global_production), 0) as avg_annual_production,
    ROUND(SUM(global_production), 0) as total_production_all_years,
    ROUND(AVG(avg_global_price), 2) as avg_price_all_years,
    ROUND(AVG(market_value), 0) as avg_annual_market_value,
    ROUND(SUM(market_value), 0) as total_market_value,
    -- Price volatility
    ROUND(AVG(max_price - min_price), 2) as avg_price_spread,
    ROUND(MAX(max_price), 2) as highest_price_recorded,
    -- Market concentration
    ROUND(AVG(producing_countries), 1) as avg_producing_countries,
    ROUND(AVG(countries_with_prices), 1) as avg_countries_with_prices,
    -- Categorization
    CASE
        WHEN AVG(global_production) > 10000000 THEN 'Major Commodity'
        WHEN AVG(global_production) > 1000000 THEN 'Medium Commodity'
        ELSE 'Minor Commodity'
    END as commodity_scale,
    CASE
        WHEN AVG(avg_global_price) > 2000 THEN 'Premium Product'
        WHEN AVG(avg_global_price) > 500 THEN 'Standard Product'
        ELSE 'Basic Product'
    END as price_tier,
    -- Data quality
    COUNT(DISTINCT year) as years_with_data,
    MIN(year) as first_year,
    MAX(year) as last_year,
    CURRENT_TIMESTAMP as calculated_at
FROM price_production_combined
WHERE item_name IS NOT NULL
GROUP BY item_name, item_code
HAVING COUNT(DISTINCT year) >= 5  -- Only include items with sufficient data
ORDER BY total_market_value DESC NULLS LAST
  );
  
[0m10:55:34.214136 [debug] [Thread-4 (]: On model.fao_elt_pipeline.gold_country_metrics: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.gold_country_metrics"} */
alter table "fao"."public_gold"."gold_country_metrics__dbt_tmp" rename to "gold_country_metrics"
[0m10:55:34.214136 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:55:34.218135 [debug] [Thread-2 (]: Using postgres connection "model.fao_elt_pipeline.silver_top_countries"
[0m10:55:34.222135 [debug] [Thread-1 (]: Using postgres connection "model.fao_elt_pipeline.gold_regional_summary"
[0m10:55:34.223136 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:55:34.224136 [debug] [Thread-2 (]: On model.fao_elt_pipeline.silver_top_countries: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.silver_top_countries"} */
alter table "fao"."public_silver"."silver_top_countries__dbt_tmp" rename to "silver_top_countries"
[0m10:55:34.225135 [debug] [Thread-1 (]: On model.fao_elt_pipeline.gold_regional_summary: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.gold_regional_summary"} */
alter table "fao"."public_gold"."gold_regional_summary__dbt_tmp" rename to "gold_regional_summary"
[0m10:55:34.227135 [debug] [Thread-4 (]: Using postgres connection "model.fao_elt_pipeline.gold_country_metrics"
[0m10:55:34.228135 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.0 seconds
[0m10:55:34.229137 [debug] [Thread-4 (]: On model.fao_elt_pipeline.gold_country_metrics: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.gold_country_metrics"} */

    create  index if not exists
  "1221751b86ec585fac847c497f67e037"
  on "fao"."public_gold"."gold_country_metrics" using btree
  (country_name)
  
[0m10:55:34.230134 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:55:34.230134 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:55:34.234134 [debug] [Thread-3 (]: Using postgres connection "model.fao_elt_pipeline.gold_price_production_analysis"
[0m10:55:34.236136 [debug] [Thread-2 (]: On model.fao_elt_pipeline.silver_top_countries: COMMIT
[0m10:55:34.238134 [debug] [Thread-1 (]: On model.fao_elt_pipeline.gold_regional_summary: COMMIT
[0m10:55:34.239136 [debug] [Thread-4 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m10:55:34.240136 [debug] [Thread-3 (]: On model.fao_elt_pipeline.gold_price_production_analysis: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.gold_price_production_analysis"} */
alter table "fao"."public_gold"."gold_price_production_analysis" rename to "gold_price_production_analysis__dbt_backup"
[0m10:55:34.241136 [debug] [Thread-2 (]: Using postgres connection "model.fao_elt_pipeline.silver_top_countries"
[0m10:55:34.241136 [debug] [Thread-1 (]: Using postgres connection "model.fao_elt_pipeline.gold_regional_summary"
[0m10:55:34.244135 [debug] [Thread-4 (]: On model.fao_elt_pipeline.gold_country_metrics: COMMIT
[0m10:55:34.245137 [debug] [Thread-2 (]: On model.fao_elt_pipeline.silver_top_countries: COMMIT
[0m10:55:34.245137 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:55:34.246136 [debug] [Thread-1 (]: On model.fao_elt_pipeline.gold_regional_summary: COMMIT
[0m10:55:34.247134 [debug] [Thread-4 (]: Using postgres connection "model.fao_elt_pipeline.gold_country_metrics"
[0m10:55:34.251134 [debug] [Thread-3 (]: Using postgres connection "model.fao_elt_pipeline.gold_price_production_analysis"
[0m10:55:34.252134 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m10:55:34.253134 [debug] [Thread-4 (]: On model.fao_elt_pipeline.gold_country_metrics: COMMIT
[0m10:55:34.254137 [debug] [Thread-3 (]: On model.fao_elt_pipeline.gold_price_production_analysis: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.gold_price_production_analysis"} */
alter table "fao"."public_gold"."gold_price_production_analysis__dbt_tmp" rename to "gold_price_production_analysis"
[0m10:55:34.254137 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m10:55:34.258134 [debug] [Thread-2 (]: Applying DROP to: "fao"."public_silver"."silver_top_countries__dbt_backup"
[0m10:55:34.262134 [debug] [Thread-1 (]: Applying DROP to: "fao"."public_gold"."gold_regional_summary__dbt_backup"
[0m10:55:34.263134 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:55:34.264135 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m10:55:34.265134 [debug] [Thread-2 (]: Using postgres connection "model.fao_elt_pipeline.silver_top_countries"
[0m10:55:34.266134 [debug] [Thread-1 (]: Using postgres connection "model.fao_elt_pipeline.gold_regional_summary"
[0m10:55:34.268134 [debug] [Thread-3 (]: On model.fao_elt_pipeline.gold_price_production_analysis: COMMIT
[0m10:55:34.271134 [debug] [Thread-4 (]: Applying DROP to: "fao"."public_gold"."gold_country_metrics__dbt_backup"
[0m10:55:34.272134 [debug] [Thread-2 (]: On model.fao_elt_pipeline.silver_top_countries: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.silver_top_countries"} */
drop table if exists "fao"."public_silver"."silver_top_countries__dbt_backup" cascade
[0m10:55:34.273134 [debug] [Thread-1 (]: On model.fao_elt_pipeline.gold_regional_summary: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.gold_regional_summary"} */
drop table if exists "fao"."public_gold"."gold_regional_summary__dbt_backup" cascade
[0m10:55:34.274135 [debug] [Thread-3 (]: Using postgres connection "model.fao_elt_pipeline.gold_price_production_analysis"
[0m10:55:34.275136 [debug] [Thread-4 (]: Using postgres connection "model.fao_elt_pipeline.gold_country_metrics"
[0m10:55:34.276136 [debug] [Thread-3 (]: On model.fao_elt_pipeline.gold_price_production_analysis: COMMIT
[0m10:55:34.277135 [debug] [Thread-4 (]: On model.fao_elt_pipeline.gold_country_metrics: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.gold_country_metrics"} */
drop table if exists "fao"."public_gold"."gold_country_metrics__dbt_backup" cascade
[0m10:55:34.278136 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:55:34.279135 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:55:34.280135 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m10:55:34.281135 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:55:34.282134 [debug] [Thread-2 (]: On model.fao_elt_pipeline.silver_top_countries: Close
[0m10:55:34.284136 [debug] [Thread-1 (]: On model.fao_elt_pipeline.gold_regional_summary: Close
[0m10:55:34.287137 [debug] [Thread-3 (]: Applying DROP to: "fao"."public_gold"."gold_price_production_analysis__dbt_backup"
[0m10:55:34.289135 [debug] [Thread-4 (]: On model.fao_elt_pipeline.gold_country_metrics: Close
[0m10:55:34.290135 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1e6c1a5-2da9-464d-80b1-98cb5ebd5bd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD730E7BB0>]}
[0m10:55:34.291137 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1e6c1a5-2da9-464d-80b1-98cb5ebd5bd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD747E1E10>]}
[0m10:55:34.292136 [debug] [Thread-3 (]: Using postgres connection "model.fao_elt_pipeline.gold_price_production_analysis"
[0m10:55:34.293135 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1e6c1a5-2da9-464d-80b1-98cb5ebd5bd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD7474F400>]}
[0m10:55:34.294138 [info ] [Thread-2 (]: 6 of 6 OK created sql table model public_silver.silver_top_countries ........... [[32mSELECT 210[0m in 0.19s]
[0m10:55:34.296136 [info ] [Thread-1 (]: 5 of 6 OK created sql table model public_gold.gold_regional_summary ............ [[32mSELECT 7[0m in 0.19s]
[0m10:55:34.296136 [debug] [Thread-3 (]: On model.fao_elt_pipeline.gold_price_production_analysis: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.gold_price_production_analysis"} */
drop table if exists "fao"."public_gold"."gold_price_production_analysis__dbt_backup" cascade
[0m10:55:34.298135 [info ] [Thread-4 (]: 3 of 6 OK created sql table model public_gold.gold_country_metrics ............. [[32mSELECT 193[0m in 0.19s]
[0m10:55:34.299134 [debug] [Thread-2 (]: Finished running node model.fao_elt_pipeline.silver_top_countries
[0m10:55:34.300136 [debug] [Thread-1 (]: Finished running node model.fao_elt_pipeline.gold_regional_summary
[0m10:55:34.301137 [debug] [Thread-4 (]: Finished running node model.fao_elt_pipeline.gold_country_metrics
[0m10:55:34.303136 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:55:34.304135 [debug] [Thread-3 (]: On model.fao_elt_pipeline.gold_price_production_analysis: Close
[0m10:55:34.305134 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1e6c1a5-2da9-464d-80b1-98cb5ebd5bd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD74734EB0>]}
[0m10:55:34.306136 [info ] [Thread-3 (]: 4 of 6 OK created sql table model public_gold.gold_price_production_analysis ... [[32mSELECT 0[0m in 0.21s]
[0m10:55:34.307135 [debug] [Thread-3 (]: Finished running node model.fao_elt_pipeline.gold_price_production_analysis
[0m10:55:34.309134 [debug] [MainThread]: Using postgres connection "master"
[0m10:55:34.310136 [debug] [MainThread]: On master: BEGIN
[0m10:55:34.310136 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:55:34.324134 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:55:34.325136 [debug] [MainThread]: On master: COMMIT
[0m10:55:34.326135 [debug] [MainThread]: Using postgres connection "master"
[0m10:55:34.327137 [debug] [MainThread]: On master: COMMIT
[0m10:55:34.328135 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:55:34.328135 [debug] [MainThread]: On master: Close
[0m10:55:34.329135 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:55:34.330134 [debug] [MainThread]: Connection 'list_fao' was properly closed.
[0m10:55:34.331135 [debug] [MainThread]: Connection 'list_fao' was properly closed.
[0m10:55:34.331135 [debug] [MainThread]: Connection 'list_fao_public_gold' was properly closed.
[0m10:55:34.332135 [debug] [MainThread]: Connection 'list_fao_public_silver' was properly closed.
[0m10:55:34.332135 [debug] [MainThread]: Connection 'model.fao_elt_pipeline.gold_regional_summary' was properly closed.
[0m10:55:34.333136 [debug] [MainThread]: Connection 'model.fao_elt_pipeline.silver_top_countries' was properly closed.
[0m10:55:34.334136 [debug] [MainThread]: Connection 'model.fao_elt_pipeline.gold_country_metrics' was properly closed.
[0m10:55:34.335134 [debug] [MainThread]: Connection 'model.fao_elt_pipeline.gold_price_production_analysis' was properly closed.
[0m10:55:34.335134 [info ] [MainThread]: 
[0m10:55:34.336135 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 0.75 seconds (0.75s).
[0m10:55:34.338135 [debug] [MainThread]: Command end result
[0m10:55:34.382712 [info ] [MainThread]: 
[0m10:55:34.382712 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:55:34.383713 [info ] [MainThread]: 
[0m10:55:34.384712 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m10:55:34.386713 [debug] [MainThread]: Command `dbt run` succeeded at 10:55:34.386713 after 1.75 seconds
[0m10:55:34.386713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD6FFA75B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD720E3940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD720CF8E0>]}
[0m10:55:34.387711 [debug] [MainThread]: Flushing usage events
[0m10:55:37.640280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CE48187580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CE4AEF3670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CE4AEF3490>]}


============================== 10:55:37.644985 | 63fe12f0-dc69-445d-bf03-747c1b6d5a4b ==============================
[0m10:55:37.644985 [info ] [MainThread]: Running with dbt=1.8.0
[0m10:55:37.646038 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\18057\\Documents\\Coding\\fao-elt-pipelines\\dbt_project', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\18057\\Documents\\Coding\\fao-elt-pipelines\\dbt_project\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --target dev', 'send_anonymous_usage_stats': 'True'}
[0m10:55:37.806177 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m10:55:37.807179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '63fe12f0-dc69-445d-bf03-747c1b6d5a4b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CE4AE83760>]}
[0m10:55:37.910101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '63fe12f0-dc69-445d-bf03-747c1b6d5a4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CE48454670>]}
[0m10:55:37.993849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '63fe12f0-dc69-445d-bf03-747c1b6d5a4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CE47DA1780>]}
[0m10:55:37.995849 [info ] [MainThread]: Registered adapter: postgres=1.8.0
[0m10:55:38.005847 [debug] [MainThread]: checksum: 2a6c64e758918535ccc035b9d143fb4c91b01df5f630e583361ba23a87d2a511, vars: {}, profile: , target: dev, version: 1.8.0
[0m10:55:38.254423 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:55:38.255423 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:55:38.264423 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.fao_elt_pipeline.bronze
[0m10:55:38.334704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '63fe12f0-dc69-445d-bf03-747c1b6d5a4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CE4B3A6020>]}
[0m10:55:38.525808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '63fe12f0-dc69-445d-bf03-747c1b6d5a4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CE4B39F6D0>]}
[0m10:55:38.526810 [info ] [MainThread]: Found 6 models, 23 data tests, 2 sources, 414 macros
[0m10:55:38.526810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63fe12f0-dc69-445d-bf03-747c1b6d5a4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CE4B355150>]}
[0m10:55:38.530658 [info ] [MainThread]: 
[0m10:55:38.531709 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:55:38.538032 [debug] [ThreadPool]: Acquiring new postgres connection 'list_fao_public_gold'
[0m10:55:38.539087 [debug] [ThreadPool]: Acquiring new postgres connection 'list_fao_public_silver'
[0m10:55:38.668132 [debug] [ThreadPool]: Using postgres connection "list_fao_public_gold"
[0m10:55:38.669130 [debug] [ThreadPool]: Using postgres connection "list_fao_public_silver"
[0m10:55:38.670134 [debug] [ThreadPool]: On list_fao_public_gold: BEGIN
[0m10:55:38.671133 [debug] [ThreadPool]: On list_fao_public_silver: BEGIN
[0m10:55:38.671133 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:55:38.672132 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:55:38.689132 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:55:38.690134 [debug] [ThreadPool]: Using postgres connection "list_fao_public_gold"
[0m10:55:38.691134 [debug] [ThreadPool]: On list_fao_public_gold: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "connection_name": "list_fao_public_gold"} */
select
      'fao' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'fao' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'fao' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m10:55:38.694132 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m10:55:38.696132 [debug] [ThreadPool]: On list_fao_public_gold: ROLLBACK
[0m10:55:38.697130 [debug] [ThreadPool]: On list_fao_public_gold: Close
[0m10:55:38.703133 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:55:38.703133 [debug] [ThreadPool]: Using postgres connection "list_fao_public_silver"
[0m10:55:38.704135 [debug] [ThreadPool]: On list_fao_public_silver: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "connection_name": "list_fao_public_silver"} */
select
      'fao' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'fao' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'fao' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m10:55:38.708134 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m10:55:38.709134 [debug] [ThreadPool]: On list_fao_public_silver: ROLLBACK
[0m10:55:38.710134 [debug] [ThreadPool]: On list_fao_public_silver: Close
[0m10:55:38.717131 [debug] [MainThread]: Using postgres connection "master"
[0m10:55:38.718132 [debug] [MainThread]: On master: BEGIN
[0m10:55:38.719131 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:55:38.750156 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:55:38.750156 [debug] [MainThread]: Using postgres connection "master"
[0m10:55:38.751155 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:55:38.756156 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m10:55:38.758157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63fe12f0-dc69-445d-bf03-747c1b6d5a4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CE4B39F280>]}
[0m10:55:38.759154 [debug] [MainThread]: On master: ROLLBACK
[0m10:55:38.760159 [debug] [MainThread]: Using postgres connection "master"
[0m10:55:38.761156 [debug] [MainThread]: On master: BEGIN
[0m10:55:38.762157 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:55:38.763156 [debug] [MainThread]: On master: COMMIT
[0m10:55:38.763156 [debug] [MainThread]: Using postgres connection "master"
[0m10:55:38.764156 [debug] [MainThread]: On master: COMMIT
[0m10:55:38.765154 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:55:38.766156 [debug] [MainThread]: On master: Close
[0m10:55:38.767154 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:55:38.767154 [info ] [MainThread]: 
[0m10:55:38.771749 [debug] [Thread-1 (]: Began running node test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee
[0m10:55:38.771749 [debug] [Thread-2 (]: Began running node test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd
[0m10:55:38.772759 [debug] [Thread-3 (]: Began running node test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53
[0m10:55:38.773758 [debug] [Thread-4 (]: Began running node test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69
[0m10:55:38.774756 [info ] [Thread-1 (]: 1 of 23 START test accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer  [RUN]
[0m10:55:38.774756 [info ] [Thread-2 (]: 2 of 23 START test accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable  [RUN]
[0m10:55:38.775758 [info ] [Thread-3 (]: 3 of 23 START test accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity  [RUN]
[0m10:55:38.776758 [info ] [Thread-4 (]: 4 of 23 START test accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product  [RUN]
[0m10:55:38.777757 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee'
[0m10:55:38.778756 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd'
[0m10:55:38.779760 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53'
[0m10:55:38.780757 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69'
[0m10:55:38.781756 [debug] [Thread-1 (]: Began compiling node test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee
[0m10:55:38.782758 [debug] [Thread-2 (]: Began compiling node test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd
[0m10:55:38.782758 [debug] [Thread-3 (]: Began compiling node test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53
[0m10:55:38.783757 [debug] [Thread-4 (]: Began compiling node test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69
[0m10:55:38.805756 [debug] [Thread-1 (]: Writing injected SQL for node "test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee"
[0m10:55:38.813759 [debug] [Thread-2 (]: Writing injected SQL for node "test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd"
[0m10:55:38.819757 [debug] [Thread-3 (]: Writing injected SQL for node "test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53"
[0m10:55:38.826756 [debug] [Thread-4 (]: Writing injected SQL for node "test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69"
[0m10:55:38.827758 [debug] [Thread-1 (]: Began executing node test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee
[0m10:55:38.828758 [debug] [Thread-2 (]: Began executing node test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd
[0m10:55:38.829757 [debug] [Thread-3 (]: Began executing node test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53
[0m10:55:38.850757 [debug] [Thread-1 (]: Writing runtime sql for node "test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee"
[0m10:55:38.853758 [debug] [Thread-2 (]: Writing runtime sql for node "test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd"
[0m10:55:38.854755 [debug] [Thread-4 (]: Began executing node test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69
[0m10:55:38.857755 [debug] [Thread-3 (]: Writing runtime sql for node "test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53"
[0m10:55:38.858756 [debug] [Thread-1 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee"
[0m10:55:38.862755 [debug] [Thread-4 (]: Writing runtime sql for node "test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69"
[0m10:55:38.862755 [debug] [Thread-2 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd"
[0m10:55:38.863761 [debug] [Thread-1 (]: On test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee: BEGIN
[0m10:55:38.864759 [debug] [Thread-3 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53"
[0m10:55:38.865756 [debug] [Thread-2 (]: On test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd: BEGIN
[0m10:55:38.866760 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:55:38.867756 [debug] [Thread-4 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69"
[0m10:55:38.868758 [debug] [Thread-3 (]: On test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53: BEGIN
[0m10:55:38.868758 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:55:38.869759 [debug] [Thread-4 (]: On test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69: BEGIN
[0m10:55:38.870757 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:55:38.871761 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:55:38.883756 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:55:38.884758 [debug] [Thread-1 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee"
[0m10:55:38.885759 [debug] [Thread-1 (]: On test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        producer_category as value_field,
        count(*) as n_records

    from "fao"."public_gold"."gold_country_metrics"
    group by producer_category

)

select *
from all_values
where value_field not in (
    'Major Producer','Medium Producer','Small Producer'
)



      
    ) dbt_internal_test
[0m10:55:38.887760 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m10:55:38.887760 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m10:55:38.888756 [debug] [Thread-4 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69"
[0m10:55:38.894758 [debug] [Thread-1 (]: On test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee: ROLLBACK
[0m10:55:38.895758 [debug] [Thread-4 (]: On test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        price_tier as value_field,
        count(*) as n_records

    from "fao"."public_gold"."gold_price_production_analysis"
    group by price_tier

)

select *
from all_values
where value_field not in (
    'Premium Product','Standard Product','Basic Product'
)



      
    ) dbt_internal_test
[0m10:55:38.896758 [debug] [Thread-1 (]: On test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee: Close
[0m10:55:38.898759 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m10:55:38.897759 [info ] [Thread-1 (]: 1 of 23 PASS accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer  [[32mPASS[0m in 0.12s]
[0m10:55:38.900759 [debug] [Thread-4 (]: On test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69: ROLLBACK
[0m10:55:38.901758 [debug] [Thread-1 (]: Finished running node test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee
[0m10:55:38.902756 [debug] [Thread-1 (]: Began running node test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6
[0m10:55:38.903757 [debug] [Thread-4 (]: On test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69: Close
[0m10:55:38.904763 [info ] [Thread-1 (]: 5 of 23 START test accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region  [RUN]
[0m10:55:38.905756 [info ] [Thread-4 (]: 4 of 23 PASS accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product  [[32mPASS[0m in 0.12s]
[0m10:55:38.906756 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee, now test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6)
[0m10:55:38.906756 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m10:55:38.907758 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m10:55:38.908758 [debug] [Thread-4 (]: Finished running node test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69
[0m10:55:38.909757 [debug] [Thread-1 (]: Began compiling node test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6
[0m10:55:38.910758 [debug] [Thread-2 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd"
[0m10:55:38.911757 [debug] [Thread-3 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53"
[0m10:55:38.911757 [debug] [Thread-4 (]: Began running node test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff
[0m10:55:38.920758 [debug] [Thread-1 (]: Writing injected SQL for node "test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6"
[0m10:55:38.921757 [debug] [Thread-2 (]: On test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        production_trend as value_field,
        count(*) as n_records

    from "fao"."public_gold"."gold_country_metrics"
    group by production_trend

)

select *
from all_values
where value_field not in (
    'Growing','Declining','Stable'
)



      
    ) dbt_internal_test
[0m10:55:38.922756 [debug] [Thread-3 (]: On test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        commodity_scale as value_field,
        count(*) as n_records

    from "fao"."public_gold"."gold_price_production_analysis"
    group by commodity_scale

)

select *
from all_values
where value_field not in (
    'Major Commodity','Medium Commodity','Minor Commodity'
)



      
    ) dbt_internal_test
[0m10:55:38.922756 [info ] [Thread-4 (]: 6 of 23 START test accepted_values_silver_prices_cleaned_is_valid_price__True__False  [RUN]
[0m10:55:38.924759 [debug] [Thread-1 (]: Began executing node test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6
[0m10:55:38.925758 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69, now test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff)
[0m10:55:38.925758 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m10:55:38.926758 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m10:55:38.929758 [debug] [Thread-1 (]: Writing runtime sql for node "test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6"
[0m10:55:38.930755 [debug] [Thread-4 (]: Began compiling node test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff
[0m10:55:38.932758 [debug] [Thread-2 (]: On test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd: ROLLBACK
[0m10:55:38.934755 [debug] [Thread-3 (]: On test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53: ROLLBACK
[0m10:55:38.939758 [debug] [Thread-4 (]: Writing injected SQL for node "test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff"
[0m10:55:38.940755 [debug] [Thread-1 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6"
[0m10:55:38.941758 [debug] [Thread-2 (]: On test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd: Close
[0m10:55:38.942757 [debug] [Thread-1 (]: On test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6: BEGIN
[0m10:55:38.943758 [debug] [Thread-3 (]: On test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53: Close
[0m10:55:38.943758 [debug] [Thread-4 (]: Began executing node test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff
[0m10:55:38.944758 [info ] [Thread-2 (]: 2 of 23 PASS accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable  [[32mPASS[0m in 0.17s]
[0m10:55:38.945760 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:55:38.946758 [info ] [Thread-3 (]: 3 of 23 PASS accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity  [[32mPASS[0m in 0.17s]
[0m10:55:38.950758 [debug] [Thread-4 (]: Writing runtime sql for node "test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff"
[0m10:55:38.951759 [debug] [Thread-2 (]: Finished running node test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd
[0m10:55:38.952758 [debug] [Thread-3 (]: Finished running node test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53
[0m10:55:38.953759 [debug] [Thread-2 (]: Began running node test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f
[0m10:55:38.954759 [debug] [Thread-3 (]: Began running node test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c
[0m10:55:38.955760 [debug] [Thread-4 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff"
[0m10:55:38.956759 [info ] [Thread-2 (]: 7 of 23 START test accepted_values_silver_production_cleaned_is_valid_production__True__False  [RUN]
[0m10:55:38.957756 [info ] [Thread-3 (]: 8 of 23 START test not_null_gold_country_metrics_country_name .................. [RUN]
[0m10:55:38.957756 [debug] [Thread-4 (]: On test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff: BEGIN
[0m10:55:38.958758 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd, now test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f)
[0m10:55:38.959760 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53, now test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c)
[0m10:55:38.960760 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:55:38.961760 [debug] [Thread-2 (]: Began compiling node test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f
[0m10:55:38.962760 [debug] [Thread-3 (]: Began compiling node test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c
[0m10:55:38.967758 [debug] [Thread-2 (]: Writing injected SQL for node "test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f"
[0m10:55:38.974837 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:55:38.977360 [debug] [Thread-3 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c"
[0m10:55:38.978361 [debug] [Thread-1 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6"
[0m10:55:38.979360 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m10:55:38.980361 [debug] [Thread-2 (]: Began executing node test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f
[0m10:55:38.981359 [debug] [Thread-1 (]: On test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        regional_scale as value_field,
        count(*) as n_records

    from "fao"."public_gold"."gold_regional_summary"
    group by regional_scale

)

select *
from all_values
where value_field not in (
    'Major Agricultural Region','Medium Agricultural Region','Minor Agricultural Region'
)



      
    ) dbt_internal_test
[0m10:55:38.982359 [debug] [Thread-4 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff"
[0m10:55:38.982359 [debug] [Thread-3 (]: Began executing node test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c
[0m10:55:38.986361 [debug] [Thread-2 (]: Writing runtime sql for node "test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f"
[0m10:55:38.987361 [debug] [Thread-4 (]: On test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        is_valid_price as value_field,
        count(*) as n_records

    from "fao"."public_silver"."silver_prices_cleaned"
    group by is_valid_price

)

select *
from all_values
where value_field not in (
    'True','False'
)



      
    ) dbt_internal_test
[0m10:55:38.992362 [debug] [Thread-3 (]: Writing runtime sql for node "test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c"
[0m10:55:38.992362 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m10:55:38.994362 [debug] [Thread-2 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f"
[0m10:55:38.996360 [debug] [Thread-1 (]: On test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6: ROLLBACK
[0m10:55:38.997360 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m10:55:38.997360 [debug] [Thread-2 (]: On test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f: BEGIN
[0m10:55:38.998358 [debug] [Thread-3 (]: Using postgres connection "test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c"
[0m10:55:39.000358 [debug] [Thread-4 (]: On test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff: ROLLBACK
[0m10:55:39.001358 [debug] [Thread-1 (]: On test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6: Close
[0m10:55:39.002362 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:55:39.002362 [debug] [Thread-3 (]: On test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c: BEGIN
[0m10:55:39.004362 [debug] [Thread-4 (]: On test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff: Close
[0m10:55:39.004362 [info ] [Thread-1 (]: 5 of 23 PASS accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region  [[32mPASS[0m in 0.10s]
[0m10:55:39.005361 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:55:39.007362 [info ] [Thread-4 (]: 6 of 23 PASS accepted_values_silver_prices_cleaned_is_valid_price__True__False . [[32mPASS[0m in 0.08s]
[0m10:55:39.008361 [debug] [Thread-1 (]: Finished running node test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6
[0m10:55:39.010359 [debug] [Thread-4 (]: Finished running node test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff
[0m10:55:39.011361 [debug] [Thread-1 (]: Began running node test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b
[0m10:55:39.012361 [debug] [Thread-4 (]: Began running node test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7
[0m10:55:39.013360 [info ] [Thread-1 (]: 9 of 23 START test not_null_gold_price_production_analysis_item_name ........... [RUN]
[0m10:55:39.014360 [info ] [Thread-4 (]: 10 of 23 START test not_null_gold_regional_summary_region ...................... [RUN]
[0m10:55:39.015359 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6, now test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b)
[0m10:55:39.016362 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff, now test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7)
[0m10:55:39.016362 [debug] [Thread-1 (]: Began compiling node test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b
[0m10:55:39.017359 [debug] [Thread-4 (]: Began compiling node test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7
[0m10:55:39.022360 [debug] [Thread-1 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b"
[0m10:55:39.028358 [debug] [Thread-4 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7"
[0m10:55:39.029360 [debug] [Thread-1 (]: Began executing node test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b
[0m10:55:39.032360 [debug] [Thread-1 (]: Writing runtime sql for node "test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b"
[0m10:55:39.033360 [debug] [Thread-4 (]: Began executing node test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7
[0m10:55:39.034358 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m10:55:39.034358 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m10:55:39.038360 [debug] [Thread-4 (]: Writing runtime sql for node "test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7"
[0m10:55:39.039360 [debug] [Thread-2 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f"
[0m10:55:39.040361 [debug] [Thread-1 (]: Using postgres connection "test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b"
[0m10:55:39.040361 [debug] [Thread-3 (]: Using postgres connection "test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c"
[0m10:55:39.041358 [debug] [Thread-2 (]: On test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        is_valid_production as value_field,
        count(*) as n_records

    from "fao"."public_silver"."silver_production_cleaned"
    group by is_valid_production

)

select *
from all_values
where value_field not in (
    'True','False'
)



      
    ) dbt_internal_test
[0m10:55:39.042360 [debug] [Thread-4 (]: Using postgres connection "test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7"
[0m10:55:39.043360 [debug] [Thread-1 (]: On test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b: BEGIN
[0m10:55:39.044358 [debug] [Thread-3 (]: On test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select country_name
from "fao"."public_gold"."gold_country_metrics"
where country_name is null



      
    ) dbt_internal_test
[0m10:55:39.045361 [debug] [Thread-4 (]: On test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7: BEGIN
[0m10:55:39.045361 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:55:39.046360 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m10:55:39.047362 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:55:39.048361 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m10:55:39.050361 [debug] [Thread-2 (]: On test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f: ROLLBACK
[0m10:55:39.053362 [debug] [Thread-3 (]: On test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c: ROLLBACK
[0m10:55:39.054361 [debug] [Thread-2 (]: On test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f: Close
[0m10:55:39.055361 [debug] [Thread-3 (]: On test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c: Close
[0m10:55:39.056363 [info ] [Thread-2 (]: 7 of 23 PASS accepted_values_silver_production_cleaned_is_valid_production__True__False  [[32mPASS[0m in 0.10s]
[0m10:55:39.057364 [info ] [Thread-3 (]: 8 of 23 PASS not_null_gold_country_metrics_country_name ........................ [[32mPASS[0m in 0.10s]
[0m10:55:39.058360 [debug] [Thread-2 (]: Finished running node test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f
[0m10:55:39.059361 [debug] [Thread-3 (]: Finished running node test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c
[0m10:55:39.060361 [debug] [Thread-2 (]: Began running node test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5
[0m10:55:39.061361 [debug] [Thread-3 (]: Began running node test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df
[0m10:55:39.062360 [info ] [Thread-2 (]: 11 of 23 START test not_null_silver_prices_cleaned_price_id .................... [RUN]
[0m10:55:39.063360 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:55:39.064361 [info ] [Thread-3 (]: 12 of 23 START test not_null_silver_prices_cleaned_price_value ................. [RUN]
[0m10:55:39.064361 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f, now test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5)
[0m10:55:39.065359 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m10:55:39.066363 [debug] [Thread-1 (]: Using postgres connection "test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b"
[0m10:55:39.067360 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c, now test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df)
[0m10:55:39.068363 [debug] [Thread-2 (]: Began compiling node test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5
[0m10:55:39.068363 [debug] [Thread-4 (]: Using postgres connection "test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7"
[0m10:55:39.069361 [debug] [Thread-1 (]: On test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select item_name
from "fao"."public_gold"."gold_price_production_analysis"
where item_name is null



      
    ) dbt_internal_test
[0m10:55:39.070360 [debug] [Thread-3 (]: Began compiling node test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df
[0m10:55:39.075360 [debug] [Thread-2 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5"
[0m10:55:39.076358 [debug] [Thread-4 (]: On test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select region
from "fao"."public_gold"."gold_regional_summary"
where region is null



      
    ) dbt_internal_test
[0m10:55:39.081358 [debug] [Thread-3 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df"
[0m10:55:39.082358 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m10:55:39.084097 [debug] [Thread-2 (]: Began executing node test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5
[0m10:55:39.086782 [debug] [Thread-1 (]: On test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b: ROLLBACK
[0m10:55:39.087309 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m10:55:39.090475 [debug] [Thread-2 (]: Writing runtime sql for node "test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5"
[0m10:55:39.091541 [debug] [Thread-3 (]: Began executing node test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df
[0m10:55:39.093149 [debug] [Thread-4 (]: On test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7: ROLLBACK
[0m10:55:39.093683 [debug] [Thread-1 (]: On test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b: Close
[0m10:55:39.098202 [debug] [Thread-3 (]: Writing runtime sql for node "test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df"
[0m10:55:39.099203 [debug] [Thread-2 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5"
[0m10:55:39.099203 [debug] [Thread-4 (]: On test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7: Close
[0m10:55:39.101203 [info ] [Thread-1 (]: 9 of 23 PASS not_null_gold_price_production_analysis_item_name ................. [[32mPASS[0m in 0.09s]
[0m10:55:39.102205 [debug] [Thread-2 (]: On test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5: BEGIN
[0m10:55:39.103204 [debug] [Thread-3 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df"
[0m10:55:39.104205 [info ] [Thread-4 (]: 10 of 23 PASS not_null_gold_regional_summary_region ............................ [[32mPASS[0m in 0.09s]
[0m10:55:39.105205 [debug] [Thread-1 (]: Finished running node test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b
[0m10:55:39.106204 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:55:39.107205 [debug] [Thread-3 (]: On test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df: BEGIN
[0m10:55:39.108202 [debug] [Thread-4 (]: Finished running node test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7
[0m10:55:39.109200 [debug] [Thread-1 (]: Began running node test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b
[0m10:55:39.110200 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:55:39.111203 [debug] [Thread-4 (]: Began running node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74
[0m10:55:39.112202 [info ] [Thread-1 (]: 13 of 23 START test not_null_silver_prices_cleaned_year ........................ [RUN]
[0m10:55:39.113203 [info ] [Thread-4 (]: 14 of 23 START test not_null_silver_production_cleaned_production_id ........... [RUN]
[0m10:55:39.114204 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b, now test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b)
[0m10:55:39.115205 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7, now test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74)
[0m10:55:39.116203 [debug] [Thread-1 (]: Began compiling node test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b
[0m10:55:39.117202 [debug] [Thread-4 (]: Began compiling node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74
[0m10:55:39.122204 [debug] [Thread-1 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b"
[0m10:55:39.127202 [debug] [Thread-4 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74"
[0m10:55:39.128201 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m10:55:39.129203 [debug] [Thread-1 (]: Began executing node test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b
[0m10:55:39.130202 [debug] [Thread-2 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5"
[0m10:55:39.131204 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m10:55:39.132205 [debug] [Thread-4 (]: Began executing node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74
[0m10:55:39.135203 [debug] [Thread-1 (]: Writing runtime sql for node "test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b"
[0m10:55:39.136201 [debug] [Thread-2 (]: On test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select price_id
from "fao"."public_silver"."silver_prices_cleaned"
where price_id is null



      
    ) dbt_internal_test
[0m10:55:39.137203 [debug] [Thread-3 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df"
[0m10:55:39.141203 [debug] [Thread-4 (]: Writing runtime sql for node "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74"
[0m10:55:39.142205 [debug] [Thread-3 (]: On test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select price_value
from "fao"."public_silver"."silver_prices_cleaned"
where price_value is null



      
    ) dbt_internal_test
[0m10:55:39.143207 [debug] [Thread-1 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b"
[0m10:55:39.144204 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m10:55:39.145205 [debug] [Thread-4 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74"
[0m10:55:39.146204 [debug] [Thread-1 (]: On test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b: BEGIN
[0m10:55:39.147205 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m10:55:39.149203 [debug] [Thread-2 (]: On test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5: ROLLBACK
[0m10:55:39.150204 [debug] [Thread-4 (]: On test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74: BEGIN
[0m10:55:39.151203 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:55:39.153202 [debug] [Thread-3 (]: On test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df: ROLLBACK
[0m10:55:39.154203 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:55:39.155204 [debug] [Thread-2 (]: On test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5: Close
[0m10:55:39.157207 [info ] [Thread-2 (]: 11 of 23 PASS not_null_silver_prices_cleaned_price_id .......................... [[32mPASS[0m in 0.09s]
[0m10:55:39.158204 [debug] [Thread-3 (]: On test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df: Close
[0m10:55:39.159209 [debug] [Thread-2 (]: Finished running node test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5
[0m10:55:39.161210 [info ] [Thread-3 (]: 12 of 23 PASS not_null_silver_prices_cleaned_price_value ....................... [[32mPASS[0m in 0.09s]
[0m10:55:39.163205 [debug] [Thread-2 (]: Began running node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d
[0m10:55:39.165204 [debug] [Thread-3 (]: Finished running node test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df
[0m10:55:39.165998 [info ] [Thread-2 (]: 15 of 23 START test not_null_silver_production_cleaned_production_metric_tons .. [RUN]
[0m10:55:39.167079 [debug] [Thread-3 (]: Began running node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df
[0m10:55:39.168144 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5, now test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d)
[0m10:55:39.168680 [info ] [Thread-3 (]: 16 of 23 START test not_null_silver_production_cleaned_production_value ........ [RUN]
[0m10:55:39.169734 [debug] [Thread-2 (]: Began compiling node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d
[0m10:55:39.170789 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df, now test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df)
[0m10:55:39.175700 [debug] [Thread-2 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d"
[0m10:55:39.176725 [debug] [Thread-3 (]: Began compiling node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df
[0m10:55:39.177734 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:55:39.177734 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m10:55:39.183732 [debug] [Thread-3 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df"
[0m10:55:39.184731 [debug] [Thread-1 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b"
[0m10:55:39.184731 [debug] [Thread-2 (]: Began executing node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d
[0m10:55:39.185731 [debug] [Thread-4 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74"
[0m10:55:39.186730 [debug] [Thread-1 (]: On test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select year
from "fao"."public_silver"."silver_prices_cleaned"
where year is null



      
    ) dbt_internal_test
[0m10:55:39.187732 [debug] [Thread-3 (]: Began executing node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df
[0m10:55:39.192730 [debug] [Thread-2 (]: Writing runtime sql for node "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d"
[0m10:55:39.192730 [debug] [Thread-4 (]: On test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select production_id
from "fao"."public_silver"."silver_production_cleaned"
where production_id is null



      
    ) dbt_internal_test
[0m10:55:39.196734 [debug] [Thread-3 (]: Writing runtime sql for node "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df"
[0m10:55:39.197732 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m10:55:39.198734 [debug] [Thread-2 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d"
[0m10:55:39.201733 [debug] [Thread-1 (]: On test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b: ROLLBACK
[0m10:55:39.201733 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m10:55:39.202733 [debug] [Thread-2 (]: On test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d: BEGIN
[0m10:55:39.203735 [debug] [Thread-3 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df"
[0m10:55:39.205733 [debug] [Thread-4 (]: On test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74: ROLLBACK
[0m10:55:39.206733 [debug] [Thread-1 (]: On test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b: Close
[0m10:55:39.206733 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:55:39.207735 [debug] [Thread-3 (]: On test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df: BEGIN
[0m10:55:39.209733 [debug] [Thread-4 (]: On test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74: Close
[0m10:55:39.208732 [info ] [Thread-1 (]: 13 of 23 PASS not_null_silver_prices_cleaned_year .............................. [[32mPASS[0m in 0.09s]
[0m10:55:39.210734 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:55:39.211732 [info ] [Thread-4 (]: 14 of 23 PASS not_null_silver_production_cleaned_production_id ................. [[32mPASS[0m in 0.10s]
[0m10:55:39.213734 [debug] [Thread-1 (]: Finished running node test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b
[0m10:55:39.214734 [debug] [Thread-4 (]: Finished running node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74
[0m10:55:39.215734 [debug] [Thread-1 (]: Began running node test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd
[0m10:55:39.216734 [debug] [Thread-4 (]: Began running node test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a
[0m10:55:39.217733 [info ] [Thread-1 (]: 17 of 23 START test not_null_silver_top_countries_area_code .................... [RUN]
[0m10:55:39.218733 [info ] [Thread-4 (]: 18 of 23 START test not_null_silver_top_countries_country_name ................. [RUN]
[0m10:55:39.218733 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b, now test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd)
[0m10:55:39.219733 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74, now test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a)
[0m10:55:39.220731 [debug] [Thread-1 (]: Began compiling node test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd
[0m10:55:39.221780 [debug] [Thread-4 (]: Began compiling node test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a
[0m10:55:39.226295 [debug] [Thread-1 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd"
[0m10:55:39.231294 [debug] [Thread-4 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a"
[0m10:55:39.232297 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m10:55:39.233297 [debug] [Thread-2 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d"
[0m10:55:39.234295 [debug] [Thread-1 (]: Began executing node test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd
[0m10:55:39.234295 [debug] [Thread-2 (]: On test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select production_metric_tons
from "fao"."public_silver"."silver_production_cleaned"
where production_metric_tons is null



      
    ) dbt_internal_test
[0m10:55:39.235299 [debug] [Thread-4 (]: Began executing node test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a
[0m10:55:39.238297 [debug] [Thread-1 (]: Writing runtime sql for node "test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd"
[0m10:55:39.242297 [debug] [Thread-4 (]: Writing runtime sql for node "test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a"
[0m10:55:39.243296 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m10:55:39.245299 [debug] [Thread-2 (]: On test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d: ROLLBACK
[0m10:55:39.246299 [debug] [Thread-1 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd"
[0m10:55:39.247297 [debug] [Thread-4 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a"
[0m10:55:39.247297 [debug] [Thread-2 (]: On test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d: Close
[0m10:55:39.248296 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m10:55:39.249295 [debug] [Thread-1 (]: On test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd: BEGIN
[0m10:55:39.250297 [debug] [Thread-4 (]: On test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a: BEGIN
[0m10:55:39.251299 [info ] [Thread-2 (]: 15 of 23 PASS not_null_silver_production_cleaned_production_metric_tons ........ [[32mPASS[0m in 0.08s]
[0m10:55:39.252297 [debug] [Thread-3 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df"
[0m10:55:39.252297 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:55:39.253298 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:55:39.255299 [debug] [Thread-2 (]: Finished running node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d
[0m10:55:39.256297 [debug] [Thread-3 (]: On test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select production_value
from "fao"."public_silver"."silver_production_cleaned"
where production_value is null



      
    ) dbt_internal_test
[0m10:55:39.257297 [debug] [Thread-2 (]: Began running node test.fao_elt_pipeline.test_data_quality
[0m10:55:39.258298 [info ] [Thread-2 (]: 19 of 23 START test test_data_quality .......................................... [RUN]
[0m10:55:39.259301 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d, now test.fao_elt_pipeline.test_data_quality)
[0m10:55:39.260299 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m10:55:39.261297 [debug] [Thread-2 (]: Began compiling node test.fao_elt_pipeline.test_data_quality
[0m10:55:39.263296 [debug] [Thread-3 (]: On test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df: ROLLBACK
[0m10:55:39.267298 [debug] [Thread-2 (]: Writing injected SQL for node "test.fao_elt_pipeline.test_data_quality"
[0m10:55:39.268299 [debug] [Thread-3 (]: On test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df: Close
[0m10:55:39.269357 [debug] [Thread-2 (]: Began executing node test.fao_elt_pipeline.test_data_quality
[0m10:55:39.269869 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:55:39.270881 [info ] [Thread-3 (]: 16 of 23 PASS not_null_silver_production_cleaned_production_value .............. [[32mPASS[0m in 0.10s]
[0m10:55:39.271880 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m10:55:39.275878 [debug] [Thread-2 (]: Writing runtime sql for node "test.fao_elt_pipeline.test_data_quality"
[0m10:55:39.276879 [debug] [Thread-1 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd"
[0m10:55:39.277879 [debug] [Thread-3 (]: Finished running node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df
[0m10:55:39.278881 [debug] [Thread-4 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a"
[0m10:55:39.279879 [debug] [Thread-1 (]: On test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select area_code
from "fao"."public_silver"."silver_top_countries"
where area_code is null



      
    ) dbt_internal_test
[0m10:55:39.280881 [debug] [Thread-3 (]: Began running node test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4
[0m10:55:39.281879 [debug] [Thread-2 (]: Using postgres connection "test.fao_elt_pipeline.test_data_quality"
[0m10:55:39.282881 [debug] [Thread-4 (]: On test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select country_name
from "fao"."public_silver"."silver_top_countries"
where country_name is null



      
    ) dbt_internal_test
[0m10:55:39.283881 [info ] [Thread-3 (]: 20 of 23 START test unique_gold_country_metrics_country_name ................... [RUN]
[0m10:55:39.284882 [debug] [Thread-2 (]: On test.fao_elt_pipeline.test_data_quality: BEGIN
[0m10:55:39.284882 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m10:55:39.285880 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df, now test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4)
[0m10:55:39.286883 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m10:55:39.287880 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:55:39.289879 [debug] [Thread-1 (]: On test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd: ROLLBACK
[0m10:55:39.290881 [debug] [Thread-3 (]: Began compiling node test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4
[0m10:55:39.291881 [debug] [Thread-4 (]: On test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a: ROLLBACK
[0m10:55:39.300879 [debug] [Thread-1 (]: On test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd: Close
[0m10:55:39.301881 [debug] [Thread-3 (]: Writing injected SQL for node "test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4"
[0m10:55:39.303884 [debug] [Thread-4 (]: On test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a: Close
[0m10:55:39.303884 [info ] [Thread-1 (]: 17 of 23 PASS not_null_silver_top_countries_area_code .......................... [[32mPASS[0m in 0.08s]
[0m10:55:39.305881 [info ] [Thread-4 (]: 18 of 23 PASS not_null_silver_top_countries_country_name ....................... [[32mPASS[0m in 0.09s]
[0m10:55:39.306882 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m10:55:39.307883 [debug] [Thread-1 (]: Finished running node test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd
[0m10:55:39.308881 [debug] [Thread-3 (]: Began executing node test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4
[0m10:55:39.309880 [debug] [Thread-4 (]: Finished running node test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a
[0m10:55:39.310883 [debug] [Thread-2 (]: Using postgres connection "test.fao_elt_pipeline.test_data_quality"
[0m10:55:39.310883 [debug] [Thread-1 (]: Began running node test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1
[0m10:55:39.314878 [debug] [Thread-3 (]: Writing runtime sql for node "test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4"
[0m10:55:39.315878 [debug] [Thread-4 (]: Began running node test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31
[0m10:55:39.316880 [debug] [Thread-2 (]: On test.fao_elt_pipeline.test_data_quality: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.test_data_quality"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- Test to ensure we have data for major countries
-- This test will fail if we don't have data for these important agricultural producers

SELECT country_name
FROM (
    VALUES
        ('China'),
        ('India'),
        ('USA'),
        ('Brazil'),
        ('Germany')
) AS required_countries(country_name)
WHERE country_name NOT IN (
    SELECT DISTINCT country_name_standardized
    FROM "fao"."public_silver"."silver_production_cleaned"
)
      
    ) dbt_internal_test
[0m10:55:39.317882 [info ] [Thread-1 (]: 21 of 23 START test unique_gold_regional_summary_region ........................ [RUN]
[0m10:55:39.318879 [info ] [Thread-4 (]: 22 of 23 START test unique_silver_prices_cleaned_price_id ...................... [RUN]
[0m10:55:39.319882 [debug] [Thread-3 (]: Using postgres connection "test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4"
[0m10:55:39.320882 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd, now test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1)
[0m10:55:39.320882 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a, now test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31)
[0m10:55:39.321881 [debug] [Thread-3 (]: On test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4: BEGIN
[0m10:55:39.322881 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m10:55:39.323879 [debug] [Thread-1 (]: Began compiling node test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1
[0m10:55:39.323879 [debug] [Thread-4 (]: Began compiling node test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31
[0m10:55:39.324880 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:55:39.326883 [debug] [Thread-2 (]: On test.fao_elt_pipeline.test_data_quality: ROLLBACK
[0m10:55:39.331878 [debug] [Thread-1 (]: Writing injected SQL for node "test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1"
[0m10:55:39.336881 [debug] [Thread-4 (]: Writing injected SQL for node "test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31"
[0m10:55:39.337879 [debug] [Thread-2 (]: On test.fao_elt_pipeline.test_data_quality: Close
[0m10:55:39.338883 [debug] [Thread-1 (]: Began executing node test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1
[0m10:55:39.339881 [debug] [Thread-4 (]: Began executing node test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31
[0m10:55:39.340883 [info ] [Thread-2 (]: 19 of 23 PASS test_data_quality ................................................ [[32mPASS[0m in 0.08s]
[0m10:55:39.343882 [debug] [Thread-1 (]: Writing runtime sql for node "test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1"
[0m10:55:39.347881 [debug] [Thread-4 (]: Writing runtime sql for node "test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31"
[0m10:55:39.348882 [debug] [Thread-2 (]: Finished running node test.fao_elt_pipeline.test_data_quality
[0m10:55:39.349883 [debug] [Thread-2 (]: Began running node test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048
[0m10:55:39.350881 [debug] [Thread-1 (]: Using postgres connection "test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1"
[0m10:55:39.351880 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m10:55:39.352882 [debug] [Thread-4 (]: Using postgres connection "test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31"
[0m10:55:39.352882 [info ] [Thread-2 (]: 23 of 23 START test unique_silver_production_cleaned_production_id ............. [RUN]
[0m10:55:39.353880 [debug] [Thread-1 (]: On test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1: BEGIN
[0m10:55:39.354881 [debug] [Thread-3 (]: Using postgres connection "test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4"
[0m10:55:39.355879 [debug] [Thread-4 (]: On test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31: BEGIN
[0m10:55:39.356882 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.test_data_quality, now test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048)
[0m10:55:39.356882 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:55:39.357881 [debug] [Thread-3 (]: On test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    country_name as unique_field,
    count(*) as n_records

from "fao"."public_gold"."gold_country_metrics"
where country_name is not null
group by country_name
having count(*) > 1



      
    ) dbt_internal_test
[0m10:55:39.358881 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:55:39.359879 [debug] [Thread-2 (]: Began compiling node test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048
[0m10:55:39.365879 [debug] [Thread-2 (]: Writing injected SQL for node "test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048"
[0m10:55:39.365879 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m10:55:39.368879 [debug] [Thread-3 (]: On test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4: ROLLBACK
[0m10:55:39.368879 [debug] [Thread-2 (]: Began executing node test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048
[0m10:55:39.369883 [debug] [Thread-3 (]: On test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4: Close
[0m10:55:39.373880 [debug] [Thread-2 (]: Writing runtime sql for node "test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048"
[0m10:55:39.375882 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:55:39.375882 [warn ] [Thread-3 (]: 20 of 23 WARN 1 unique_gold_country_metrics_country_name ....................... [[33mWARN 1[0m in 0.09s]
[0m10:55:39.376883 [debug] [Thread-1 (]: Using postgres connection "test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1"
[0m10:55:39.377882 [debug] [Thread-2 (]: Using postgres connection "test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048"
[0m10:55:39.378881 [debug] [Thread-3 (]: Finished running node test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4
[0m10:55:39.379970 [debug] [Thread-1 (]: On test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    region as unique_field,
    count(*) as n_records

from "fao"."public_gold"."gold_regional_summary"
where region is not null
group by region
having count(*) > 1



      
    ) dbt_internal_test
[0m10:55:39.380493 [debug] [Thread-2 (]: On test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048: BEGIN
[0m10:55:39.382491 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:55:39.383491 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m10:55:39.385490 [debug] [Thread-1 (]: On test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1: ROLLBACK
[0m10:55:39.386492 [debug] [Thread-1 (]: On test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1: Close
[0m10:55:39.387490 [info ] [Thread-1 (]: 21 of 23 PASS unique_gold_regional_summary_region .............................. [[32mPASS[0m in 0.07s]
[0m10:55:39.388494 [debug] [Thread-1 (]: Finished running node test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1
[0m10:55:39.390491 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m10:55:39.390491 [debug] [Thread-4 (]: Using postgres connection "test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31"
[0m10:55:39.391492 [debug] [Thread-4 (]: On test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    price_id as unique_field,
    count(*) as n_records

from "fao"."public_silver"."silver_prices_cleaned"
where price_id is not null
group by price_id
having count(*) > 1



      
    ) dbt_internal_test
[0m10:55:39.394493 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m10:55:39.396066 [debug] [Thread-4 (]: On test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31: ROLLBACK
[0m10:55:39.398075 [debug] [Thread-4 (]: On test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31: Close
[0m10:55:39.399073 [warn ] [Thread-4 (]: 22 of 23 WARN 17 unique_silver_prices_cleaned_price_id ......................... [[33mWARN 17[0m in 0.08s]
[0m10:55:39.400073 [debug] [Thread-4 (]: Finished running node test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31
[0m10:55:39.405076 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m10:55:39.406076 [debug] [Thread-2 (]: Using postgres connection "test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048"
[0m10:55:39.406076 [debug] [Thread-2 (]: On test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    production_id as unique_field,
    count(*) as n_records

from "fao"."public_silver"."silver_production_cleaned"
where production_id is not null
group by production_id
having count(*) > 1



      
    ) dbt_internal_test
[0m10:55:39.409077 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m10:55:39.412126 [debug] [Thread-2 (]: On test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048: ROLLBACK
[0m10:55:39.413734 [debug] [Thread-2 (]: On test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048: Close
[0m10:55:39.414811 [warn ] [Thread-2 (]: 23 of 23 WARN 12 unique_silver_production_cleaned_production_id ................ [[33mWARN 12[0m in 0.06s]
[0m10:55:39.416434 [debug] [Thread-2 (]: Finished running node test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048
[0m10:55:39.418034 [debug] [MainThread]: Using postgres connection "master"
[0m10:55:39.419093 [debug] [MainThread]: On master: BEGIN
[0m10:55:39.419630 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:55:39.433207 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:55:39.434208 [debug] [MainThread]: On master: COMMIT
[0m10:55:39.434208 [debug] [MainThread]: Using postgres connection "master"
[0m10:55:39.435208 [debug] [MainThread]: On master: COMMIT
[0m10:55:39.436206 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:55:39.437207 [debug] [MainThread]: On master: Close
[0m10:55:39.438206 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:55:39.438206 [debug] [MainThread]: Connection 'list_fao_public_gold' was properly closed.
[0m10:55:39.439207 [debug] [MainThread]: Connection 'list_fao_public_silver' was properly closed.
[0m10:55:39.440208 [debug] [MainThread]: Connection 'test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1' was properly closed.
[0m10:55:39.440208 [debug] [MainThread]: Connection 'test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048' was properly closed.
[0m10:55:39.441209 [debug] [MainThread]: Connection 'test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4' was properly closed.
[0m10:55:39.442208 [debug] [MainThread]: Connection 'test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31' was properly closed.
[0m10:55:39.443209 [info ] [MainThread]: 
[0m10:55:39.443209 [info ] [MainThread]: Finished running 23 data tests in 0 hours 0 minutes and 0.91 seconds (0.91s).
[0m10:55:39.449209 [debug] [MainThread]: Command end result
[0m10:55:39.495158 [info ] [MainThread]: 
[0m10:55:39.496158 [info ] [MainThread]: [33mCompleted with 3 warnings:[0m
[0m10:55:39.497159 [info ] [MainThread]: 
[0m10:55:39.498159 [warn ] [MainThread]: [33mWarning in test unique_gold_country_metrics_country_name (models\gold\schema.yml)[0m
[0m10:55:39.498159 [warn ] [MainThread]: Got 1 result, configured to warn if != 0
[0m10:55:39.499159 [info ] [MainThread]: 
[0m10:55:39.500158 [info ] [MainThread]:   compiled code at target\compiled\fao_elt_pipeline\models\gold\schema.yml\unique_gold_country_metrics_country_name.sql
[0m10:55:39.500158 [info ] [MainThread]: 
[0m10:55:39.501159 [warn ] [MainThread]: [33mWarning in test unique_silver_prices_cleaned_price_id (models\silver\schema.yml)[0m
[0m10:55:39.502159 [warn ] [MainThread]: Got 17 results, configured to warn if != 0
[0m10:55:39.503158 [info ] [MainThread]: 
[0m10:55:39.503158 [info ] [MainThread]:   compiled code at target\compiled\fao_elt_pipeline\models\silver\schema.yml\unique_silver_prices_cleaned_price_id.sql
[0m10:55:39.504159 [info ] [MainThread]: 
[0m10:55:39.505159 [warn ] [MainThread]: [33mWarning in test unique_silver_production_cleaned_production_id (models\silver\schema.yml)[0m
[0m10:55:39.506159 [warn ] [MainThread]: Got 12 results, configured to warn if != 0
[0m10:55:39.506159 [info ] [MainThread]: 
[0m10:55:39.507158 [info ] [MainThread]:   compiled code at target\compiled\fao_elt_pipeline\models\silver\schema.yml\unique_silver_production_cleaned_production_id.sql
[0m10:55:39.508158 [info ] [MainThread]: 
[0m10:55:39.508158 [info ] [MainThread]: Done. PASS=20 WARN=3 ERROR=0 SKIP=0 TOTAL=23
[0m10:55:39.510159 [debug] [MainThread]: Command `dbt test` succeeded at 10:55:39.510159 after 1.96 seconds
[0m10:55:39.510159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CE48187580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CE4B397E20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CE4C8753F0>]}
[0m10:55:39.511158 [debug] [MainThread]: Flushing usage events
[0m10:55:42.711652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024094017580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024096D83820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024096D83640>]}


============================== 10:55:42.716659 | 87d20101-7fd0-41e8-9d3f-d7a0da9570ac ==============================
[0m10:55:42.716659 [info ] [MainThread]: Running with dbt=1.8.0
[0m10:55:42.717659 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\18057\\Documents\\Coding\\fao-elt-pipelines\\dbt_project', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\18057\\Documents\\Coding\\fao-elt-pipelines\\dbt_project\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt docs generate --target dev', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:55:42.876755 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m10:55:42.877755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '87d20101-7fd0-41e8-9d3f-d7a0da9570ac', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024096CC3100>]}
[0m10:55:42.982713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '87d20101-7fd0-41e8-9d3f-d7a0da9570ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240942E9870>]}
[0m10:55:43.066754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '87d20101-7fd0-41e8-9d3f-d7a0da9570ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024096153F40>]}
[0m10:55:43.068312 [info ] [MainThread]: Registered adapter: postgres=1.8.0
[0m10:55:43.078768 [debug] [MainThread]: checksum: 2a6c64e758918535ccc035b9d143fb4c91b01df5f630e583361ba23a87d2a511, vars: {}, profile: , target: dev, version: 1.8.0
[0m10:55:43.331067 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:55:43.332118 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:55:43.340052 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.fao_elt_pipeline.bronze
[0m10:55:43.414897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '87d20101-7fd0-41e8-9d3f-d7a0da9570ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002409723A1A0>]}
[0m10:55:43.441175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '87d20101-7fd0-41e8-9d3f-d7a0da9570ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240971D14B0>]}
[0m10:55:43.442321 [info ] [MainThread]: Found 6 models, 23 data tests, 2 sources, 414 macros
[0m10:55:43.442858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87d20101-7fd0-41e8-9d3f-d7a0da9570ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240971D0BB0>]}
[0m10:55:43.446591 [info ] [MainThread]: 
[0m10:55:43.447649 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:55:43.453774 [debug] [ThreadPool]: Acquiring new postgres connection 'list_fao_public_silver'
[0m10:55:43.454774 [debug] [ThreadPool]: Acquiring new postgres connection 'list_fao_public_gold'
[0m10:55:43.550146 [debug] [ThreadPool]: Using postgres connection "list_fao_public_silver"
[0m10:55:43.551148 [debug] [ThreadPool]: Using postgres connection "list_fao_public_gold"
[0m10:55:43.552370 [debug] [ThreadPool]: On list_fao_public_silver: BEGIN
[0m10:55:43.552892 [debug] [ThreadPool]: On list_fao_public_gold: BEGIN
[0m10:55:43.553920 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:55:43.554459 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:55:43.573559 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:55:43.574097 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:55:43.575152 [debug] [ThreadPool]: Using postgres connection "list_fao_public_silver"
[0m10:55:43.575670 [debug] [ThreadPool]: Using postgres connection "list_fao_public_gold"
[0m10:55:43.576703 [debug] [ThreadPool]: On list_fao_public_silver: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "connection_name": "list_fao_public_silver"} */
select
      'fao' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'fao' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'fao' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m10:55:43.577232 [debug] [ThreadPool]: On list_fao_public_gold: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "connection_name": "list_fao_public_gold"} */
select
      'fao' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'fao' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'fao' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m10:55:43.581470 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m10:55:43.582014 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m10:55:43.584085 [debug] [ThreadPool]: On list_fao_public_silver: ROLLBACK
[0m10:55:43.585641 [debug] [ThreadPool]: On list_fao_public_gold: ROLLBACK
[0m10:55:43.586695 [debug] [ThreadPool]: On list_fao_public_silver: Close
[0m10:55:43.587219 [debug] [ThreadPool]: On list_fao_public_gold: Close
[0m10:55:43.594099 [debug] [MainThread]: Using postgres connection "master"
[0m10:55:43.594604 [debug] [MainThread]: On master: BEGIN
[0m10:55:43.595610 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:55:43.610188 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:55:43.610728 [debug] [MainThread]: Using postgres connection "master"
[0m10:55:43.611815 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:55:43.616860 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m10:55:43.619156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87d20101-7fd0-41e8-9d3f-d7a0da9570ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024094329CF0>]}
[0m10:55:43.619677 [debug] [MainThread]: On master: ROLLBACK
[0m10:55:43.621240 [debug] [MainThread]: On master: Close
[0m10:55:43.621745 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:55:43.622754 [info ] [MainThread]: 
[0m10:55:43.625753 [debug] [Thread-1 (]: Began running node model.fao_elt_pipeline.silver_prices_cleaned
[0m10:55:43.626752 [debug] [Thread-2 (]: Began running node model.fao_elt_pipeline.silver_production_cleaned
[0m10:55:43.627753 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.fao_elt_pipeline.silver_prices_cleaned'
[0m10:55:43.628887 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.fao_elt_pipeline.silver_production_cleaned'
[0m10:55:43.629410 [debug] [Thread-1 (]: Began compiling node model.fao_elt_pipeline.silver_prices_cleaned
[0m10:55:43.630459 [debug] [Thread-2 (]: Began compiling node model.fao_elt_pipeline.silver_production_cleaned
[0m10:55:43.645465 [debug] [Thread-1 (]: Writing injected SQL for node "model.fao_elt_pipeline.silver_prices_cleaned"
[0m10:55:43.651213 [debug] [Thread-2 (]: Writing injected SQL for node "model.fao_elt_pipeline.silver_production_cleaned"
[0m10:55:43.652805 [debug] [Thread-1 (]: Began executing node model.fao_elt_pipeline.silver_prices_cleaned
[0m10:55:43.654384 [debug] [Thread-1 (]: Finished running node model.fao_elt_pipeline.silver_prices_cleaned
[0m10:55:43.654902 [debug] [Thread-2 (]: Began executing node model.fao_elt_pipeline.silver_production_cleaned
[0m10:55:43.655944 [debug] [Thread-4 (]: Began running node test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff
[0m10:55:43.657026 [debug] [Thread-3 (]: Began running node test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5
[0m10:55:43.657554 [debug] [Thread-1 (]: Began running node test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df
[0m10:55:43.658674 [debug] [Thread-2 (]: Finished running node model.fao_elt_pipeline.silver_production_cleaned
[0m10:55:43.659714 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff'
[0m10:55:43.660724 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5'
[0m10:55:43.660724 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fao_elt_pipeline.silver_prices_cleaned, now test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df)
[0m10:55:43.661723 [debug] [Thread-2 (]: Began running node test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b
[0m10:55:43.662722 [debug] [Thread-4 (]: Began compiling node test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff
[0m10:55:43.663723 [debug] [Thread-3 (]: Began compiling node test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5
[0m10:55:43.664795 [debug] [Thread-1 (]: Began compiling node test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df
[0m10:55:43.665828 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.fao_elt_pipeline.silver_production_cleaned, now test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b)
[0m10:55:43.679848 [debug] [Thread-4 (]: Writing injected SQL for node "test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff"
[0m10:55:43.690938 [debug] [Thread-3 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5"
[0m10:55:43.695620 [debug] [Thread-1 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df"
[0m10:55:43.696627 [debug] [Thread-2 (]: Began compiling node test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b
[0m10:55:43.697626 [debug] [Thread-4 (]: Began executing node test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff
[0m10:55:43.702797 [debug] [Thread-2 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b"
[0m10:55:43.703316 [debug] [Thread-3 (]: Began executing node test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5
[0m10:55:43.704345 [debug] [Thread-4 (]: Finished running node test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff
[0m10:55:43.704345 [debug] [Thread-1 (]: Began executing node test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df
[0m10:55:43.706353 [debug] [Thread-3 (]: Finished running node test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5
[0m10:55:43.706353 [debug] [Thread-4 (]: Began running node test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31
[0m10:55:43.707354 [debug] [Thread-2 (]: Began executing node test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b
[0m10:55:43.708353 [debug] [Thread-1 (]: Finished running node test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df
[0m10:55:43.709353 [debug] [Thread-3 (]: Began running node model.fao_elt_pipeline.gold_country_metrics
[0m10:55:43.710409 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff, now test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31)
[0m10:55:43.711451 [debug] [Thread-2 (]: Finished running node test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b
[0m10:55:43.711979 [debug] [Thread-1 (]: Began running node model.fao_elt_pipeline.gold_price_production_analysis
[0m10:55:43.713060 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5, now model.fao_elt_pipeline.gold_country_metrics)
[0m10:55:43.713583 [debug] [Thread-4 (]: Began compiling node test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31
[0m10:55:43.714639 [debug] [Thread-2 (]: Began running node model.fao_elt_pipeline.gold_regional_summary
[0m10:55:43.715157 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df, now model.fao_elt_pipeline.gold_price_production_analysis)
[0m10:55:43.716199 [debug] [Thread-3 (]: Began compiling node model.fao_elt_pipeline.gold_country_metrics
[0m10:55:43.768888 [debug] [Thread-4 (]: Writing injected SQL for node "test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31"
[0m10:55:43.769409 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b, now model.fao_elt_pipeline.gold_regional_summary)
[0m10:55:43.770447 [debug] [Thread-1 (]: Began compiling node model.fao_elt_pipeline.gold_price_production_analysis
[0m10:55:43.775639 [debug] [Thread-3 (]: Writing injected SQL for node "model.fao_elt_pipeline.gold_country_metrics"
[0m10:55:43.776684 [debug] [Thread-2 (]: Began compiling node model.fao_elt_pipeline.gold_regional_summary
[0m10:55:43.781344 [debug] [Thread-1 (]: Writing injected SQL for node "model.fao_elt_pipeline.gold_price_production_analysis"
[0m10:55:43.781872 [debug] [Thread-4 (]: Began executing node test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31
[0m10:55:43.787156 [debug] [Thread-2 (]: Writing injected SQL for node "model.fao_elt_pipeline.gold_regional_summary"
[0m10:55:43.787672 [debug] [Thread-3 (]: Began executing node model.fao_elt_pipeline.gold_country_metrics
[0m10:55:43.788704 [debug] [Thread-4 (]: Finished running node test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31
[0m10:55:43.789710 [debug] [Thread-1 (]: Began executing node model.fao_elt_pipeline.gold_price_production_analysis
[0m10:55:43.790712 [debug] [Thread-3 (]: Finished running node model.fao_elt_pipeline.gold_country_metrics
[0m10:55:43.791710 [debug] [Thread-4 (]: Began running node model.fao_elt_pipeline.silver_top_countries
[0m10:55:43.791710 [debug] [Thread-2 (]: Began executing node model.fao_elt_pipeline.gold_regional_summary
[0m10:55:43.792712 [debug] [Thread-1 (]: Finished running node model.fao_elt_pipeline.gold_price_production_analysis
[0m10:55:43.794421 [debug] [Thread-3 (]: Began running node test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f
[0m10:55:43.794950 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31, now model.fao_elt_pipeline.silver_top_countries)
[0m10:55:43.795990 [debug] [Thread-2 (]: Finished running node model.fao_elt_pipeline.gold_regional_summary
[0m10:55:43.797038 [debug] [Thread-1 (]: Began running node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74
[0m10:55:43.798048 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.fao_elt_pipeline.gold_country_metrics, now test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f)
[0m10:55:43.799047 [debug] [Thread-4 (]: Began compiling node model.fao_elt_pipeline.silver_top_countries
[0m10:55:43.799047 [debug] [Thread-2 (]: Began running node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d
[0m10:55:43.800046 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fao_elt_pipeline.gold_price_production_analysis, now test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74)
[0m10:55:43.801046 [debug] [Thread-3 (]: Began compiling node test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f
[0m10:55:43.805045 [debug] [Thread-4 (]: Writing injected SQL for node "model.fao_elt_pipeline.silver_top_countries"
[0m10:55:43.806045 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.fao_elt_pipeline.gold_regional_summary, now test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d)
[0m10:55:43.807142 [debug] [Thread-1 (]: Began compiling node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74
[0m10:55:43.811247 [debug] [Thread-3 (]: Writing injected SQL for node "test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f"
[0m10:55:43.812247 [debug] [Thread-2 (]: Began compiling node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d
[0m10:55:43.817306 [debug] [Thread-1 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74"
[0m10:55:43.818340 [debug] [Thread-4 (]: Began executing node model.fao_elt_pipeline.silver_top_countries
[0m10:55:43.822849 [debug] [Thread-2 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d"
[0m10:55:43.823849 [debug] [Thread-3 (]: Began executing node test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f
[0m10:55:43.826088 [debug] [Thread-4 (]: Finished running node model.fao_elt_pipeline.silver_top_countries
[0m10:55:43.826623 [debug] [Thread-1 (]: Began executing node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74
[0m10:55:43.829173 [debug] [Thread-3 (]: Finished running node test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f
[0m10:55:43.830175 [debug] [Thread-2 (]: Began executing node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d
[0m10:55:43.831175 [debug] [Thread-4 (]: Began running node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df
[0m10:55:43.832174 [debug] [Thread-1 (]: Finished running node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74
[0m10:55:43.833174 [debug] [Thread-3 (]: Began running node test.fao_elt_pipeline.test_data_quality
[0m10:55:43.834595 [debug] [Thread-2 (]: Finished running node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d
[0m10:55:43.835629 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.fao_elt_pipeline.silver_top_countries, now test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df)
[0m10:55:43.836184 [debug] [Thread-1 (]: Began running node test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048
[0m10:55:43.837217 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f, now test.fao_elt_pipeline.test_data_quality)
[0m10:55:43.837217 [debug] [Thread-2 (]: Began running node test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee
[0m10:55:43.838224 [debug] [Thread-4 (]: Began compiling node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df
[0m10:55:43.839224 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74, now test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048)
[0m10:55:43.840226 [debug] [Thread-3 (]: Began compiling node test.fao_elt_pipeline.test_data_quality
[0m10:55:43.840226 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d, now test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee)
[0m10:55:43.845838 [debug] [Thread-4 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df"
[0m10:55:43.846344 [debug] [Thread-1 (]: Began compiling node test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048
[0m10:55:43.849352 [debug] [Thread-3 (]: Writing injected SQL for node "test.fao_elt_pipeline.test_data_quality"
[0m10:55:43.850352 [debug] [Thread-2 (]: Began compiling node test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee
[0m10:55:43.855301 [debug] [Thread-1 (]: Writing injected SQL for node "test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048"
[0m10:55:43.856306 [debug] [Thread-4 (]: Began executing node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df
[0m10:55:43.862760 [debug] [Thread-2 (]: Writing injected SQL for node "test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee"
[0m10:55:43.863803 [debug] [Thread-3 (]: Began executing node test.fao_elt_pipeline.test_data_quality
[0m10:55:43.865317 [debug] [Thread-4 (]: Finished running node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df
[0m10:55:43.865317 [debug] [Thread-1 (]: Began executing node test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048
[0m10:55:43.867317 [debug] [Thread-3 (]: Finished running node test.fao_elt_pipeline.test_data_quality
[0m10:55:43.867317 [debug] [Thread-2 (]: Began executing node test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee
[0m10:55:43.868316 [debug] [Thread-4 (]: Began running node test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd
[0m10:55:43.869315 [debug] [Thread-1 (]: Finished running node test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048
[0m10:55:43.870507 [debug] [Thread-3 (]: Began running node test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c
[0m10:55:43.871551 [debug] [Thread-2 (]: Finished running node test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee
[0m10:55:43.872617 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df, now test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd)
[0m10:55:43.873135 [debug] [Thread-1 (]: Began running node test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4
[0m10:55:43.873641 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.test_data_quality, now test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c)
[0m10:55:43.874649 [debug] [Thread-2 (]: Began running node test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53
[0m10:55:43.875648 [debug] [Thread-4 (]: Began compiling node test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd
[0m10:55:43.876650 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048, now test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4)
[0m10:55:43.876650 [debug] [Thread-3 (]: Began compiling node test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c
[0m10:55:43.877649 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee, now test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53)
[0m10:55:43.885126 [debug] [Thread-4 (]: Writing injected SQL for node "test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd"
[0m10:55:43.885126 [debug] [Thread-1 (]: Began compiling node test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4
[0m10:55:43.890383 [debug] [Thread-3 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c"
[0m10:55:43.890887 [debug] [Thread-2 (]: Began compiling node test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53
[0m10:55:43.895893 [debug] [Thread-1 (]: Writing injected SQL for node "test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4"
[0m10:55:43.897353 [debug] [Thread-4 (]: Began executing node test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd
[0m10:55:43.905478 [debug] [Thread-2 (]: Writing injected SQL for node "test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53"
[0m10:55:43.906905 [debug] [Thread-3 (]: Began executing node test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c
[0m10:55:43.907976 [debug] [Thread-4 (]: Finished running node test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd
[0m10:55:43.909015 [debug] [Thread-1 (]: Began executing node test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4
[0m10:55:43.909522 [debug] [Thread-3 (]: Finished running node test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c
[0m10:55:43.910529 [debug] [Thread-4 (]: Began running node test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69
[0m10:55:43.911530 [debug] [Thread-2 (]: Began executing node test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53
[0m10:55:43.912530 [debug] [Thread-1 (]: Finished running node test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4
[0m10:55:43.913529 [debug] [Thread-3 (]: Began running node test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b
[0m10:55:43.913529 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd, now test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69)
[0m10:55:43.914528 [debug] [Thread-2 (]: Finished running node test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53
[0m10:55:43.915861 [debug] [Thread-1 (]: Began running node test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6
[0m10:55:43.916973 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c, now test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b)
[0m10:55:43.917493 [debug] [Thread-4 (]: Began compiling node test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69
[0m10:55:43.918523 [debug] [Thread-2 (]: Began running node test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7
[0m10:55:43.919039 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4, now test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6)
[0m10:55:43.920047 [debug] [Thread-3 (]: Began compiling node test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b
[0m10:55:43.926966 [debug] [Thread-4 (]: Writing injected SQL for node "test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69"
[0m10:55:43.928001 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53, now test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7)
[0m10:55:43.928508 [debug] [Thread-1 (]: Began compiling node test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6
[0m10:55:43.933515 [debug] [Thread-3 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b"
[0m10:55:43.934500 [debug] [Thread-2 (]: Began compiling node test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7
[0m10:55:43.940635 [debug] [Thread-1 (]: Writing injected SQL for node "test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6"
[0m10:55:43.941635 [debug] [Thread-4 (]: Began executing node test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69
[0m10:55:43.947160 [debug] [Thread-2 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7"
[0m10:55:43.948167 [debug] [Thread-3 (]: Began executing node test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b
[0m10:55:43.949168 [debug] [Thread-4 (]: Finished running node test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69
[0m10:55:43.950167 [debug] [Thread-1 (]: Began executing node test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6
[0m10:55:43.951169 [debug] [Thread-3 (]: Finished running node test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b
[0m10:55:43.952168 [debug] [Thread-2 (]: Began executing node test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7
[0m10:55:43.952168 [debug] [Thread-4 (]: Began running node test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1
[0m10:55:43.954120 [debug] [Thread-1 (]: Finished running node test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6
[0m10:55:43.954648 [debug] [Thread-3 (]: Began running node test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd
[0m10:55:43.955694 [debug] [Thread-2 (]: Finished running node test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7
[0m10:55:43.956198 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69, now test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1)
[0m10:55:43.957206 [debug] [Thread-1 (]: Began running node test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a
[0m10:55:43.958205 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b, now test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd)
[0m10:55:43.959204 [debug] [Thread-4 (]: Began compiling node test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1
[0m10:55:43.960204 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6, now test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a)
[0m10:55:43.960204 [debug] [Thread-3 (]: Began compiling node test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd
[0m10:55:43.965476 [debug] [Thread-4 (]: Writing injected SQL for node "test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1"
[0m10:55:43.966476 [debug] [Thread-1 (]: Began compiling node test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a
[0m10:55:43.970477 [debug] [Thread-3 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd"
[0m10:55:43.976596 [debug] [Thread-1 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a"
[0m10:55:43.977595 [debug] [Thread-4 (]: Began executing node test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1
[0m10:55:43.978596 [debug] [Thread-4 (]: Finished running node test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1
[0m10:55:43.979598 [debug] [Thread-3 (]: Began executing node test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd
[0m10:55:43.979598 [debug] [Thread-1 (]: Began executing node test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a
[0m10:55:43.981190 [debug] [Thread-3 (]: Finished running node test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd
[0m10:55:43.982757 [debug] [Thread-1 (]: Finished running node test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a
[0m10:55:43.984395 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:55:43.984917 [debug] [MainThread]: Connection 'list_fao_public_silver' was properly closed.
[0m10:55:43.985434 [debug] [MainThread]: Connection 'list_fao_public_gold' was properly closed.
[0m10:55:43.985957 [debug] [MainThread]: Connection 'test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a' was properly closed.
[0m10:55:43.987047 [debug] [MainThread]: Connection 'test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7' was properly closed.
[0m10:55:43.987563 [debug] [MainThread]: Connection 'test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1' was properly closed.
[0m10:55:43.988079 [debug] [MainThread]: Connection 'test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd' was properly closed.
[0m10:55:43.994308 [debug] [MainThread]: Command end result
[0m10:55:44.318592 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m10:55:44.319594 [info ] [MainThread]: Building catalog
[0m10:55:44.331592 [debug] [ThreadPool]: Acquiring new postgres connection 'fao.information_schema'
[0m10:55:44.341592 [debug] [ThreadPool]: Using postgres connection "fao.information_schema"
[0m10:55:44.341592 [debug] [ThreadPool]: On fao.information_schema: BEGIN
[0m10:55:44.342593 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:55:44.355593 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:55:44.356593 [debug] [ThreadPool]: Using postgres connection "fao.information_schema"
[0m10:55:44.357592 [debug] [ThreadPool]: On fao.information_schema: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "connection_name": "fao.information_schema"} */

    
    

    select
        'fao' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public_gold') and
           upper(tbl.relname) = upper('gold_price_production_analysis')) or (upper(sch.nspname) = upper('public_silver') and
           upper(tbl.relname) = upper('silver_top_countries')) or (upper(sch.nspname) = upper('public_silver') and
           upper(tbl.relname) = upper('silver_prices_cleaned')) or (upper(sch.nspname) = upper('bronze') and
           upper(tbl.relname) = upper('raw_food_balance')) or (upper(sch.nspname) = upper('public_gold') and
           upper(tbl.relname) = upper('gold_country_metrics')) or (upper(sch.nspname) = upper('public_gold') and
           upper(tbl.relname) = upper('gold_regional_summary')) or (upper(sch.nspname) = upper('bronze') and
           upper(tbl.relname) = upper('raw_prices')) or (upper(sch.nspname) = upper('public_silver') and
           upper(tbl.relname) = upper('silver_production_cleaned')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m10:55:44.365592 [debug] [ThreadPool]: SQL status: SELECT 111 in 0.0 seconds
[0m10:55:44.377592 [debug] [ThreadPool]: On fao.information_schema: ROLLBACK
[0m10:55:44.379592 [debug] [ThreadPool]: On fao.information_schema: Close
[0m10:55:44.445054 [info ] [MainThread]: Catalog written to C:\Users\18057\Documents\Coding\fao-elt-pipelines\dbt_project\target\catalog.json
[0m10:55:44.446653 [debug] [MainThread]: Command `dbt docs generate` succeeded at 10:55:44.446653 after 1.83 seconds
[0m10:55:44.447704 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m10:55:44.448232 [debug] [MainThread]: Connection 'fao.information_schema' was properly closed.
[0m10:55:44.448751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024094017580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240943C46A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240971C6740>]}
[0m10:55:44.449802 [debug] [MainThread]: Flushing usage events
[0m11:12:18.609255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C955D87520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C958AF3640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C958AF3460>]}


============================== 11:12:18.613254 | e07e73c6-3a12-42e2-a4e1-f2abfdecdc6d ==============================
[0m11:12:18.613254 [info ] [MainThread]: Running with dbt=1.8.0
[0m11:12:18.614256 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\18057\\Documents\\Coding\\fao-elt-pipelines\\dbt_project\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\18057\\Documents\\Coding\\fao-elt-pipelines\\dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --target dev', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:12:18.769844 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m11:12:18.770844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e07e73c6-3a12-42e2-a4e1-f2abfdecdc6d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C958BADAE0>]}
[0m11:12:18.874845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e07e73c6-3a12-42e2-a4e1-f2abfdecdc6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C956054520>]}
[0m11:12:18.956429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e07e73c6-3a12-42e2-a4e1-f2abfdecdc6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C957EC3FA0>]}
[0m11:12:18.958428 [info ] [MainThread]: Registered adapter: postgres=1.8.0
[0m11:12:18.968427 [debug] [MainThread]: checksum: 2a6c64e758918535ccc035b9d143fb4c91b01df5f630e583361ba23a87d2a511, vars: {}, profile: , target: dev, version: 1.8.0
[0m11:12:19.133223 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m11:12:19.134222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e07e73c6-3a12-42e2-a4e1-f2abfdecdc6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C957EC0550>]}
[0m11:12:20.955238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e07e73c6-3a12-42e2-a4e1-f2abfdecdc6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C95A3BC130>]}
[0m11:12:21.130824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e07e73c6-3a12-42e2-a4e1-f2abfdecdc6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C95A3D2020>]}
[0m11:12:21.131825 [info ] [MainThread]: Found 6 models, 23 data tests, 2 sources, 414 macros
[0m11:12:21.131825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e07e73c6-3a12-42e2-a4e1-f2abfdecdc6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C95A3D21D0>]}
[0m11:12:21.134821 [info ] [MainThread]: 
[0m11:12:21.135823 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:12:21.141822 [debug] [ThreadPool]: Acquiring new postgres connection 'list_fao'
[0m11:12:21.273823 [debug] [ThreadPool]: Using postgres connection "list_fao"
[0m11:12:21.274822 [debug] [ThreadPool]: On list_fao: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "connection_name": "list_fao"} */

    select distinct nspname from pg_namespace
  
[0m11:12:21.275822 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:12:21.293823 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m11:12:21.295824 [debug] [ThreadPool]: On list_fao: Close
[0m11:12:21.297825 [debug] [ThreadPool]: Acquiring new postgres connection 'list_fao_public'
[0m11:12:21.305823 [debug] [ThreadPool]: Using postgres connection "list_fao_public"
[0m11:12:21.306825 [debug] [ThreadPool]: On list_fao_public: BEGIN
[0m11:12:21.307824 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:12:21.335449 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:12:21.335449 [debug] [ThreadPool]: Using postgres connection "list_fao_public"
[0m11:12:21.336450 [debug] [ThreadPool]: On list_fao_public: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "connection_name": "list_fao_public"} */
select
      'fao' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'fao' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'fao' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:12:21.340449 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m11:12:21.343448 [debug] [ThreadPool]: On list_fao_public: ROLLBACK
[0m11:12:21.344449 [debug] [ThreadPool]: On list_fao_public: Close
[0m11:12:21.351446 [debug] [MainThread]: Using postgres connection "master"
[0m11:12:21.352447 [debug] [MainThread]: On master: BEGIN
[0m11:12:21.353447 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:12:21.380448 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:12:21.381448 [debug] [MainThread]: Using postgres connection "master"
[0m11:12:21.382449 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:12:21.387448 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m11:12:21.389446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e07e73c6-3a12-42e2-a4e1-f2abfdecdc6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C956158B20>]}
[0m11:12:21.390446 [debug] [MainThread]: On master: ROLLBACK
[0m11:12:21.391449 [debug] [MainThread]: Using postgres connection "master"
[0m11:12:21.392448 [debug] [MainThread]: On master: BEGIN
[0m11:12:21.393449 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:12:21.394448 [debug] [MainThread]: On master: COMMIT
[0m11:12:21.394448 [debug] [MainThread]: Using postgres connection "master"
[0m11:12:21.395448 [debug] [MainThread]: On master: COMMIT
[0m11:12:21.396448 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:12:21.397447 [debug] [MainThread]: On master: Close
[0m11:12:21.398451 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:12:21.398451 [info ] [MainThread]: 
[0m11:12:21.401447 [debug] [Thread-1 (]: Began running node model.fao_elt_pipeline.silver_prices_cleaned
[0m11:12:21.402446 [debug] [Thread-2 (]: Began running node model.fao_elt_pipeline.silver_production_cleaned
[0m11:12:21.403448 [info ] [Thread-1 (]: 1 of 6 START sql table model public.silver_prices_cleaned ...................... [RUN]
[0m11:12:21.404448 [info ] [Thread-2 (]: 2 of 6 START sql table model public.silver_production_cleaned .................. [RUN]
[0m11:12:21.405449 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.fao_elt_pipeline.silver_prices_cleaned'
[0m11:12:21.406448 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.fao_elt_pipeline.silver_production_cleaned'
[0m11:12:21.406448 [debug] [Thread-1 (]: Began compiling node model.fao_elt_pipeline.silver_prices_cleaned
[0m11:12:21.407446 [debug] [Thread-2 (]: Began compiling node model.fao_elt_pipeline.silver_production_cleaned
[0m11:12:21.420449 [debug] [Thread-1 (]: Writing injected SQL for node "model.fao_elt_pipeline.silver_prices_cleaned"
[0m11:12:21.426446 [debug] [Thread-2 (]: Writing injected SQL for node "model.fao_elt_pipeline.silver_production_cleaned"
[0m11:12:21.427446 [debug] [Thread-1 (]: Began executing node model.fao_elt_pipeline.silver_prices_cleaned
[0m11:12:21.434517 [debug] [Thread-2 (]: Began executing node model.fao_elt_pipeline.silver_production_cleaned
[0m11:12:21.476033 [debug] [Thread-1 (]: Writing runtime sql for node "model.fao_elt_pipeline.silver_prices_cleaned"
[0m11:12:21.481030 [debug] [Thread-2 (]: Writing runtime sql for node "model.fao_elt_pipeline.silver_production_cleaned"
[0m11:12:21.482030 [debug] [Thread-1 (]: Using postgres connection "model.fao_elt_pipeline.silver_prices_cleaned"
[0m11:12:21.483033 [debug] [Thread-1 (]: On model.fao_elt_pipeline.silver_prices_cleaned: BEGIN
[0m11:12:21.484033 [debug] [Thread-2 (]: Using postgres connection "model.fao_elt_pipeline.silver_production_cleaned"
[0m11:12:21.484033 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:12:21.485032 [debug] [Thread-2 (]: On model.fao_elt_pipeline.silver_production_cleaned: BEGIN
[0m11:12:21.486032 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:12:21.499032 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:12:21.500032 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:12:21.500032 [debug] [Thread-1 (]: Using postgres connection "model.fao_elt_pipeline.silver_prices_cleaned"
[0m11:12:21.501032 [debug] [Thread-2 (]: Using postgres connection "model.fao_elt_pipeline.silver_production_cleaned"
[0m11:12:21.502032 [debug] [Thread-1 (]: On model.fao_elt_pipeline.silver_prices_cleaned: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.silver_prices_cleaned"} */

  
    

  create  table "fao"."public"."silver_prices_cleaned__dbt_tmp"
  
  
    as
  
  (
    

WITH raw_prices AS (
    SELECT
        data,
        loaded_at
    FROM "fao"."bronze"."raw_prices"
),

flattened_prices AS (
    SELECT
        (data->>'area')::TEXT as country_name,
        (data->>'area_code')::TEXT as area_code,
        (data->>'area_code_m49')::TEXT as area_code_m49,
        (data->>'element')::TEXT as element_name,
        (data->>'element_code')::TEXT as element_code,
        (data->>'flag')::TEXT as flag,
        (data->>'item')::TEXT as item_name,
        (data->>'item_code')::TEXT as item_code,
        (data->>'item_code_cpc')::TEXT as item_code_cpc,
        (data->>'unit')::TEXT as unit,
        (data->>'value')::NUMERIC as price_value,
        (data->>'year')::INTEGER as year,
        loaded_at
    FROM raw_prices
)

SELECT
    
    md5(
            coalesce(cast(area_code as varchar), '') || '-' || 
            coalesce(cast(element_code as varchar), '') || '-' || 
            coalesce(cast(item_code as varchar), '') || '-' || 
            coalesce(cast(year as varchar), '')
    )
 as price_id,
    country_name,
    area_code,
    area_code_m49,
    element_name,
    element_code,
    flag,
    item_name,
    item_code,
    item_code_cpc,
    unit,
    price_value,
    year,
    -- Add data quality flags
    CASE
        WHEN price_value IS NULL OR price_value <= 0 THEN FALSE
        ELSE TRUE
    END as is_valid_price,
    -- Add standardized country names (handle special characters)
    CASE
        WHEN country_name LIKE '%Côte%' THEN 'Ivory Coast'
        WHEN country_name = 'China, mainland' THEN 'China'
        WHEN country_name = 'United States of America' THEN 'USA'
        WHEN country_name = 'United Kingdom of Great Britain and Northern Ireland' THEN 'UK'
        ELSE country_name
    END as country_name_standardized,
    loaded_at,
    CURRENT_TIMESTAMP as transformed_at
FROM flattened_prices
WHERE price_value IS NOT NULL
  AND price_value > 0
  AND year >= 1990  -- Focus on more recent data
  );
  
[0m11:12:21.503032 [debug] [Thread-2 (]: On model.fao_elt_pipeline.silver_production_cleaned: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.silver_production_cleaned"} */

  
    

  create  table "fao"."public"."silver_production_cleaned__dbt_tmp"
  
  
    as
  
  (
    

WITH raw_production AS (
    SELECT
        data,
        loaded_at
    FROM "fao"."bronze"."raw_food_balance"
),

flattened_production AS (
    SELECT
        (data->>'area')::TEXT as country_name,
        (data->>'area_code')::TEXT as area_code,
        (data->>'area_code_m49')::TEXT as area_code_m49,
        (data->>'element')::TEXT as element_name,
        (data->>'element_code')::TEXT as element_code,
        (data->>'flag')::TEXT as flag,
        (data->>'item')::TEXT as item_name,
        (data->>'item_code')::TEXT as item_code,
        (data->>'item_code_fbs')::TEXT as item_code_fbs,
        (data->>'unit')::TEXT as unit,
        (data->>'value')::NUMERIC as production_value,
        (data->>'year')::INTEGER as year,
        loaded_at
    FROM raw_production
)

SELECT
    
    md5(
            coalesce(cast(area_code as varchar), '') || '-' || 
            coalesce(cast(item_code as varchar), '') || '-' || 
            coalesce(cast(year as varchar), '')
    )
 as production_id,
    country_name,
    area_code,
    area_code_m49,
    element_name,
    element_code,
    flag,
    item_name,
    item_code,
    item_code_fbs,
    unit,
    production_value,
    year,
    -- Convert to metric tons for consistency
    CASE
        WHEN unit = '1000 t' THEN production_value * 1000
        ELSE production_value
    END as production_metric_tons,
    -- Add data quality flags
    CASE
        WHEN production_value IS NULL OR production_value < 0 THEN FALSE
        ELSE TRUE
    END as is_valid_production,
    -- Add standardized country names
    CASE
        WHEN country_name LIKE '%Côte%' THEN 'Ivory Coast'
        WHEN country_name = 'China, mainland' THEN 'China'
        WHEN country_name = 'United States of America' THEN 'USA'
        WHEN country_name = 'United Kingdom of Great Britain and Northern Ireland' THEN 'UK'
        ELSE country_name
    END as country_name_standardized,
    loaded_at,
    CURRENT_TIMESTAMP as transformed_at
FROM flattened_production
WHERE element_name = 'Production'  -- Focus on production data only
  AND production_value >= 0
  AND year >= 1990
  );
  
[0m11:12:21.517002 [debug] [Thread-1 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m11:12:21.518001 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m11:12:21.525001 [debug] [Thread-1 (]: Using postgres connection "model.fao_elt_pipeline.silver_prices_cleaned"
[0m11:12:21.529000 [debug] [Thread-2 (]: Using postgres connection "model.fao_elt_pipeline.silver_production_cleaned"
[0m11:12:21.530002 [debug] [Thread-1 (]: On model.fao_elt_pipeline.silver_prices_cleaned: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.silver_prices_cleaned"} */
alter table "fao"."public"."silver_prices_cleaned__dbt_tmp" rename to "silver_prices_cleaned"
[0m11:12:21.530999 [debug] [Thread-2 (]: On model.fao_elt_pipeline.silver_production_cleaned: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.silver_production_cleaned"} */
alter table "fao"."public"."silver_production_cleaned__dbt_tmp" rename to "silver_production_cleaned"
[0m11:12:21.533001 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:12:21.533001 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:12:21.552003 [debug] [Thread-1 (]: Using postgres connection "model.fao_elt_pipeline.silver_prices_cleaned"
[0m11:12:21.554999 [debug] [Thread-2 (]: Using postgres connection "model.fao_elt_pipeline.silver_production_cleaned"
[0m11:12:21.556001 [debug] [Thread-1 (]: On model.fao_elt_pipeline.silver_prices_cleaned: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.silver_prices_cleaned"} */

    create  index if not exists
  "0a4340ae665a161173ea251920c949f6"
  on "fao"."public"."silver_prices_cleaned" using btree
  (area_code, year)
  
[0m11:12:21.556999 [debug] [Thread-2 (]: On model.fao_elt_pipeline.silver_production_cleaned: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.silver_production_cleaned"} */

    create  index if not exists
  "64fb648d9fc6b1f120e36bb6850a7c99"
  on "fao"."public"."silver_production_cleaned" using btree
  (area_code, year)
  
[0m11:12:21.561001 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m11:12:21.562001 [debug] [Thread-2 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m11:12:21.564001 [debug] [Thread-1 (]: Using postgres connection "model.fao_elt_pipeline.silver_prices_cleaned"
[0m11:12:21.566001 [debug] [Thread-2 (]: Using postgres connection "model.fao_elt_pipeline.silver_production_cleaned"
[0m11:12:21.567001 [debug] [Thread-1 (]: On model.fao_elt_pipeline.silver_prices_cleaned: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.silver_prices_cleaned"} */

    create  index if not exists
  "a415b41d9724d143d6e2f0e96ad11aee"
  on "fao"."public"."silver_prices_cleaned" using btree
  (item_code)
  
[0m11:12:21.567001 [debug] [Thread-2 (]: On model.fao_elt_pipeline.silver_production_cleaned: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.silver_production_cleaned"} */

    create  index if not exists
  "ef00f35ca37434ee9a24f313634a2c6d"
  on "fao"."public"."silver_production_cleaned" using btree
  (item_code)
  
[0m11:12:21.571001 [debug] [Thread-2 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m11:12:21.590003 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m11:12:21.589003 [debug] [Thread-2 (]: On model.fao_elt_pipeline.silver_production_cleaned: COMMIT
[0m11:12:21.591999 [debug] [Thread-1 (]: On model.fao_elt_pipeline.silver_prices_cleaned: COMMIT
[0m11:12:21.593001 [debug] [Thread-2 (]: Using postgres connection "model.fao_elt_pipeline.silver_production_cleaned"
[0m11:12:21.593999 [debug] [Thread-1 (]: Using postgres connection "model.fao_elt_pipeline.silver_prices_cleaned"
[0m11:12:21.594999 [debug] [Thread-2 (]: On model.fao_elt_pipeline.silver_production_cleaned: COMMIT
[0m11:12:21.594999 [debug] [Thread-1 (]: On model.fao_elt_pipeline.silver_prices_cleaned: COMMIT
[0m11:12:21.598385 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m11:12:21.599397 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:12:21.606397 [debug] [Thread-2 (]: Applying DROP to: "fao"."public"."silver_production_cleaned__dbt_backup"
[0m11:12:21.610394 [debug] [Thread-1 (]: Applying DROP to: "fao"."public"."silver_prices_cleaned__dbt_backup"
[0m11:12:21.615397 [debug] [Thread-2 (]: Using postgres connection "model.fao_elt_pipeline.silver_production_cleaned"
[0m11:12:21.616394 [debug] [Thread-1 (]: Using postgres connection "model.fao_elt_pipeline.silver_prices_cleaned"
[0m11:12:21.617395 [debug] [Thread-2 (]: On model.fao_elt_pipeline.silver_production_cleaned: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.silver_production_cleaned"} */
drop table if exists "fao"."public"."silver_production_cleaned__dbt_backup" cascade
[0m11:12:21.618394 [debug] [Thread-1 (]: On model.fao_elt_pipeline.silver_prices_cleaned: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.silver_prices_cleaned"} */
drop table if exists "fao"."public"."silver_prices_cleaned__dbt_backup" cascade
[0m11:12:21.619397 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:12:21.620396 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:12:21.623395 [debug] [Thread-2 (]: On model.fao_elt_pipeline.silver_production_cleaned: Close
[0m11:12:21.624395 [debug] [Thread-1 (]: On model.fao_elt_pipeline.silver_prices_cleaned: Close
[0m11:12:21.626397 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e07e73c6-3a12-42e2-a4e1-f2abfdecdc6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C959FEA0E0>]}
[0m11:12:21.627397 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e07e73c6-3a12-42e2-a4e1-f2abfdecdc6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C95A172260>]}
[0m11:12:21.628399 [info ] [Thread-2 (]: 2 of 6 OK created sql table model public.silver_production_cleaned ............. [[32mSELECT 1000[0m in 0.22s]
[0m11:12:21.629397 [info ] [Thread-1 (]: 1 of 6 OK created sql table model public.silver_prices_cleaned ................. [[32mSELECT 1000[0m in 0.22s]
[0m11:12:21.630394 [debug] [Thread-2 (]: Finished running node model.fao_elt_pipeline.silver_production_cleaned
[0m11:12:21.631396 [debug] [Thread-1 (]: Finished running node model.fao_elt_pipeline.silver_prices_cleaned
[0m11:12:21.632396 [debug] [Thread-4 (]: Began running node model.fao_elt_pipeline.gold_country_metrics
[0m11:12:21.633394 [debug] [Thread-3 (]: Began running node model.fao_elt_pipeline.gold_price_production_analysis
[0m11:12:21.634394 [debug] [Thread-2 (]: Began running node model.fao_elt_pipeline.gold_regional_summary
[0m11:12:21.634394 [debug] [Thread-1 (]: Began running node model.fao_elt_pipeline.silver_top_countries
[0m11:12:21.635396 [info ] [Thread-4 (]: 3 of 6 START sql table model public.gold_country_metrics ....................... [RUN]
[0m11:12:21.636395 [info ] [Thread-3 (]: 4 of 6 START sql table model public.gold_price_production_analysis ............. [RUN]
[0m11:12:21.637394 [info ] [Thread-2 (]: 5 of 6 START sql table model public.gold_regional_summary ...................... [RUN]
[0m11:12:21.638395 [info ] [Thread-1 (]: 6 of 6 START sql table model public.silver_top_countries ....................... [RUN]
[0m11:12:21.639394 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.fao_elt_pipeline.gold_country_metrics'
[0m11:12:21.640395 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.fao_elt_pipeline.gold_price_production_analysis'
[0m11:12:21.641394 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.fao_elt_pipeline.silver_production_cleaned, now model.fao_elt_pipeline.gold_regional_summary)
[0m11:12:21.642396 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fao_elt_pipeline.silver_prices_cleaned, now model.fao_elt_pipeline.silver_top_countries)
[0m11:12:21.643395 [debug] [Thread-4 (]: Began compiling node model.fao_elt_pipeline.gold_country_metrics
[0m11:12:21.643395 [debug] [Thread-3 (]: Began compiling node model.fao_elt_pipeline.gold_price_production_analysis
[0m11:12:21.644395 [debug] [Thread-2 (]: Began compiling node model.fao_elt_pipeline.gold_regional_summary
[0m11:12:21.645395 [debug] [Thread-1 (]: Began compiling node model.fao_elt_pipeline.silver_top_countries
[0m11:12:21.650394 [debug] [Thread-4 (]: Writing injected SQL for node "model.fao_elt_pipeline.gold_country_metrics"
[0m11:12:21.655395 [debug] [Thread-3 (]: Writing injected SQL for node "model.fao_elt_pipeline.gold_price_production_analysis"
[0m11:12:21.660233 [debug] [Thread-2 (]: Writing injected SQL for node "model.fao_elt_pipeline.gold_regional_summary"
[0m11:12:21.664428 [debug] [Thread-1 (]: Writing injected SQL for node "model.fao_elt_pipeline.silver_top_countries"
[0m11:12:21.665990 [debug] [Thread-4 (]: Began executing node model.fao_elt_pipeline.gold_country_metrics
[0m11:12:21.667048 [debug] [Thread-3 (]: Began executing node model.fao_elt_pipeline.gold_price_production_analysis
[0m11:12:21.671771 [debug] [Thread-4 (]: Writing runtime sql for node "model.fao_elt_pipeline.gold_country_metrics"
[0m11:12:21.672775 [debug] [Thread-2 (]: Began executing node model.fao_elt_pipeline.gold_regional_summary
[0m11:12:21.677771 [debug] [Thread-3 (]: Writing runtime sql for node "model.fao_elt_pipeline.gold_price_production_analysis"
[0m11:12:21.677771 [debug] [Thread-1 (]: Began executing node model.fao_elt_pipeline.silver_top_countries
[0m11:12:21.682772 [debug] [Thread-2 (]: Writing runtime sql for node "model.fao_elt_pipeline.gold_regional_summary"
[0m11:12:21.683772 [debug] [Thread-4 (]: Using postgres connection "model.fao_elt_pipeline.gold_country_metrics"
[0m11:12:21.687771 [debug] [Thread-1 (]: Writing runtime sql for node "model.fao_elt_pipeline.silver_top_countries"
[0m11:12:21.688771 [debug] [Thread-3 (]: Using postgres connection "model.fao_elt_pipeline.gold_price_production_analysis"
[0m11:12:21.689771 [debug] [Thread-4 (]: On model.fao_elt_pipeline.gold_country_metrics: BEGIN
[0m11:12:21.689771 [debug] [Thread-2 (]: Using postgres connection "model.fao_elt_pipeline.gold_regional_summary"
[0m11:12:21.690771 [debug] [Thread-3 (]: On model.fao_elt_pipeline.gold_price_production_analysis: BEGIN
[0m11:12:21.691771 [debug] [Thread-1 (]: Using postgres connection "model.fao_elt_pipeline.silver_top_countries"
[0m11:12:21.692772 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:12:21.693772 [debug] [Thread-2 (]: On model.fao_elt_pipeline.gold_regional_summary: BEGIN
[0m11:12:21.693772 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:12:21.694771 [debug] [Thread-1 (]: On model.fao_elt_pipeline.silver_top_countries: BEGIN
[0m11:12:21.695772 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:12:21.696771 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:12:21.708777 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m11:12:21.709774 [debug] [Thread-4 (]: Using postgres connection "model.fao_elt_pipeline.gold_country_metrics"
[0m11:12:21.710774 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:12:21.711772 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:12:21.711772 [debug] [Thread-4 (]: On model.fao_elt_pipeline.gold_country_metrics: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.gold_country_metrics"} */

  
    

  create  table "fao"."public"."gold_country_metrics__dbt_tmp"
  
  
    as
  
  (
    

WITH country_production AS (
    SELECT
        country_name_standardized as country_name,
        area_code,
        year,
        SUM(production_metric_tons) as annual_production,
        COUNT(DISTINCT item_code) as products_produced
    FROM "fao"."public"."silver_production_cleaned"
    WHERE is_valid_production = TRUE
    GROUP BY country_name_standardized, area_code, year
),

country_prices AS (
    SELECT
        country_name_standardized as country_name,
        area_code,
        year,
        AVG(price_value) as avg_annual_price,
        COUNT(DISTINCT item_code) as products_priced
    FROM "fao"."public"."silver_prices_cleaned"
    WHERE is_valid_price = TRUE
    GROUP BY country_name_standardized, area_code, year
),

country_trends AS (
    SELECT
        cp.country_name,
        cp.area_code,
        -- Production metrics
        SUM(cp.annual_production) as total_production_all_years,
        AVG(cp.annual_production) as avg_annual_production,
        MAX(cp.annual_production) as peak_annual_production,
        MIN(cp.annual_production) as min_annual_production,
        -- Calculate production growth rate (comparing first and last 3 years)
        AVG(CASE WHEN cp.year >= 2018 THEN cp.annual_production END) -
        AVG(CASE WHEN cp.year <= 1993 THEN cp.annual_production END) as production_change,
        -- Price metrics
        AVG(pc.avg_annual_price) as avg_price_all_years,
        MAX(pc.avg_annual_price) as max_price,
        MIN(pc.avg_annual_price) as min_price,
        -- Product diversity
        MAX(cp.products_produced) as max_products_produced,
        AVG(cp.products_produced) as avg_products_produced,
        -- Data availability
        COUNT(DISTINCT cp.year) as years_with_data,
        MIN(cp.year) as first_year,
        MAX(cp.year) as last_year
    FROM country_production cp
    LEFT JOIN country_prices pc
        ON cp.country_name = pc.country_name
        AND cp.area_code = pc.area_code
        AND cp.year = pc.year
    GROUP BY cp.country_name, cp.area_code
)





SELECT
    country_name,
    area_code,
    -- Production metrics
    ROUND(total_production_all_years, 0) as total_production_metric_tons,
    ROUND(avg_annual_production, 0) as avg_annual_production_metric_tons,
    ROUND(peak_annual_production, 0) as peak_production_metric_tons,
    ROUND(production_change, 0) as production_growth_metric_tons,
    CASE
        WHEN production_change > 0 THEN 'Growing'
        WHEN production_change < 0 THEN 'Declining'
        ELSE 'Stable'
    END as production_trend,
    -- Price metrics
    ROUND(avg_price_all_years, 2) as avg_price_usd_per_tonne,
    ROUND(max_price, 2) as max_price_usd_per_tonne,
    ROUND(min_price, 2) as min_price_usd_per_tonne,
    ROUND(max_price - min_price, 2) as price_volatility,
    -- Product diversity
    max_products_produced,
    ROUND(avg_products_produced, 1) as avg_products_produced,
    -- Classifications
    CASE
        WHEN total_production_all_years > 1000000 THEN 'Major Producer'
        WHEN total_production_all_years > 100000 THEN 'Medium Producer'
        ELSE 'Small Producer'
    END as producer_category,
    CASE
        WHEN avg_price_all_years > 1000 THEN 'High Value'
        WHEN avg_price_all_years > 500 THEN 'Medium Value'
        ELSE 'Low Value'
    END as price_category,
    -- Metadata
    years_with_data,
    first_year,
    last_year,
    CURRENT_TIMESTAMP as calculated_at
FROM country_trends
WHERE total_production_all_years > 0
ORDER BY total_production_all_years DESC
  );
  
[0m11:12:21.712773 [debug] [Thread-2 (]: Using postgres connection "model.fao_elt_pipeline.gold_regional_summary"
[0m11:12:21.713771 [debug] [Thread-1 (]: Using postgres connection "model.fao_elt_pipeline.silver_top_countries"
[0m11:12:21.715356 [debug] [Thread-2 (]: On model.fao_elt_pipeline.gold_regional_summary: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.gold_regional_summary"} */

  
    

  create  table "fao"."public"."gold_regional_summary__dbt_tmp"
  
  
    as
  
  (
    

WITH country_regions AS (
    -- Simple regional classification based on country names
    -- In production, you'd use a proper country-region mapping table
    SELECT
        country_name_standardized,
        area_code,
        CASE
            WHEN country_name_standardized IN ('China', 'India', 'Japan', 'Republic of Korea',
                                               'Thailand', 'Pakistan', 'Bangladesh', 'Myanmar') THEN 'Asia'
            WHEN country_name_standardized IN ('USA', 'Canada', 'Mexico') THEN 'North America'
            WHEN country_name_standardized IN ('Brazil', 'Argentina', 'Chile', 'Colombia',
                                               'Peru', 'Ecuador', 'Venezuela (Bolivarian Republic of)',
                                               'Paraguay', 'Uruguay', 'Bolivia (Plurinational State of)') THEN 'South America'
            WHEN country_name_standardized IN ('Germany', 'France', 'UK', 'Italy', 'Spain',
                                               'Poland', 'Netherlands (Kingdom of the)', 'Belgium',
                                               'Greece', 'Portugal', 'Sweden', 'Austria',
                                               'Denmark', 'Finland', 'Norway', 'Switzerland') THEN 'Europe'
            WHEN country_name_standardized IN ('Nigeria', 'Egypt', 'South Africa', 'Kenya',
                                               'Ethiopia', 'Morocco', 'Tunisia', 'Algeria',
                                               'Ghana', 'Ivory Coast', 'Senegal') THEN 'Africa'
            WHEN country_name_standardized IN ('Australia', 'New Zealand', 'Fiji') THEN 'Oceania'
            WHEN country_name_standardized IN ('Saudi Arabia', 'Iran (Islamic Republic of)',
                                               'Iraq', 'Syrian Arab Republic', 'Yemen',
                                               'United Arab Emirates', 'Oman') THEN 'Middle East'
            ELSE 'Other'
        END as region
    FROM (
        SELECT DISTINCT country_name_standardized, area_code
        FROM "fao"."public"."silver_production_cleaned"
        UNION
        SELECT DISTINCT country_name_standardized, area_code
        FROM "fao"."public"."silver_prices_cleaned"
    ) countries
),

regional_production AS (
    SELECT
        cr.region,
        p.year,
        p.item_name,
        SUM(p.production_metric_tons) as regional_production,
        COUNT(DISTINCT p.area_code) as countries_producing,
        AVG(p.production_metric_tons) as avg_country_production
    FROM "fao"."public"."silver_production_cleaned" p
    JOIN country_regions cr
        ON p.country_name_standardized = cr.country_name_standardized
    WHERE p.is_valid_production = TRUE
    GROUP BY cr.region, p.year, p.item_name
),

regional_prices AS (
    SELECT
        cr.region,
        pr.year,
        pr.item_name,
        AVG(pr.price_value) as avg_regional_price,
        MAX(pr.price_value) as max_regional_price,
        MIN(pr.price_value) as min_regional_price,
        COUNT(DISTINCT pr.area_code) as countries_with_prices
    FROM "fao"."public"."silver_prices_cleaned" pr
    JOIN country_regions cr
        ON pr.country_name_standardized = cr.country_name_standardized
    WHERE pr.is_valid_price = TRUE
    GROUP BY cr.region, pr.year, pr.item_name
)

SELECT
    COALESCE(rp.region, rpr.region) as region,
    -- Production metrics
    ROUND(SUM(rp.regional_production), 0) as total_production_metric_tons,
    ROUND(AVG(rp.regional_production), 0) as avg_annual_production,
    COUNT(DISTINCT rp.countries_producing) as total_producing_countries,
    COUNT(DISTINCT rp.item_name) as products_produced,
    -- Price metrics
    ROUND(AVG(rpr.avg_regional_price), 2) as avg_price_usd_per_tonne,
    ROUND(MAX(rpr.max_regional_price), 2) as highest_price_recorded,
    ROUND(AVG(rpr.max_regional_price - rpr.min_regional_price), 2) as avg_price_volatility,
    -- Market value
    ROUND(SUM(
        CASE
            WHEN rp.regional_production > 0 AND rpr.avg_regional_price > 0
            THEN rp.regional_production * rpr.avg_regional_price
            ELSE 0
        END
    ), 0) as total_market_value,
    -- Growth metrics (comparing recent vs early years)
    ROUND(
        AVG(CASE WHEN rp.year >= 2018 THEN rp.regional_production END) -
        AVG(CASE WHEN rp.year <= 1995 THEN rp.regional_production END),
        0
    ) as production_growth,
    -- Regional characteristics
    CASE
        WHEN SUM(rp.regional_production) > 100000000 THEN 'Major Agricultural Region'
        WHEN SUM(rp.regional_production) > 10000000 THEN 'Medium Agricultural Region'
        ELSE 'Minor Agricultural Region'
    END as regional_scale,
    -- Data coverage
    COUNT(DISTINCT COALESCE(rp.year, rpr.year)) as years_with_data,
    MIN(COALESCE(rp.year, rpr.year)) as first_year,
    MAX(COALESCE(rp.year, rpr.year)) as last_year,
    CURRENT_TIMESTAMP as calculated_at
FROM regional_production rp
FULL OUTER JOIN regional_prices rpr
    ON rp.region = rpr.region
    AND rp.year = rpr.year
    AND rp.item_name = rpr.item_name
WHERE COALESCE(rp.region, rpr.region) != 'Other'
GROUP BY COALESCE(rp.region, rpr.region)
ORDER BY total_production_metric_tons DESC
  );
  
[0m11:12:21.716367 [debug] [Thread-1 (]: On model.fao_elt_pipeline.silver_top_countries: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.silver_top_countries"} */

  
    

  create  table "fao"."public"."silver_top_countries__dbt_tmp"
  
  
    as
  
  (
    

WITH production_rankings AS (
    SELECT
        country_name_standardized,
        area_code,
        SUM(production_metric_tons) as total_production,
        COUNT(DISTINCT item_code) as product_diversity,
        COUNT(DISTINCT year) as years_of_data,
        AVG(production_metric_tons) as avg_annual_production,
        MAX(year) as latest_year
    FROM "fao"."public"."silver_production_cleaned"
    WHERE is_valid_production = TRUE
    GROUP BY country_name_standardized, area_code
),

price_rankings AS (
    SELECT
        country_name_standardized,
        area_code,
        AVG(price_value) as avg_price,
        COUNT(DISTINCT item_code) as items_with_prices,
        MAX(price_value) as max_price,
        MIN(price_value) as min_price
    FROM "fao"."public"."silver_prices_cleaned"
    WHERE is_valid_price = TRUE
    GROUP BY country_name_standardized, area_code
),

combined_rankings AS (
    SELECT
        COALESCE(pr.country_name_standardized, pc.country_name_standardized) as country_name,
        COALESCE(pr.area_code, pc.area_code) as area_code,
        pr.total_production,
        pr.product_diversity,
        pr.avg_annual_production,
        pc.avg_price,
        pc.items_with_prices,
        pc.max_price,
        -- Calculate rankings
        RANK() OVER (ORDER BY pr.total_production DESC NULLS LAST) as production_rank,
        RANK() OVER (ORDER BY pc.avg_price DESC NULLS LAST) as price_rank,
        RANK() OVER (ORDER BY pr.product_diversity DESC NULLS LAST) as diversity_rank
    FROM production_rankings pr
    FULL OUTER JOIN price_rankings pc
        ON pr.country_name_standardized = pc.country_name_standardized
        AND pr.area_code = pc.area_code
)

SELECT
    country_name,
    area_code,
    total_production,
    product_diversity,
    ROUND(avg_annual_production, 2) as avg_annual_production,
    ROUND(avg_price, 2) as avg_price_usd_per_tonne,
    items_with_prices,
    ROUND(max_price, 2) as max_price_usd_per_tonne,
    production_rank,
    price_rank,
    diversity_rank,
    -- Identify top performers
    CASE
        WHEN production_rank <= 10 THEN TRUE
        ELSE FALSE
    END as is_top_producer,
    CASE
        WHEN price_rank <= 10 THEN TRUE
        ELSE FALSE
    END as is_high_price_country,
    CASE
        WHEN diversity_rank <= 10 THEN TRUE
        ELSE FALSE
    END as is_diverse_producer,
    CURRENT_TIMESTAMP as calculated_at
FROM combined_rankings
WHERE country_name IS NOT NULL
  );
  
[0m11:12:21.723368 [debug] [Thread-4 (]: SQL status: SELECT 193 in 0.0 seconds
[0m11:12:21.724367 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m11:12:21.728368 [debug] [Thread-4 (]: Using postgres connection "model.fao_elt_pipeline.gold_country_metrics"
[0m11:12:21.729368 [debug] [Thread-1 (]: SQL status: SELECT 210 in 0.0 seconds
[0m11:12:21.730368 [debug] [Thread-2 (]: SQL status: SELECT 7 in 0.0 seconds
[0m11:12:21.730368 [debug] [Thread-3 (]: Using postgres connection "model.fao_elt_pipeline.gold_price_production_analysis"
[0m11:12:21.731367 [debug] [Thread-4 (]: On model.fao_elt_pipeline.gold_country_metrics: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.gold_country_metrics"} */
alter table "fao"."public"."gold_country_metrics__dbt_tmp" rename to "gold_country_metrics"
[0m11:12:21.735365 [debug] [Thread-1 (]: Using postgres connection "model.fao_elt_pipeline.silver_top_countries"
[0m11:12:21.739365 [debug] [Thread-2 (]: Using postgres connection "model.fao_elt_pipeline.gold_regional_summary"
[0m11:12:21.740367 [debug] [Thread-3 (]: On model.fao_elt_pipeline.gold_price_production_analysis: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.gold_price_production_analysis"} */

  
    

  create  table "fao"."public"."gold_price_production_analysis__dbt_tmp"
  
  
    as
  
  (
    

WITH item_production AS (
    SELECT
        item_name,
        item_code,
        year,
        SUM(production_metric_tons) as global_production,
        COUNT(DISTINCT area_code) as producing_countries
    FROM "fao"."public"."silver_production_cleaned"
    WHERE is_valid_production = TRUE
    GROUP BY item_name, item_code, year
),

item_prices AS (
    SELECT
        item_name,
        item_code,
        year,
        AVG(price_value) as avg_global_price,
        MAX(price_value) as max_price,
        MIN(price_value) as min_price,
        COUNT(DISTINCT area_code) as countries_with_prices
    FROM "fao"."public"."silver_prices_cleaned"
    WHERE is_valid_price = TRUE
    GROUP BY item_name, item_code, year
),

price_production_combined AS (
    SELECT
        COALESCE(ip.item_name, ipr.item_name) as item_name,
        COALESCE(ip.item_code, ipr.item_code) as item_code,
        COALESCE(ip.year, ipr.year) as year,
        ip.global_production,
        ip.producing_countries,
        ipr.avg_global_price,
        ipr.max_price,
        ipr.min_price,
        ipr.countries_with_prices,
        -- Calculate price-production metrics
        CASE
            WHEN ip.global_production > 0 AND ipr.avg_global_price > 0
            THEN ipr.avg_global_price * ip.global_production
            ELSE NULL
        END as market_value
    FROM item_production ip
    FULL OUTER JOIN item_prices ipr
        ON ip.item_code = ipr.item_code
        AND ip.year = ipr.year
)

SELECT
    item_name,
    item_code,
    -- Aggregate metrics across all years
    ROUND(AVG(global_production), 0) as avg_annual_production,
    ROUND(SUM(global_production), 0) as total_production_all_years,
    ROUND(AVG(avg_global_price), 2) as avg_price_all_years,
    ROUND(AVG(market_value), 0) as avg_annual_market_value,
    ROUND(SUM(market_value), 0) as total_market_value,
    -- Price volatility
    ROUND(AVG(max_price - min_price), 2) as avg_price_spread,
    ROUND(MAX(max_price), 2) as highest_price_recorded,
    -- Market concentration
    ROUND(AVG(producing_countries), 1) as avg_producing_countries,
    ROUND(AVG(countries_with_prices), 1) as avg_countries_with_prices,
    -- Categorization
    CASE
        WHEN AVG(global_production) > 10000000 THEN 'Major Commodity'
        WHEN AVG(global_production) > 1000000 THEN 'Medium Commodity'
        ELSE 'Minor Commodity'
    END as commodity_scale,
    CASE
        WHEN AVG(avg_global_price) > 2000 THEN 'Premium Product'
        WHEN AVG(avg_global_price) > 500 THEN 'Standard Product'
        ELSE 'Basic Product'
    END as price_tier,
    -- Data quality
    COUNT(DISTINCT year) as years_with_data,
    MIN(year) as first_year,
    MAX(year) as last_year,
    CURRENT_TIMESTAMP as calculated_at
FROM price_production_combined
WHERE item_name IS NOT NULL
GROUP BY item_name, item_code
HAVING COUNT(DISTINCT year) >= 5  -- Only include items with sufficient data
ORDER BY total_market_value DESC NULLS LAST
  );
  
[0m11:12:21.741365 [debug] [Thread-1 (]: On model.fao_elt_pipeline.silver_top_countries: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.silver_top_countries"} */
alter table "fao"."public"."silver_top_countries__dbt_tmp" rename to "silver_top_countries"
[0m11:12:21.742368 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:12:21.743368 [debug] [Thread-2 (]: On model.fao_elt_pipeline.gold_regional_summary: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.gold_regional_summary"} */
alter table "fao"."public"."gold_regional_summary__dbt_tmp" rename to "gold_regional_summary"
[0m11:12:21.745694 [debug] [Thread-4 (]: Using postgres connection "model.fao_elt_pipeline.gold_country_metrics"
[0m11:12:21.745694 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:12:21.746696 [debug] [Thread-4 (]: On model.fao_elt_pipeline.gold_country_metrics: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.gold_country_metrics"} */

    create  index if not exists
  "a25953239a33810358f90a9a2a2a6737"
  on "fao"."public"."gold_country_metrics" using btree
  (country_name)
  
[0m11:12:21.747807 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:12:21.749912 [debug] [Thread-1 (]: On model.fao_elt_pipeline.silver_top_countries: COMMIT
[0m11:12:21.751508 [debug] [Thread-2 (]: On model.fao_elt_pipeline.gold_regional_summary: COMMIT
[0m11:12:21.752037 [debug] [Thread-1 (]: Using postgres connection "model.fao_elt_pipeline.silver_top_countries"
[0m11:12:21.753114 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.0 seconds
[0m11:12:21.753642 [debug] [Thread-4 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m11:12:21.754162 [debug] [Thread-2 (]: Using postgres connection "model.fao_elt_pipeline.gold_regional_summary"
[0m11:12:21.754690 [debug] [Thread-1 (]: On model.fao_elt_pipeline.silver_top_countries: COMMIT
[0m11:12:21.758862 [debug] [Thread-3 (]: Using postgres connection "model.fao_elt_pipeline.gold_price_production_analysis"
[0m11:12:21.760871 [debug] [Thread-4 (]: On model.fao_elt_pipeline.gold_country_metrics: COMMIT
[0m11:12:21.761750 [debug] [Thread-2 (]: On model.fao_elt_pipeline.gold_regional_summary: COMMIT
[0m11:12:21.762815 [debug] [Thread-3 (]: On model.fao_elt_pipeline.gold_price_production_analysis: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.gold_price_production_analysis"} */
alter table "fao"."public"."gold_price_production_analysis__dbt_tmp" rename to "gold_price_production_analysis"
[0m11:12:21.763347 [debug] [Thread-4 (]: Using postgres connection "model.fao_elt_pipeline.gold_country_metrics"
[0m11:12:21.764413 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:12:21.765484 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m11:12:21.766018 [debug] [Thread-4 (]: On model.fao_elt_pipeline.gold_country_metrics: COMMIT
[0m11:12:21.766548 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:12:21.770211 [debug] [Thread-1 (]: Applying DROP to: "fao"."public"."silver_top_countries__dbt_backup"
[0m11:12:21.773359 [debug] [Thread-2 (]: Applying DROP to: "fao"."public"."gold_regional_summary__dbt_backup"
[0m11:12:21.774938 [debug] [Thread-3 (]: On model.fao_elt_pipeline.gold_price_production_analysis: COMMIT
[0m11:12:21.775982 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m11:12:21.776549 [debug] [Thread-1 (]: Using postgres connection "model.fao_elt_pipeline.silver_top_countries"
[0m11:12:21.777586 [debug] [Thread-2 (]: Using postgres connection "model.fao_elt_pipeline.gold_regional_summary"
[0m11:12:21.778594 [debug] [Thread-3 (]: Using postgres connection "model.fao_elt_pipeline.gold_price_production_analysis"
[0m11:12:21.781594 [debug] [Thread-4 (]: Applying DROP to: "fao"."public"."gold_country_metrics__dbt_backup"
[0m11:12:21.782595 [debug] [Thread-1 (]: On model.fao_elt_pipeline.silver_top_countries: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.silver_top_countries"} */
drop table if exists "fao"."public"."silver_top_countries__dbt_backup" cascade
[0m11:12:21.783593 [debug] [Thread-2 (]: On model.fao_elt_pipeline.gold_regional_summary: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.gold_regional_summary"} */
drop table if exists "fao"."public"."gold_regional_summary__dbt_backup" cascade
[0m11:12:21.784594 [debug] [Thread-3 (]: On model.fao_elt_pipeline.gold_price_production_analysis: COMMIT
[0m11:12:21.785595 [debug] [Thread-4 (]: Using postgres connection "model.fao_elt_pipeline.gold_country_metrics"
[0m11:12:21.786595 [debug] [Thread-4 (]: On model.fao_elt_pipeline.gold_country_metrics: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.gold_country_metrics"} */
drop table if exists "fao"."public"."gold_country_metrics__dbt_backup" cascade
[0m11:12:21.787593 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:12:21.788594 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:12:21.788594 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m11:12:21.790596 [debug] [Thread-1 (]: On model.fao_elt_pipeline.silver_top_countries: Close
[0m11:12:21.791593 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:12:21.793596 [debug] [Thread-2 (]: On model.fao_elt_pipeline.gold_regional_summary: Close
[0m11:12:21.797593 [debug] [Thread-3 (]: Applying DROP to: "fao"."public"."gold_price_production_analysis__dbt_backup"
[0m11:12:21.798601 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e07e73c6-3a12-42e2-a4e1-f2abfdecdc6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C958D52650>]}
[0m11:12:21.800595 [debug] [Thread-4 (]: On model.fao_elt_pipeline.gold_country_metrics: Close
[0m11:12:21.801596 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e07e73c6-3a12-42e2-a4e1-f2abfdecdc6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C958D05750>]}
[0m11:12:21.803597 [debug] [Thread-3 (]: Using postgres connection "model.fao_elt_pipeline.gold_price_production_analysis"
[0m11:12:21.804596 [info ] [Thread-1 (]: 6 of 6 OK created sql table model public.silver_top_countries .................. [[32mSELECT 210[0m in 0.16s]
[0m11:12:21.805595 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e07e73c6-3a12-42e2-a4e1-f2abfdecdc6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C958F04340>]}
[0m11:12:21.806596 [info ] [Thread-2 (]: 5 of 6 OK created sql table model public.gold_regional_summary ................. [[32mSELECT 7[0m in 0.16s]
[0m11:12:21.807593 [debug] [Thread-3 (]: On model.fao_elt_pipeline.gold_price_production_analysis: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.gold_price_production_analysis"} */
drop table if exists "fao"."public"."gold_price_production_analysis__dbt_backup" cascade
[0m11:12:21.808596 [debug] [Thread-1 (]: Finished running node model.fao_elt_pipeline.silver_top_countries
[0m11:12:21.809595 [info ] [Thread-4 (]: 3 of 6 OK created sql table model public.gold_country_metrics .................. [[32mSELECT 193[0m in 0.17s]
[0m11:12:21.810595 [debug] [Thread-2 (]: Finished running node model.fao_elt_pipeline.gold_regional_summary
[0m11:12:21.811593 [debug] [Thread-4 (]: Finished running node model.fao_elt_pipeline.gold_country_metrics
[0m11:12:21.812594 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:12:21.814594 [debug] [Thread-3 (]: On model.fao_elt_pipeline.gold_price_production_analysis: Close
[0m11:12:21.815595 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e07e73c6-3a12-42e2-a4e1-f2abfdecdc6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C958DBAF50>]}
[0m11:12:21.816593 [info ] [Thread-3 (]: 4 of 6 OK created sql table model public.gold_price_production_analysis ........ [[32mSELECT 0[0m in 0.18s]
[0m11:12:21.817593 [debug] [Thread-3 (]: Finished running node model.fao_elt_pipeline.gold_price_production_analysis
[0m11:12:21.819596 [debug] [MainThread]: Using postgres connection "master"
[0m11:12:21.820594 [debug] [MainThread]: On master: BEGIN
[0m11:12:21.820594 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:12:21.834594 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:12:21.834594 [debug] [MainThread]: On master: COMMIT
[0m11:12:21.835594 [debug] [MainThread]: Using postgres connection "master"
[0m11:12:21.836592 [debug] [MainThread]: On master: COMMIT
[0m11:12:21.837595 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:12:21.838236 [debug] [MainThread]: On master: Close
[0m11:12:21.839381 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:12:21.839917 [debug] [MainThread]: Connection 'list_fao' was properly closed.
[0m11:12:21.840451 [debug] [MainThread]: Connection 'list_fao_public' was properly closed.
[0m11:12:21.841523 [debug] [MainThread]: Connection 'model.fao_elt_pipeline.silver_top_countries' was properly closed.
[0m11:12:21.842066 [debug] [MainThread]: Connection 'model.fao_elt_pipeline.gold_regional_summary' was properly closed.
[0m11:12:21.842602 [debug] [MainThread]: Connection 'model.fao_elt_pipeline.gold_country_metrics' was properly closed.
[0m11:12:21.843676 [debug] [MainThread]: Connection 'model.fao_elt_pipeline.gold_price_production_analysis' was properly closed.
[0m11:12:21.844216 [info ] [MainThread]: 
[0m11:12:21.845282 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 0.71 seconds (0.71s).
[0m11:12:21.847418 [debug] [MainThread]: Command end result
[0m11:12:21.890862 [info ] [MainThread]: 
[0m11:12:21.891862 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:12:21.892862 [info ] [MainThread]: 
[0m11:12:21.892862 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m11:12:21.894861 [debug] [MainThread]: Command `dbt run` succeeded at 11:12:21.894861 after 3.38 seconds
[0m11:12:21.894861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C955D87520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C957EC3FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C95A3D2320>]}
[0m11:12:21.895862 [debug] [MainThread]: Flushing usage events
[0m11:12:25.159863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2746E7580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D277453670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D277453490>]}


============================== 11:12:25.163863 | 670692f8-8508-4ffe-951c-571eb38fe25f ==============================
[0m11:12:25.163863 [info ] [MainThread]: Running with dbt=1.8.0
[0m11:12:25.164863 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\18057\\Documents\\Coding\\fao-elt-pipelines\\dbt_project', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\18057\\Documents\\Coding\\fao-elt-pipelines\\dbt_project\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test --target dev', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:12:25.320864 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m11:12:25.321864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '670692f8-8508-4ffe-951c-571eb38fe25f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2773DF760>]}
[0m11:12:25.425959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '670692f8-8508-4ffe-951c-571eb38fe25f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2749B4670>]}
[0m11:12:25.506959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '670692f8-8508-4ffe-951c-571eb38fe25f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D274301780>]}
[0m11:12:25.508959 [info ] [MainThread]: Registered adapter: postgres=1.8.0
[0m11:12:25.518959 [debug] [MainThread]: checksum: 2a6c64e758918535ccc035b9d143fb4c91b01df5f630e583361ba23a87d2a511, vars: {}, profile: , target: dev, version: 1.8.0
[0m11:12:25.773112 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:12:25.773632 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:12:25.856575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '670692f8-8508-4ffe-951c-571eb38fe25f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D277902020>]}
[0m11:12:26.075466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '670692f8-8508-4ffe-951c-571eb38fe25f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2778FB580>]}
[0m11:12:26.076467 [info ] [MainThread]: Found 6 models, 23 data tests, 2 sources, 414 macros
[0m11:12:26.077468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '670692f8-8508-4ffe-951c-571eb38fe25f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2778B5060>]}
[0m11:12:26.080467 [info ] [MainThread]: 
[0m11:12:26.082467 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:12:26.089467 [debug] [ThreadPool]: Acquiring new postgres connection 'list_fao_public'
[0m11:12:26.218085 [debug] [ThreadPool]: Using postgres connection "list_fao_public"
[0m11:12:26.219084 [debug] [ThreadPool]: On list_fao_public: BEGIN
[0m11:12:26.220086 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:12:26.237083 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:12:26.238085 [debug] [ThreadPool]: Using postgres connection "list_fao_public"
[0m11:12:26.239084 [debug] [ThreadPool]: On list_fao_public: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "connection_name": "list_fao_public"} */
select
      'fao' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'fao' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'fao' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:12:26.243084 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m11:12:26.245085 [debug] [ThreadPool]: On list_fao_public: ROLLBACK
[0m11:12:26.247086 [debug] [ThreadPool]: On list_fao_public: Close
[0m11:12:26.254083 [debug] [MainThread]: Using postgres connection "master"
[0m11:12:26.255083 [debug] [MainThread]: On master: BEGIN
[0m11:12:26.256084 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:12:26.269083 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:12:26.270085 [debug] [MainThread]: Using postgres connection "master"
[0m11:12:26.271083 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:12:26.277083 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m11:12:26.279083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '670692f8-8508-4ffe-951c-571eb38fe25f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D277937970>]}
[0m11:12:26.279083 [debug] [MainThread]: On master: ROLLBACK
[0m11:12:26.281083 [debug] [MainThread]: Using postgres connection "master"
[0m11:12:26.281083 [debug] [MainThread]: On master: BEGIN
[0m11:12:26.283086 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:12:26.283086 [debug] [MainThread]: On master: COMMIT
[0m11:12:26.284084 [debug] [MainThread]: Using postgres connection "master"
[0m11:12:26.285083 [debug] [MainThread]: On master: COMMIT
[0m11:12:26.286083 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:12:26.286083 [debug] [MainThread]: On master: Close
[0m11:12:26.287083 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:12:26.288084 [info ] [MainThread]: 
[0m11:12:26.292083 [debug] [Thread-1 (]: Began running node test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee
[0m11:12:26.293084 [debug] [Thread-2 (]: Began running node test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd
[0m11:12:26.293084 [debug] [Thread-3 (]: Began running node test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53
[0m11:12:26.294083 [debug] [Thread-4 (]: Began running node test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69
[0m11:12:26.295085 [info ] [Thread-1 (]: 1 of 23 START test accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer  [RUN]
[0m11:12:26.296085 [info ] [Thread-2 (]: 2 of 23 START test accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable  [RUN]
[0m11:12:26.297084 [info ] [Thread-3 (]: 3 of 23 START test accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity  [RUN]
[0m11:12:26.297084 [info ] [Thread-4 (]: 4 of 23 START test accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product  [RUN]
[0m11:12:26.298083 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee'
[0m11:12:26.299085 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd'
[0m11:12:26.300083 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53'
[0m11:12:26.301083 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69'
[0m11:12:26.302083 [debug] [Thread-1 (]: Began compiling node test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee
[0m11:12:26.303083 [debug] [Thread-2 (]: Began compiling node test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd
[0m11:12:26.304083 [debug] [Thread-3 (]: Began compiling node test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53
[0m11:12:26.305084 [debug] [Thread-4 (]: Began compiling node test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69
[0m11:12:26.326083 [debug] [Thread-1 (]: Writing injected SQL for node "test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee"
[0m11:12:26.333695 [debug] [Thread-2 (]: Writing injected SQL for node "test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd"
[0m11:12:26.341693 [debug] [Thread-3 (]: Writing injected SQL for node "test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53"
[0m11:12:26.349694 [debug] [Thread-4 (]: Writing injected SQL for node "test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69"
[0m11:12:26.350694 [debug] [Thread-1 (]: Began executing node test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee
[0m11:12:26.351694 [debug] [Thread-2 (]: Began executing node test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd
[0m11:12:26.352694 [debug] [Thread-3 (]: Began executing node test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53
[0m11:12:26.373694 [debug] [Thread-1 (]: Writing runtime sql for node "test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee"
[0m11:12:26.377693 [debug] [Thread-2 (]: Writing runtime sql for node "test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd"
[0m11:12:26.377693 [debug] [Thread-4 (]: Began executing node test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69
[0m11:12:26.380693 [debug] [Thread-3 (]: Writing runtime sql for node "test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53"
[0m11:12:26.382695 [debug] [Thread-1 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee"
[0m11:12:26.385694 [debug] [Thread-4 (]: Writing runtime sql for node "test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69"
[0m11:12:26.386693 [debug] [Thread-2 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd"
[0m11:12:26.387694 [debug] [Thread-1 (]: On test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee: BEGIN
[0m11:12:26.388693 [debug] [Thread-3 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53"
[0m11:12:26.389694 [debug] [Thread-2 (]: On test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd: BEGIN
[0m11:12:26.390696 [debug] [Thread-4 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69"
[0m11:12:26.390696 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:12:26.391694 [debug] [Thread-3 (]: On test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53: BEGIN
[0m11:12:26.392694 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:12:26.393694 [debug] [Thread-4 (]: On test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69: BEGIN
[0m11:12:26.394693 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:12:26.395694 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:12:26.407698 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:12:26.408695 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:12:26.409694 [debug] [Thread-1 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee"
[0m11:12:26.410697 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m11:12:26.411697 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m11:12:26.411697 [debug] [Thread-2 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd"
[0m11:12:26.412696 [debug] [Thread-1 (]: On test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        producer_category as value_field,
        count(*) as n_records

    from "fao"."public"."gold_country_metrics"
    group by producer_category

)

select *
from all_values
where value_field not in (
    'Major Producer','Medium Producer','Small Producer'
)



      
    ) dbt_internal_test
[0m11:12:26.413694 [debug] [Thread-3 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53"
[0m11:12:26.414694 [debug] [Thread-4 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69"
[0m11:12:26.415694 [debug] [Thread-2 (]: On test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        production_trend as value_field,
        count(*) as n_records

    from "fao"."public"."gold_country_metrics"
    group by production_trend

)

select *
from all_values
where value_field not in (
    'Growing','Declining','Stable'
)



      
    ) dbt_internal_test
[0m11:12:26.416694 [debug] [Thread-3 (]: On test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        commodity_scale as value_field,
        count(*) as n_records

    from "fao"."public"."gold_price_production_analysis"
    group by commodity_scale

)

select *
from all_values
where value_field not in (
    'Major Commodity','Medium Commodity','Minor Commodity'
)



      
    ) dbt_internal_test
[0m11:12:26.416694 [debug] [Thread-4 (]: On test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        price_tier as value_field,
        count(*) as n_records

    from "fao"."public"."gold_price_production_analysis"
    group by price_tier

)

select *
from all_values
where value_field not in (
    'Premium Product','Standard Product','Basic Product'
)



      
    ) dbt_internal_test
[0m11:12:26.417696 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:12:26.423695 [debug] [Thread-1 (]: On test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee: ROLLBACK
[0m11:12:26.424694 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:12:26.425694 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:12:26.425694 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:12:26.428695 [debug] [Thread-2 (]: On test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd: ROLLBACK
[0m11:12:26.428695 [debug] [Thread-1 (]: On test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee: Close
[0m11:12:26.430695 [debug] [Thread-3 (]: On test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53: ROLLBACK
[0m11:12:26.432696 [debug] [Thread-4 (]: On test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69: ROLLBACK
[0m11:12:26.434694 [debug] [Thread-2 (]: On test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd: Close
[0m11:12:26.433695 [info ] [Thread-1 (]: 1 of 23 PASS accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer  [[32mPASS[0m in 0.14s]
[0m11:12:26.435696 [debug] [Thread-3 (]: On test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53: Close
[0m11:12:26.436694 [debug] [Thread-4 (]: On test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69: Close
[0m11:12:26.437696 [info ] [Thread-2 (]: 2 of 23 PASS accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable  [[32mPASS[0m in 0.14s]
[0m11:12:26.438695 [debug] [Thread-1 (]: Finished running node test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee
[0m11:12:26.440696 [info ] [Thread-3 (]: 3 of 23 PASS accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity  [[32mPASS[0m in 0.14s]
[0m11:12:26.441697 [info ] [Thread-4 (]: 4 of 23 PASS accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product  [[32mPASS[0m in 0.14s]
[0m11:12:26.442697 [debug] [Thread-2 (]: Finished running node test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd
[0m11:12:26.443694 [debug] [Thread-1 (]: Began running node test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6
[0m11:12:26.444696 [debug] [Thread-3 (]: Finished running node test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53
[0m11:12:26.445695 [debug] [Thread-4 (]: Finished running node test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69
[0m11:12:26.446694 [debug] [Thread-2 (]: Began running node test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff
[0m11:12:26.447694 [info ] [Thread-1 (]: 5 of 23 START test accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region  [RUN]
[0m11:12:26.448695 [debug] [Thread-3 (]: Began running node test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f
[0m11:12:26.449693 [debug] [Thread-4 (]: Began running node test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c
[0m11:12:26.450695 [info ] [Thread-2 (]: 6 of 23 START test accepted_values_silver_prices_cleaned_is_valid_price__True__False  [RUN]
[0m11:12:26.451693 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee, now test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6)
[0m11:12:26.452697 [info ] [Thread-3 (]: 7 of 23 START test accepted_values_silver_production_cleaned_is_valid_production__True__False  [RUN]
[0m11:12:26.452697 [info ] [Thread-4 (]: 8 of 23 START test not_null_gold_country_metrics_country_name .................. [RUN]
[0m11:12:26.453695 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd, now test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff)
[0m11:12:26.454697 [debug] [Thread-1 (]: Began compiling node test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6
[0m11:12:26.455696 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53, now test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f)
[0m11:12:26.456694 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69, now test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c)
[0m11:12:26.457694 [debug] [Thread-2 (]: Began compiling node test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff
[0m11:12:26.464694 [debug] [Thread-1 (]: Writing injected SQL for node "test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6"
[0m11:12:26.465693 [debug] [Thread-3 (]: Began compiling node test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f
[0m11:12:26.466694 [debug] [Thread-4 (]: Began compiling node test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c
[0m11:12:26.472694 [debug] [Thread-2 (]: Writing injected SQL for node "test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff"
[0m11:12:26.477693 [debug] [Thread-3 (]: Writing injected SQL for node "test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f"
[0m11:12:26.486694 [debug] [Thread-4 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c"
[0m11:12:26.486694 [debug] [Thread-1 (]: Began executing node test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6
[0m11:12:26.488694 [debug] [Thread-2 (]: Began executing node test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff
[0m11:12:26.489694 [debug] [Thread-3 (]: Began executing node test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f
[0m11:12:26.492694 [debug] [Thread-1 (]: Writing runtime sql for node "test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6"
[0m11:12:26.495693 [debug] [Thread-2 (]: Writing runtime sql for node "test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff"
[0m11:12:26.496697 [debug] [Thread-4 (]: Began executing node test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c
[0m11:12:26.499696 [debug] [Thread-3 (]: Writing runtime sql for node "test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f"
[0m11:12:26.503694 [debug] [Thread-4 (]: Writing runtime sql for node "test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c"
[0m11:12:26.503694 [debug] [Thread-1 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6"
[0m11:12:26.504697 [debug] [Thread-2 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff"
[0m11:12:26.505694 [debug] [Thread-3 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f"
[0m11:12:26.506694 [debug] [Thread-1 (]: On test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6: BEGIN
[0m11:12:26.507693 [debug] [Thread-4 (]: Using postgres connection "test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c"
[0m11:12:26.508696 [debug] [Thread-2 (]: On test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff: BEGIN
[0m11:12:26.508696 [debug] [Thread-3 (]: On test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f: BEGIN
[0m11:12:26.509694 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:12:26.510694 [debug] [Thread-4 (]: On test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c: BEGIN
[0m11:12:26.511693 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:12:26.512695 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:12:26.513694 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:12:26.526694 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:12:26.527696 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:12:26.528695 [debug] [Thread-1 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6"
[0m11:12:26.529694 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m11:12:26.529694 [debug] [Thread-2 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff"
[0m11:12:26.531276 [debug] [Thread-1 (]: On test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        regional_scale as value_field,
        count(*) as n_records

    from "fao"."public"."gold_regional_summary"
    group by regional_scale

)

select *
from all_values
where value_field not in (
    'Major Agricultural Region','Medium Agricultural Region','Minor Agricultural Region'
)



      
    ) dbt_internal_test
[0m11:12:26.531276 [debug] [Thread-4 (]: Using postgres connection "test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c"
[0m11:12:26.532286 [debug] [Thread-2 (]: On test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        is_valid_price as value_field,
        count(*) as n_records

    from "fao"."public"."silver_prices_cleaned"
    group by is_valid_price

)

select *
from all_values
where value_field not in (
    'True','False'
)



      
    ) dbt_internal_test
[0m11:12:26.533286 [debug] [Thread-4 (]: On test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select country_name
from "fao"."public"."gold_country_metrics"
where country_name is null



      
    ) dbt_internal_test
[0m11:12:26.535285 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:12:26.535285 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:12:26.536287 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:12:26.538285 [debug] [Thread-1 (]: On test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6: ROLLBACK
[0m11:12:26.540287 [debug] [Thread-4 (]: On test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c: ROLLBACK
[0m11:12:26.542285 [debug] [Thread-2 (]: On test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff: ROLLBACK
[0m11:12:26.542285 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m11:12:26.544287 [debug] [Thread-1 (]: On test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6: Close
[0m11:12:26.545286 [debug] [Thread-3 (]: Using postgres connection "test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f"
[0m11:12:26.545286 [debug] [Thread-4 (]: On test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c: Close
[0m11:12:26.546285 [debug] [Thread-2 (]: On test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff: Close
[0m11:12:26.547285 [info ] [Thread-1 (]: 5 of 23 PASS accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region  [[32mPASS[0m in 0.10s]
[0m11:12:26.548287 [debug] [Thread-3 (]: On test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        is_valid_production as value_field,
        count(*) as n_records

    from "fao"."public"."silver_production_cleaned"
    group by is_valid_production

)

select *
from all_values
where value_field not in (
    'True','False'
)



      
    ) dbt_internal_test
[0m11:12:26.549285 [info ] [Thread-4 (]: 8 of 23 PASS not_null_gold_country_metrics_country_name ........................ [[32mPASS[0m in 0.09s]
[0m11:12:26.550288 [info ] [Thread-2 (]: 6 of 23 PASS accepted_values_silver_prices_cleaned_is_valid_price__True__False . [[32mPASS[0m in 0.10s]
[0m11:12:26.551287 [debug] [Thread-1 (]: Finished running node test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6
[0m11:12:26.553286 [debug] [Thread-4 (]: Finished running node test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c
[0m11:12:26.554286 [debug] [Thread-2 (]: Finished running node test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff
[0m11:12:26.554286 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:12:26.555286 [debug] [Thread-1 (]: Began running node test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b
[0m11:12:26.556285 [debug] [Thread-4 (]: Began running node test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7
[0m11:12:26.557285 [debug] [Thread-2 (]: Began running node test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5
[0m11:12:26.559286 [debug] [Thread-3 (]: On test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f: ROLLBACK
[0m11:12:26.560285 [info ] [Thread-1 (]: 9 of 23 START test not_null_gold_price_production_analysis_item_name ........... [RUN]
[0m11:12:26.561285 [info ] [Thread-4 (]: 10 of 23 START test not_null_gold_regional_summary_region ...................... [RUN]
[0m11:12:26.561285 [info ] [Thread-2 (]: 11 of 23 START test not_null_silver_prices_cleaned_price_id .................... [RUN]
[0m11:12:26.563287 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6, now test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b)
[0m11:12:26.563287 [debug] [Thread-3 (]: On test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f: Close
[0m11:12:26.564285 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c, now test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7)
[0m11:12:26.565284 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff, now test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5)
[0m11:12:26.566284 [debug] [Thread-1 (]: Began compiling node test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b
[0m11:12:26.567285 [info ] [Thread-3 (]: 7 of 23 PASS accepted_values_silver_production_cleaned_is_valid_production__True__False  [[32mPASS[0m in 0.11s]
[0m11:12:26.568287 [debug] [Thread-4 (]: Began compiling node test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7
[0m11:12:26.568287 [debug] [Thread-2 (]: Began compiling node test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5
[0m11:12:26.574286 [debug] [Thread-1 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b"
[0m11:12:26.576285 [debug] [Thread-3 (]: Finished running node test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f
[0m11:12:26.580287 [debug] [Thread-4 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7"
[0m11:12:26.585287 [debug] [Thread-2 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5"
[0m11:12:26.586285 [debug] [Thread-3 (]: Began running node test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df
[0m11:12:26.587285 [debug] [Thread-1 (]: Began executing node test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b
[0m11:12:26.588284 [debug] [Thread-4 (]: Began executing node test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7
[0m11:12:26.589285 [info ] [Thread-3 (]: 12 of 23 START test not_null_silver_prices_cleaned_price_value ................. [RUN]
[0m11:12:26.590285 [debug] [Thread-2 (]: Began executing node test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5
[0m11:12:26.593286 [debug] [Thread-1 (]: Writing runtime sql for node "test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b"
[0m11:12:26.596285 [debug] [Thread-4 (]: Writing runtime sql for node "test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7"
[0m11:12:26.597285 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f, now test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df)
[0m11:12:26.600284 [debug] [Thread-2 (]: Writing runtime sql for node "test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5"
[0m11:12:26.602285 [debug] [Thread-3 (]: Began compiling node test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df
[0m11:12:26.602285 [debug] [Thread-1 (]: Using postgres connection "test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b"
[0m11:12:26.603287 [debug] [Thread-4 (]: Using postgres connection "test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7"
[0m11:12:26.608284 [debug] [Thread-3 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df"
[0m11:12:26.609285 [debug] [Thread-2 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5"
[0m11:12:26.609285 [debug] [Thread-1 (]: On test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b: BEGIN
[0m11:12:26.610285 [debug] [Thread-4 (]: On test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7: BEGIN
[0m11:12:26.611288 [debug] [Thread-2 (]: On test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5: BEGIN
[0m11:12:26.612284 [debug] [Thread-3 (]: Began executing node test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df
[0m11:12:26.613285 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:12:26.614285 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:12:26.614285 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:12:26.618284 [debug] [Thread-3 (]: Writing runtime sql for node "test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df"
[0m11:12:26.620286 [debug] [Thread-3 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df"
[0m11:12:26.621287 [debug] [Thread-3 (]: On test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df: BEGIN
[0m11:12:26.622286 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:12:26.634287 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m11:12:26.635285 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:12:26.635285 [debug] [Thread-4 (]: Using postgres connection "test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7"
[0m11:12:26.636286 [debug] [Thread-2 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5"
[0m11:12:26.637285 [debug] [Thread-4 (]: On test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select region
from "fao"."public"."gold_regional_summary"
where region is null



      
    ) dbt_internal_test
[0m11:12:26.638285 [debug] [Thread-2 (]: On test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select price_id
from "fao"."public"."silver_prices_cleaned"
where price_id is null



      
    ) dbt_internal_test
[0m11:12:26.640286 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:12:26.641285 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:12:26.643285 [debug] [Thread-4 (]: On test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7: ROLLBACK
[0m11:12:26.645285 [debug] [Thread-2 (]: On test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5: ROLLBACK
[0m11:12:26.646284 [debug] [Thread-4 (]: On test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7: Close
[0m11:12:26.647287 [debug] [Thread-2 (]: On test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5: Close
[0m11:12:26.648286 [info ] [Thread-4 (]: 10 of 23 PASS not_null_gold_regional_summary_region ............................ [[32mPASS[0m in 0.08s]
[0m11:12:26.649288 [info ] [Thread-2 (]: 11 of 23 PASS not_null_silver_prices_cleaned_price_id .......................... [[32mPASS[0m in 0.08s]
[0m11:12:26.650288 [debug] [Thread-4 (]: Finished running node test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7
[0m11:12:26.651286 [debug] [Thread-2 (]: Finished running node test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5
[0m11:12:26.652286 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m11:12:26.652286 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:12:26.653286 [debug] [Thread-4 (]: Began running node test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b
[0m11:12:26.654284 [debug] [Thread-2 (]: Began running node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74
[0m11:12:26.655285 [debug] [Thread-3 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df"
[0m11:12:26.656286 [debug] [Thread-1 (]: Using postgres connection "test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b"
[0m11:12:26.657285 [info ] [Thread-4 (]: 13 of 23 START test not_null_silver_prices_cleaned_year ........................ [RUN]
[0m11:12:26.658284 [info ] [Thread-2 (]: 14 of 23 START test not_null_silver_production_cleaned_production_id ........... [RUN]
[0m11:12:26.658284 [debug] [Thread-3 (]: On test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select price_value
from "fao"."public"."silver_prices_cleaned"
where price_value is null



      
    ) dbt_internal_test
[0m11:12:26.659285 [debug] [Thread-1 (]: On test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select item_name
from "fao"."public"."gold_price_production_analysis"
where item_name is null



      
    ) dbt_internal_test
[0m11:12:26.660284 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7, now test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b)
[0m11:12:26.661284 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5, now test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74)
[0m11:12:26.662285 [debug] [Thread-4 (]: Began compiling node test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b
[0m11:12:26.663289 [debug] [Thread-2 (]: Began compiling node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74
[0m11:12:26.664285 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:12:26.664285 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:12:26.669285 [debug] [Thread-4 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b"
[0m11:12:26.675285 [debug] [Thread-2 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74"
[0m11:12:26.679288 [debug] [Thread-1 (]: On test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b: ROLLBACK
[0m11:12:26.682286 [debug] [Thread-3 (]: On test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df: ROLLBACK
[0m11:12:26.684289 [debug] [Thread-4 (]: Began executing node test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b
[0m11:12:26.686289 [debug] [Thread-1 (]: On test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b: Close
[0m11:12:26.687287 [debug] [Thread-2 (]: Began executing node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74
[0m11:12:26.688287 [debug] [Thread-3 (]: On test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df: Close
[0m11:12:26.691285 [debug] [Thread-4 (]: Writing runtime sql for node "test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b"
[0m11:12:26.693288 [info ] [Thread-1 (]: 9 of 23 PASS not_null_gold_price_production_analysis_item_name ................. [[32mPASS[0m in 0.13s]
[0m11:12:26.697288 [debug] [Thread-2 (]: Writing runtime sql for node "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74"
[0m11:12:26.698287 [info ] [Thread-3 (]: 12 of 23 PASS not_null_silver_prices_cleaned_price_value ....................... [[32mPASS[0m in 0.10s]
[0m11:12:26.699289 [debug] [Thread-1 (]: Finished running node test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b
[0m11:12:26.700289 [debug] [Thread-4 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b"
[0m11:12:26.701288 [debug] [Thread-3 (]: Finished running node test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df
[0m11:12:26.702285 [debug] [Thread-2 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74"
[0m11:12:26.704286 [debug] [Thread-1 (]: Began running node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d
[0m11:12:26.705286 [debug] [Thread-4 (]: On test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b: BEGIN
[0m11:12:26.706284 [debug] [Thread-3 (]: Began running node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df
[0m11:12:26.706284 [debug] [Thread-2 (]: On test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74: BEGIN
[0m11:12:26.707286 [info ] [Thread-1 (]: 15 of 23 START test not_null_silver_production_cleaned_production_metric_tons .. [RUN]
[0m11:12:26.708288 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:12:26.709286 [info ] [Thread-3 (]: 16 of 23 START test not_null_silver_production_cleaned_production_value ........ [RUN]
[0m11:12:26.711285 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:12:26.712285 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b, now test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d)
[0m11:12:26.713287 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df, now test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df)
[0m11:12:26.715288 [debug] [Thread-1 (]: Began compiling node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d
[0m11:12:26.716287 [debug] [Thread-3 (]: Began compiling node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df
[0m11:12:26.723284 [debug] [Thread-1 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d"
[0m11:12:26.728286 [debug] [Thread-3 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df"
[0m11:12:26.730288 [debug] [Thread-1 (]: Began executing node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d
[0m11:12:26.731288 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m11:12:26.732285 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:12:26.735909 [debug] [Thread-1 (]: Writing runtime sql for node "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d"
[0m11:12:26.736924 [debug] [Thread-3 (]: Began executing node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df
[0m11:12:26.737925 [debug] [Thread-4 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b"
[0m11:12:26.738924 [debug] [Thread-2 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74"
[0m11:12:26.743926 [debug] [Thread-3 (]: Writing runtime sql for node "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df"
[0m11:12:26.744924 [debug] [Thread-1 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d"
[0m11:12:26.744924 [debug] [Thread-4 (]: On test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select year
from "fao"."public"."silver_prices_cleaned"
where year is null



      
    ) dbt_internal_test
[0m11:12:26.745924 [debug] [Thread-2 (]: On test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select production_id
from "fao"."public"."silver_production_cleaned"
where production_id is null



      
    ) dbt_internal_test
[0m11:12:26.746925 [debug] [Thread-1 (]: On test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d: BEGIN
[0m11:12:26.747923 [debug] [Thread-3 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df"
[0m11:12:26.748925 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:12:26.749923 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:12:26.749923 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:12:26.750923 [debug] [Thread-3 (]: On test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df: BEGIN
[0m11:12:26.753925 [debug] [Thread-4 (]: On test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b: ROLLBACK
[0m11:12:26.755925 [debug] [Thread-2 (]: On test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74: ROLLBACK
[0m11:12:26.755925 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:12:26.757925 [debug] [Thread-4 (]: On test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b: Close
[0m11:12:26.757925 [debug] [Thread-2 (]: On test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74: Close
[0m11:12:26.759925 [info ] [Thread-4 (]: 13 of 23 PASS not_null_silver_prices_cleaned_year .............................. [[32mPASS[0m in 0.10s]
[0m11:12:26.760925 [info ] [Thread-2 (]: 14 of 23 PASS not_null_silver_production_cleaned_production_id ................. [[32mPASS[0m in 0.10s]
[0m11:12:26.761925 [debug] [Thread-4 (]: Finished running node test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b
[0m11:12:26.762927 [debug] [Thread-2 (]: Finished running node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74
[0m11:12:26.763925 [debug] [Thread-4 (]: Began running node test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd
[0m11:12:26.764925 [debug] [Thread-2 (]: Began running node test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a
[0m11:12:26.765924 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:12:26.765924 [info ] [Thread-4 (]: 17 of 23 START test not_null_silver_top_countries_area_code .................... [RUN]
[0m11:12:26.766924 [info ] [Thread-2 (]: 18 of 23 START test not_null_silver_top_countries_country_name ................. [RUN]
[0m11:12:26.767925 [debug] [Thread-1 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d"
[0m11:12:26.768926 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b, now test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd)
[0m11:12:26.769925 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74, now test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a)
[0m11:12:26.770924 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m11:12:26.771924 [debug] [Thread-1 (]: On test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select production_metric_tons
from "fao"."public"."silver_production_cleaned"
where production_metric_tons is null



      
    ) dbt_internal_test
[0m11:12:26.771924 [debug] [Thread-4 (]: Began compiling node test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd
[0m11:12:26.772924 [debug] [Thread-2 (]: Began compiling node test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a
[0m11:12:26.773924 [debug] [Thread-3 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df"
[0m11:12:26.778925 [debug] [Thread-4 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd"
[0m11:12:26.779923 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:12:26.784924 [debug] [Thread-2 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a"
[0m11:12:26.785923 [debug] [Thread-3 (]: On test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select production_value
from "fao"."public"."silver_production_cleaned"
where production_value is null



      
    ) dbt_internal_test
[0m11:12:26.788925 [debug] [Thread-1 (]: On test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d: ROLLBACK
[0m11:12:26.789923 [debug] [Thread-4 (]: Began executing node test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd
[0m11:12:26.790923 [debug] [Thread-2 (]: Began executing node test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a
[0m11:12:26.793923 [debug] [Thread-4 (]: Writing runtime sql for node "test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd"
[0m11:12:26.794924 [debug] [Thread-1 (]: On test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d: Close
[0m11:12:26.795923 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:12:26.798924 [debug] [Thread-2 (]: Writing runtime sql for node "test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a"
[0m11:12:26.799925 [info ] [Thread-1 (]: 15 of 23 PASS not_null_silver_production_cleaned_production_metric_tons ........ [[32mPASS[0m in 0.09s]
[0m11:12:26.801926 [debug] [Thread-3 (]: On test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df: ROLLBACK
[0m11:12:26.802925 [debug] [Thread-4 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd"
[0m11:12:26.804924 [debug] [Thread-1 (]: Finished running node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d
[0m11:12:26.804924 [debug] [Thread-2 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a"
[0m11:12:26.805925 [debug] [Thread-3 (]: On test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df: Close
[0m11:12:26.806924 [debug] [Thread-4 (]: On test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd: BEGIN
[0m11:12:26.807923 [debug] [Thread-1 (]: Began running node test.fao_elt_pipeline.test_data_quality
[0m11:12:26.808925 [debug] [Thread-2 (]: On test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a: BEGIN
[0m11:12:26.809927 [info ] [Thread-3 (]: 16 of 23 PASS not_null_silver_production_cleaned_production_value .............. [[32mPASS[0m in 0.10s]
[0m11:12:26.809927 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:12:26.810924 [info ] [Thread-1 (]: 19 of 23 START test test_data_quality .......................................... [RUN]
[0m11:12:26.811925 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:12:26.812926 [debug] [Thread-3 (]: Finished running node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df
[0m11:12:26.814924 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d, now test.fao_elt_pipeline.test_data_quality)
[0m11:12:26.815926 [debug] [Thread-3 (]: Began running node test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4
[0m11:12:26.816924 [debug] [Thread-1 (]: Began compiling node test.fao_elt_pipeline.test_data_quality
[0m11:12:26.817925 [info ] [Thread-3 (]: 20 of 23 START test unique_gold_country_metrics_country_name ................... [RUN]
[0m11:12:26.821923 [debug] [Thread-1 (]: Writing injected SQL for node "test.fao_elt_pipeline.test_data_quality"
[0m11:12:26.822923 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df, now test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4)
[0m11:12:26.823925 [debug] [Thread-3 (]: Began compiling node test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4
[0m11:12:26.832521 [debug] [Thread-3 (]: Writing injected SQL for node "test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4"
[0m11:12:26.833522 [debug] [Thread-1 (]: Began executing node test.fao_elt_pipeline.test_data_quality
[0m11:12:26.837520 [debug] [Thread-1 (]: Writing runtime sql for node "test.fao_elt_pipeline.test_data_quality"
[0m11:12:26.838521 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:12:26.839521 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m11:12:26.840520 [debug] [Thread-3 (]: Began executing node test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4
[0m11:12:26.840520 [debug] [Thread-2 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a"
[0m11:12:26.841521 [debug] [Thread-1 (]: Using postgres connection "test.fao_elt_pipeline.test_data_quality"
[0m11:12:26.842522 [debug] [Thread-4 (]: Using postgres connection "test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd"
[0m11:12:26.846521 [debug] [Thread-3 (]: Writing runtime sql for node "test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4"
[0m11:12:26.847521 [debug] [Thread-2 (]: On test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select country_name
from "fao"."public"."silver_top_countries"
where country_name is null



      
    ) dbt_internal_test
[0m11:12:26.848522 [debug] [Thread-1 (]: On test.fao_elt_pipeline.test_data_quality: BEGIN
[0m11:12:26.849521 [debug] [Thread-4 (]: On test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select area_code
from "fao"."public"."silver_top_countries"
where area_code is null



      
    ) dbt_internal_test
[0m11:12:26.850522 [debug] [Thread-3 (]: Using postgres connection "test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4"
[0m11:12:26.851524 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:12:26.851524 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:12:26.852521 [debug] [Thread-3 (]: On test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4: BEGIN
[0m11:12:26.853520 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:12:26.855523 [debug] [Thread-2 (]: On test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a: ROLLBACK
[0m11:12:26.856524 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:12:26.858522 [debug] [Thread-4 (]: On test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd: ROLLBACK
[0m11:12:26.859521 [debug] [Thread-2 (]: On test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a: Close
[0m11:12:26.860523 [debug] [Thread-4 (]: On test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd: Close
[0m11:12:26.861523 [info ] [Thread-2 (]: 18 of 23 PASS not_null_silver_top_countries_country_name ....................... [[32mPASS[0m in 0.09s]
[0m11:12:26.863522 [info ] [Thread-4 (]: 17 of 23 PASS not_null_silver_top_countries_area_code .......................... [[32mPASS[0m in 0.09s]
[0m11:12:26.864523 [debug] [Thread-2 (]: Finished running node test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a
[0m11:12:26.865524 [debug] [Thread-4 (]: Finished running node test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd
[0m11:12:26.866525 [debug] [Thread-2 (]: Began running node test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1
[0m11:12:26.867522 [debug] [Thread-4 (]: Began running node test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31
[0m11:12:26.868522 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:12:26.868522 [info ] [Thread-2 (]: 21 of 23 START test unique_gold_regional_summary_region ........................ [RUN]
[0m11:12:26.869522 [info ] [Thread-4 (]: 22 of 23 START test unique_silver_prices_cleaned_price_id ...................... [RUN]
[0m11:12:26.870521 [debug] [Thread-1 (]: Using postgres connection "test.fao_elt_pipeline.test_data_quality"
[0m11:12:26.871521 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a, now test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1)
[0m11:12:26.872521 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd, now test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31)
[0m11:12:26.873521 [debug] [Thread-1 (]: On test.fao_elt_pipeline.test_data_quality: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.test_data_quality"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- Test to ensure we have data for major countries
-- This test will fail if we don't have data for these important agricultural producers

SELECT country_name
FROM (
    VALUES
        ('China'),
        ('India'),
        ('USA'),
        ('Brazil'),
        ('Germany')
) AS required_countries(country_name)
WHERE country_name NOT IN (
    SELECT DISTINCT country_name_standardized
    FROM "fao"."public"."silver_production_cleaned"
)
      
    ) dbt_internal_test
[0m11:12:26.873521 [debug] [Thread-2 (]: Began compiling node test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1
[0m11:12:26.874521 [debug] [Thread-4 (]: Began compiling node test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31
[0m11:12:26.880521 [debug] [Thread-2 (]: Writing injected SQL for node "test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1"
[0m11:12:26.881523 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:12:26.886521 [debug] [Thread-4 (]: Writing injected SQL for node "test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31"
[0m11:12:26.888526 [debug] [Thread-1 (]: On test.fao_elt_pipeline.test_data_quality: ROLLBACK
[0m11:12:26.889521 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m11:12:26.890520 [debug] [Thread-2 (]: Began executing node test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1
[0m11:12:26.891521 [debug] [Thread-3 (]: Using postgres connection "test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4"
[0m11:12:26.891521 [debug] [Thread-4 (]: Began executing node test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31
[0m11:12:26.892523 [debug] [Thread-1 (]: On test.fao_elt_pipeline.test_data_quality: Close
[0m11:12:26.898526 [debug] [Thread-2 (]: Writing runtime sql for node "test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1"
[0m11:12:26.900524 [debug] [Thread-3 (]: On test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    country_name as unique_field,
    count(*) as n_records

from "fao"."public"."gold_country_metrics"
where country_name is not null
group by country_name
having count(*) > 1



      
    ) dbt_internal_test
[0m11:12:26.906527 [debug] [Thread-4 (]: Writing runtime sql for node "test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31"
[0m11:12:26.908525 [info ] [Thread-1 (]: 19 of 23 PASS test_data_quality ................................................ [[32mPASS[0m in 0.09s]
[0m11:12:26.911525 [debug] [Thread-2 (]: Using postgres connection "test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1"
[0m11:12:26.912524 [debug] [Thread-1 (]: Finished running node test.fao_elt_pipeline.test_data_quality
[0m11:12:26.913525 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:12:26.914525 [debug] [Thread-4 (]: Using postgres connection "test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31"
[0m11:12:26.914525 [debug] [Thread-2 (]: On test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1: BEGIN
[0m11:12:26.915523 [debug] [Thread-1 (]: Began running node test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048
[0m11:12:26.917523 [debug] [Thread-3 (]: On test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4: ROLLBACK
[0m11:12:26.918524 [debug] [Thread-4 (]: On test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31: BEGIN
[0m11:12:26.919525 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:12:26.919525 [info ] [Thread-1 (]: 23 of 23 START test unique_silver_production_cleaned_production_id ............. [RUN]
[0m11:12:26.920524 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:12:26.921523 [debug] [Thread-3 (]: On test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4: Close
[0m11:12:26.922523 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.test_data_quality, now test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048)
[0m11:12:26.923526 [warn ] [Thread-3 (]: 20 of 23 WARN 1 unique_gold_country_metrics_country_name ....................... [[33mWARN 1[0m in 0.10s]
[0m11:12:26.925215 [debug] [Thread-1 (]: Began compiling node test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048
[0m11:12:26.926232 [debug] [Thread-3 (]: Finished running node test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4
[0m11:12:26.933227 [debug] [Thread-1 (]: Writing injected SQL for node "test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048"
[0m11:12:26.935233 [debug] [Thread-1 (]: Began executing node test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048
[0m11:12:26.940228 [debug] [Thread-1 (]: Writing runtime sql for node "test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048"
[0m11:12:26.941228 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m11:12:26.941228 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:12:26.942228 [debug] [Thread-4 (]: Using postgres connection "test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31"
[0m11:12:26.943227 [debug] [Thread-2 (]: Using postgres connection "test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1"
[0m11:12:26.944227 [debug] [Thread-1 (]: Using postgres connection "test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048"
[0m11:12:26.945228 [debug] [Thread-4 (]: On test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    price_id as unique_field,
    count(*) as n_records

from "fao"."public"."silver_prices_cleaned"
where price_id is not null
group by price_id
having count(*) > 1



      
    ) dbt_internal_test
[0m11:12:26.945228 [debug] [Thread-2 (]: On test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    region as unique_field,
    count(*) as n_records

from "fao"."public"."gold_regional_summary"
where region is not null
group by region
having count(*) > 1



      
    ) dbt_internal_test
[0m11:12:26.946228 [debug] [Thread-1 (]: On test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048: BEGIN
[0m11:12:26.948230 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:12:26.949229 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:12:26.950228 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:12:26.952231 [debug] [Thread-2 (]: On test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1: ROLLBACK
[0m11:12:26.954229 [debug] [Thread-4 (]: On test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31: ROLLBACK
[0m11:12:26.956229 [debug] [Thread-2 (]: On test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1: Close
[0m11:12:26.956229 [debug] [Thread-4 (]: On test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31: Close
[0m11:12:26.958231 [info ] [Thread-2 (]: 21 of 23 PASS unique_gold_regional_summary_region .............................. [[32mPASS[0m in 0.09s]
[0m11:12:26.959228 [warn ] [Thread-4 (]: 22 of 23 WARN 17 unique_silver_prices_cleaned_price_id ......................... [[33mWARN 17[0m in 0.09s]
[0m11:12:26.961232 [debug] [Thread-2 (]: Finished running node test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1
[0m11:12:26.963230 [debug] [Thread-4 (]: Finished running node test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31
[0m11:12:26.981228 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:12:26.982228 [debug] [Thread-1 (]: Using postgres connection "test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048"
[0m11:12:26.983231 [debug] [Thread-1 (]: On test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    production_id as unique_field,
    count(*) as n_records

from "fao"."public"."silver_production_cleaned"
where production_id is not null
group by production_id
having count(*) > 1



      
    ) dbt_internal_test
[0m11:12:26.986230 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:12:26.988229 [debug] [Thread-1 (]: On test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048: ROLLBACK
[0m11:12:26.990229 [debug] [Thread-1 (]: On test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048: Close
[0m11:12:26.992229 [warn ] [Thread-1 (]: 23 of 23 WARN 16 unique_silver_production_cleaned_production_id ................ [[33mWARN 16[0m in 0.07s]
[0m11:12:26.993232 [debug] [Thread-1 (]: Finished running node test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048
[0m11:12:26.995229 [debug] [MainThread]: Using postgres connection "master"
[0m11:12:26.996233 [debug] [MainThread]: On master: BEGIN
[0m11:12:26.997232 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:12:27.011229 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:12:27.011229 [debug] [MainThread]: On master: COMMIT
[0m11:12:27.012228 [debug] [MainThread]: Using postgres connection "master"
[0m11:12:27.013228 [debug] [MainThread]: On master: COMMIT
[0m11:12:27.014227 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:12:27.015228 [debug] [MainThread]: On master: Close
[0m11:12:27.015228 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:12:27.016229 [debug] [MainThread]: Connection 'list_fao_public' was properly closed.
[0m11:12:27.017230 [debug] [MainThread]: Connection 'test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048' was properly closed.
[0m11:12:27.018228 [debug] [MainThread]: Connection 'test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1' was properly closed.
[0m11:12:27.018228 [debug] [MainThread]: Connection 'test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4' was properly closed.
[0m11:12:27.019229 [debug] [MainThread]: Connection 'test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31' was properly closed.
[0m11:12:27.020228 [info ] [MainThread]: 
[0m11:12:27.021229 [info ] [MainThread]: Finished running 23 data tests in 0 hours 0 minutes and 0.94 seconds (0.94s).
[0m11:12:27.026227 [debug] [MainThread]: Command end result
[0m11:12:27.072227 [info ] [MainThread]: 
[0m11:12:27.073228 [info ] [MainThread]: [33mCompleted with 3 warnings:[0m
[0m11:12:27.073228 [info ] [MainThread]: 
[0m11:12:27.074227 [warn ] [MainThread]: [33mWarning in test unique_gold_country_metrics_country_name (models\gold\schema.yml)[0m
[0m11:12:27.075227 [warn ] [MainThread]: Got 1 result, configured to warn if != 0
[0m11:12:27.075227 [info ] [MainThread]: 
[0m11:12:27.076227 [info ] [MainThread]:   compiled code at target\compiled\fao_elt_pipeline\models\gold\schema.yml\unique_gold_country_metrics_country_name.sql
[0m11:12:27.077227 [info ] [MainThread]: 
[0m11:12:27.078227 [warn ] [MainThread]: [33mWarning in test unique_silver_prices_cleaned_price_id (models\silver\schema.yml)[0m
[0m11:12:27.078227 [warn ] [MainThread]: Got 17 results, configured to warn if != 0
[0m11:12:27.079227 [info ] [MainThread]: 
[0m11:12:27.080227 [info ] [MainThread]:   compiled code at target\compiled\fao_elt_pipeline\models\silver\schema.yml\unique_silver_prices_cleaned_price_id.sql
[0m11:12:27.080227 [info ] [MainThread]: 
[0m11:12:27.081227 [warn ] [MainThread]: [33mWarning in test unique_silver_production_cleaned_production_id (models\silver\schema.yml)[0m
[0m11:12:27.082229 [warn ] [MainThread]: Got 16 results, configured to warn if != 0
[0m11:12:27.082229 [info ] [MainThread]: 
[0m11:12:27.083228 [info ] [MainThread]:   compiled code at target\compiled\fao_elt_pipeline\models\silver\schema.yml\unique_silver_production_cleaned_production_id.sql
[0m11:12:27.084227 [info ] [MainThread]: 
[0m11:12:27.085227 [info ] [MainThread]: Done. PASS=20 WARN=3 ERROR=0 SKIP=0 TOTAL=23
[0m11:12:27.086227 [debug] [MainThread]: Command `dbt test` succeeded at 11:12:27.086227 after 2.02 seconds
[0m11:12:27.087227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2746E7580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D274301780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D27680CFD0>]}
[0m11:12:27.087227 [debug] [MainThread]: Flushing usage events
[0m11:12:30.190812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA540475B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA56DB3820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA56DB3640>]}


============================== 11:12:30.195810 | 6400103f-c8e2-4d4f-8114-691c69c4477e ==============================
[0m11:12:30.195810 [info ] [MainThread]: Running with dbt=1.8.0
[0m11:12:30.196809 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\18057\\Documents\\Coding\\fao-elt-pipelines\\dbt_project', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\18057\\Documents\\Coding\\fao-elt-pipelines\\dbt_project\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt docs generate --target dev', 'send_anonymous_usage_stats': 'True'}
[0m11:12:30.354420 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m11:12:30.355419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6400103f-c8e2-4d4f-8114-691c69c4477e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA56CF3520>]}
[0m11:12:30.460420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6400103f-c8e2-4d4f-8114-691c69c4477e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA56E6F730>]}
[0m11:12:30.544992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6400103f-c8e2-4d4f-8114-691c69c4477e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA56CF3EB0>]}
[0m11:12:30.546993 [info ] [MainThread]: Registered adapter: postgres=1.8.0
[0m11:12:30.555992 [debug] [MainThread]: checksum: 2a6c64e758918535ccc035b9d143fb4c91b01df5f630e583361ba23a87d2a511, vars: {}, profile: , target: dev, version: 1.8.0
[0m11:12:30.797553 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:12:30.798553 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:12:30.874199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6400103f-c8e2-4d4f-8114-691c69c4477e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA57167BB0>]}
[0m11:12:30.899202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6400103f-c8e2-4d4f-8114-691c69c4477e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA571F9FC0>]}
[0m11:12:30.900199 [info ] [MainThread]: Found 6 models, 23 data tests, 2 sources, 414 macros
[0m11:12:30.901199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6400103f-c8e2-4d4f-8114-691c69c4477e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA571FA740>]}
[0m11:12:30.905202 [info ] [MainThread]: 
[0m11:12:30.906198 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:12:30.912202 [debug] [ThreadPool]: Acquiring new postgres connection 'list_fao_public'
[0m11:12:31.010752 [debug] [ThreadPool]: Using postgres connection "list_fao_public"
[0m11:12:31.011750 [debug] [ThreadPool]: On list_fao_public: BEGIN
[0m11:12:31.012751 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:12:31.029751 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:12:31.030752 [debug] [ThreadPool]: Using postgres connection "list_fao_public"
[0m11:12:31.031753 [debug] [ThreadPool]: On list_fao_public: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "connection_name": "list_fao_public"} */
select
      'fao' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'fao' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'fao' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:12:31.035751 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m11:12:31.038750 [debug] [ThreadPool]: On list_fao_public: ROLLBACK
[0m11:12:31.039753 [debug] [ThreadPool]: On list_fao_public: Close
[0m11:12:31.047752 [debug] [MainThread]: Using postgres connection "master"
[0m11:12:31.048752 [debug] [MainThread]: On master: BEGIN
[0m11:12:31.049751 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:12:31.064751 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:12:31.064751 [debug] [MainThread]: Using postgres connection "master"
[0m11:12:31.065753 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:12:31.072751 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m11:12:31.073750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6400103f-c8e2-4d4f-8114-691c69c4477e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA56E6CA00>]}
[0m11:12:31.074753 [debug] [MainThread]: On master: ROLLBACK
[0m11:12:31.075753 [debug] [MainThread]: On master: Close
[0m11:12:31.076752 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:12:31.077752 [info ] [MainThread]: 
[0m11:12:31.080749 [debug] [Thread-1 (]: Began running node model.fao_elt_pipeline.silver_prices_cleaned
[0m11:12:31.081749 [debug] [Thread-2 (]: Began running node model.fao_elt_pipeline.silver_production_cleaned
[0m11:12:31.082749 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.fao_elt_pipeline.silver_prices_cleaned'
[0m11:12:31.083752 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.fao_elt_pipeline.silver_production_cleaned'
[0m11:12:31.084753 [debug] [Thread-1 (]: Began compiling node model.fao_elt_pipeline.silver_prices_cleaned
[0m11:12:31.085749 [debug] [Thread-2 (]: Began compiling node model.fao_elt_pipeline.silver_production_cleaned
[0m11:12:31.099749 [debug] [Thread-1 (]: Writing injected SQL for node "model.fao_elt_pipeline.silver_prices_cleaned"
[0m11:12:31.105752 [debug] [Thread-2 (]: Writing injected SQL for node "model.fao_elt_pipeline.silver_production_cleaned"
[0m11:12:31.107749 [debug] [Thread-1 (]: Began executing node model.fao_elt_pipeline.silver_prices_cleaned
[0m11:12:31.108751 [debug] [Thread-1 (]: Finished running node model.fao_elt_pipeline.silver_prices_cleaned
[0m11:12:31.109750 [debug] [Thread-2 (]: Began executing node model.fao_elt_pipeline.silver_production_cleaned
[0m11:12:31.110752 [debug] [Thread-4 (]: Began running node test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff
[0m11:12:31.111751 [debug] [Thread-3 (]: Began running node test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5
[0m11:12:31.112751 [debug] [Thread-1 (]: Began running node test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df
[0m11:12:31.113749 [debug] [Thread-2 (]: Finished running node model.fao_elt_pipeline.silver_production_cleaned
[0m11:12:31.114749 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff'
[0m11:12:31.115753 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5'
[0m11:12:31.116749 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fao_elt_pipeline.silver_prices_cleaned, now test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df)
[0m11:12:31.117749 [debug] [Thread-2 (]: Began running node test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b
[0m11:12:31.118749 [debug] [Thread-4 (]: Began compiling node test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff
[0m11:12:31.119749 [debug] [Thread-3 (]: Began compiling node test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5
[0m11:12:31.120750 [debug] [Thread-1 (]: Began compiling node test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df
[0m11:12:31.121749 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.fao_elt_pipeline.silver_production_cleaned, now test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b)
[0m11:12:31.136312 [debug] [Thread-4 (]: Writing injected SQL for node "test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff"
[0m11:12:31.147309 [debug] [Thread-3 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5"
[0m11:12:31.153311 [debug] [Thread-1 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df"
[0m11:12:31.154312 [debug] [Thread-2 (]: Began compiling node test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b
[0m11:12:31.155313 [debug] [Thread-4 (]: Began executing node test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff
[0m11:12:31.161312 [debug] [Thread-2 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b"
[0m11:12:31.161312 [debug] [Thread-3 (]: Began executing node test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5
[0m11:12:31.163311 [debug] [Thread-4 (]: Finished running node test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff
[0m11:12:31.164312 [debug] [Thread-1 (]: Began executing node test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df
[0m11:12:31.165311 [debug] [Thread-3 (]: Finished running node test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5
[0m11:12:31.166312 [debug] [Thread-2 (]: Began executing node test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b
[0m11:12:31.167310 [debug] [Thread-4 (]: Began running node test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31
[0m11:12:31.168309 [debug] [Thread-1 (]: Finished running node test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df
[0m11:12:31.169311 [debug] [Thread-3 (]: Began running node model.fao_elt_pipeline.gold_country_metrics
[0m11:12:31.170309 [debug] [Thread-2 (]: Finished running node test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b
[0m11:12:31.171310 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.accepted_values_silver_prices_cleaned_is_valid_price__True__False.ad7800ddff, now test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31)
[0m11:12:31.172314 [debug] [Thread-1 (]: Began running node model.fao_elt_pipeline.gold_price_production_analysis
[0m11:12:31.173310 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_id.c36c327aa5, now model.fao_elt_pipeline.gold_country_metrics)
[0m11:12:31.174311 [debug] [Thread-2 (]: Began running node model.fao_elt_pipeline.gold_regional_summary
[0m11:12:31.175310 [debug] [Thread-4 (]: Began compiling node test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31
[0m11:12:31.176310 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_silver_prices_cleaned_price_value.1d92cb84df, now model.fao_elt_pipeline.gold_price_production_analysis)
[0m11:12:31.176310 [debug] [Thread-3 (]: Began compiling node model.fao_elt_pipeline.gold_country_metrics
[0m11:12:31.177313 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_silver_prices_cleaned_year.59a86b354b, now model.fao_elt_pipeline.gold_regional_summary)
[0m11:12:31.186308 [debug] [Thread-4 (]: Writing injected SQL for node "test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31"
[0m11:12:31.187309 [debug] [Thread-1 (]: Began compiling node model.fao_elt_pipeline.gold_price_production_analysis
[0m11:12:31.193312 [debug] [Thread-3 (]: Writing injected SQL for node "model.fao_elt_pipeline.gold_country_metrics"
[0m11:12:31.195313 [debug] [Thread-2 (]: Began compiling node model.fao_elt_pipeline.gold_regional_summary
[0m11:12:31.241311 [debug] [Thread-1 (]: Writing injected SQL for node "model.fao_elt_pipeline.gold_price_production_analysis"
[0m11:12:31.242310 [debug] [Thread-4 (]: Began executing node test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31
[0m11:12:31.248313 [debug] [Thread-2 (]: Writing injected SQL for node "model.fao_elt_pipeline.gold_regional_summary"
[0m11:12:31.248313 [debug] [Thread-3 (]: Began executing node model.fao_elt_pipeline.gold_country_metrics
[0m11:12:31.250311 [debug] [Thread-4 (]: Finished running node test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31
[0m11:12:31.251309 [debug] [Thread-1 (]: Began executing node model.fao_elt_pipeline.gold_price_production_analysis
[0m11:12:31.252312 [debug] [Thread-3 (]: Finished running node model.fao_elt_pipeline.gold_country_metrics
[0m11:12:31.253313 [debug] [Thread-4 (]: Began running node model.fao_elt_pipeline.silver_top_countries
[0m11:12:31.253313 [debug] [Thread-2 (]: Began executing node model.fao_elt_pipeline.gold_regional_summary
[0m11:12:31.255311 [debug] [Thread-1 (]: Finished running node model.fao_elt_pipeline.gold_price_production_analysis
[0m11:12:31.255311 [debug] [Thread-3 (]: Began running node test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f
[0m11:12:31.256311 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.unique_silver_prices_cleaned_price_id.c655b1ce31, now model.fao_elt_pipeline.silver_top_countries)
[0m11:12:31.258310 [debug] [Thread-2 (]: Finished running node model.fao_elt_pipeline.gold_regional_summary
[0m11:12:31.259309 [debug] [Thread-1 (]: Began running node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74
[0m11:12:31.259309 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.fao_elt_pipeline.gold_country_metrics, now test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f)
[0m11:12:31.260313 [debug] [Thread-4 (]: Began compiling node model.fao_elt_pipeline.silver_top_countries
[0m11:12:31.261311 [debug] [Thread-2 (]: Began running node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d
[0m11:12:31.262309 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.fao_elt_pipeline.gold_price_production_analysis, now test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74)
[0m11:12:31.263310 [debug] [Thread-3 (]: Began compiling node test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f
[0m11:12:31.268309 [debug] [Thread-4 (]: Writing injected SQL for node "model.fao_elt_pipeline.silver_top_countries"
[0m11:12:31.269309 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.fao_elt_pipeline.gold_regional_summary, now test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d)
[0m11:12:31.269309 [debug] [Thread-1 (]: Began compiling node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74
[0m11:12:31.274312 [debug] [Thread-3 (]: Writing injected SQL for node "test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f"
[0m11:12:31.276313 [debug] [Thread-2 (]: Began compiling node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d
[0m11:12:31.281311 [debug] [Thread-1 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74"
[0m11:12:31.281311 [debug] [Thread-4 (]: Began executing node model.fao_elt_pipeline.silver_top_countries
[0m11:12:31.286313 [debug] [Thread-2 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d"
[0m11:12:31.287313 [debug] [Thread-3 (]: Began executing node test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f
[0m11:12:31.288310 [debug] [Thread-4 (]: Finished running node model.fao_elt_pipeline.silver_top_countries
[0m11:12:31.289310 [debug] [Thread-1 (]: Began executing node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74
[0m11:12:31.290311 [debug] [Thread-3 (]: Finished running node test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f
[0m11:12:31.291310 [debug] [Thread-2 (]: Began executing node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d
[0m11:12:31.292309 [debug] [Thread-4 (]: Began running node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df
[0m11:12:31.293310 [debug] [Thread-1 (]: Finished running node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74
[0m11:12:31.294311 [debug] [Thread-3 (]: Began running node test.fao_elt_pipeline.test_data_quality
[0m11:12:31.295313 [debug] [Thread-2 (]: Finished running node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d
[0m11:12:31.296310 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.fao_elt_pipeline.silver_top_countries, now test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df)
[0m11:12:31.297310 [debug] [Thread-1 (]: Began running node test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048
[0m11:12:31.298309 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.accepted_values_silver_production_cleaned_is_valid_production__True__False.4d4cd48e1f, now test.fao_elt_pipeline.test_data_quality)
[0m11:12:31.299313 [debug] [Thread-2 (]: Began running node test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee
[0m11:12:31.299313 [debug] [Thread-4 (]: Began compiling node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df
[0m11:12:31.300309 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_silver_production_cleaned_production_id.ff891a8c74, now test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048)
[0m11:12:31.301311 [debug] [Thread-3 (]: Began compiling node test.fao_elt_pipeline.test_data_quality
[0m11:12:31.302310 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_silver_production_cleaned_production_metric_tons.83bf65b74d, now test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee)
[0m11:12:31.307313 [debug] [Thread-4 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df"
[0m11:12:31.308311 [debug] [Thread-1 (]: Began compiling node test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048
[0m11:12:31.313313 [debug] [Thread-3 (]: Writing injected SQL for node "test.fao_elt_pipeline.test_data_quality"
[0m11:12:31.314311 [debug] [Thread-2 (]: Began compiling node test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee
[0m11:12:31.319311 [debug] [Thread-1 (]: Writing injected SQL for node "test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048"
[0m11:12:31.319311 [debug] [Thread-4 (]: Began executing node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df
[0m11:12:31.326313 [debug] [Thread-2 (]: Writing injected SQL for node "test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee"
[0m11:12:31.327313 [debug] [Thread-3 (]: Began executing node test.fao_elt_pipeline.test_data_quality
[0m11:12:31.329311 [debug] [Thread-4 (]: Finished running node test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df
[0m11:12:31.329311 [debug] [Thread-1 (]: Began executing node test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048
[0m11:12:31.331312 [debug] [Thread-3 (]: Finished running node test.fao_elt_pipeline.test_data_quality
[0m11:12:31.331312 [debug] [Thread-4 (]: Began running node test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd
[0m11:12:31.332313 [debug] [Thread-2 (]: Began executing node test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee
[0m11:12:31.333311 [debug] [Thread-1 (]: Finished running node test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048
[0m11:12:31.334311 [debug] [Thread-3 (]: Began running node test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c
[0m11:12:31.335311 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_silver_production_cleaned_production_value.458b9b17df, now test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd)
[0m11:12:31.337310 [debug] [Thread-2 (]: Finished running node test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee
[0m11:12:31.337310 [debug] [Thread-1 (]: Began running node test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4
[0m11:12:31.338310 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.test_data_quality, now test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c)
[0m11:12:31.339310 [debug] [Thread-4 (]: Began compiling node test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd
[0m11:12:31.340388 [debug] [Thread-2 (]: Began running node test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53
[0m11:12:31.340897 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.unique_silver_production_cleaned_production_id.3b195f0048, now test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4)
[0m11:12:31.341906 [debug] [Thread-3 (]: Began compiling node test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c
[0m11:12:31.348909 [debug] [Thread-4 (]: Writing injected SQL for node "test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd"
[0m11:12:31.349906 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.accepted_values_gold_country_metrics_producer_category__Major_Producer__Medium_Producer__Small_Producer.afd4b02aee, now test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53)
[0m11:12:31.350906 [debug] [Thread-1 (]: Began compiling node test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4
[0m11:12:31.355906 [debug] [Thread-3 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c"
[0m11:12:31.356906 [debug] [Thread-2 (]: Began compiling node test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53
[0m11:12:31.361906 [debug] [Thread-1 (]: Writing injected SQL for node "test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4"
[0m11:12:31.362906 [debug] [Thread-4 (]: Began executing node test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd
[0m11:12:31.370907 [debug] [Thread-2 (]: Writing injected SQL for node "test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53"
[0m11:12:31.370907 [debug] [Thread-3 (]: Began executing node test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c
[0m11:12:31.372908 [debug] [Thread-4 (]: Finished running node test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd
[0m11:12:31.373908 [debug] [Thread-1 (]: Began executing node test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4
[0m11:12:31.374907 [debug] [Thread-3 (]: Finished running node test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c
[0m11:12:31.375909 [debug] [Thread-4 (]: Began running node test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69
[0m11:12:31.376909 [debug] [Thread-2 (]: Began executing node test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53
[0m11:12:31.377906 [debug] [Thread-1 (]: Finished running node test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4
[0m11:12:31.378906 [debug] [Thread-3 (]: Began running node test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b
[0m11:12:31.379908 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.accepted_values_gold_country_metrics_production_trend__Growing__Declining__Stable.435cbf23fd, now test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69)
[0m11:12:31.380905 [debug] [Thread-2 (]: Finished running node test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53
[0m11:12:31.381905 [debug] [Thread-1 (]: Began running node test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6
[0m11:12:31.382909 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_gold_country_metrics_country_name.462ab9960c, now test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b)
[0m11:12:31.382909 [debug] [Thread-4 (]: Began compiling node test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69
[0m11:12:31.383907 [debug] [Thread-2 (]: Began running node test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7
[0m11:12:31.384909 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.unique_gold_country_metrics_country_name.06f9b7e3c4, now test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6)
[0m11:12:31.385906 [debug] [Thread-3 (]: Began compiling node test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b
[0m11:12:31.393905 [debug] [Thread-4 (]: Writing injected SQL for node "test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69"
[0m11:12:31.394905 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_commodity_scale__Major_Commodity__Medium_Commodity__Minor_Commodity.11f8d68f53, now test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7)
[0m11:12:31.395909 [debug] [Thread-1 (]: Began compiling node test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6
[0m11:12:31.400908 [debug] [Thread-3 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b"
[0m11:12:31.401907 [debug] [Thread-2 (]: Began compiling node test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7
[0m11:12:31.408906 [debug] [Thread-1 (]: Writing injected SQL for node "test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6"
[0m11:12:31.409906 [debug] [Thread-4 (]: Began executing node test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69
[0m11:12:31.414909 [debug] [Thread-2 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7"
[0m11:12:31.414909 [debug] [Thread-3 (]: Began executing node test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b
[0m11:12:31.416909 [debug] [Thread-4 (]: Finished running node test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69
[0m11:12:31.417907 [debug] [Thread-1 (]: Began executing node test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6
[0m11:12:31.418909 [debug] [Thread-3 (]: Finished running node test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b
[0m11:12:31.419908 [debug] [Thread-4 (]: Began running node test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1
[0m11:12:31.419908 [debug] [Thread-2 (]: Began executing node test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7
[0m11:12:31.420907 [debug] [Thread-1 (]: Finished running node test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6
[0m11:12:31.421906 [debug] [Thread-3 (]: Began running node test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd
[0m11:12:31.422907 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.accepted_values_gold_price_production_analysis_price_tier__Premium_Product__Standard_Product__Basic_Product.51e9d6ba69, now test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1)
[0m11:12:31.423909 [debug] [Thread-2 (]: Finished running node test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7
[0m11:12:31.424905 [debug] [Thread-1 (]: Began running node test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a
[0m11:12:31.425905 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.not_null_gold_price_production_analysis_item_name.9e08aafb9b, now test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd)
[0m11:12:31.426904 [debug] [Thread-4 (]: Began compiling node test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1
[0m11:12:31.427905 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.fao_elt_pipeline.accepted_values_gold_regional_summary_regional_scale__Major_Agricultural_Region__Medium_Agricultural_Region__Minor_Agricultural_Region.367c4d27d6, now test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a)
[0m11:12:31.428906 [debug] [Thread-3 (]: Began compiling node test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd
[0m11:12:31.433909 [debug] [Thread-4 (]: Writing injected SQL for node "test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1"
[0m11:12:31.433909 [debug] [Thread-1 (]: Began compiling node test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a
[0m11:12:31.438909 [debug] [Thread-3 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd"
[0m11:12:31.443906 [debug] [Thread-1 (]: Writing injected SQL for node "test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a"
[0m11:12:31.444906 [debug] [Thread-4 (]: Began executing node test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1
[0m11:12:31.445905 [debug] [Thread-4 (]: Finished running node test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1
[0m11:12:31.446907 [debug] [Thread-3 (]: Began executing node test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd
[0m11:12:31.447908 [debug] [Thread-1 (]: Began executing node test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a
[0m11:12:31.448905 [debug] [Thread-3 (]: Finished running node test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd
[0m11:12:31.449906 [debug] [Thread-1 (]: Finished running node test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a
[0m11:12:31.451908 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:12:31.452907 [debug] [MainThread]: Connection 'list_fao_public' was properly closed.
[0m11:12:31.452907 [debug] [MainThread]: Connection 'test.fao_elt_pipeline.not_null_silver_top_countries_country_name.2b018e022a' was properly closed.
[0m11:12:31.453909 [debug] [MainThread]: Connection 'test.fao_elt_pipeline.not_null_gold_regional_summary_region.e96a308fe7' was properly closed.
[0m11:12:31.454909 [debug] [MainThread]: Connection 'test.fao_elt_pipeline.unique_gold_regional_summary_region.0f46db56e1' was properly closed.
[0m11:12:31.454909 [debug] [MainThread]: Connection 'test.fao_elt_pipeline.not_null_silver_top_countries_area_code.78853a8ffd' was properly closed.
[0m11:12:31.461907 [debug] [MainThread]: Command end result
[0m11:12:31.634534 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m11:12:31.635534 [info ] [MainThread]: Building catalog
[0m11:12:31.647535 [debug] [ThreadPool]: Acquiring new postgres connection 'fao.information_schema'
[0m11:12:31.657533 [debug] [ThreadPool]: Using postgres connection "fao.information_schema"
[0m11:12:31.658535 [debug] [ThreadPool]: On fao.information_schema: BEGIN
[0m11:12:31.658535 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:12:31.672533 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:12:31.673535 [debug] [ThreadPool]: Using postgres connection "fao.information_schema"
[0m11:12:31.674535 [debug] [ThreadPool]: On fao.information_schema: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "connection_name": "fao.information_schema"} */

    
    

    select
        'fao' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('gold_country_metrics')) or (upper(sch.nspname) = upper('bronze') and
           upper(tbl.relname) = upper('raw_prices')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('silver_production_cleaned')) or (upper(sch.nspname) = upper('bronze') and
           upper(tbl.relname) = upper('raw_food_balance')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('gold_regional_summary')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('silver_prices_cleaned')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('gold_price_production_analysis')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('silver_top_countries')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m11:12:31.679533 [debug] [ThreadPool]: SQL status: SELECT 111 in 0.0 seconds
[0m11:12:31.692533 [debug] [ThreadPool]: On fao.information_schema: ROLLBACK
[0m11:12:31.693535 [debug] [ThreadPool]: On fao.information_schema: Close
[0m11:12:31.749107 [info ] [MainThread]: Catalog written to C:\Users\18057\Documents\Coding\fao-elt-pipelines\dbt_project\target\catalog.json
[0m11:12:31.751115 [debug] [MainThread]: Command `dbt docs generate` succeeded at 11:12:31.751115 after 1.65 seconds
[0m11:12:31.752116 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m11:12:31.752116 [debug] [MainThread]: Connection 'fao.information_schema' was properly closed.
[0m11:12:31.753116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA540475B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA571F65F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CA5487B460>]}
[0m11:12:31.754114 [debug] [MainThread]: Flushing usage events
[0m11:17:59.489558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247B7F07580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247BAC73670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247BAC73490>]}


============================== 11:17:59.493554 | ad59a573-006a-427a-b7cf-96b30fae828f ==============================
[0m11:17:59.493554 [info ] [MainThread]: Running with dbt=1.8.0
[0m11:17:59.494554 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\18057\\Documents\\Coding\\fao-elt-pipelines\\dbt_project', 'log_path': 'C:\\Users\\18057\\Documents\\Coding\\fao-elt-pipelines\\dbt_project\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --target dev', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:17:59.649133 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m11:17:59.650133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ad59a573-006a-427a-b7cf-96b30fae828f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247BABFF760>]}
[0m11:17:59.754133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ad59a573-006a-427a-b7cf-96b30fae828f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247B81D4670>]}
[0m11:17:59.836696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ad59a573-006a-427a-b7cf-96b30fae828f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247B7B25780>]}
[0m11:17:59.838698 [info ] [MainThread]: Registered adapter: postgres=1.8.0
[0m11:17:59.848695 [debug] [MainThread]: checksum: 2a6c64e758918535ccc035b9d143fb4c91b01df5f630e583361ba23a87d2a511, vars: {}, profile: , target: dev, version: 1.8.0
[0m11:18:00.094278 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m11:18:00.095278 [debug] [MainThread]: Partial parsing: updated file: fao_elt_pipeline://models\silver\silver_production_cleaned.sql
[0m11:18:00.096278 [debug] [MainThread]: Partial parsing: updated file: fao_elt_pipeline://models\silver\silver_prices_cleaned.sql
[0m11:18:00.792114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ad59a573-006a-427a-b7cf-96b30fae828f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247BB1D8F70>]}
[0m11:18:00.970771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ad59a573-006a-427a-b7cf-96b30fae828f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247BADB8910>]}
[0m11:18:00.971773 [info ] [MainThread]: Found 6 models, 23 data tests, 2 sources, 414 macros
[0m11:18:00.972773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad59a573-006a-427a-b7cf-96b30fae828f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247BADB9720>]}
[0m11:18:00.974772 [info ] [MainThread]: 
[0m11:18:00.975773 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:18:00.981772 [debug] [ThreadPool]: Acquiring new postgres connection 'list_fao'
[0m11:18:01.067357 [debug] [ThreadPool]: Using postgres connection "list_fao"
[0m11:18:01.068357 [debug] [ThreadPool]: On list_fao: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "connection_name": "list_fao"} */

    select distinct nspname from pg_namespace
  
[0m11:18:01.069358 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:18:01.087357 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m11:18:01.089355 [debug] [ThreadPool]: On list_fao: Close
[0m11:18:01.091358 [debug] [ThreadPool]: Acquiring new postgres connection 'list_fao_public'
[0m11:18:01.098357 [debug] [ThreadPool]: Using postgres connection "list_fao_public"
[0m11:18:01.099358 [debug] [ThreadPool]: On list_fao_public: BEGIN
[0m11:18:01.100357 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:18:01.114360 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:18:01.114360 [debug] [ThreadPool]: Using postgres connection "list_fao_public"
[0m11:18:01.115358 [debug] [ThreadPool]: On list_fao_public: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "connection_name": "list_fao_public"} */
select
      'fao' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'fao' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'fao' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:18:01.119360 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m11:18:01.121358 [debug] [ThreadPool]: On list_fao_public: ROLLBACK
[0m11:18:01.122359 [debug] [ThreadPool]: On list_fao_public: Close
[0m11:18:01.129358 [debug] [MainThread]: Using postgres connection "master"
[0m11:18:01.129358 [debug] [MainThread]: On master: BEGIN
[0m11:18:01.130358 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:18:01.143358 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:18:01.144359 [debug] [MainThread]: Using postgres connection "master"
[0m11:18:01.145356 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:18:01.151359 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m11:18:01.153360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad59a573-006a-427a-b7cf-96b30fae828f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247BAD2DE40>]}
[0m11:18:01.154360 [debug] [MainThread]: On master: ROLLBACK
[0m11:18:01.155675 [debug] [MainThread]: Using postgres connection "master"
[0m11:18:01.156358 [debug] [MainThread]: On master: BEGIN
[0m11:18:01.158357 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:18:01.158357 [debug] [MainThread]: On master: COMMIT
[0m11:18:01.159359 [debug] [MainThread]: Using postgres connection "master"
[0m11:18:01.160359 [debug] [MainThread]: On master: COMMIT
[0m11:18:01.161356 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:18:01.161356 [debug] [MainThread]: On master: Close
[0m11:18:01.162356 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:18:01.163360 [info ] [MainThread]: 
[0m11:18:01.167359 [debug] [Thread-1 (]: Began running node model.fao_elt_pipeline.silver_prices_cleaned
[0m11:18:01.168357 [debug] [Thread-2 (]: Began running node model.fao_elt_pipeline.silver_production_cleaned
[0m11:18:01.168357 [info ] [Thread-1 (]: 1 of 6 START sql table model public.silver_prices_cleaned ...................... [RUN]
[0m11:18:01.169357 [info ] [Thread-2 (]: 2 of 6 START sql table model public.silver_production_cleaned .................. [RUN]
[0m11:18:01.171360 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.fao_elt_pipeline.silver_prices_cleaned'
[0m11:18:01.172360 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.fao_elt_pipeline.silver_production_cleaned'
[0m11:18:01.172360 [debug] [Thread-1 (]: Began compiling node model.fao_elt_pipeline.silver_prices_cleaned
[0m11:18:01.173358 [debug] [Thread-2 (]: Began compiling node model.fao_elt_pipeline.silver_production_cleaned
[0m11:18:01.186359 [debug] [Thread-1 (]: Writing injected SQL for node "model.fao_elt_pipeline.silver_prices_cleaned"
[0m11:18:01.192359 [debug] [Thread-2 (]: Writing injected SQL for node "model.fao_elt_pipeline.silver_production_cleaned"
[0m11:18:01.193360 [debug] [Thread-1 (]: Began executing node model.fao_elt_pipeline.silver_prices_cleaned
[0m11:18:01.194358 [debug] [Thread-2 (]: Began executing node model.fao_elt_pipeline.silver_production_cleaned
[0m11:18:01.242918 [debug] [Thread-1 (]: Writing runtime sql for node "model.fao_elt_pipeline.silver_prices_cleaned"
[0m11:18:01.246918 [debug] [Thread-2 (]: Writing runtime sql for node "model.fao_elt_pipeline.silver_production_cleaned"
[0m11:18:01.248922 [debug] [Thread-1 (]: Using postgres connection "model.fao_elt_pipeline.silver_prices_cleaned"
[0m11:18:01.249922 [debug] [Thread-1 (]: On model.fao_elt_pipeline.silver_prices_cleaned: BEGIN
[0m11:18:01.249922 [debug] [Thread-2 (]: Using postgres connection "model.fao_elt_pipeline.silver_production_cleaned"
[0m11:18:01.250919 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:18:01.251920 [debug] [Thread-2 (]: On model.fao_elt_pipeline.silver_production_cleaned: BEGIN
[0m11:18:01.252921 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:18:01.265921 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:18:01.267921 [debug] [Thread-1 (]: Using postgres connection "model.fao_elt_pipeline.silver_prices_cleaned"
[0m11:18:01.267921 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:18:01.268920 [debug] [Thread-1 (]: On model.fao_elt_pipeline.silver_prices_cleaned: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.silver_prices_cleaned"} */

  
    

  create  table "fao"."public"."silver_prices_cleaned__dbt_tmp"
  
  
    as
  
  (
    

WITH raw_prices AS (
    SELECT
        data,
        loaded_at
    FROM "fao"."bronze"."raw_prices"
),

flattened_prices AS (
    SELECT
        (data->>'area')::TEXT as country_name,
        (data->>'area_code')::TEXT as area_code,
        (data->>'area_code_m49')::TEXT as area_code_m49,
        (data->>'element')::TEXT as element_name,
        (data->>'element_code')::TEXT as element_code,
        (data->>'flag')::TEXT as flag,
        (data->>'item')::TEXT as item_name,
        (data->>'item_code')::TEXT as item_code,
        (data->>'item_code_cpc')::TEXT as item_code_cpc,
        (data->>'unit')::TEXT as unit,
        (data->>'value')::NUMERIC as price_value,
        (data->>'year')::INTEGER as year,
        loaded_at
    FROM raw_prices
)

SELECT
    
    md5(
            coalesce(cast(area_code as varchar), '') || '-' || 
            coalesce(cast(element_code as varchar), '') || '-' || 
            coalesce(cast(item_code as varchar), '') || '-' || 
            coalesce(cast(value as varchar), '') || '-' || 
            coalesce(cast(year as varchar), '')
    )
 as price_id,
    country_name,
    area_code,
    area_code_m49,
    element_name,
    element_code,
    flag,
    item_name,
    item_code,
    item_code_cpc,
    unit,
    price_value,
    year,
    -- Add data quality flags
    CASE
        WHEN price_value IS NULL OR price_value <= 0 THEN FALSE
        ELSE TRUE
    END as is_valid_price,
    -- Add standardized country names (handle special characters)
    CASE
        WHEN country_name LIKE '%Côte%' THEN 'Ivory Coast'
        WHEN country_name = 'China, mainland' THEN 'China'
        WHEN country_name = 'United States of America' THEN 'USA'
        WHEN country_name = 'United Kingdom of Great Britain and Northern Ireland' THEN 'UK'
        ELSE country_name
    END as country_name_standardized,
    loaded_at,
    CURRENT_TIMESTAMP as transformed_at
FROM flattened_prices
WHERE price_value IS NOT NULL
  AND price_value > 0
  AND year >= 1990  -- Focus on more recent data
  );
  
[0m11:18:01.269919 [debug] [Thread-2 (]: Using postgres connection "model.fao_elt_pipeline.silver_production_cleaned"
[0m11:18:01.270919 [debug] [Thread-2 (]: On model.fao_elt_pipeline.silver_production_cleaned: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "fao_elt_pipeline", "target_name": "dev", "node_id": "model.fao_elt_pipeline.silver_production_cleaned"} */

  
    

  create  table "fao"."public"."silver_production_cleaned__dbt_tmp"
  
  
    as
  
  (
    

WITH raw_production AS (
    SELECT
        data,
        loaded_at
    FROM "fao"."bronze"."raw_food_balance"
),

flattened_production AS (
    SELECT
        (data->>'area')::TEXT as country_name,
        (data->>'area_code')::TEXT as area_code,
        (data->>'area_code_m49')::TEXT as area_code_m49,
        (data->>'element')::TEXT as element_name,
        (data->>'element_code')::TEXT as element_code,
        (data->>'flag')::TEXT as flag,
        (data->>'item')::TEXT as item_name,
        (data->>'item_code')::TEXT as item_code,
        (data->>'item_code_fbs')::TEXT as item_code_fbs,
        (data->>'unit')::TEXT as unit,
        (data->>'value')::NUMERIC as production_value,
        (data->>'year')::INTEGER as year,
        loaded_at
    FROM raw_production
)

SELECT
    
    md5(
            coalesce(cast(area_code as varchar), '') || '-' || 
            coalesce(cast(element_code as varchar), '') || '-' || 
            coalesce(cast(item_code as varchar), '') || '-' || 
            coalesce(cast(value as varchar), '') || '-' || 
            coalesce(cast(year as varchar), '')
    )
 as production_id,
    country_name,
    area_code,
    area_code_m49,
    element_name,
    element_code,
    flag,
    item_name,
    item_code,
    item_code_fbs,
    unit,
    production_value,
    year,
    -- Convert to metric tons for consistency
    CASE
        WHEN unit = '1000 t' THEN production_value * 1000
        ELSE production_value
    END as production_metric_tons,
    -- Add data quality flags
    CASE
        WHEN production_value IS NULL OR production_value < 0 THEN FALSE
        ELSE TRUE
    END as is_valid_production,
    -- Add standardized country names
    CASE
        WHEN country_name LIKE '%Côte%' THEN 'Ivory Coast'
        WHEN country_name = 'China, mainland' THEN 'China'
        WHEN country_name = 'United States of America' THEN 'USA'
        WHEN country_name = 'United Kingdom of Great Britain and Northern Ireland' THEN 'UK'
        ELSE country_name
    END as country_name_standardized,
    loaded_at,
    CURRENT_TIMESTAMP as transformed_at
FROM flattened_production
WHERE element_name = 'Production'  -- Focus on production data only
  AND production_value >= 0
  AND year >= 1990
  );
  
[0m11:18:01.272920 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "value" does not exist
LINE 45:             coalesce(cast(value as varchar), '') || '-' || 
                                   ^

[0m11:18:01.272920 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column "value" does not exist
LINE 45:             coalesce(cast(value as varchar), '') || '-' || 
                                   ^

[0m11:18:01.273920 [debug] [Thread-1 (]: On model.fao_elt_pipeline.silver_prices_cleaned: ROLLBACK
[0m11:18:01.275454 [debug] [Thread-2 (]: On model.fao_elt_pipeline.silver_production_cleaned: ROLLBACK
[0m11:18:01.276523 [debug] [Thread-1 (]: On model.fao_elt_pipeline.silver_prices_cleaned: Close
[0m11:18:01.277602 [debug] [Thread-2 (]: On model.fao_elt_pipeline.silver_production_cleaned: Close
[0m11:18:01.286411 [debug] [Thread-1 (]: Database Error in model silver_prices_cleaned (models\silver\silver_prices_cleaned.sql)
  column "value" does not exist
  LINE 45:             coalesce(cast(value as varchar), '') || '-' || 
                                     ^
  compiled code at target\run\fao_elt_pipeline\models\silver\silver_prices_cleaned.sql
[0m11:18:01.288060 [debug] [Thread-2 (]: Database Error in model silver_production_cleaned (models\silver\silver_production_cleaned.sql)
  column "value" does not exist
  LINE 45:             coalesce(cast(value as varchar), '') || '-' || 
                                     ^
  compiled code at target\run\fao_elt_pipeline\models\silver\silver_production_cleaned.sql
[0m11:18:01.290586 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad59a573-006a-427a-b7cf-96b30fae828f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247BC83FBB0>]}
[0m11:18:01.291583 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad59a573-006a-427a-b7cf-96b30fae828f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247B7BB63B0>]}
[0m11:18:01.292586 [error] [Thread-1 (]: 1 of 6 ERROR creating sql table model public.silver_prices_cleaned ............. [[31mERROR[0m in 0.12s]
[0m11:18:01.293587 [error] [Thread-2 (]: 2 of 6 ERROR creating sql table model public.silver_production_cleaned ......... [[31mERROR[0m in 0.12s]
[0m11:18:01.294584 [debug] [Thread-1 (]: Finished running node model.fao_elt_pipeline.silver_prices_cleaned
[0m11:18:01.295585 [debug] [Thread-2 (]: Finished running node model.fao_elt_pipeline.silver_production_cleaned
[0m11:18:01.298201 [debug] [Thread-4 (]: Began running node model.fao_elt_pipeline.gold_country_metrics
[0m11:18:01.299206 [debug] [Thread-3 (]: Began running node model.fao_elt_pipeline.gold_price_production_analysis
[0m11:18:01.300205 [debug] [Thread-1 (]: Began running node model.fao_elt_pipeline.gold_regional_summary
[0m11:18:01.300444 [debug] [Thread-2 (]: Began running node model.fao_elt_pipeline.silver_top_countries
[0m11:18:01.301864 [info ] [Thread-4 (]: 3 of 6 SKIP relation public.gold_country_metrics ............................... [[33mSKIP[0m]
[0m11:18:01.302881 [info ] [Thread-3 (]: 4 of 6 SKIP relation public.gold_price_production_analysis ..................... [[33mSKIP[0m]
[0m11:18:01.304879 [info ] [Thread-1 (]: 5 of 6 SKIP relation public.gold_regional_summary .............................. [[33mSKIP[0m]
[0m11:18:01.305880 [info ] [Thread-2 (]: 6 of 6 SKIP relation public.silver_top_countries ............................... [[33mSKIP[0m]
[0m11:18:01.306881 [debug] [Thread-4 (]: Finished running node model.fao_elt_pipeline.gold_country_metrics
[0m11:18:01.308879 [debug] [Thread-3 (]: Finished running node model.fao_elt_pipeline.gold_price_production_analysis
[0m11:18:01.309881 [debug] [Thread-1 (]: Finished running node model.fao_elt_pipeline.gold_regional_summary
[0m11:18:01.310881 [debug] [Thread-2 (]: Finished running node model.fao_elt_pipeline.silver_top_countries
[0m11:18:01.313881 [debug] [MainThread]: Using postgres connection "master"
[0m11:18:01.314878 [debug] [MainThread]: On master: BEGIN
[0m11:18:01.315878 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:18:01.348378 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:18:01.349379 [debug] [MainThread]: On master: COMMIT
[0m11:18:01.350378 [debug] [MainThread]: Using postgres connection "master"
[0m11:18:01.351378 [debug] [MainThread]: On master: COMMIT
[0m11:18:01.352380 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:18:01.353377 [debug] [MainThread]: On master: Close
[0m11:18:01.353905 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:18:01.354903 [debug] [MainThread]: Connection 'list_fao' was properly closed.
[0m11:18:01.355903 [debug] [MainThread]: Connection 'list_fao_public' was properly closed.
[0m11:18:01.355903 [debug] [MainThread]: Connection 'model.fao_elt_pipeline.silver_prices_cleaned' was properly closed.
[0m11:18:01.356905 [debug] [MainThread]: Connection 'model.fao_elt_pipeline.silver_production_cleaned' was properly closed.
[0m11:18:01.357903 [info ] [MainThread]: 
[0m11:18:01.358904 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m11:18:01.360904 [debug] [MainThread]: Command end result
[0m11:18:01.410591 [info ] [MainThread]: 
[0m11:18:01.411589 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m11:18:01.412591 [info ] [MainThread]: 
[0m11:18:01.412591 [error] [MainThread]:   Database Error in model silver_prices_cleaned (models\silver\silver_prices_cleaned.sql)
  column "value" does not exist
  LINE 45:             coalesce(cast(value as varchar), '') || '-' || 
                                     ^
  compiled code at target\run\fao_elt_pipeline\models\silver\silver_prices_cleaned.sql
[0m11:18:01.413591 [info ] [MainThread]: 
[0m11:18:01.414591 [error] [MainThread]:   Database Error in model silver_production_cleaned (models\silver\silver_production_cleaned.sql)
  column "value" does not exist
  LINE 45:             coalesce(cast(value as varchar), '') || '-' || 
                                     ^
  compiled code at target\run\fao_elt_pipeline\models\silver\silver_production_cleaned.sql
[0m11:18:01.414591 [info ] [MainThread]: 
[0m11:18:01.415917 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=4 TOTAL=6
[0m11:18:01.417591 [debug] [MainThread]: Command `dbt run` failed at 11:18:01.416591 after 2.02 seconds
[0m11:18:01.417591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247B7F07580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247BAD8FAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247BAD8F6D0>]}
[0m11:18:01.418591 [debug] [MainThread]: Flushing usage events
