{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.0", "generated_at": "2025-07-17T18:18:01.359905Z", "invocation_id": "ad59a573-006a-427a-b7cf-96b30fae828f", "env": {}}, "results": [{"status": "error", "timing": [{"name": "compile", "started_at": "2025-07-17T18:18:01.174360Z", "completed_at": "2025-07-17T18:18:01.193360Z"}, {"name": "execute", "started_at": "2025-07-17T18:18:01.195396Z", "completed_at": "2025-07-17T18:18:01.276523Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.11821126937866211, "adapter_response": {}, "message": "Database Error in model silver_prices_cleaned (models\\silver\\silver_prices_cleaned.sql)\n  column \"value\" does not exist\n  LINE 45:             coalesce(cast(value as varchar), '') || '-' || \n                                     ^\n  compiled code at target\\run\\fao_elt_pipeline\\models\\silver\\silver_prices_cleaned.sql", "failures": null, "unique_id": "model.fao_elt_pipeline.silver_prices_cleaned", "compiled": true, "compiled_code": "\n\nWITH raw_prices AS (\n    SELECT\n        data,\n        loaded_at\n    FROM \"fao\".\"bronze\".\"raw_prices\"\n),\n\nflattened_prices AS (\n    SELECT\n        (data->>'area')::TEXT as country_name,\n        (data->>'area_code')::TEXT as area_code,\n        (data->>'area_code_m49')::TEXT as area_code_m49,\n        (data->>'element')::TEXT as element_name,\n        (data->>'element_code')::TEXT as element_code,\n        (data->>'flag')::TEXT as flag,\n        (data->>'item')::TEXT as item_name,\n        (data->>'item_code')::TEXT as item_code,\n        (data->>'item_code_cpc')::TEXT as item_code_cpc,\n        (data->>'unit')::TEXT as unit,\n        (data->>'value')::NUMERIC as price_value,\n        (data->>'year')::INTEGER as year,\n        loaded_at\n    FROM raw_prices\n)\n\nSELECT\n    \n    md5(\n            coalesce(cast(area_code as varchar), '') || '-' || \n            coalesce(cast(element_code as varchar), '') || '-' || \n            coalesce(cast(item_code as varchar), '') || '-' || \n            coalesce(cast(value as varchar), '') || '-' || \n            coalesce(cast(year as varchar), '')\n    )\n as price_id,\n    country_name,\n    area_code,\n    area_code_m49,\n    element_name,\n    element_code,\n    flag,\n    item_name,\n    item_code,\n    item_code_cpc,\n    unit,\n    price_value,\n    year,\n    -- Add data quality flags\n    CASE\n        WHEN price_value IS NULL OR price_value <= 0 THEN FALSE\n        ELSE TRUE\n    END as is_valid_price,\n    -- Add standardized country names (handle special characters)\n    CASE\n        WHEN country_name LIKE '%C\u00f4te%' THEN 'Ivory Coast'\n        WHEN country_name = 'China, mainland' THEN 'China'\n        WHEN country_name = 'United States of America' THEN 'USA'\n        WHEN country_name = 'United Kingdom of Great Britain and Northern Ireland' THEN 'UK'\n        ELSE country_name\n    END as country_name_standardized,\n    loaded_at,\n    CURRENT_TIMESTAMP as transformed_at\nFROM flattened_prices\nWHERE price_value IS NOT NULL\n  AND price_value > 0\n  AND year >= 1990  -- Focus on more recent data", "relation_name": "\"fao\".\"public\".\"silver_prices_cleaned\""}, {"status": "error", "timing": [{"name": "compile", "started_at": "2025-07-17T18:18:01.187360Z", "completed_at": "2025-07-17T18:18:01.194358Z"}, {"name": "execute", "started_at": "2025-07-17T18:18:01.242918Z", "completed_at": "2025-07-17T18:18:01.277602Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.1202232837677002, "adapter_response": {}, "message": "Database Error in model silver_production_cleaned (models\\silver\\silver_production_cleaned.sql)\n  column \"value\" does not exist\n  LINE 45:             coalesce(cast(value as varchar), '') || '-' || \n                                     ^\n  compiled code at target\\run\\fao_elt_pipeline\\models\\silver\\silver_production_cleaned.sql", "failures": null, "unique_id": "model.fao_elt_pipeline.silver_production_cleaned", "compiled": true, "compiled_code": "\n\nWITH raw_production AS (\n    SELECT\n        data,\n        loaded_at\n    FROM \"fao\".\"bronze\".\"raw_food_balance\"\n),\n\nflattened_production AS (\n    SELECT\n        (data->>'area')::TEXT as country_name,\n        (data->>'area_code')::TEXT as area_code,\n        (data->>'area_code_m49')::TEXT as area_code_m49,\n        (data->>'element')::TEXT as element_name,\n        (data->>'element_code')::TEXT as element_code,\n        (data->>'flag')::TEXT as flag,\n        (data->>'item')::TEXT as item_name,\n        (data->>'item_code')::TEXT as item_code,\n        (data->>'item_code_fbs')::TEXT as item_code_fbs,\n        (data->>'unit')::TEXT as unit,\n        (data->>'value')::NUMERIC as production_value,\n        (data->>'year')::INTEGER as year,\n        loaded_at\n    FROM raw_production\n)\n\nSELECT\n    \n    md5(\n            coalesce(cast(area_code as varchar), '') || '-' || \n            coalesce(cast(element_code as varchar), '') || '-' || \n            coalesce(cast(item_code as varchar), '') || '-' || \n            coalesce(cast(value as varchar), '') || '-' || \n            coalesce(cast(year as varchar), '')\n    )\n as production_id,\n    country_name,\n    area_code,\n    area_code_m49,\n    element_name,\n    element_code,\n    flag,\n    item_name,\n    item_code,\n    item_code_fbs,\n    unit,\n    production_value,\n    year,\n    -- Convert to metric tons for consistency\n    CASE\n        WHEN unit = '1000 t' THEN production_value * 1000\n        ELSE production_value\n    END as production_metric_tons,\n    -- Add data quality flags\n    CASE\n        WHEN production_value IS NULL OR production_value < 0 THEN FALSE\n        ELSE TRUE\n    END as is_valid_production,\n    -- Add standardized country names\n    CASE\n        WHEN country_name LIKE '%C\u00f4te%' THEN 'Ivory Coast'\n        WHEN country_name = 'China, mainland' THEN 'China'\n        WHEN country_name = 'United States of America' THEN 'USA'\n        WHEN country_name = 'United Kingdom of Great Britain and Northern Ireland' THEN 'UK'\n        ELSE country_name\n    END as country_name_standardized,\n    loaded_at,\n    CURRENT_TIMESTAMP as transformed_at\nFROM flattened_production\nWHERE element_name = 'Production'  -- Focus on production data only\n  AND production_value >= 0\n  AND year >= 1990", "relation_name": "\"fao\".\"public\".\"silver_production_cleaned\""}, {"status": "skipped", "timing": [], "thread_id": "Thread-4 (worker)", "execution_time": 0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.fao_elt_pipeline.gold_country_metrics", "compiled": false, "compiled_code": null, "relation_name": "\"fao\".\"public\".\"gold_country_metrics\""}, {"status": "skipped", "timing": [], "thread_id": "Thread-3 (worker)", "execution_time": 0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.fao_elt_pipeline.gold_price_production_analysis", "compiled": false, "compiled_code": null, "relation_name": "\"fao\".\"public\".\"gold_price_production_analysis\""}, {"status": "skipped", "timing": [], "thread_id": "Thread-1 (worker)", "execution_time": 0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.fao_elt_pipeline.gold_regional_summary", "compiled": false, "compiled_code": null, "relation_name": "\"fao\".\"public\".\"gold_regional_summary\""}, {"status": "skipped", "timing": [], "thread_id": "Thread-2 (worker)", "execution_time": 0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.fao_elt_pipeline.silver_top_countries", "compiled": false, "compiled_code": null, "relation_name": "\"fao\".\"public\".\"silver_top_countries\""}], "elapsed_time": 0.3821299076080322, "args": {"project_dir": "C:\\Users\\18057\\Documents\\Coding\\fao-elt-pipelines\\dbt_project", "source_freshness_run_project_hooks": false, "send_anonymous_usage_stats": true, "print": true, "strict_mode": false, "require_explicit_package_overrides_for_builtin_materializations": true, "log_format_file": "debug", "use_colors": true, "log_format": "default", "log_file_max_bytes": 10485760, "profiles_dir": "C:\\Users\\18057\\Documents\\Coding\\fao-elt-pipelines\\dbt_project", "partial_parse": true, "warn_error_options": {"include": [], "exclude": []}, "cache_selected_only": false, "printer_width": 80, "target": "dev", "macro_debugging": false, "vars": {}, "write_json": true, "quiet": false, "require_resource_names_without_spaces": false, "select": [], "log_level": "info", "show_resource_report": false, "introspect": true, "which": "run", "use_colors_file": true, "log_level_file": "debug", "partial_parse_file_diff": true, "version_check": true, "favor_state": false, "empty": false, "static_parser": true, "populate_cache": true, "indirect_selection": "eager", "enable_legacy_logger": false, "exclude": [], "defer": false, "invocation_command": "dbt run --target dev", "log_path": "C:\\Users\\18057\\Documents\\Coding\\fao-elt-pipelines\\dbt_project\\logs"}}